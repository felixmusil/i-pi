FCOMP = gfortran
FCFLAGS = -O -fdefault-real-8 -fdefault-double-8 -ffree-line-length-0 -J./mod3b

#FFLAGS = -O -openmp -parallel  -u -module ./mod3b_omp
#FFLAGS = -mcmodel=medium -shared-intel -O -u -module ./mod3b_bigm
#FC = pgf90
#FFLAGS = -O -mp -mcmodel=medium -module ./mod_3bpgi_omp
#FFLAGS = -O  -module ./mod_3bpgi

BLD = /usr/bin/ar -rcv

# Set objlibinv to the list of object files to be included in libinv.a.
objlib = inv_wp_t.o \
bg63_prims.o \
cg3_prims.o \
cg6_prims.o \
inv_mgx_t.o \
inv_mg63_t.o\
inv_cxx_t.o \
inv_cx63_t.o\
inv_t.o\
pes0_t.o \
pes_x6y3_t.o\
pes1c_t.o\
pes_t.o

LIBDIR = ../../../lib/watlib
LIB = libpes3b.a
MODS = mod3b

#-----------------------------------------------------------------------
# Rules.

all : $(objlib) $(LIB) $(LIBDIR)/$(LIB)


.PHONY : all clean
.SUFFIXES : $(nil)
.SUFFIXES : .f90 .o .exe

# Autogenerated dependency file
include .depend

# Pattern rule to make %.o file
%.o: %.f90
	$(FCOMP) $(FCFLAGS) -c $<

# Here are the rules to make the libraries.
$(LIB) : $(objlib)
	$(BLD) $(@F) $(objlib)
	mv $(@F) $(LIBDIR)/
	cp -r $(MODS) $(LIBDIR)/$(MODS)

# Targets 'clean' and 'realclean' clean up the directory.
clean :
	rm -f *.o *.a $(MODS)/*.mod *~ core junk $(LIBDIR)/$(LIB) $(LIBDIR)/$(MODS)/*.mod


