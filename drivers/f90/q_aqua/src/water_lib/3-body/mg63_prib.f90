SUBROUTINE mg63_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg63_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg63_prib: bad size u'
!! else if (size(w).ne.mg63_npb(mxd)) then
!!  stop 'mg63_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 3 6 8 7 5 4 0 0 0
! prib,  dnpb(0:*): 1 3 12 36 103 266 663 1548 3502 7601
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(4:6) = u(0)*w(1:3)
 w(7:8) = u(1)*w(2:3)
 w(9) = u(2)*w(3)
 w(10) = u(3)*w(0)
 w(11) = u(4)*w(0)
 w(12) = u(5)*w(0)
 w(13) = u(6)*w(0)
 w(14) = u(7)*w(0)
 w(15) = u(8)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(16:27) = u(0)*w(4:15)
 w(28:36) = u(1)*w(7:15)
 w(37:43) = u(2)*w(9:15)
 w(44) = u(9)*w(0)
 w(45) = u(10)*w(0)
 w(46) = u(11)*w(0)
 w(47) = u(12)*w(0)
 w(48) = u(13)*w(0)
 w(49) = u(14)*w(0)
 w(50) = u(15)*w(0)
 w(51) = u(16)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(52:87) = u(0)*w(16:51)
 w(88:111) = u(1)*w(28:51)
 w(112:126) = u(2)*w(37:51)
 w(127:132) = u(3)*w(10:15)
 w(133:137) = u(4)*w(11:15)
 w(138:141) = u(5)*w(12:15)
 w(142:144) = u(6)*w(13:15)
 w(145:146) = u(7)*w(14:15)
 w(147) = u(8)*w(15)
 w(148) = u(17)*w(0)
 w(149) = u(18)*w(0)
 w(150) = u(19)*w(0)
 w(151) = u(20)*w(0)
 w(152) = u(21)*w(0)
 w(153) = u(22)*w(0)
 w(154) = u(23)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(155:257) = u(0)*w(52:154)
 w(258:324) = u(1)*w(88:154)
 w(325:367) = u(2)*w(112:154)
 w(368:375) = u(3)*w(44:51)
 w(376:383) = u(4)*w(44:51)
 w(384:391) = u(5)*w(44:51)
 w(392:399) = u(6)*w(44:51)
 w(400:407) = u(7)*w(44:51)
 w(408:415) = u(8)*w(44:51)
 w(416) = u(24)*w(0)
 w(417) = u(25)*w(0)
 w(418) = u(26)*w(0)
 w(419) = u(27)*w(0)
 w(420) = u(28)*w(0)
endif
! terms of degree 6
if (6.le.mxd) then
 w(421:686) = u(0)*w(155:420)
 w(687:849) = u(1)*w(258:420)
 w(850:945) = u(2)*w(325:420)
 w(946:973) = u(3)*w(127:154)
 w(974:995) = u(4)*w(133:154)
 w(996:1012) = u(5)*w(138:154)
 w(1013:1025) = u(6)*w(142:154)
 w(1026:1035) = u(7)*w(145:154)
 w(1036:1043) = u(8)*w(147:154)
 w(1044:1051) = u(9)*w(44:51)
 w(1052:1058) = u(10)*w(45:51)
 w(1059:1064) = u(11)*w(46:51)
 w(1065:1069) = u(12)*w(47:51)
 w(1070:1073) = u(13)*w(48:51)
 w(1074:1076) = u(14)*w(49:51)
 w(1077:1078) = u(15)*w(50:51)
 w(1079) = u(16)*w(51)
 w(1080) = u(29)*w(0)
 w(1081) = u(30)*w(0)
 w(1082) = u(31)*w(0)
 w(1083) = u(32)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(1084:1746) = u(0)*w(421:1083)
 w(1747:2143) = u(1)*w(687:1083)
 w(2144:2377) = u(2)*w(850:1083)
 w(2378:2430) = u(3)*w(368:420)
 w(2431:2475) = u(4)*w(376:420)
 w(2476:2512) = u(5)*w(384:420)
 w(2513:2541) = u(6)*w(392:420)
 w(2542:2562) = u(7)*w(400:420)
 w(2563:2575) = u(8)*w(408:420)
 w(2576:2582) = u(9)*w(148:154)
 w(2583:2589) = u(10)*w(148:154)
 w(2590:2596) = u(11)*w(148:154)
 w(2597:2603) = u(12)*w(148:154)
 w(2604:2610) = u(13)*w(148:154)
 w(2611:2617) = u(14)*w(148:154)
 w(2618:2624) = u(15)*w(148:154)
 w(2625:2631) = u(16)*w(148:154)
endif
! terms of degree 8
if (8.le.mxd) then
 w(2632:4179) = u(0)*w(1084:2631)
 w(4180:5064) = u(1)*w(1747:2631)
 w(5065:5552) = u(2)*w(2144:2631)
 w(5553:5690) = u(3)*w(946:1083)
 w(5691:5800) = u(4)*w(974:1083)
 w(5801:5888) = u(5)*w(996:1083)
 w(5889:5959) = u(6)*w(1013:1083)
 w(5960:6017) = u(7)*w(1026:1083)
 w(6018:6065) = u(8)*w(1036:1083)
 w(6066:6070) = u(9)*w(416:420)
 w(6071:6075) = u(10)*w(416:420)
 w(6076:6080) = u(11)*w(416:420)
 w(6081:6085) = u(12)*w(416:420)
 w(6086:6090) = u(13)*w(416:420)
 w(6091:6095) = u(14)*w(416:420)
 w(6096:6100) = u(15)*w(416:420)
 w(6101:6105) = u(16)*w(416:420)
 w(6106:6112) = u(17)*w(148:154)
 w(6113:6118) = u(18)*w(149:154)
 w(6119:6123) = u(19)*w(150:154)
 w(6124:6127) = u(20)*w(151:154)
 w(6128:6130) = u(21)*w(152:154)
 w(6131:6132) = u(22)*w(153:154)
 w(6133) = u(23)*w(154)
endif
! terms of degree 9
if (9.le.mxd) then
 w(6134:9635) = u(0)*w(2632:6133)
 w(9636:11589) = u(1)*w(4180:6133)
 w(11590:12658) = u(2)*w(5065:6133)
 w(12659:12912) = u(3)*w(2378:2631)
 w(12913:13113) = u(4)*w(2431:2631)
 w(13114:13269) = u(5)*w(2476:2631)
 w(13270:13388) = u(6)*w(2513:2631)
 w(13389:13478) = u(7)*w(2542:2631)
 w(13479:13547) = u(8)*w(2563:2631)
 w(13548:13587) = u(9)*w(1044:1083)
 w(13588:13619) = u(10)*w(1052:1083)
 w(13620:13644) = u(11)*w(1059:1083)
 w(13645:13663) = u(12)*w(1065:1083)
 w(13664:13677) = u(13)*w(1070:1083)
 w(13678:13687) = u(14)*w(1074:1083)
 w(13688:13694) = u(15)*w(1077:1083)
 w(13695:13699) = u(16)*w(1079:1083)
 w(13700:13704) = u(17)*w(416:420)
 w(13705:13709) = u(18)*w(416:420)
 w(13710:13714) = u(19)*w(416:420)
 w(13715:13719) = u(20)*w(416:420)
 w(13720:13724) = u(21)*w(416:420)
 w(13725:13729) = u(22)*w(416:420)
 w(13730:13734) = u(23)*w(416:420)
endif
END SUBROUTINE mg63_prib
