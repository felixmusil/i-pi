SUBROUTINE mg44_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg44_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg44_prib: bad size u'
!! else if (size(w).ne.mg44_npb(mxd)) then
!!  stop 'mg44_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 3 7 9 7 0 1 0 0 0
! prib,  dnpb(0:*): 1 3 13 40 119 313 801 1898 4360 9558
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(4:6) = u(0)*w(1:3)
 w(7:8) = u(1)*w(2:3)
 w(9) = u(2)*w(3)
 w(10) = u(3)*w(0)
 w(11) = u(4)*w(0)
 w(12) = u(5)*w(0)
 w(13) = u(6)*w(0)
 w(14) = u(7)*w(0)
 w(15) = u(8)*w(0)
 w(16) = u(9)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(17:29) = u(0)*w(4:16)
 w(30:39) = u(1)*w(7:16)
 w(40:47) = u(2)*w(9:16)
 w(48) = u(10)*w(0)
 w(49) = u(11)*w(0)
 w(50) = u(12)*w(0)
 w(51) = u(13)*w(0)
 w(52) = u(14)*w(0)
 w(53) = u(15)*w(0)
 w(54) = u(16)*w(0)
 w(55) = u(17)*w(0)
 w(56) = u(18)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(57:96) = u(0)*w(17:56)
 w(97:123) = u(1)*w(30:56)
 w(124:140) = u(2)*w(40:56)
 w(141:147) = u(3)*w(10:16)
 w(148:153) = u(4)*w(11:16)
 w(154:158) = u(5)*w(12:16)
 w(159:162) = u(6)*w(13:16)
 w(163:165) = u(7)*w(14:16)
 w(166:167) = u(8)*w(15:16)
 w(168) = u(9)*w(16)
 w(169) = u(19)*w(0)
 w(170) = u(20)*w(0)
 w(171) = u(21)*w(0)
 w(172) = u(22)*w(0)
 w(173) = u(23)*w(0)
 w(174) = u(24)*w(0)
 w(175) = u(25)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(176:294) = u(0)*w(57:175)
 w(295:373) = u(1)*w(97:175)
 w(374:425) = u(2)*w(124:175)
 w(426:434) = u(3)*w(48:56)
 w(435:443) = u(4)*w(48:56)
 w(444:452) = u(5)*w(48:56)
 w(453:461) = u(6)*w(48:56)
 w(462:470) = u(7)*w(48:56)
 w(471:479) = u(8)*w(48:56)
 w(480:488) = u(9)*w(48:56)
endif
! terms of degree 6
if (6.le.mxd) then
 w(489:801) = u(0)*w(176:488)
 w(802:995) = u(1)*w(295:488)
 w(996:1110) = u(2)*w(374:488)
 w(1111:1145) = u(3)*w(141:175)
 w(1146:1173) = u(4)*w(148:175)
 w(1174:1195) = u(5)*w(154:175)
 w(1196:1212) = u(6)*w(159:175)
 w(1213:1225) = u(7)*w(163:175)
 w(1226:1235) = u(8)*w(166:175)
 w(1236:1243) = u(9)*w(168:175)
 w(1244:1252) = u(10)*w(48:56)
 w(1253:1260) = u(11)*w(49:56)
 w(1261:1267) = u(12)*w(50:56)
 w(1268:1273) = u(13)*w(51:56)
 w(1274:1278) = u(14)*w(52:56)
 w(1279:1282) = u(15)*w(53:56)
 w(1283:1285) = u(16)*w(54:56)
 w(1286:1287) = u(17)*w(55:56)
 w(1288) = u(18)*w(56)
 w(1289) = u(26)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(1290:2090) = u(0)*w(489:1289)
 w(2091:2578) = u(1)*w(802:1289)
 w(2579:2872) = u(2)*w(996:1289)
 w(2873:2935) = u(3)*w(426:488)
 w(2936:2989) = u(4)*w(435:488)
 w(2990:3034) = u(5)*w(444:488)
 w(3035:3070) = u(6)*w(453:488)
 w(3071:3097) = u(7)*w(462:488)
 w(3098:3115) = u(8)*w(471:488)
 w(3116:3124) = u(9)*w(480:488)
 w(3125:3131) = u(10)*w(169:175)
 w(3132:3138) = u(11)*w(169:175)
 w(3139:3145) = u(12)*w(169:175)
 w(3146:3152) = u(13)*w(169:175)
 w(3153:3159) = u(14)*w(169:175)
 w(3160:3166) = u(15)*w(169:175)
 w(3167:3173) = u(16)*w(169:175)
 w(3174:3180) = u(17)*w(169:175)
 w(3181:3187) = u(18)*w(169:175)
endif
! terms of degree 8
if (8.le.mxd) then
 w(3188:5085) = u(0)*w(1290:3187)
 w(5086:6182) = u(1)*w(2091:3187)
 w(6183:6791) = u(2)*w(2579:3187)
 w(6792:6970) = u(3)*w(1111:1289)
 w(6971:7114) = u(4)*w(1146:1289)
 w(7115:7230) = u(5)*w(1174:1289)
 w(7231:7324) = u(6)*w(1196:1289)
 w(7325:7401) = u(7)*w(1213:1289)
 w(7402:7465) = u(8)*w(1226:1289)
 w(7466:7519) = u(9)*w(1236:1289)
 w(7520:7526) = u(19)*w(169:175)
 w(7527:7532) = u(20)*w(170:175)
 w(7533:7537) = u(21)*w(171:175)
 w(7538:7541) = u(22)*w(172:175)
 w(7542:7544) = u(23)*w(173:175)
 w(7545:7546) = u(24)*w(174:175)
 w(7547) = u(25)*w(175)
endif
! terms of degree 9
if (9.le.mxd) then
 w(7548:11907) = u(0)*w(3188:7547)
 w(11908:14369) = u(1)*w(5086:7547)
 w(14370:15734) = u(2)*w(6183:7547)
 w(15735:16049) = u(3)*w(2873:3187)
 w(16050:16301) = u(4)*w(2936:3187)
 w(16302:16499) = u(5)*w(2990:3187)
 w(16500:16652) = u(6)*w(3035:3187)
 w(16653:16769) = u(7)*w(3071:3187)
 w(16770:16859) = u(8)*w(3098:3187)
 w(16860:16931) = u(9)*w(3116:3187)
 w(16932:16977) = u(10)*w(1244:1289)
 w(16978:17014) = u(11)*w(1253:1289)
 w(17015:17043) = u(12)*w(1261:1289)
 w(17044:17065) = u(13)*w(1268:1289)
 w(17066:17081) = u(14)*w(1274:1289)
 w(17082:17092) = u(15)*w(1279:1289)
 w(17093:17099) = u(16)*w(1283:1289)
 w(17100:17103) = u(17)*w(1286:1289)
 w(17104:17105) = u(18)*w(1288:1289)
endif
END SUBROUTINE mg44_prib
