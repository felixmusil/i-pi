SUBROUTINE mg222_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg222_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg222_prib: bad size u'
!! else if (size(w).ne.mg222_npb(mxd)) then
!!  stop 'mg222_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 6 9 0 0 0 0 0 0 0
! prib,  dnpb(0:*): 1 6 30 110 360 1026 2706 6570 15075 32680
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(7:12) = u(0)*w(1:6)
 w(13:17) = u(1)*w(2:6)
 w(18:21) = u(2)*w(3:6)
 w(22:24) = u(3)*w(4:6)
 w(25:26) = u(4)*w(5:6)
 w(27) = u(5)*w(6)
 w(28) = u(6)*w(0)
 w(29) = u(7)*w(0)
 w(30) = u(8)*w(0)
 w(31) = u(9)*w(0)
 w(32) = u(10)*w(0)
 w(33) = u(11)*w(0)
 w(34) = u(12)*w(0)
 w(35) = u(13)*w(0)
 w(36) = u(14)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(37:66) = u(0)*w(7:36)
 w(67:90) = u(1)*w(13:36)
 w(91:109) = u(2)*w(18:36)
 w(110:124) = u(3)*w(22:36)
 w(125:136) = u(4)*w(25:36)
 w(137:146) = u(5)*w(27:36)
endif
! terms of degree 4
if (4.le.mxd) then
 w(147:256) = u(0)*w(37:146)
 w(257:336) = u(1)*w(67:146)
 w(337:392) = u(2)*w(91:146)
 w(393:429) = u(3)*w(110:146)
 w(430:451) = u(4)*w(125:146)
 w(452:461) = u(5)*w(137:146)
 w(462:470) = u(6)*w(28:36)
 w(471:478) = u(7)*w(29:36)
 w(479:485) = u(8)*w(30:36)
 w(486:491) = u(9)*w(31:36)
 w(492:496) = u(10)*w(32:36)
 w(497:500) = u(11)*w(33:36)
 w(501:503) = u(12)*w(34:36)
 w(504:505) = u(13)*w(35:36)
 w(506) = u(14)*w(36)
endif
! terms of degree 5
if (5.le.mxd) then
 w(507:866) = u(0)*w(147:506)
 w(867:1116) = u(1)*w(257:506)
 w(1117:1286) = u(2)*w(337:506)
 w(1287:1400) = u(3)*w(393:506)
 w(1401:1477) = u(4)*w(430:506)
 w(1478:1532) = u(5)*w(452:506)
endif
! terms of degree 6
if (6.le.mxd) then
 w(1533:2558) = u(0)*w(507:1532)
 w(2559:3224) = u(1)*w(867:1532)
 w(3225:3640) = u(2)*w(1117:1532)
 w(3641:3886) = u(3)*w(1287:1532)
 w(3887:4018) = u(4)*w(1401:1532)
 w(4019:4073) = u(5)*w(1478:1532)
 w(4074:4118) = u(6)*w(462:506)
 w(4119:4154) = u(7)*w(471:506)
 w(4155:4182) = u(8)*w(479:506)
 w(4183:4203) = u(9)*w(486:506)
 w(4204:4218) = u(10)*w(492:506)
 w(4219:4228) = u(11)*w(497:506)
 w(4229:4234) = u(12)*w(501:506)
 w(4235:4237) = u(13)*w(504:506)
 w(4238) = u(14)*w(506)
endif
! terms of degree 7
if (7.le.mxd) then
 w(4239:6944) = u(0)*w(1533:4238)
 w(6945:8624) = u(1)*w(2559:4238)
 w(8625:9638) = u(2)*w(3225:4238)
 w(9639:10236) = u(3)*w(3641:4238)
 w(10237:10588) = u(4)*w(3887:4238)
 w(10589:10808) = u(5)*w(4019:4238)
endif
! terms of degree 8
if (8.le.mxd) then
 w(10809:17378) = u(0)*w(4239:10808)
 w(17379:21242) = u(1)*w(6945:10808)
 w(21243:23426) = u(2)*w(8625:10808)
 w(23427:24596) = u(3)*w(9639:10808)
 w(24597:25168) = u(4)*w(10237:10808)
 w(25169:25388) = u(5)*w(10589:10808)
 w(25389:25553) = u(6)*w(4074:4238)
 w(25554:25673) = u(7)*w(4119:4238)
 w(25674:25757) = u(8)*w(4155:4238)
 w(25758:25813) = u(9)*w(4183:4238)
 w(25814:25848) = u(10)*w(4204:4238)
 w(25849:25868) = u(11)*w(4219:4238)
 w(25869:25878) = u(12)*w(4229:4238)
 w(25879:25882) = u(13)*w(4235:4238)
 w(25883) = u(14)*w(4238)
endif
! terms of degree 9
if (9.le.mxd) then
 w(25884:40958) = u(0)*w(10809:25883)
 w(40959:49463) = u(1)*w(17379:25883)
 w(49464:54104) = u(2)*w(21243:25883)
 w(54105:56561) = u(3)*w(23427:25883)
 w(56562:57848) = u(4)*w(24597:25883)
 w(57849:58563) = u(5)*w(25169:25883)
endif
END SUBROUTINE mg222_prib
