SUBROUTINE mg73_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg73_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg73_prib: bad size u'
!! else if (size(w).ne.mg73_npb(mxd)) then
!!  stop 'mg73_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 3 6 9 7 5 4 4 0 0
! prib,  dnpb(0:*): 1 3 12 37 106 278 700 1658 3792 8349
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(4:6) = u(0)*w(1:3)
 w(7:8) = u(1)*w(2:3)
 w(9) = u(2)*w(3)
 w(10) = u(3)*w(0)
 w(11) = u(4)*w(0)
 w(12) = u(5)*w(0)
 w(13) = u(6)*w(0)
 w(14) = u(7)*w(0)
 w(15) = u(8)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(16:27) = u(0)*w(4:15)
 w(28:36) = u(1)*w(7:15)
 w(37:43) = u(2)*w(9:15)
 w(44) = u(9)*w(0)
 w(45) = u(10)*w(0)
 w(46) = u(11)*w(0)
 w(47) = u(12)*w(0)
 w(48) = u(13)*w(0)
 w(49) = u(14)*w(0)
 w(50) = u(15)*w(0)
 w(51) = u(16)*w(0)
 w(52) = u(17)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(53:89) = u(0)*w(16:52)
 w(90:114) = u(1)*w(28:52)
 w(115:130) = u(2)*w(37:52)
 w(131:136) = u(3)*w(10:15)
 w(137:141) = u(4)*w(11:15)
 w(142:145) = u(5)*w(12:15)
 w(146:148) = u(6)*w(13:15)
 w(149:150) = u(7)*w(14:15)
 w(151) = u(8)*w(15)
 w(152) = u(18)*w(0)
 w(153) = u(19)*w(0)
 w(154) = u(20)*w(0)
 w(155) = u(21)*w(0)
 w(156) = u(22)*w(0)
 w(157) = u(23)*w(0)
 w(158) = u(24)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(159:264) = u(0)*w(53:158)
 w(265:333) = u(1)*w(90:158)
 w(334:377) = u(2)*w(115:158)
 w(378:386) = u(3)*w(44:52)
 w(387:395) = u(4)*w(44:52)
 w(396:404) = u(5)*w(44:52)
 w(405:413) = u(6)*w(44:52)
 w(414:422) = u(7)*w(44:52)
 w(423:431) = u(8)*w(44:52)
 w(432) = u(25)*w(0)
 w(433) = u(26)*w(0)
 w(434) = u(27)*w(0)
 w(435) = u(28)*w(0)
 w(436) = u(29)*w(0)
endif
! terms of degree 6
if (6.le.mxd) then
 w(437:714) = u(0)*w(159:436)
 w(715:886) = u(1)*w(265:436)
 w(887:989) = u(2)*w(334:436)
 w(990:1017) = u(3)*w(131:158)
 w(1018:1039) = u(4)*w(137:158)
 w(1040:1056) = u(5)*w(142:158)
 w(1057:1069) = u(6)*w(146:158)
 w(1070:1079) = u(7)*w(149:158)
 w(1080:1087) = u(8)*w(151:158)
 w(1088:1096) = u(9)*w(44:52)
 w(1097:1104) = u(10)*w(45:52)
 w(1105:1111) = u(11)*w(46:52)
 w(1112:1117) = u(12)*w(47:52)
 w(1118:1122) = u(13)*w(48:52)
 w(1123:1126) = u(14)*w(49:52)
 w(1127:1129) = u(15)*w(50:52)
 w(1130:1131) = u(16)*w(51:52)
 w(1132) = u(17)*w(52)
 w(1133) = u(30)*w(0)
 w(1134) = u(31)*w(0)
 w(1135) = u(32)*w(0)
 w(1136) = u(33)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(1137:1836) = u(0)*w(437:1136)
 w(1837:2258) = u(1)*w(715:1136)
 w(2259:2508) = u(2)*w(887:1136)
 w(2509:2567) = u(3)*w(378:436)
 w(2568:2617) = u(4)*w(387:436)
 w(2618:2658) = u(5)*w(396:436)
 w(2659:2690) = u(6)*w(405:436)
 w(2691:2713) = u(7)*w(414:436)
 w(2714:2727) = u(8)*w(423:436)
 w(2728:2734) = u(9)*w(152:158)
 w(2735:2741) = u(10)*w(152:158)
 w(2742:2748) = u(11)*w(152:158)
 w(2749:2755) = u(12)*w(152:158)
 w(2756:2762) = u(13)*w(152:158)
 w(2763:2769) = u(14)*w(152:158)
 w(2770:2776) = u(15)*w(152:158)
 w(2777:2783) = u(16)*w(152:158)
 w(2784:2790) = u(17)*w(152:158)
 w(2791) = u(34)*w(0)
 w(2792) = u(35)*w(0)
 w(2793) = u(36)*w(0)
 w(2794) = u(37)*w(0)
endif
! terms of degree 8
if (8.le.mxd) then
 w(2795:4452) = u(0)*w(1137:2794)
 w(4453:5410) = u(1)*w(1837:2794)
 w(5411:5946) = u(2)*w(2259:2794)
 w(5947:6093) = u(3)*w(990:1136)
 w(6094:6212) = u(4)*w(1018:1136)
 w(6213:6309) = u(5)*w(1040:1136)
 w(6310:6389) = u(6)*w(1057:1136)
 w(6390:6456) = u(7)*w(1070:1136)
 w(6457:6513) = u(8)*w(1080:1136)
 w(6514:6518) = u(9)*w(432:436)
 w(6519:6523) = u(10)*w(432:436)
 w(6524:6528) = u(11)*w(432:436)
 w(6529:6533) = u(12)*w(432:436)
 w(6534:6538) = u(13)*w(432:436)
 w(6539:6543) = u(14)*w(432:436)
 w(6544:6548) = u(15)*w(432:436)
 w(6549:6553) = u(16)*w(432:436)
 w(6554:6558) = u(17)*w(432:436)
 w(6559:6565) = u(18)*w(152:158)
 w(6566:6571) = u(19)*w(153:158)
 w(6572:6576) = u(20)*w(154:158)
 w(6577:6580) = u(21)*w(155:158)
 w(6581:6583) = u(22)*w(156:158)
 w(6584:6585) = u(23)*w(157:158)
 w(6586) = u(24)*w(158)
endif
! terms of degree 9
if (9.le.mxd) then
 w(6587:10378) = u(0)*w(2795:6586)
 w(10379:12512) = u(1)*w(4453:6586)
 w(12513:13688) = u(2)*w(5411:6586)
 w(13689:13974) = u(3)*w(2509:2794)
 w(13975:14201) = u(4)*w(2568:2794)
 w(14202:14378) = u(5)*w(2618:2794)
 w(14379:14514) = u(6)*w(2659:2794)
 w(14515:14618) = u(7)*w(2691:2794)
 w(14619:14699) = u(8)*w(2714:2794)
 w(14700:14748) = u(9)*w(1088:1136)
 w(14749:14788) = u(10)*w(1097:1136)
 w(14789:14820) = u(11)*w(1105:1136)
 w(14821:14845) = u(12)*w(1112:1136)
 w(14846:14864) = u(13)*w(1118:1136)
 w(14865:14878) = u(14)*w(1123:1136)
 w(14879:14888) = u(15)*w(1127:1136)
 w(14889:14895) = u(16)*w(1130:1136)
 w(14896:14900) = u(17)*w(1132:1136)
 w(14901:14905) = u(18)*w(432:436)
 w(14906:14910) = u(19)*w(432:436)
 w(14911:14915) = u(20)*w(432:436)
 w(14916:14920) = u(21)*w(432:436)
 w(14921:14925) = u(22)*w(432:436)
 w(14926:14930) = u(23)*w(432:436)
 w(14931:14935) = u(24)*w(432:436)
endif
END SUBROUTINE mg73_prib
