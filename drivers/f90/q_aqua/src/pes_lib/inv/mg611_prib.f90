SUBROUTINE mg611_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg611_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg611_prib: bad size u'
!! else if (size(w).ne.mg611_npb(mxd)) then
!!  stop 'mg611_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 4 4 6 5 5 4 0 0 0
! prib,  dnpb(0:*): 1 4 14 42 114 285 675 1514 3262 6774
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(5:8) = u(0)*w(1:4)
 w(9:11) = u(1)*w(2:4)
 w(12:13) = u(2)*w(3:4)
 w(14) = u(3)*w(4)
 w(15) = u(4)*w(0)
 w(16) = u(5)*w(0)
 w(17) = u(6)*w(0)
 w(18) = u(7)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(19:32) = u(0)*w(5:18)
 w(33:42) = u(1)*w(9:18)
 w(43:49) = u(2)*w(12:18)
 w(50:54) = u(3)*w(14:18)
 w(55) = u(8)*w(0)
 w(56) = u(9)*w(0)
 w(57) = u(10)*w(0)
 w(58) = u(11)*w(0)
 w(59) = u(12)*w(0)
 w(60) = u(13)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(61:102) = u(0)*w(19:60)
 w(103:130) = u(1)*w(33:60)
 w(131:148) = u(2)*w(43:60)
 w(149:159) = u(3)*w(50:60)
 w(160:163) = u(4)*w(15:18)
 w(164:166) = u(5)*w(16:18)
 w(167:168) = u(6)*w(17:18)
 w(169) = u(7)*w(18)
 w(170) = u(14)*w(0)
 w(171) = u(15)*w(0)
 w(172) = u(16)*w(0)
 w(173) = u(17)*w(0)
 w(174) = u(18)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(175:288) = u(0)*w(61:174)
 w(289:360) = u(1)*w(103:174)
 w(361:404) = u(2)*w(131:174)
 w(405:430) = u(3)*w(149:174)
 w(431:436) = u(4)*w(55:60)
 w(437:442) = u(5)*w(55:60)
 w(443:448) = u(6)*w(55:60)
 w(449:454) = u(7)*w(55:60)
 w(455) = u(19)*w(0)
 w(456) = u(20)*w(0)
 w(457) = u(21)*w(0)
 w(458) = u(22)*w(0)
 w(459) = u(23)*w(0)
endif
! terms of degree 6
if (6.le.mxd) then
 w(460:744) = u(0)*w(175:459)
 w(745:915) = u(1)*w(289:459)
 w(916:1014) = u(2)*w(361:459)
 w(1015:1069) = u(3)*w(405:459)
 w(1070:1084) = u(4)*w(160:174)
 w(1085:1095) = u(5)*w(164:174)
 w(1096:1103) = u(6)*w(167:174)
 w(1104:1109) = u(7)*w(169:174)
 w(1110:1115) = u(8)*w(55:60)
 w(1116:1120) = u(9)*w(56:60)
 w(1121:1124) = u(10)*w(57:60)
 w(1125:1127) = u(11)*w(58:60)
 w(1128:1129) = u(12)*w(59:60)
 w(1130) = u(13)*w(60)
 w(1131) = u(24)*w(0)
 w(1132) = u(25)*w(0)
 w(1133) = u(26)*w(0)
 w(1134) = u(27)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(1135:1809) = u(0)*w(460:1134)
 w(1810:2199) = u(1)*w(745:1134)
 w(2200:2418) = u(2)*w(916:1134)
 w(2419:2538) = u(3)*w(1015:1134)
 w(2539:2567) = u(4)*w(431:459)
 w(2568:2590) = u(5)*w(437:459)
 w(2591:2607) = u(6)*w(443:459)
 w(2608:2618) = u(7)*w(449:459)
 w(2619:2623) = u(8)*w(170:174)
 w(2624:2628) = u(9)*w(170:174)
 w(2629:2633) = u(10)*w(170:174)
 w(2634:2638) = u(11)*w(170:174)
 w(2639:2643) = u(12)*w(170:174)
 w(2644:2648) = u(13)*w(170:174)
endif
! terms of degree 8
if (8.le.mxd) then
 w(2649:4162) = u(0)*w(1135:2648)
 w(4163:5001) = u(1)*w(1810:2648)
 w(5002:5450) = u(2)*w(2200:2648)
 w(5451:5680) = u(3)*w(2419:2648)
 w(5681:5745) = u(4)*w(1070:1134)
 w(5746:5795) = u(5)*w(1085:1134)
 w(5796:5834) = u(6)*w(1096:1134)
 w(5835:5865) = u(7)*w(1104:1134)
 w(5866:5870) = u(8)*w(455:459)
 w(5871:5875) = u(9)*w(455:459)
 w(5876:5880) = u(10)*w(455:459)
 w(5881:5885) = u(11)*w(455:459)
 w(5886:5890) = u(12)*w(455:459)
 w(5891:5895) = u(13)*w(455:459)
 w(5896:5900) = u(14)*w(170:174)
 w(5901:5904) = u(15)*w(171:174)
 w(5905:5907) = u(16)*w(172:174)
 w(5908:5909) = u(17)*w(173:174)
 w(5910) = u(18)*w(174)
endif
! terms of degree 9
if (9.le.mxd) then
 w(5911:9172) = u(0)*w(2649:5910)
 w(9173:10920) = u(1)*w(4163:5910)
 w(10921:11829) = u(2)*w(5002:5910)
 w(11830:12289) = u(3)*w(5451:5910)
 w(12290:12399) = u(4)*w(2539:2648)
 w(12400:12480) = u(5)*w(2568:2648)
 w(12481:12538) = u(6)*w(2591:2648)
 w(12539:12579) = u(7)*w(2608:2648)
 w(12580:12604) = u(8)*w(1110:1134)
 w(12605:12623) = u(9)*w(1116:1134)
 w(12624:12637) = u(10)*w(1121:1134)
 w(12638:12647) = u(11)*w(1125:1134)
 w(12648:12654) = u(12)*w(1128:1134)
 w(12655:12659) = u(13)*w(1130:1134)
 w(12660:12664) = u(14)*w(455:459)
 w(12665:12669) = u(15)*w(455:459)
 w(12670:12674) = u(16)*w(455:459)
 w(12675:12679) = u(17)*w(455:459)
 w(12680:12684) = u(18)*w(455:459)
endif
END SUBROUTINE mg611_prib
