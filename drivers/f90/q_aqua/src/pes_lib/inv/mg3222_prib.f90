SUBROUTINE mg3222_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg3222_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg3222_prib: bad size u'
!! else if (size(w).ne.mg3222_npb(mxd)) then
!!  stop 'mg3222_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 10 19 4 0 0 3 0 0 0
! prib,  dnpb(0:*): 1 10 74 414 1990 8378 32023 112508 369010 1138952
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
 w(10) = u(9)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(11:20) = u(0)*w(1:10)
 w(21:29) = u(1)*w(2:10)
 w(30:37) = u(2)*w(3:10)
 w(38:44) = u(3)*w(4:10)
 w(45:50) = u(4)*w(5:10)
 w(51:55) = u(5)*w(6:10)
 w(56:59) = u(6)*w(7:10)
 w(60:62) = u(7)*w(8:10)
 w(63:64) = u(8)*w(9:10)
 w(65) = u(9)*w(10)
 w(66) = u(10)*w(0)
 w(67) = u(11)*w(0)
 w(68) = u(12)*w(0)
 w(69) = u(13)*w(0)
 w(70) = u(14)*w(0)
 w(71) = u(15)*w(0)
 w(72) = u(16)*w(0)
 w(73) = u(17)*w(0)
 w(74) = u(18)*w(0)
 w(75) = u(19)*w(0)
 w(76) = u(20)*w(0)
 w(77) = u(21)*w(0)
 w(78) = u(22)*w(0)
 w(79) = u(23)*w(0)
 w(80) = u(24)*w(0)
 w(81) = u(25)*w(0)
 w(82) = u(26)*w(0)
 w(83) = u(27)*w(0)
 w(84) = u(28)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(85:158) = u(0)*w(11:84)
 w(159:222) = u(1)*w(21:84)
 w(223:277) = u(2)*w(30:84)
 w(278:324) = u(3)*w(38:84)
 w(325:364) = u(4)*w(45:84)
 w(365:398) = u(5)*w(51:84)
 w(399:427) = u(6)*w(56:84)
 w(428:452) = u(7)*w(60:84)
 w(453:474) = u(8)*w(63:84)
 w(475:494) = u(9)*w(65:84)
 w(495) = u(29)*w(0)
 w(496) = u(30)*w(0)
 w(497) = u(31)*w(0)
 w(498) = u(32)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(499:912) = u(0)*w(85:498)
 w(913:1252) = u(1)*w(159:498)
 w(1253:1528) = u(2)*w(223:498)
 w(1529:1749) = u(3)*w(278:498)
 w(1750:1923) = u(4)*w(325:498)
 w(1924:2057) = u(5)*w(365:498)
 w(2058:2157) = u(6)*w(399:498)
 w(2158:2228) = u(7)*w(428:498)
 w(2229:2274) = u(8)*w(453:498)
 w(2275:2298) = u(9)*w(475:498)
 w(2299:2317) = u(10)*w(66:84)
 w(2318:2335) = u(11)*w(67:84)
 w(2336:2352) = u(12)*w(68:84)
 w(2353:2368) = u(13)*w(69:84)
 w(2369:2383) = u(14)*w(70:84)
 w(2384:2397) = u(15)*w(71:84)
 w(2398:2410) = u(16)*w(72:84)
 w(2411:2422) = u(17)*w(73:84)
 w(2423:2433) = u(18)*w(74:84)
 w(2434:2443) = u(19)*w(75:84)
 w(2444:2452) = u(20)*w(76:84)
 w(2453:2460) = u(21)*w(77:84)
 w(2461:2467) = u(22)*w(78:84)
 w(2468:2473) = u(23)*w(79:84)
 w(2474:2478) = u(24)*w(80:84)
 w(2479:2482) = u(25)*w(81:84)
 w(2483:2485) = u(26)*w(82:84)
 w(2486:2487) = u(27)*w(83:84)
 w(2488) = u(28)*w(84)
endif
! terms of degree 5
if (5.le.mxd) then
 w(2489:4478) = u(0)*w(499:2488)
 w(4479:6054) = u(1)*w(913:2488)
 w(6055:7290) = u(2)*w(1253:2488)
 w(7291:8250) = u(3)*w(1529:2488)
 w(8251:8989) = u(4)*w(1750:2488)
 w(8990:9554) = u(5)*w(1924:2488)
 w(9555:9985) = u(6)*w(2058:2488)
 w(9986:10316) = u(7)*w(2158:2488)
 w(10317:10576) = u(8)*w(2229:2488)
 w(10577:10790) = u(9)*w(2275:2488)
 w(10791:10794) = u(10)*w(495:498)
 w(10795:10798) = u(11)*w(495:498)
 w(10799:10802) = u(12)*w(495:498)
 w(10803:10806) = u(13)*w(495:498)
 w(10807:10810) = u(14)*w(495:498)
 w(10811:10814) = u(15)*w(495:498)
 w(10815:10818) = u(16)*w(495:498)
 w(10819:10822) = u(17)*w(495:498)
 w(10823:10826) = u(18)*w(495:498)
 w(10827:10830) = u(19)*w(495:498)
 w(10831:10834) = u(20)*w(495:498)
 w(10835:10838) = u(21)*w(495:498)
 w(10839:10842) = u(22)*w(495:498)
 w(10843:10846) = u(23)*w(495:498)
 w(10847:10850) = u(24)*w(495:498)
 w(10851:10854) = u(25)*w(495:498)
 w(10855:10858) = u(26)*w(495:498)
 w(10859:10862) = u(27)*w(495:498)
 w(10863:10866) = u(28)*w(495:498)
endif
! terms of degree 6
if (6.le.mxd) then
 w(10867:19244) = u(0)*w(2489:10866)
 w(19245:25632) = u(1)*w(4479:10866)
 w(25633:30444) = u(2)*w(6055:10866)
 w(30445:34020) = u(3)*w(7291:10866)
 w(34021:36636) = u(4)*w(8251:10866)
 w(36637:38513) = u(5)*w(8990:10866)
 w(38514:39825) = u(6)*w(9555:10866)
 w(39826:40706) = u(7)*w(9986:10866)
 w(40707:41256) = u(8)*w(10317:10866)
 w(41257:41546) = u(9)*w(10577:10866)
 w(41547:41736) = u(10)*w(2299:2488)
 w(41737:41907) = u(11)*w(2318:2488)
 w(41908:42060) = u(12)*w(2336:2488)
 w(42061:42196) = u(13)*w(2353:2488)
 w(42197:42316) = u(14)*w(2369:2488)
 w(42317:42421) = u(15)*w(2384:2488)
 w(42422:42512) = u(16)*w(2398:2488)
 w(42513:42590) = u(17)*w(2411:2488)
 w(42591:42656) = u(18)*w(2423:2488)
 w(42657:42711) = u(19)*w(2434:2488)
 w(42712:42756) = u(20)*w(2444:2488)
 w(42757:42792) = u(21)*w(2453:2488)
 w(42793:42820) = u(22)*w(2461:2488)
 w(42821:42841) = u(23)*w(2468:2488)
 w(42842:42856) = u(24)*w(2474:2488)
 w(42857:42866) = u(25)*w(2479:2488)
 w(42867:42872) = u(26)*w(2483:2488)
 w(42873:42875) = u(27)*w(2486:2488)
 w(42876) = u(28)*w(2488)
 w(42877:42880) = u(29)*w(495:498)
 w(42881:42883) = u(30)*w(496:498)
 w(42884:42885) = u(31)*w(497:498)
 w(42886) = u(32)*w(498)
 w(42887) = u(33)*w(0)
 w(42888) = u(34)*w(0)
 w(42889) = u(35)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(42890:74912) = u(0)*w(10867:42889)
 w(74913:98557) = u(1)*w(19245:42889)
 w(98558:115814) = u(2)*w(25633:42889)
 w(115815:128259) = u(3)*w(30445:42889)
 w(128260:137128) = u(4)*w(34021:42889)
 w(137129:143381) = u(5)*w(36637:42889)
 w(143382:147757) = u(6)*w(38514:42889)
 w(147758:150821) = u(7)*w(39826:42889)
 w(150822:153004) = u(8)*w(40707:42889)
 w(153005:154637) = u(9)*w(41257:42889)
 w(154638:154713) = u(10)*w(10791:10866)
 w(154714:154785) = u(11)*w(10795:10866)
 w(154786:154853) = u(12)*w(10799:10866)
 w(154854:154917) = u(13)*w(10803:10866)
 w(154918:154977) = u(14)*w(10807:10866)
 w(154978:155033) = u(15)*w(10811:10866)
 w(155034:155085) = u(16)*w(10815:10866)
 w(155086:155133) = u(17)*w(10819:10866)
 w(155134:155177) = u(18)*w(10823:10866)
 w(155178:155217) = u(19)*w(10827:10866)
 w(155218:155253) = u(20)*w(10831:10866)
 w(155254:155285) = u(21)*w(10835:10866)
 w(155286:155313) = u(22)*w(10839:10866)
 w(155314:155337) = u(23)*w(10843:10866)
 w(155338:155357) = u(24)*w(10847:10866)
 w(155358:155373) = u(25)*w(10851:10866)
 w(155374:155385) = u(26)*w(10855:10866)
 w(155386:155393) = u(27)*w(10859:10866)
 w(155394:155397) = u(28)*w(10863:10866)
endif
! terms of degree 8
if (8.le.mxd) then
 w(155398:267905) = u(0)*w(42890:155397)
 w(267906:348390) = u(1)*w(74913:155397)
 w(348391:405230) = u(2)*w(98558:155397)
 w(405231:444813) = u(3)*w(115815:155397)
 w(444814:471951) = u(4)*w(128260:155397)
 w(471952:490220) = u(5)*w(137129:155397)
 w(490221:502236) = u(6)*w(143382:155397)
 w(502237:509876) = u(7)*w(147758:155397)
 w(509877:514452) = u(8)*w(150822:155397)
 w(514453:516845) = u(9)*w(153005:155397)
 w(516846:518188) = u(10)*w(41547:42889)
 w(518189:519341) = u(11)*w(41737:42889)
 w(519342:520323) = u(12)*w(41908:42889)
 w(520324:521152) = u(13)*w(42061:42889)
 w(521153:521845) = u(14)*w(42197:42889)
 w(521846:522418) = u(15)*w(42317:42889)
 w(522419:522886) = u(16)*w(42422:42889)
 w(522887:523263) = u(17)*w(42513:42889)
 w(523264:523562) = u(18)*w(42591:42889)
 w(523563:523795) = u(19)*w(42657:42889)
 w(523796:523973) = u(20)*w(42712:42889)
 w(523974:524106) = u(21)*w(42757:42889)
 w(524107:524203) = u(22)*w(42793:42889)
 w(524204:524272) = u(23)*w(42821:42889)
 w(524273:524320) = u(24)*w(42842:42889)
 w(524321:524353) = u(25)*w(42857:42889)
 w(524354:524376) = u(26)*w(42867:42889)
 w(524377:524393) = u(27)*w(42873:42889)
 w(524394:524407) = u(28)*w(42876:42889)
endif
! terms of degree 9
if (9.le.mxd) then
 w(524408:893417) = u(0)*w(155398:524407)
 w(893418:1149919) = u(1)*w(267906:524407)
 w(1149920:1325936) = u(2)*w(348391:524407)
 w(1325937:1445113) = u(3)*w(405231:524407)
 w(1445114:1524707) = u(4)*w(444814:524407)
 w(1524708:1577163) = u(5)*w(471952:524407)
 w(1577164:1611350) = u(6)*w(490221:524407)
 w(1611351:1633521) = u(7)*w(502237:524407)
 w(1633522:1648052) = u(8)*w(509877:524407)
 w(1648053:1658007) = u(9)*w(514453:524407)
 w(1658008:1658767) = u(10)*w(154638:155397)
 w(1658768:1659451) = u(11)*w(154714:155397)
 w(1659452:1660063) = u(12)*w(154786:155397)
 w(1660064:1660607) = u(13)*w(154854:155397)
 w(1660608:1661087) = u(14)*w(154918:155397)
 w(1661088:1661507) = u(15)*w(154978:155397)
 w(1661508:1661871) = u(16)*w(155034:155397)
 w(1661872:1662183) = u(17)*w(155086:155397)
 w(1662184:1662447) = u(18)*w(155134:155397)
 w(1662448:1662667) = u(19)*w(155178:155397)
 w(1662668:1662847) = u(20)*w(155218:155397)
 w(1662848:1662991) = u(21)*w(155254:155397)
 w(1662992:1663103) = u(22)*w(155286:155397)
 w(1663104:1663187) = u(23)*w(155314:155397)
 w(1663188:1663247) = u(24)*w(155338:155397)
 w(1663248:1663287) = u(25)*w(155358:155397)
 w(1663288:1663311) = u(26)*w(155374:155397)
 w(1663312:1663323) = u(27)*w(155386:155397)
 w(1663324:1663327) = u(28)*w(155394:155397)
 w(1663328:1663340) = u(29)*w(42877:42889)
 w(1663341:1663349) = u(30)*w(42881:42889)
 w(1663350:1663355) = u(31)*w(42884:42889)
 w(1663356:1663359) = u(32)*w(42886:42889)
endif
END SUBROUTINE mg3222_prib
