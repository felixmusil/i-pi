SUBROUTINE mg33_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg33_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg33_prib: bad size u'
!! else if (size(w).ne.mg33_npb(mxd)) then
!!  stop 'mg33_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 3 5 5 1 0 1 0 0 0
! prib,  dnpb(0:*): 1 3 11 30 76 174 380 774 1522 2864
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(4:6) = u(0)*w(1:3)
 w(7:8) = u(1)*w(2:3)
 w(9) = u(2)*w(3)
 w(10) = u(3)*w(0)
 w(11) = u(4)*w(0)
 w(12) = u(5)*w(0)
 w(13) = u(6)*w(0)
 w(14) = u(7)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(15:25) = u(0)*w(4:14)
 w(26:33) = u(1)*w(7:14)
 w(34:39) = u(2)*w(9:14)
 w(40) = u(8)*w(0)
 w(41) = u(9)*w(0)
 w(42) = u(10)*w(0)
 w(43) = u(11)*w(0)
 w(44) = u(12)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(45:74) = u(0)*w(15:44)
 w(75:93) = u(1)*w(26:44)
 w(94:104) = u(2)*w(34:44)
 w(105:109) = u(3)*w(10:14)
 w(110:113) = u(4)*w(11:14)
 w(114:116) = u(5)*w(12:14)
 w(117:118) = u(6)*w(13:14)
 w(119) = u(7)*w(14)
 w(120) = u(13)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(121:196) = u(0)*w(45:120)
 w(197:242) = u(1)*w(75:120)
 w(243:269) = u(2)*w(94:120)
 w(270:274) = u(3)*w(40:44)
 w(275:279) = u(4)*w(40:44)
 w(280:284) = u(5)*w(40:44)
 w(285:289) = u(6)*w(40:44)
 w(290:294) = u(7)*w(40:44)
endif
! terms of degree 6
if (6.le.mxd) then
 w(295:468) = u(0)*w(121:294)
 w(469:566) = u(1)*w(197:294)
 w(567:618) = u(2)*w(243:294)
 w(619:634) = u(3)*w(105:120)
 w(635:645) = u(4)*w(110:120)
 w(646:652) = u(5)*w(114:120)
 w(653:656) = u(6)*w(117:120)
 w(657:658) = u(7)*w(119:120)
 w(659:663) = u(8)*w(40:44)
 w(664:667) = u(9)*w(41:44)
 w(668:670) = u(10)*w(42:44)
 w(671:672) = u(11)*w(43:44)
 w(673) = u(12)*w(44)
 w(674) = u(14)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(675:1054) = u(0)*w(295:674)
 w(1055:1260) = u(1)*w(469:674)
 w(1261:1368) = u(2)*w(567:674)
 w(1369:1393) = u(3)*w(270:294)
 w(1394:1413) = u(4)*w(275:294)
 w(1414:1428) = u(5)*w(280:294)
 w(1429:1438) = u(6)*w(285:294)
 w(1439:1443) = u(7)*w(290:294)
 w(1444) = u(8)*w(120)
 w(1445) = u(9)*w(120)
 w(1446) = u(10)*w(120)
 w(1447) = u(11)*w(120)
 w(1448) = u(12)*w(120)
endif
! terms of degree 8
if (8.le.mxd) then
 w(1449:2222) = u(0)*w(675:1448)
 w(2223:2616) = u(1)*w(1055:1448)
 w(2617:2804) = u(2)*w(1261:1448)
 w(2805:2860) = u(3)*w(619:674)
 w(2861:2900) = u(4)*w(635:674)
 w(2901:2929) = u(5)*w(646:674)
 w(2930:2951) = u(6)*w(653:674)
 w(2952:2969) = u(7)*w(657:674)
 w(2970) = u(13)*w(120)
endif
! terms of degree 9
if (9.le.mxd) then
 w(2971:4492) = u(0)*w(1449:2970)
 w(4493:5240) = u(1)*w(2223:2970)
 w(5241:5594) = u(2)*w(2617:2970)
 w(5595:5674) = u(3)*w(1369:1448)
 w(5675:5729) = u(4)*w(1394:1448)
 w(5730:5764) = u(5)*w(1414:1448)
 w(5765:5784) = u(6)*w(1429:1448)
 w(5785:5794) = u(7)*w(1439:1448)
 w(5795:5810) = u(8)*w(659:674)
 w(5811:5821) = u(9)*w(664:674)
 w(5822:5828) = u(10)*w(668:674)
 w(5829:5832) = u(11)*w(671:674)
 w(5833:5834) = u(12)*w(673:674)
endif
END SUBROUTINE mg33_prib
