SUBROUTINE mg333_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg333_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg333_prib: bad size u'
!! else if (size(w).ne.mg333_npb(mxd)) then
!!  stop 'mg333_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 6 12 12 3 0 3 0 0 0
! prib,  dnpb(0:*): 1 6 33 140 531 1806 5692 16746 46635 123616
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(7:12) = u(0)*w(1:6)
 w(13:17) = u(1)*w(2:6)
 w(18:21) = u(2)*w(3:6)
 w(22:24) = u(3)*w(4:6)
 w(25:26) = u(4)*w(5:6)
 w(27) = u(5)*w(6)
 w(28) = u(6)*w(0)
 w(29) = u(7)*w(0)
 w(30) = u(8)*w(0)
 w(31) = u(9)*w(0)
 w(32) = u(10)*w(0)
 w(33) = u(11)*w(0)
 w(34) = u(12)*w(0)
 w(35) = u(13)*w(0)
 w(36) = u(14)*w(0)
 w(37) = u(15)*w(0)
 w(38) = u(16)*w(0)
 w(39) = u(17)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(40:72) = u(0)*w(7:39)
 w(73:99) = u(1)*w(13:39)
 w(100:121) = u(2)*w(18:39)
 w(122:139) = u(3)*w(22:39)
 w(140:154) = u(4)*w(25:39)
 w(155:167) = u(5)*w(27:39)
 w(168) = u(18)*w(0)
 w(169) = u(19)*w(0)
 w(170) = u(20)*w(0)
 w(171) = u(21)*w(0)
 w(172) = u(22)*w(0)
 w(173) = u(23)*w(0)
 w(174) = u(24)*w(0)
 w(175) = u(25)*w(0)
 w(176) = u(26)*w(0)
 w(177) = u(27)*w(0)
 w(178) = u(28)*w(0)
 w(179) = u(29)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(180:319) = u(0)*w(40:179)
 w(320:426) = u(1)*w(73:179)
 w(427:506) = u(2)*w(100:179)
 w(507:564) = u(3)*w(122:179)
 w(565:604) = u(4)*w(140:179)
 w(605:629) = u(5)*w(155:179)
 w(630:641) = u(6)*w(28:39)
 w(642:652) = u(7)*w(29:39)
 w(653:662) = u(8)*w(30:39)
 w(663:671) = u(9)*w(31:39)
 w(672:679) = u(10)*w(32:39)
 w(680:686) = u(11)*w(33:39)
 w(687:692) = u(12)*w(34:39)
 w(693:697) = u(13)*w(35:39)
 w(698:701) = u(14)*w(36:39)
 w(702:704) = u(15)*w(37:39)
 w(705:706) = u(16)*w(38:39)
 w(707) = u(17)*w(39)
 w(708) = u(30)*w(0)
 w(709) = u(31)*w(0)
 w(710) = u(32)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(711:1241) = u(0)*w(180:710)
 w(1242:1632) = u(1)*w(320:710)
 w(1633:1916) = u(2)*w(427:710)
 w(1917:2120) = u(3)*w(507:710)
 w(2121:2266) = u(4)*w(565:710)
 w(2267:2372) = u(5)*w(605:710)
 w(2373:2384) = u(6)*w(168:179)
 w(2385:2396) = u(7)*w(168:179)
 w(2397:2408) = u(8)*w(168:179)
 w(2409:2420) = u(9)*w(168:179)
 w(2421:2432) = u(10)*w(168:179)
 w(2433:2444) = u(11)*w(168:179)
 w(2445:2456) = u(12)*w(168:179)
 w(2457:2468) = u(13)*w(168:179)
 w(2469:2480) = u(14)*w(168:179)
 w(2481:2492) = u(15)*w(168:179)
 w(2493:2504) = u(16)*w(168:179)
 w(2505:2516) = u(17)*w(168:179)
endif
! terms of degree 6
if (6.le.mxd) then
 w(2517:4322) = u(0)*w(711:2516)
 w(4323:5597) = u(1)*w(1242:2516)
 w(5598:6481) = u(2)*w(1633:2516)
 w(6482:7081) = u(3)*w(1917:2516)
 w(7082:7477) = u(4)*w(2121:2516)
 w(7478:7727) = u(5)*w(2267:2516)
 w(7728:7808) = u(6)*w(630:710)
 w(7809:7877) = u(7)*w(642:710)
 w(7878:7935) = u(8)*w(653:710)
 w(7936:7983) = u(9)*w(663:710)
 w(7984:8022) = u(10)*w(672:710)
 w(8023:8053) = u(11)*w(680:710)
 w(8054:8077) = u(12)*w(687:710)
 w(8078:8095) = u(13)*w(693:710)
 w(8096:8108) = u(14)*w(698:710)
 w(8109:8117) = u(15)*w(702:710)
 w(8118:8123) = u(16)*w(705:710)
 w(8124:8127) = u(17)*w(707:710)
 w(8128:8139) = u(18)*w(168:179)
 w(8140:8150) = u(19)*w(169:179)
 w(8151:8160) = u(20)*w(170:179)
 w(8161:8169) = u(21)*w(171:179)
 w(8170:8177) = u(22)*w(172:179)
 w(8178:8184) = u(23)*w(173:179)
 w(8185:8190) = u(24)*w(174:179)
 w(8191:8195) = u(25)*w(175:179)
 w(8196:8199) = u(26)*w(176:179)
 w(8200:8202) = u(27)*w(177:179)
 w(8203:8204) = u(28)*w(178:179)
 w(8205) = u(29)*w(179)
 w(8206) = u(33)*w(0)
 w(8207) = u(34)*w(0)
 w(8208) = u(35)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(8209:13900) = u(0)*w(2517:8208)
 w(13901:17786) = u(1)*w(4323:8208)
 w(17787:20397) = u(2)*w(5598:8208)
 w(20398:22124) = u(3)*w(6482:8208)
 w(22125:23251) = u(4)*w(7082:8208)
 w(23252:23982) = u(5)*w(7478:8208)
 w(23983:24126) = u(6)*w(2373:2516)
 w(24127:24258) = u(7)*w(2385:2516)
 w(24259:24378) = u(8)*w(2397:2516)
 w(24379:24486) = u(9)*w(2409:2516)
 w(24487:24582) = u(10)*w(2421:2516)
 w(24583:24666) = u(11)*w(2433:2516)
 w(24667:24738) = u(12)*w(2445:2516)
 w(24739:24798) = u(13)*w(2457:2516)
 w(24799:24846) = u(14)*w(2469:2516)
 w(24847:24882) = u(15)*w(2481:2516)
 w(24883:24906) = u(16)*w(2493:2516)
 w(24907:24918) = u(17)*w(2505:2516)
 w(24919:24921) = u(18)*w(708:710)
 w(24922:24924) = u(19)*w(708:710)
 w(24925:24927) = u(20)*w(708:710)
 w(24928:24930) = u(21)*w(708:710)
 w(24931:24933) = u(22)*w(708:710)
 w(24934:24936) = u(23)*w(708:710)
 w(24937:24939) = u(24)*w(708:710)
 w(24940:24942) = u(25)*w(708:710)
 w(24943:24945) = u(26)*w(708:710)
 w(24946:24948) = u(27)*w(708:710)
 w(24949:24951) = u(28)*w(708:710)
 w(24952:24954) = u(29)*w(708:710)
endif
! terms of degree 8
if (8.le.mxd) then
 w(24955:41700) = u(0)*w(8209:24954)
 w(41701:52754) = u(1)*w(13901:24954)
 w(52755:59922) = u(2)*w(17787:24954)
 w(59923:64479) = u(3)*w(20398:24954)
 w(64480:67309) = u(4)*w(22125:24954)
 w(67310:69012) = u(5)*w(23252:24954)
 w(69013:69493) = u(6)*w(7728:8208)
 w(69494:69893) = u(7)*w(7809:8208)
 w(69894:70224) = u(8)*w(7878:8208)
 w(70225:70497) = u(9)*w(7936:8208)
 w(70498:70722) = u(10)*w(7984:8208)
 w(70723:70908) = u(11)*w(8023:8208)
 w(70909:71063) = u(12)*w(8054:8208)
 w(71064:71194) = u(13)*w(8078:8208)
 w(71195:71307) = u(14)*w(8096:8208)
 w(71308:71407) = u(15)*w(8109:8208)
 w(71408:71498) = u(16)*w(8118:8208)
 w(71499:71583) = u(17)*w(8124:8208)
 w(71584:71586) = u(30)*w(708:710)
 w(71587:71588) = u(31)*w(709:710)
 w(71589) = u(32)*w(710)
endif
! terms of degree 9
if (9.le.mxd) then
 w(71590:118224) = u(0)*w(24955:71589)
 w(118225:148113) = u(1)*w(41701:71589)
 w(148114:166948) = u(2)*w(52755:71589)
 w(166949:178615) = u(3)*w(59923:71589)
 w(178616:185725) = u(4)*w(64480:71589)
 w(185726:190005) = u(5)*w(67310:71589)
 w(190006:190977) = u(6)*w(23983:24954)
 w(190978:191805) = u(7)*w(24127:24954)
 w(191806:192501) = u(8)*w(24259:24954)
 w(192502:193077) = u(9)*w(24379:24954)
 w(193078:193545) = u(10)*w(24487:24954)
 w(193546:193917) = u(11)*w(24583:24954)
 w(193918:194205) = u(12)*w(24667:24954)
 w(194206:194421) = u(13)*w(24739:24954)
 w(194422:194577) = u(14)*w(24799:24954)
 w(194578:194685) = u(15)*w(24847:24954)
 w(194686:194757) = u(16)*w(24883:24954)
 w(194758:194805) = u(17)*w(24907:24954)
 w(194806:194886) = u(18)*w(8128:8208)
 w(194887:194955) = u(19)*w(8140:8208)
 w(194956:195013) = u(20)*w(8151:8208)
 w(195014:195061) = u(21)*w(8161:8208)
 w(195062:195100) = u(22)*w(8170:8208)
 w(195101:195131) = u(23)*w(8178:8208)
 w(195132:195155) = u(24)*w(8185:8208)
 w(195156:195173) = u(25)*w(8191:8208)
 w(195174:195186) = u(26)*w(8196:8208)
 w(195187:195195) = u(27)*w(8200:8208)
 w(195196:195201) = u(28)*w(8203:8208)
 w(195202:195205) = u(29)*w(8205:8208)
endif
END SUBROUTINE mg333_prib
