SUBROUTINE mg2221_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg2221_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg2221_prib: bad size u'
!! else if (size(w).ne.mg2221_npb(mxd)) then
!!  stop 'mg2221_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 9 12 0 0 0 0 0 0 0
! prib,  dnpb(0:*): 1 9 57 273 1113 3969 12817 38025 105261 274261
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(10:18) = u(0)*w(1:9)
 w(19:26) = u(1)*w(2:9)
 w(27:33) = u(2)*w(3:9)
 w(34:39) = u(3)*w(4:9)
 w(40:44) = u(4)*w(5:9)
 w(45:48) = u(5)*w(6:9)
 w(49:51) = u(6)*w(7:9)
 w(52:53) = u(7)*w(8:9)
 w(54) = u(8)*w(9)
 w(55) = u(9)*w(0)
 w(56) = u(10)*w(0)
 w(57) = u(11)*w(0)
 w(58) = u(12)*w(0)
 w(59) = u(13)*w(0)
 w(60) = u(14)*w(0)
 w(61) = u(15)*w(0)
 w(62) = u(16)*w(0)
 w(63) = u(17)*w(0)
 w(64) = u(18)*w(0)
 w(65) = u(19)*w(0)
 w(66) = u(20)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(67:123) = u(0)*w(10:66)
 w(124:171) = u(1)*w(19:66)
 w(172:211) = u(2)*w(27:66)
 w(212:244) = u(3)*w(34:66)
 w(245:271) = u(4)*w(40:66)
 w(272:293) = u(5)*w(45:66)
 w(294:311) = u(6)*w(49:66)
 w(312:326) = u(7)*w(52:66)
 w(327:339) = u(8)*w(54:66)
endif
! terms of degree 4
if (4.le.mxd) then
 w(340:612) = u(0)*w(67:339)
 w(613:828) = u(1)*w(124:339)
 w(829:996) = u(2)*w(172:339)
 w(997:1124) = u(3)*w(212:339)
 w(1125:1219) = u(4)*w(245:339)
 w(1220:1287) = u(5)*w(272:339)
 w(1288:1333) = u(6)*w(294:339)
 w(1334:1361) = u(7)*w(312:339)
 w(1362:1374) = u(8)*w(327:339)
 w(1375:1386) = u(9)*w(55:66)
 w(1387:1397) = u(10)*w(56:66)
 w(1398:1407) = u(11)*w(57:66)
 w(1408:1416) = u(12)*w(58:66)
 w(1417:1424) = u(13)*w(59:66)
 w(1425:1431) = u(14)*w(60:66)
 w(1432:1437) = u(15)*w(61:66)
 w(1438:1442) = u(16)*w(62:66)
 w(1443:1446) = u(17)*w(63:66)
 w(1447:1449) = u(18)*w(64:66)
 w(1450:1451) = u(19)*w(65:66)
 w(1452) = u(20)*w(66)
endif
! terms of degree 5
if (5.le.mxd) then
 w(1453:2565) = u(0)*w(340:1452)
 w(2566:3405) = u(1)*w(613:1452)
 w(3406:4029) = u(2)*w(829:1452)
 w(4030:4485) = u(3)*w(997:1452)
 w(4486:4813) = u(4)*w(1125:1452)
 w(4814:5046) = u(5)*w(1220:1452)
 w(5047:5211) = u(6)*w(1288:1452)
 w(5212:5330) = u(7)*w(1334:1452)
 w(5331:5421) = u(8)*w(1362:1452)
endif
! terms of degree 6
if (6.le.mxd) then
 w(5422:9390) = u(0)*w(1453:5421)
 w(9391:12246) = u(1)*w(2566:5421)
 w(12247:14262) = u(2)*w(3406:5421)
 w(14263:15654) = u(3)*w(4030:5421)
 w(15655:16590) = u(4)*w(4486:5421)
 w(16591:17198) = u(5)*w(4814:5421)
 w(17199:17573) = u(6)*w(5047:5421)
 w(17574:17783) = u(7)*w(5212:5421)
 w(17784:17874) = u(8)*w(5331:5421)
 w(17875:17952) = u(9)*w(1375:1452)
 w(17953:18018) = u(10)*w(1387:1452)
 w(18019:18073) = u(11)*w(1398:1452)
 w(18074:18118) = u(12)*w(1408:1452)
 w(18119:18154) = u(13)*w(1417:1452)
 w(18155:18182) = u(14)*w(1425:1452)
 w(18183:18203) = u(15)*w(1432:1452)
 w(18204:18218) = u(16)*w(1438:1452)
 w(18219:18228) = u(17)*w(1443:1452)
 w(18229:18234) = u(18)*w(1447:1452)
 w(18235:18237) = u(19)*w(1450:1452)
 w(18238) = u(20)*w(1452)
endif
! terms of degree 7
if (7.le.mxd) then
 w(18239:31055) = u(0)*w(5422:18238)
 w(31056:39903) = u(1)*w(9391:18238)
 w(39904:45895) = u(2)*w(12247:18238)
 w(45896:49871) = u(3)*w(14263:18238)
 w(49872:52455) = u(4)*w(15655:18238)
 w(52456:54103) = u(5)*w(16591:18238)
 w(54104:55143) = u(6)*w(17199:18238)
 w(55144:55808) = u(7)*w(17574:18238)
 w(55809:56263) = u(8)*w(17784:18238)
endif
! terms of degree 8
if (8.le.mxd) then
 w(56264:94288) = u(0)*w(18239:56263)
 w(94289:119496) = u(1)*w(31056:56263)
 w(119497:135856) = u(2)*w(39904:56263)
 w(135857:146224) = u(3)*w(45896:56263)
 w(146225:152616) = u(4)*w(49872:56263)
 w(152617:156424) = u(5)*w(52456:56263)
 w(156425:158584) = u(6)*w(54104:56263)
 w(158585:159704) = u(7)*w(55144:56263)
 w(159705:160159) = u(8)*w(55809:56263)
 w(160160:160523) = u(9)*w(17875:18238)
 w(160524:160809) = u(10)*w(17953:18238)
 w(160810:161029) = u(11)*w(18019:18238)
 w(161030:161194) = u(12)*w(18074:18238)
 w(161195:161314) = u(13)*w(18119:18238)
 w(161315:161398) = u(14)*w(18155:18238)
 w(161399:161454) = u(15)*w(18183:18238)
 w(161455:161489) = u(16)*w(18204:18238)
 w(161490:161509) = u(17)*w(18219:18238)
 w(161510:161519) = u(18)*w(18229:18238)
 w(161520:161523) = u(19)*w(18235:18238)
 w(161524) = u(20)*w(18238)
endif
! terms of degree 9
if (9.le.mxd) then
 w(161525:266785) = u(0)*w(56264:161524)
 w(266786:334021) = u(1)*w(94289:161524)
 w(334022:376049) = u(2)*w(119497:161524)
 w(376050:401717) = u(3)*w(135857:161524)
 w(401718:417017) = u(4)*w(146225:161524)
 w(417018:425925) = u(5)*w(152617:161524)
 w(425926:431025) = u(6)*w(156425:161524)
 w(431026:433965) = u(7)*w(158585:161524)
 w(433966:435785) = u(8)*w(159705:161524)
endif
END SUBROUTINE mg2221_prib
