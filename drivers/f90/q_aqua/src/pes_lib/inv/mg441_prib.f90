SUBROUTINE mg441_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg441_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg441_prib: bad size u'
!! else if (size(w).ne.mg441_npb(mxd)) then
!!  stop 'mg441_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 5 9 11 9 0 1 0 0 0
! prib,  dnpb(0:*): 1 5 24 91 314 975 2843 7768 20229 50337
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(6:10) = u(0)*w(1:5)
 w(11:14) = u(1)*w(2:5)
 w(15:17) = u(2)*w(3:5)
 w(18:19) = u(3)*w(4:5)
 w(20) = u(4)*w(5)
 w(21) = u(5)*w(0)
 w(22) = u(6)*w(0)
 w(23) = u(7)*w(0)
 w(24) = u(8)*w(0)
 w(25) = u(9)*w(0)
 w(26) = u(10)*w(0)
 w(27) = u(11)*w(0)
 w(28) = u(12)*w(0)
 w(29) = u(13)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(30:53) = u(0)*w(6:29)
 w(54:72) = u(1)*w(11:29)
 w(73:87) = u(2)*w(15:29)
 w(88:99) = u(3)*w(18:29)
 w(100:109) = u(4)*w(20:29)
 w(110) = u(14)*w(0)
 w(111) = u(15)*w(0)
 w(112) = u(16)*w(0)
 w(113) = u(17)*w(0)
 w(114) = u(18)*w(0)
 w(115) = u(19)*w(0)
 w(116) = u(20)*w(0)
 w(117) = u(21)*w(0)
 w(118) = u(22)*w(0)
 w(119) = u(23)*w(0)
 w(120) = u(24)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(121:211) = u(0)*w(30:120)
 w(212:278) = u(1)*w(54:120)
 w(279:326) = u(2)*w(73:120)
 w(327:359) = u(3)*w(88:120)
 w(360:380) = u(4)*w(100:120)
 w(381:389) = u(5)*w(21:29)
 w(390:397) = u(6)*w(22:29)
 w(398:404) = u(7)*w(23:29)
 w(405:410) = u(8)*w(24:29)
 w(411:415) = u(9)*w(25:29)
 w(416:419) = u(10)*w(26:29)
 w(420:422) = u(11)*w(27:29)
 w(423:424) = u(12)*w(28:29)
 w(425) = u(13)*w(29)
 w(426) = u(25)*w(0)
 w(427) = u(26)*w(0)
 w(428) = u(27)*w(0)
 w(429) = u(28)*w(0)
 w(430) = u(29)*w(0)
 w(431) = u(30)*w(0)
 w(432) = u(31)*w(0)
 w(433) = u(32)*w(0)
 w(434) = u(33)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(435:748) = u(0)*w(121:434)
 w(749:971) = u(1)*w(212:434)
 w(972:1127) = u(2)*w(279:434)
 w(1128:1235) = u(3)*w(327:434)
 w(1236:1310) = u(4)*w(360:434)
 w(1311:1321) = u(5)*w(110:120)
 w(1322:1332) = u(6)*w(110:120)
 w(1333:1343) = u(7)*w(110:120)
 w(1344:1354) = u(8)*w(110:120)
 w(1355:1365) = u(9)*w(110:120)
 w(1366:1376) = u(10)*w(110:120)
 w(1377:1387) = u(11)*w(110:120)
 w(1388:1398) = u(12)*w(110:120)
 w(1399:1409) = u(13)*w(110:120)
endif
! terms of degree 6
if (6.le.mxd) then
 w(1410:2384) = u(0)*w(435:1409)
 w(2385:3045) = u(1)*w(749:1409)
 w(3046:3483) = u(2)*w(972:1409)
 w(3484:3765) = u(3)*w(1128:1409)
 w(3766:3939) = u(4)*w(1236:1409)
 w(3940:3993) = u(5)*w(381:434)
 w(3994:4038) = u(6)*w(390:434)
 w(4039:4075) = u(7)*w(398:434)
 w(4076:4105) = u(8)*w(405:434)
 w(4106:4129) = u(9)*w(411:434)
 w(4130:4148) = u(10)*w(416:434)
 w(4149:4163) = u(11)*w(420:434)
 w(4164:4175) = u(12)*w(423:434)
 w(4176:4185) = u(13)*w(425:434)
 w(4186:4196) = u(14)*w(110:120)
 w(4197:4206) = u(15)*w(111:120)
 w(4207:4215) = u(16)*w(112:120)
 w(4216:4223) = u(17)*w(113:120)
 w(4224:4230) = u(18)*w(114:120)
 w(4231:4236) = u(19)*w(115:120)
 w(4237:4241) = u(20)*w(116:120)
 w(4242:4245) = u(21)*w(117:120)
 w(4246:4248) = u(22)*w(118:120)
 w(4249:4250) = u(23)*w(119:120)
 w(4251) = u(24)*w(120)
 w(4252) = u(34)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(4253:7095) = u(0)*w(1410:4252)
 w(7096:8963) = u(1)*w(2385:4252)
 w(8964:10170) = u(2)*w(3046:4252)
 w(10171:10939) = u(3)*w(3484:4252)
 w(10940:11426) = u(4)*w(3766:4252)
 w(11427:11525) = u(5)*w(1311:1409)
 w(11526:11613) = u(6)*w(1322:1409)
 w(11614:11690) = u(7)*w(1333:1409)
 w(11691:11756) = u(8)*w(1344:1409)
 w(11757:11811) = u(9)*w(1355:1409)
 w(11812:11855) = u(10)*w(1366:1409)
 w(11856:11888) = u(11)*w(1377:1409)
 w(11889:11910) = u(12)*w(1388:1409)
 w(11911:11921) = u(13)*w(1399:1409)
 w(11922:11930) = u(14)*w(426:434)
 w(11931:11939) = u(15)*w(426:434)
 w(11940:11948) = u(16)*w(426:434)
 w(11949:11957) = u(17)*w(426:434)
 w(11958:11966) = u(18)*w(426:434)
 w(11967:11975) = u(19)*w(426:434)
 w(11976:11984) = u(20)*w(426:434)
 w(11985:11993) = u(21)*w(426:434)
 w(11994:12002) = u(22)*w(426:434)
 w(12003:12011) = u(23)*w(426:434)
 w(12012:12020) = u(24)*w(426:434)
endif
! terms of degree 8
if (8.le.mxd) then
 w(12021:19788) = u(0)*w(4253:12020)
 w(19789:24713) = u(1)*w(7096:12020)
 w(24714:27770) = u(2)*w(8964:12020)
 w(27771:29620) = u(3)*w(10171:12020)
 w(29621:30701) = u(4)*w(10940:12020)
 w(30702:31014) = u(5)*w(3940:4252)
 w(31015:31273) = u(6)*w(3994:4252)
 w(31274:31487) = u(7)*w(4039:4252)
 w(31488:31664) = u(8)*w(4076:4252)
 w(31665:31811) = u(9)*w(4106:4252)
 w(31812:31934) = u(10)*w(4130:4252)
 w(31935:32038) = u(11)*w(4149:4252)
 w(32039:32127) = u(12)*w(4164:4252)
 w(32128:32204) = u(13)*w(4176:4252)
 w(32205:32213) = u(25)*w(426:434)
 w(32214:32221) = u(26)*w(427:434)
 w(32222:32228) = u(27)*w(428:434)
 w(32229:32234) = u(28)*w(429:434)
 w(32235:32239) = u(29)*w(430:434)
 w(32240:32243) = u(30)*w(431:434)
 w(32244:32246) = u(31)*w(432:434)
 w(32247:32248) = u(32)*w(433:434)
 w(32249) = u(33)*w(434)
endif
! terms of degree 9
if (9.le.mxd) then
 w(32250:52478) = u(0)*w(12021:32249)
 w(52479:64939) = u(1)*w(19789:32249)
 w(64940:72475) = u(2)*w(24714:32249)
 w(72476:76954) = u(3)*w(27771:32249)
 w(76955:79583) = u(4)*w(29621:32249)
 w(79584:80177) = u(5)*w(11427:12020)
 w(80178:80672) = u(6)*w(11526:12020)
 w(80673:81079) = u(7)*w(11614:12020)
 w(81080:81409) = u(8)*w(11691:12020)
 w(81410:81673) = u(9)*w(11757:12020)
 w(81674:81882) = u(10)*w(11812:12020)
 w(81883:82047) = u(11)*w(11856:12020)
 w(82048:82179) = u(12)*w(11889:12020)
 w(82180:82289) = u(13)*w(11911:12020)
 w(82290:82356) = u(14)*w(4186:4252)
 w(82357:82412) = u(15)*w(4197:4252)
 w(82413:82458) = u(16)*w(4207:4252)
 w(82459:82495) = u(17)*w(4216:4252)
 w(82496:82524) = u(18)*w(4224:4252)
 w(82525:82546) = u(19)*w(4231:4252)
 w(82547:82562) = u(20)*w(4237:4252)
 w(82563:82573) = u(21)*w(4242:4252)
 w(82574:82580) = u(22)*w(4246:4252)
 w(82581:82584) = u(23)*w(4249:4252)
 w(82585:82586) = u(24)*w(4251:4252)
endif
END SUBROUTINE mg441_prib
