SUBROUTINE mg53_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg53_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg53_prib: bad size u'
!! else if (size(w).ne.mg53_npb(mxd)) then
!!  stop 'mg53_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 3 6 6 5 3 2 0 0 0
! prib,  dnpb(0:*): 1 3 12 34 95 234 560 1247 2697 5572
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(4:6) = u(0)*w(1:3)
 w(7:8) = u(1)*w(2:3)
 w(9) = u(2)*w(3)
 w(10) = u(3)*w(0)
 w(11) = u(4)*w(0)
 w(12) = u(5)*w(0)
 w(13) = u(6)*w(0)
 w(14) = u(7)*w(0)
 w(15) = u(8)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(16:27) = u(0)*w(4:15)
 w(28:36) = u(1)*w(7:15)
 w(37:43) = u(2)*w(9:15)
 w(44) = u(9)*w(0)
 w(45) = u(10)*w(0)
 w(46) = u(11)*w(0)
 w(47) = u(12)*w(0)
 w(48) = u(13)*w(0)
 w(49) = u(14)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(50:83) = u(0)*w(16:49)
 w(84:105) = u(1)*w(28:49)
 w(106:118) = u(2)*w(37:49)
 w(119:124) = u(3)*w(10:15)
 w(125:129) = u(4)*w(11:15)
 w(130:133) = u(5)*w(12:15)
 w(134:136) = u(6)*w(13:15)
 w(137:138) = u(7)*w(14:15)
 w(139) = u(8)*w(15)
 w(140) = u(15)*w(0)
 w(141) = u(16)*w(0)
 w(142) = u(17)*w(0)
 w(143) = u(18)*w(0)
 w(144) = u(19)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(145:239) = u(0)*w(50:144)
 w(240:300) = u(1)*w(84:144)
 w(301:339) = u(2)*w(106:144)
 w(340:345) = u(3)*w(44:49)
 w(346:351) = u(4)*w(44:49)
 w(352:357) = u(5)*w(44:49)
 w(358:363) = u(6)*w(44:49)
 w(364:369) = u(7)*w(44:49)
 w(370:375) = u(8)*w(44:49)
 w(376) = u(20)*w(0)
 w(377) = u(21)*w(0)
 w(378) = u(22)*w(0)
endif
! terms of degree 6
if (6.le.mxd) then
 w(379:612) = u(0)*w(145:378)
 w(613:751) = u(1)*w(240:378)
 w(752:829) = u(2)*w(301:378)
 w(830:855) = u(3)*w(119:144)
 w(856:875) = u(4)*w(125:144)
 w(876:890) = u(5)*w(130:144)
 w(891:901) = u(6)*w(134:144)
 w(902:909) = u(7)*w(137:144)
 w(910:915) = u(8)*w(139:144)
 w(916:921) = u(9)*w(44:49)
 w(922:926) = u(10)*w(45:49)
 w(927:930) = u(11)*w(46:49)
 w(931:933) = u(12)*w(47:49)
 w(934:935) = u(13)*w(48:49)
 w(936) = u(14)*w(49)
 w(937) = u(23)*w(0)
 w(938) = u(24)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(939:1498) = u(0)*w(379:938)
 w(1499:1824) = u(1)*w(613:938)
 w(1825:2011) = u(2)*w(752:938)
 w(2012:2050) = u(3)*w(340:378)
 w(2051:2083) = u(4)*w(346:378)
 w(2084:2110) = u(5)*w(352:378)
 w(2111:2131) = u(6)*w(358:378)
 w(2132:2146) = u(7)*w(364:378)
 w(2147:2155) = u(8)*w(370:378)
 w(2156:2160) = u(9)*w(140:144)
 w(2161:2165) = u(10)*w(140:144)
 w(2166:2170) = u(11)*w(140:144)
 w(2171:2175) = u(12)*w(140:144)
 w(2176:2180) = u(13)*w(140:144)
 w(2181:2185) = u(14)*w(140:144)
endif
! terms of degree 8
if (8.le.mxd) then
 w(2186:3432) = u(0)*w(939:2185)
 w(3433:4119) = u(1)*w(1499:2185)
 w(4120:4480) = u(2)*w(1825:2185)
 w(4481:4589) = u(3)*w(830:938)
 w(4590:4672) = u(4)*w(856:938)
 w(4673:4735) = u(5)*w(876:938)
 w(4736:4783) = u(6)*w(891:938)
 w(4784:4820) = u(7)*w(902:938)
 w(4821:4849) = u(8)*w(910:938)
 w(4850:4852) = u(9)*w(376:378)
 w(4853:4855) = u(10)*w(376:378)
 w(4856:4858) = u(11)*w(376:378)
 w(4859:4861) = u(12)*w(376:378)
 w(4862:4864) = u(13)*w(376:378)
 w(4865:4867) = u(14)*w(376:378)
 w(4868:4872) = u(15)*w(140:144)
 w(4873:4876) = u(16)*w(141:144)
 w(4877:4879) = u(17)*w(142:144)
 w(4880:4881) = u(18)*w(143:144)
 w(4882) = u(19)*w(144)
endif
! terms of degree 9
if (9.le.mxd) then
 w(4883:7579) = u(0)*w(2186:4882)
 w(7580:9029) = u(1)*w(3433:4882)
 w(9030:9792) = u(2)*w(4120:4882)
 w(9793:9966) = u(3)*w(2012:2185)
 w(9967:10101) = u(4)*w(2051:2185)
 w(10102:10203) = u(5)*w(2084:2185)
 w(10204:10278) = u(6)*w(2111:2185)
 w(10279:10332) = u(7)*w(2132:2185)
 w(10333:10371) = u(8)*w(2147:2185)
 w(10372:10394) = u(9)*w(916:938)
 w(10395:10411) = u(10)*w(922:938)
 w(10412:10423) = u(11)*w(927:938)
 w(10424:10431) = u(12)*w(931:938)
 w(10432:10436) = u(13)*w(934:938)
 w(10437:10439) = u(14)*w(936:938)
 w(10440:10442) = u(15)*w(376:378)
 w(10443:10445) = u(16)*w(376:378)
 w(10446:10448) = u(17)*w(376:378)
 w(10449:10451) = u(18)*w(376:378)
 w(10452:10454) = u(19)*w(376:378)
endif
END SUBROUTINE mg53_prib
