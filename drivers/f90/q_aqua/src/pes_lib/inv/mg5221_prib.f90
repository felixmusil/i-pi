SUBROUTINE mg5221_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg5221_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg5221_prib: bad size u'
!! else if (size(w).ne.mg5221_npb(mxd)) then
!!  stop 'mg5221_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 9 14 5 7 5 3 0 0 0
! prib,  dnpb(0:*): 1 9 59 296 1282 4905 17149 55497 168672 485254
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(10:18) = u(0)*w(1:9)
 w(19:26) = u(1)*w(2:9)
 w(27:33) = u(2)*w(3:9)
 w(34:39) = u(3)*w(4:9)
 w(40:44) = u(4)*w(5:9)
 w(45:48) = u(5)*w(6:9)
 w(49:51) = u(6)*w(7:9)
 w(52:53) = u(7)*w(8:9)
 w(54) = u(8)*w(9)
 w(55) = u(9)*w(0)
 w(56) = u(10)*w(0)
 w(57) = u(11)*w(0)
 w(58) = u(12)*w(0)
 w(59) = u(13)*w(0)
 w(60) = u(14)*w(0)
 w(61) = u(15)*w(0)
 w(62) = u(16)*w(0)
 w(63) = u(17)*w(0)
 w(64) = u(18)*w(0)
 w(65) = u(19)*w(0)
 w(66) = u(20)*w(0)
 w(67) = u(21)*w(0)
 w(68) = u(22)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(69:127) = u(0)*w(10:68)
 w(128:177) = u(1)*w(19:68)
 w(178:219) = u(2)*w(27:68)
 w(220:254) = u(3)*w(34:68)
 w(255:283) = u(4)*w(40:68)
 w(284:307) = u(5)*w(45:68)
 w(308:327) = u(6)*w(49:68)
 w(328:344) = u(7)*w(52:68)
 w(345:359) = u(8)*w(54:68)
 w(360) = u(23)*w(0)
 w(361) = u(24)*w(0)
 w(362) = u(25)*w(0)
 w(363) = u(26)*w(0)
 w(364) = u(27)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(365:660) = u(0)*w(69:364)
 w(661:897) = u(1)*w(128:364)
 w(898:1084) = u(2)*w(178:364)
 w(1085:1229) = u(3)*w(220:364)
 w(1230:1339) = u(4)*w(255:364)
 w(1340:1420) = u(5)*w(284:364)
 w(1421:1477) = u(6)*w(308:364)
 w(1478:1514) = u(7)*w(328:364)
 w(1515:1534) = u(8)*w(345:364)
 w(1535:1548) = u(9)*w(55:68)
 w(1549:1561) = u(10)*w(56:68)
 w(1562:1573) = u(11)*w(57:68)
 w(1574:1584) = u(12)*w(58:68)
 w(1585:1594) = u(13)*w(59:68)
 w(1595:1603) = u(14)*w(60:68)
 w(1604:1611) = u(15)*w(61:68)
 w(1612:1618) = u(16)*w(62:68)
 w(1619:1624) = u(17)*w(63:68)
 w(1625:1629) = u(18)*w(64:68)
 w(1630:1633) = u(19)*w(65:68)
 w(1634:1636) = u(20)*w(66:68)
 w(1637:1638) = u(21)*w(67:68)
 w(1639) = u(22)*w(68)
 w(1640) = u(28)*w(0)
 w(1641) = u(29)*w(0)
 w(1642) = u(30)*w(0)
 w(1643) = u(31)*w(0)
 w(1644) = u(32)*w(0)
 w(1645) = u(33)*w(0)
 w(1646) = u(34)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(1647:2928) = u(0)*w(365:1646)
 w(2929:3914) = u(1)*w(661:1646)
 w(3915:4663) = u(2)*w(898:1646)
 w(4664:5225) = u(3)*w(1085:1646)
 w(5226:5642) = u(4)*w(1230:1646)
 w(5643:5949) = u(5)*w(1340:1646)
 w(5950:6175) = u(6)*w(1421:1646)
 w(6176:6344) = u(7)*w(1478:1646)
 w(6345:6476) = u(8)*w(1515:1646)
 w(6477:6481) = u(9)*w(360:364)
 w(6482:6486) = u(10)*w(360:364)
 w(6487:6491) = u(11)*w(360:364)
 w(6492:6496) = u(12)*w(360:364)
 w(6497:6501) = u(13)*w(360:364)
 w(6502:6506) = u(14)*w(360:364)
 w(6507:6511) = u(15)*w(360:364)
 w(6512:6516) = u(16)*w(360:364)
 w(6517:6521) = u(17)*w(360:364)
 w(6522:6526) = u(18)*w(360:364)
 w(6527:6531) = u(19)*w(360:364)
 w(6532:6536) = u(20)*w(360:364)
 w(6537:6541) = u(21)*w(360:364)
 w(6542:6546) = u(22)*w(360:364)
 w(6547) = u(35)*w(0)
 w(6548) = u(36)*w(0)
 w(6549) = u(37)*w(0)
 w(6550) = u(38)*w(0)
 w(6551) = u(39)*w(0)
endif
! terms of degree 6
if (6.le.mxd) then
 w(6552:11456) = u(0)*w(1647:6551)
 w(11457:15079) = u(1)*w(2929:6551)
 w(15080:17716) = u(2)*w(3915:6551)
 w(17717:19604) = u(3)*w(4664:6551)
 w(19605:20930) = u(4)*w(5226:6551)
 w(20931:21839) = u(5)*w(5643:6551)
 w(21840:22441) = u(6)*w(5950:6551)
 w(22442:22817) = u(7)*w(6176:6551)
 w(22818:23024) = u(8)*w(6345:6551)
 w(23025:23136) = u(9)*w(1535:1646)
 w(23137:23234) = u(10)*w(1549:1646)
 w(23235:23319) = u(11)*w(1562:1646)
 w(23320:23392) = u(12)*w(1574:1646)
 w(23393:23454) = u(13)*w(1585:1646)
 w(23455:23506) = u(14)*w(1595:1646)
 w(23507:23549) = u(15)*w(1604:1646)
 w(23550:23584) = u(16)*w(1612:1646)
 w(23585:23612) = u(17)*w(1619:1646)
 w(23613:23634) = u(18)*w(1625:1646)
 w(23635:23651) = u(19)*w(1630:1646)
 w(23652:23664) = u(20)*w(1634:1646)
 w(23665:23674) = u(21)*w(1637:1646)
 w(23675:23682) = u(22)*w(1639:1646)
 w(23683:23687) = u(23)*w(360:364)
 w(23688:23691) = u(24)*w(361:364)
 w(23692:23694) = u(25)*w(362:364)
 w(23695:23696) = u(26)*w(363:364)
 w(23697) = u(27)*w(364)
 w(23698) = u(40)*w(0)
 w(23699) = u(41)*w(0)
 w(23700) = u(42)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(23701:40849) = u(0)*w(6552:23700)
 w(40850:53093) = u(1)*w(11457:23700)
 w(53094:61714) = u(2)*w(15080:23700)
 w(61715:67698) = u(3)*w(17717:23700)
 w(67699:71794) = u(4)*w(19605:23700)
 w(71795:74564) = u(5)*w(20931:23700)
 w(74565:76425) = u(6)*w(21840:23700)
 w(76426:77684) = u(7)*w(22442:23700)
 w(77685:78567) = u(8)*w(22818:23700)
 w(78568:78642) = u(9)*w(6477:6551)
 w(78643:78712) = u(10)*w(6482:6551)
 w(78713:78777) = u(11)*w(6487:6551)
 w(78778:78837) = u(12)*w(6492:6551)
 w(78838:78892) = u(13)*w(6497:6551)
 w(78893:78942) = u(14)*w(6502:6551)
 w(78943:78987) = u(15)*w(6507:6551)
 w(78988:79027) = u(16)*w(6512:6551)
 w(79028:79062) = u(17)*w(6517:6551)
 w(79063:79092) = u(18)*w(6522:6551)
 w(79093:79117) = u(19)*w(6527:6551)
 w(79118:79137) = u(20)*w(6532:6551)
 w(79138:79152) = u(21)*w(6537:6551)
 w(79153:79162) = u(22)*w(6542:6551)
 w(79163:79169) = u(23)*w(1640:1646)
 w(79170:79176) = u(24)*w(1640:1646)
 w(79177:79183) = u(25)*w(1640:1646)
 w(79184:79190) = u(26)*w(1640:1646)
 w(79191:79197) = u(27)*w(1640:1646)
endif
! terms of degree 8
if (8.le.mxd) then
 w(79198:134694) = u(0)*w(23701:79197)
 w(134695:173042) = u(1)*w(40850:79197)
 w(173043:199146) = u(2)*w(53094:79197)
 w(199147:216629) = u(3)*w(61715:79197)
 w(216630:228128) = u(4)*w(67699:79197)
 w(228129:235531) = u(5)*w(71795:79197)
 w(235532:240164) = u(6)*w(74565:79197)
 w(240165:242936) = u(7)*w(76426:79197)
 w(242937:244449) = u(8)*w(77685:79197)
 w(244450:245125) = u(9)*w(23025:23700)
 w(245126:245689) = u(10)*w(23137:23700)
 w(245690:246155) = u(11)*w(23235:23700)
 w(246156:246536) = u(12)*w(23320:23700)
 w(246537:246844) = u(13)*w(23393:23700)
 w(246845:247090) = u(14)*w(23455:23700)
 w(247091:247284) = u(15)*w(23507:23700)
 w(247285:247435) = u(16)*w(23550:23700)
 w(247436:247551) = u(17)*w(23585:23700)
 w(247552:247639) = u(18)*w(23613:23700)
 w(247640:247705) = u(19)*w(23635:23700)
 w(247706:247754) = u(20)*w(23652:23700)
 w(247755:247790) = u(21)*w(23665:23700)
 w(247791:247816) = u(22)*w(23675:23700)
 w(247817:247821) = u(23)*w(6547:6551)
 w(247822:247826) = u(24)*w(6547:6551)
 w(247827:247831) = u(25)*w(6547:6551)
 w(247832:247836) = u(26)*w(6547:6551)
 w(247837:247841) = u(27)*w(6547:6551)
 w(247842:247848) = u(28)*w(1640:1646)
 w(247849:247854) = u(29)*w(1641:1646)
 w(247855:247859) = u(30)*w(1642:1646)
 w(247860:247863) = u(31)*w(1643:1646)
 w(247864:247866) = u(32)*w(1644:1646)
 w(247867:247868) = u(33)*w(1645:1646)
 w(247869) = u(34)*w(1646)
endif
! terms of degree 9
if (9.le.mxd) then
 w(247870:416541) = u(0)*w(79198:247869)
 w(416542:529716) = u(1)*w(134695:247869)
 w(529717:604543) = u(2)*w(173043:247869)
 w(604544:653266) = u(3)*w(199147:247869)
 w(653267:684506) = u(4)*w(216630:247869)
 w(684507:704247) = u(5)*w(228129:247869)
 w(704248:716585) = u(6)*w(235532:247869)
 w(716586:724290) = u(7)*w(240165:247869)
 w(724291:729223) = u(8)*w(242937:247869)
 w(729224:729853) = u(9)*w(78568:79197)
 w(729854:730408) = u(10)*w(78643:79197)
 w(730409:730893) = u(11)*w(78713:79197)
 w(730894:731313) = u(12)*w(78778:79197)
 w(731314:731673) = u(13)*w(78838:79197)
 w(731674:731978) = u(14)*w(78893:79197)
 w(731979:732233) = u(15)*w(78943:79197)
 w(732234:732443) = u(16)*w(78988:79197)
 w(732444:732613) = u(17)*w(79028:79197)
 w(732614:732748) = u(18)*w(79063:79197)
 w(732749:732853) = u(19)*w(79093:79197)
 w(732854:732933) = u(20)*w(79118:79197)
 w(732934:732993) = u(21)*w(79138:79197)
 w(732994:733038) = u(22)*w(79153:79197)
 w(733039:733056) = u(23)*w(23683:23700)
 w(733057:733069) = u(24)*w(23688:23700)
 w(733070:733078) = u(25)*w(23692:23700)
 w(733079:733084) = u(26)*w(23695:23700)
 w(733085:733088) = u(27)*w(23697:23700)
 w(733089:733093) = u(28)*w(6547:6551)
 w(733094:733098) = u(29)*w(6547:6551)
 w(733099:733103) = u(30)*w(6547:6551)
 w(733104:733108) = u(31)*w(6547:6551)
 w(733109:733113) = u(32)*w(6547:6551)
 w(733114:733118) = u(33)*w(6547:6551)
 w(733119:733123) = u(34)*w(6547:6551)
endif
END SUBROUTINE mg5221_prib
