SUBROUTINE mgy_base (nkj, mxd, r, w)
integer, intent (in) :: nkj(0:), mxd
real (kind=wp), intent (in) :: r(0:,0:)
real (kind=wp), intent (out) :: w(0:)
!-----------------------------------------------------------------------
integer :: ikv(0:size(nkj)-1), iord(0,size(r,1)-1), i, k, l, ib
if (size(r,1).ne.sum(nkj).or.size(r,2).ne.sum(nkj)) then
 stop 'mgy_base: bad dimension nkj, r'
!! else if (size(w).ne....) then
!!  stop 'mgy_base: bad dimension w'
endif
ikv = cx_sort(nkj)
k = 0
do l = 0, size(nkj)-1
 ib = sum(nkj(0:ikv(l)-1))
 do i = 0, nkj(ikv(l))-1
  iord(k) = ib+i
  k = k+1
 enddo
enddo
w = 0
select case (mgx_id(nkj))
case (0)
case (1)
 call mg1_base (mxd, r(iord,iord), w)
case (mg2_id)
 call mg2_base (mxd, r(iord,iord), w)
case (mg11_id)
 call mg11_base (mxd, r(iord,iord), w)
case (mg3_id)
 call mg3_base (mxd, r(iord,iord), w)
case (mg21_id)
 call mg21_base (mxd, r(iord,iord), w)
case (mg111_id)
 call mg111_base (mxd, r(iord,iord), w)
case (mg4_id)
 call mg4_base (mxd, r(iord,iord), w)
case (mg31_id)
 call mg31_base (mxd, r(iord,iord), w)
case (mg22_id)
 call mg22_base (mxd, r(iord,iord), w)
case (mg211_id)
 call mg211_base (mxd, r(iord,iord), w)
case (mg1111_id)
 call mg1111_base (mxd, r(iord,iord), w)
case (mg5_id)
 call mg5_base (mxd, r(iord,iord), w)
case (mg41_id)
 call mg41_base (mxd, r(iord,iord), w)
case (mg32_id)
 call mg32_base (mxd, r(iord,iord), w)
case (mg311_id)
 call mg311_base (mxd, r(iord,iord), w)
case (mg221_id)
 call mg221_base (mxd, r(iord,iord), w)
case (mg2111_id)
 call mg2111_base (mxd, r(iord,iord), w)
case (mg11111_id)
 call mg11111_base (mxd, r(iord,iord), w)
case (mg6_id)
 call mg6_base (mxd, r(iord,iord), w)
case (mg51_id)
 call mg51_base (mxd, r(iord,iord), w)
case (mg42_id)
 call mg42_base (mxd, r(iord,iord), w)
case (mg33_id)
 call mg33_base (mxd, r(iord,iord), w)
case (mg411_id)
 call mg411_base (mxd, r(iord,iord), w)
case (mg321_id)
 call mg321_base (mxd, r(iord,iord), w)
case (mg222_id)
 call mg222_base (mxd, r(iord,iord), w)
case (mg3111_id)
 call mg3111_base (mxd, r(iord,iord), w)
case (mg2211_id)
 call mg2211_base (mxd, r(iord,iord), w)
case (mg21111_id)
 call mg21111_base (mxd, r(iord,iord), w)
case (mg111111_id)
 call mg111111_base (mxd, r(iord,iord), w)
case (mg7_id)
 call mg7_base (mxd, r(iord,iord), w)
case (mg61_id)
 call mg61_base (mxd, r(iord,iord), w)
case (mg52_id)
 call mg52_base (mxd, r(iord,iord), w)
case (mg43_id)
 call mg43_base (mxd, r(iord,iord), w)
case (mg511_id)
 call mg511_base (mxd, r(iord,iord), w)
case (mg421_id)
 call mg421_base (mxd, r(iord,iord), w)
case (mg331_id)
 call mg331_base (mxd, r(iord,iord), w)
case (mg322_id)
 call mg322_base (mxd, r(iord,iord), w)
case (mg4111_id)
 call mg4111_base (mxd, r(iord,iord), w)
case (mg3211_id)
 call mg3211_base (mxd, r(iord,iord), w)
case (mg2221_id)
 call mg2221_base (mxd, r(iord,iord), w)
case (mg31111_id)
 call mg31111_base (mxd, r(iord,iord), w)
case (mg22111_id)
 call mg22111_base (mxd, r(iord,iord), w)
case (mg211111_id)
 call mg211111_base (mxd, r(iord,iord), w)
case (mg1111111_id)
 call mg1111111_base (mxd, r(iord,iord), w)
!! case (mg8_id)
!!  call mg8_base (mxd, r(iord,iord), w)
case (mg71_id)
 call mg71_base (mxd, r(iord,iord), w)
case (mg62_id)
 call mg62_base (mxd, r(iord,iord), w)
case (mg53_id)
 call mg53_base (mxd, r(iord,iord), w)
case (mg44_id)
 call mg44_base (mxd, r(iord,iord), w)
case (mg611_id)
 call mg611_base (mxd, r(iord,iord), w)
case (mg521_id)
 call mg521_base (mxd, r(iord,iord), w)
case (mg431_id)
 call mg431_base (mxd, r(iord,iord), w)
case (mg422_id)
 call mg422_base (mxd, r(iord,iord), w)
case (mg332_id)
 call mg332_base (mxd, r(iord,iord), w)
case (mg5111_id)
 call mg5111_base (mxd, r(iord,iord), w)
case (mg4211_id)
 call mg4211_base (mxd, r(iord,iord), w)
case (mg3311_id)
 call mg3311_base (mxd, r(iord,iord), w)
case (mg3221_id)
 call mg3221_base (mxd, r(iord,iord), w)
case (mg2222_id)
 call mg2222_base (mxd, r(iord,iord), w)
case (mg41111_id)
 call mg41111_base (mxd, r(iord,iord), w)
case (mg32111_id)
 call mg32111_base (mxd, r(iord,iord), w)
case (mg22211_id)
 call mg22211_base (mxd, r(iord,iord), w)
case (mg311111_id)
 call mg311111_base (mxd, r(iord,iord), w)
case (mg221111_id)
 call mg221111_base (mxd, r(iord,iord), w)
case (mg2111111_id)
 call mg2111111_base (mxd, r(iord,iord), w)
case (mg11111111_id)
 call mg11111111_base (mxd, r(iord,iord), w)
!! case (mg9_id)
!!  call mg9_base (mxd, r(iord,iord), w)
!! case (mg81_id)
!!  call mg81_base (mxd, r(iord,iord), w)
case (mg72_id)
 call mg72_base (mxd, r(iord,iord), w)
case (mg63_id)
 call mg63_base (mxd, r(iord,iord), w)
case (mg54_id)
 call mg54_base (mxd, r(iord,iord), w)
case (mg711_id)
 call mg711_base (mxd, r(iord,iord), w)
case (mg621_id)
 call mg621_base (mxd, r(iord,iord), w)
case (mg531_id)
 call mg531_base (mxd, r(iord,iord), w)
case (mg441_id)
 call mg441_base (mxd, r(iord,iord), w)
case (mg522_id)
 call mg522_base (mxd, r(iord,iord), w)
case (mg432_id)
 call mg432_base (mxd, r(iord,iord), w)
case (mg333_id)
 call mg333_base (mxd, r(iord,iord), w)
case (mg6111_id)
 call mg6111_base (mxd, r(iord,iord), w)
case (mg5211_id)
 call mg5211_base (mxd, r(iord,iord), w)
case (mg4311_id)
 call mg4311_base (mxd, r(iord,iord), w)
case (mg4221_id)
 call mg4221_base (mxd, r(iord,iord), w)
case (mg3321_id)
 call mg3321_base (mxd, r(iord,iord), w)
case (mg3222_id)
 call mg3222_base (mxd, r(iord,iord), w)
case (mg51111_id)
 call mg51111_base (mxd, r(iord,iord), w)
case (mg42111_id)
 call mg42111_base (mxd, r(iord,iord), w)
case (mg33111_id)
 call mg33111_base (mxd, r(iord,iord), w)
case (mg32211_id)
 call mg32211_base (mxd, r(iord,iord), w)
case (mg22221_id)
 call mg22221_base (mxd, r(iord,iord), w)
case (mg411111_id)
 call mg411111_base (mxd, r(iord,iord), w)
case (mg321111_id)
 call mg321111_base (mxd, r(iord,iord), w)
case (mg222111_id)
 call mg222111_base (mxd, r(iord,iord), w)
case (mg3111111_id)
 call mg3111111_base (mxd, r(iord,iord), w)
case (mg2211111_id)
 call mg2211111_base (mxd, r(iord,iord), w)
case (mg21111111_id)
 call mg21111111_base (mxd, r(iord,iord), w)
case (mg111111111_id)
 call mg111111111_base (mxd, r(iord,iord), w)
case default
 stop 'mgy_base: bad nkj'
end select
return
END SUBROUTINE mgy_base
