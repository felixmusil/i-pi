SUBROUTINE mg432_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg432_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg432_prib: bad size u'
!! else if (size(w).ne.mg432_npb(mxd)) then
!!  stop 'mg432_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 6 12 8 6 0 3 0 0 0
! prib,  dnpb(0:*): 1 6 33 136 510 1692 5237 15066 41136 106742
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(7:12) = u(0)*w(1:6)
 w(13:17) = u(1)*w(2:6)
 w(18:21) = u(2)*w(3:6)
 w(22:24) = u(3)*w(4:6)
 w(25:26) = u(4)*w(5:6)
 w(27) = u(5)*w(6)
 w(28) = u(6)*w(0)
 w(29) = u(7)*w(0)
 w(30) = u(8)*w(0)
 w(31) = u(9)*w(0)
 w(32) = u(10)*w(0)
 w(33) = u(11)*w(0)
 w(34) = u(12)*w(0)
 w(35) = u(13)*w(0)
 w(36) = u(14)*w(0)
 w(37) = u(15)*w(0)
 w(38) = u(16)*w(0)
 w(39) = u(17)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(40:72) = u(0)*w(7:39)
 w(73:99) = u(1)*w(13:39)
 w(100:121) = u(2)*w(18:39)
 w(122:139) = u(3)*w(22:39)
 w(140:154) = u(4)*w(25:39)
 w(155:167) = u(5)*w(27:39)
 w(168) = u(18)*w(0)
 w(169) = u(19)*w(0)
 w(170) = u(20)*w(0)
 w(171) = u(21)*w(0)
 w(172) = u(22)*w(0)
 w(173) = u(23)*w(0)
 w(174) = u(24)*w(0)
 w(175) = u(25)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(176:311) = u(0)*w(40:175)
 w(312:414) = u(1)*w(73:175)
 w(415:490) = u(2)*w(100:175)
 w(491:544) = u(3)*w(122:175)
 w(545:580) = u(4)*w(140:175)
 w(581:601) = u(5)*w(155:175)
 w(602:613) = u(6)*w(28:39)
 w(614:624) = u(7)*w(29:39)
 w(625:634) = u(8)*w(30:39)
 w(635:643) = u(9)*w(31:39)
 w(644:651) = u(10)*w(32:39)
 w(652:658) = u(11)*w(33:39)
 w(659:664) = u(12)*w(34:39)
 w(665:669) = u(13)*w(35:39)
 w(670:673) = u(14)*w(36:39)
 w(674:676) = u(15)*w(37:39)
 w(677:678) = u(16)*w(38:39)
 w(679) = u(17)*w(39)
 w(680) = u(26)*w(0)
 w(681) = u(27)*w(0)
 w(682) = u(28)*w(0)
 w(683) = u(29)*w(0)
 w(684) = u(30)*w(0)
 w(685) = u(31)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(686:1195) = u(0)*w(176:685)
 w(1196:1569) = u(1)*w(312:685)
 w(1570:1840) = u(2)*w(415:685)
 w(1841:2035) = u(3)*w(491:685)
 w(2036:2176) = u(4)*w(545:685)
 w(2177:2281) = u(5)*w(581:685)
 w(2282:2289) = u(6)*w(168:175)
 w(2290:2297) = u(7)*w(168:175)
 w(2298:2305) = u(8)*w(168:175)
 w(2306:2313) = u(9)*w(168:175)
 w(2314:2321) = u(10)*w(168:175)
 w(2322:2329) = u(11)*w(168:175)
 w(2330:2337) = u(12)*w(168:175)
 w(2338:2345) = u(13)*w(168:175)
 w(2346:2353) = u(14)*w(168:175)
 w(2354:2361) = u(15)*w(168:175)
 w(2362:2369) = u(16)*w(168:175)
 w(2370:2377) = u(17)*w(168:175)
endif
! terms of degree 6
if (6.le.mxd) then
 w(2378:4069) = u(0)*w(686:2377)
 w(4070:5251) = u(1)*w(1196:2377)
 w(5252:6059) = u(2)*w(1570:2377)
 w(6060:6596) = u(3)*w(1841:2377)
 w(6597:6938) = u(4)*w(2036:2377)
 w(6939:7139) = u(5)*w(2177:2377)
 w(7140:7223) = u(6)*w(602:685)
 w(7224:7295) = u(7)*w(614:685)
 w(7296:7356) = u(8)*w(625:685)
 w(7357:7407) = u(9)*w(635:685)
 w(7408:7449) = u(10)*w(644:685)
 w(7450:7483) = u(11)*w(652:685)
 w(7484:7510) = u(12)*w(659:685)
 w(7511:7531) = u(13)*w(665:685)
 w(7532:7547) = u(14)*w(670:685)
 w(7548:7559) = u(15)*w(674:685)
 w(7560:7568) = u(16)*w(677:685)
 w(7569:7575) = u(17)*w(679:685)
 w(7576:7583) = u(18)*w(168:175)
 w(7584:7590) = u(19)*w(169:175)
 w(7591:7596) = u(20)*w(170:175)
 w(7597:7601) = u(21)*w(171:175)
 w(7602:7605) = u(22)*w(172:175)
 w(7606:7608) = u(23)*w(173:175)
 w(7609:7610) = u(24)*w(174:175)
 w(7611) = u(25)*w(175)
 w(7612) = u(32)*w(0)
 w(7613) = u(33)*w(0)
 w(7614) = u(34)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(7615:12851) = u(0)*w(2378:7614)
 w(12852:16396) = u(1)*w(4070:7614)
 w(16397:18759) = u(2)*w(5252:7614)
 w(18760:20314) = u(3)*w(6060:7614)
 w(20315:21332) = u(4)*w(6597:7614)
 w(21333:22008) = u(5)*w(6939:7614)
 w(22009:22104) = u(6)*w(2282:2377)
 w(22105:22192) = u(7)*w(2290:2377)
 w(22193:22272) = u(8)*w(2298:2377)
 w(22273:22344) = u(9)*w(2306:2377)
 w(22345:22408) = u(10)*w(2314:2377)
 w(22409:22464) = u(11)*w(2322:2377)
 w(22465:22512) = u(12)*w(2330:2377)
 w(22513:22552) = u(13)*w(2338:2377)
 w(22553:22584) = u(14)*w(2346:2377)
 w(22585:22608) = u(15)*w(2354:2377)
 w(22609:22624) = u(16)*w(2362:2377)
 w(22625:22632) = u(17)*w(2370:2377)
 w(22633:22638) = u(18)*w(680:685)
 w(22639:22644) = u(19)*w(680:685)
 w(22645:22650) = u(20)*w(680:685)
 w(22651:22656) = u(21)*w(680:685)
 w(22657:22662) = u(22)*w(680:685)
 w(22663:22668) = u(23)*w(680:685)
 w(22669:22674) = u(24)*w(680:685)
 w(22675:22680) = u(25)*w(680:685)
endif
! terms of degree 8
if (8.le.mxd) then
 w(22681:37746) = u(0)*w(7615:22680)
 w(37747:47575) = u(1)*w(12852:22680)
 w(47576:53859) = u(2)*w(16397:22680)
 w(53860:57780) = u(3)*w(18760:22680)
 w(57781:60146) = u(4)*w(20315:22680)
 w(60147:61494) = u(5)*w(21333:22680)
 w(61495:61969) = u(6)*w(7140:7614)
 w(61970:62360) = u(7)*w(7224:7614)
 w(62361:62679) = u(8)*w(7296:7614)
 w(62680:62937) = u(9)*w(7357:7614)
 w(62938:63144) = u(10)*w(7408:7614)
 w(63145:63309) = u(11)*w(7450:7614)
 w(63310:63440) = u(12)*w(7484:7614)
 w(63441:63544) = u(13)*w(7511:7614)
 w(63545:63627) = u(14)*w(7532:7614)
 w(63628:63694) = u(15)*w(7548:7614)
 w(63695:63749) = u(16)*w(7560:7614)
 w(63750:63795) = u(17)*w(7569:7614)
 w(63796:63801) = u(26)*w(680:685)
 w(63802:63806) = u(27)*w(681:685)
 w(63807:63810) = u(28)*w(682:685)
 w(63811:63813) = u(29)*w(683:685)
 w(63814:63815) = u(30)*w(684:685)
 w(63816) = u(31)*w(685)
endif
! terms of degree 9
if (9.le.mxd) then
 w(63817:104952) = u(0)*w(22681:63816)
 w(104953:131022) = u(1)*w(37747:63816)
 w(131023:147263) = u(2)*w(47576:63816)
 w(147264:157220) = u(3)*w(53860:63816)
 w(157221:163256) = u(4)*w(57781:63816)
 w(163257:166926) = u(5)*w(60147:63816)
 w(166927:167598) = u(6)*w(22009:22680)
 w(167599:168174) = u(7)*w(22105:22680)
 w(168175:168662) = u(8)*w(22193:22680)
 w(168663:169070) = u(9)*w(22273:22680)
 w(169071:169406) = u(10)*w(22345:22680)
 w(169407:169678) = u(11)*w(22409:22680)
 w(169679:169894) = u(12)*w(22465:22680)
 w(169895:170062) = u(13)*w(22513:22680)
 w(170063:170190) = u(14)*w(22553:22680)
 w(170191:170286) = u(15)*w(22585:22680)
 w(170287:170358) = u(16)*w(22609:22680)
 w(170359:170414) = u(17)*w(22625:22680)
 w(170415:170453) = u(18)*w(7576:7614)
 w(170454:170484) = u(19)*w(7584:7614)
 w(170485:170508) = u(20)*w(7591:7614)
 w(170509:170526) = u(21)*w(7597:7614)
 w(170527:170539) = u(22)*w(7602:7614)
 w(170540:170548) = u(23)*w(7606:7614)
 w(170549:170554) = u(24)*w(7609:7614)
 w(170555:170558) = u(25)*w(7611:7614)
endif
END SUBROUTINE mg432_prib
