SUBROUTINE mg5111_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg5111_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg5111_prib: bad size u'
!! else if (size(w).ne.mg5111_npb(mxd)) then
!!  stop 'mg5111_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 7 5 5 5 5 1 0 0 0
! prib,  dnpb(0:*): 1 7 33 124 405 1192 3240 8253 19921 45924
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(8:14) = u(0)*w(1:7)
 w(15:20) = u(1)*w(2:7)
 w(21:25) = u(2)*w(3:7)
 w(26:29) = u(3)*w(4:7)
 w(30:32) = u(4)*w(5:7)
 w(33:34) = u(5)*w(6:7)
 w(35) = u(6)*w(7)
 w(36) = u(7)*w(0)
 w(37) = u(8)*w(0)
 w(38) = u(9)*w(0)
 w(39) = u(10)*w(0)
 w(40) = u(11)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(41:73) = u(0)*w(8:40)
 w(74:99) = u(1)*w(15:40)
 w(100:119) = u(2)*w(21:40)
 w(120:134) = u(3)*w(26:40)
 w(135:145) = u(4)*w(30:40)
 w(146:153) = u(5)*w(33:40)
 w(154:159) = u(6)*w(35:40)
 w(160) = u(12)*w(0)
 w(161) = u(13)*w(0)
 w(162) = u(14)*w(0)
 w(163) = u(15)*w(0)
 w(164) = u(16)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(165:288) = u(0)*w(41:164)
 w(289:379) = u(1)*w(74:164)
 w(380:444) = u(2)*w(100:164)
 w(445:489) = u(3)*w(120:164)
 w(490:519) = u(4)*w(135:164)
 w(520:538) = u(5)*w(146:164)
 w(539:549) = u(6)*w(154:164)
 w(550:554) = u(7)*w(36:40)
 w(555:558) = u(8)*w(37:40)
 w(559:561) = u(9)*w(38:40)
 w(562:563) = u(10)*w(39:40)
 w(564) = u(11)*w(40)
 w(565) = u(17)*w(0)
 w(566) = u(18)*w(0)
 w(567) = u(19)*w(0)
 w(568) = u(20)*w(0)
 w(569) = u(21)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(570:974) = u(0)*w(165:569)
 w(975:1255) = u(1)*w(289:569)
 w(1256:1445) = u(2)*w(380:569)
 w(1446:1570) = u(3)*w(445:569)
 w(1571:1650) = u(4)*w(490:569)
 w(1651:1700) = u(5)*w(520:569)
 w(1701:1731) = u(6)*w(539:569)
 w(1732:1736) = u(7)*w(160:164)
 w(1737:1741) = u(8)*w(160:164)
 w(1742:1746) = u(9)*w(160:164)
 w(1747:1751) = u(10)*w(160:164)
 w(1752:1756) = u(11)*w(160:164)
 w(1757) = u(22)*w(0)
 w(1758) = u(23)*w(0)
 w(1759) = u(24)*w(0)
 w(1760) = u(25)*w(0)
 w(1761) = u(26)*w(0)
endif
! terms of degree 6
if (6.le.mxd) then
 w(1762:2953) = u(0)*w(570:1761)
 w(2954:3740) = u(1)*w(975:1761)
 w(3741:4246) = u(2)*w(1256:1761)
 w(4247:4562) = u(3)*w(1446:1761)
 w(4563:4753) = u(4)*w(1571:1761)
 w(4754:4864) = u(5)*w(1651:1761)
 w(4865:4925) = u(6)*w(1701:1761)
 w(4926:4945) = u(7)*w(550:569)
 w(4946:4960) = u(8)*w(555:569)
 w(4961:4971) = u(9)*w(559:569)
 w(4972:4979) = u(10)*w(562:569)
 w(4980:4985) = u(11)*w(564:569)
 w(4986:4990) = u(12)*w(160:164)
 w(4991:4994) = u(13)*w(161:164)
 w(4995:4997) = u(14)*w(162:164)
 w(4998:4999) = u(15)*w(163:164)
 w(5000) = u(16)*w(164)
 w(5001) = u(27)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(5002:8241) = u(0)*w(1762:5001)
 w(8242:10289) = u(1)*w(2954:5001)
 w(10290:11550) = u(2)*w(3741:5001)
 w(11551:12305) = u(3)*w(4247:5001)
 w(12306:12744) = u(4)*w(4563:5001)
 w(12745:12992) = u(5)*w(4754:5001)
 w(12993:13129) = u(6)*w(4865:5001)
 w(13130:13159) = u(7)*w(1732:1761)
 w(13160:13184) = u(8)*w(1737:1761)
 w(13185:13204) = u(9)*w(1742:1761)
 w(13205:13219) = u(10)*w(1747:1761)
 w(13220:13229) = u(11)*w(1752:1761)
 w(13230:13234) = u(12)*w(565:569)
 w(13235:13239) = u(13)*w(565:569)
 w(13240:13244) = u(14)*w(565:569)
 w(13245:13249) = u(15)*w(565:569)
 w(13250:13254) = u(16)*w(565:569)
endif
! terms of degree 8
if (8.le.mxd) then
 w(13255:21507) = u(0)*w(5002:13254)
 w(21508:26520) = u(1)*w(8242:13254)
 w(26521:29485) = u(2)*w(10290:13254)
 w(29486:31189) = u(3)*w(11551:13254)
 w(31190:32138) = u(4)*w(12306:13254)
 w(32139:32648) = u(5)*w(12745:13254)
 w(32649:32910) = u(6)*w(12993:13254)
 w(32911:32986) = u(7)*w(4926:5001)
 w(32987:33042) = u(8)*w(4946:5001)
 w(33043:33083) = u(9)*w(4961:5001)
 w(33084:33113) = u(10)*w(4972:5001)
 w(33114:33135) = u(11)*w(4980:5001)
 w(33136:33140) = u(12)*w(1757:1761)
 w(33141:33145) = u(13)*w(1757:1761)
 w(33146:33150) = u(14)*w(1757:1761)
 w(33151:33155) = u(15)*w(1757:1761)
 w(33156:33160) = u(16)*w(1757:1761)
 w(33161:33165) = u(17)*w(565:569)
 w(33166:33169) = u(18)*w(566:569)
 w(33170:33172) = u(19)*w(567:569)
 w(33173:33174) = u(20)*w(568:569)
 w(33175) = u(21)*w(569)
endif
! terms of degree 9
if (9.le.mxd) then
 w(33176:53096) = u(0)*w(13255:33175)
 w(53097:64764) = u(1)*w(21508:33175)
 w(64765:71419) = u(2)*w(26521:33175)
 w(71420:75109) = u(3)*w(29486:33175)
 w(75110:77095) = u(4)*w(31190:33175)
 w(77096:78132) = u(5)*w(32139:33175)
 w(78133:78659) = u(6)*w(32649:33175)
 w(78660:78784) = u(7)*w(13130:13254)
 w(78785:78879) = u(8)*w(13160:13254)
 w(78880:78949) = u(9)*w(13185:13254)
 w(78950:78999) = u(10)*w(13205:13254)
 w(79000:79034) = u(11)*w(13220:13254)
 w(79035:79050) = u(12)*w(4986:5001)
 w(79051:79061) = u(13)*w(4991:5001)
 w(79062:79068) = u(14)*w(4995:5001)
 w(79069:79072) = u(15)*w(4998:5001)
 w(79073:79074) = u(16)*w(5000:5001)
 w(79075:79079) = u(17)*w(1757:1761)
 w(79080:79084) = u(18)*w(1757:1761)
 w(79085:79089) = u(19)*w(1757:1761)
 w(79090:79094) = u(20)*w(1757:1761)
 w(79095:79099) = u(21)*w(1757:1761)
endif
END SUBROUTINE mg5111_prib
