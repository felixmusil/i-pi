SUBROUTINE mg41111_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg41111_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg41111_prib: bad size u'
!! else if (size(w).ne.mg41111_npb(mxd)) then
!!  stop 'mg41111_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 11 6 6 5 0 0 0 0 0
! prib,  dnpb(0:*): 1 11 72 358 1489 5437 17949 54617 155296 416790
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
 w(10) = u(9)*w(0)
 w(11) = u(10)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(12:22) = u(0)*w(1:11)
 w(23:32) = u(1)*w(2:11)
 w(33:41) = u(2)*w(3:11)
 w(42:49) = u(3)*w(4:11)
 w(50:56) = u(4)*w(5:11)
 w(57:62) = u(5)*w(6:11)
 w(63:67) = u(6)*w(7:11)
 w(68:71) = u(7)*w(8:11)
 w(72:74) = u(8)*w(9:11)
 w(75:76) = u(9)*w(10:11)
 w(77) = u(10)*w(11)
 w(78) = u(11)*w(0)
 w(79) = u(12)*w(0)
 w(80) = u(13)*w(0)
 w(81) = u(14)*w(0)
 w(82) = u(15)*w(0)
 w(83) = u(16)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(84:155) = u(0)*w(12:83)
 w(156:216) = u(1)*w(23:83)
 w(217:267) = u(2)*w(33:83)
 w(268:309) = u(3)*w(42:83)
 w(310:343) = u(4)*w(50:83)
 w(344:370) = u(5)*w(57:83)
 w(371:391) = u(6)*w(63:83)
 w(392:407) = u(7)*w(68:83)
 w(408:419) = u(8)*w(72:83)
 w(420:428) = u(9)*w(75:83)
 w(429:435) = u(10)*w(77:83)
 w(436) = u(17)*w(0)
 w(437) = u(18)*w(0)
 w(438) = u(19)*w(0)
 w(439) = u(20)*w(0)
 w(440) = u(21)*w(0)
 w(441) = u(22)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(442:799) = u(0)*w(84:441)
 w(800:1085) = u(1)*w(156:441)
 w(1086:1310) = u(2)*w(217:441)
 w(1311:1484) = u(3)*w(268:441)
 w(1485:1616) = u(4)*w(310:441)
 w(1617:1714) = u(5)*w(344:441)
 w(1715:1785) = u(6)*w(371:441)
 w(1786:1835) = u(7)*w(392:441)
 w(1836:1869) = u(8)*w(408:441)
 w(1870:1891) = u(9)*w(420:441)
 w(1892:1904) = u(10)*w(429:441)
 w(1905:1910) = u(11)*w(78:83)
 w(1911:1915) = u(12)*w(79:83)
 w(1916:1919) = u(13)*w(80:83)
 w(1920:1922) = u(14)*w(81:83)
 w(1923:1924) = u(15)*w(82:83)
 w(1925) = u(16)*w(83)
 w(1926) = u(23)*w(0)
 w(1927) = u(24)*w(0)
 w(1928) = u(25)*w(0)
 w(1929) = u(26)*w(0)
 w(1930) = u(27)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(1931:3419) = u(0)*w(442:1930)
 w(3420:4550) = u(1)*w(800:1930)
 w(4551:5395) = u(2)*w(1086:1930)
 w(5396:6015) = u(3)*w(1311:1930)
 w(6016:6461) = u(4)*w(1485:1930)
 w(6462:6775) = u(5)*w(1617:1930)
 w(6776:6991) = u(6)*w(1715:1930)
 w(6992:7136) = u(7)*w(1786:1930)
 w(7137:7231) = u(8)*w(1836:1930)
 w(7232:7292) = u(9)*w(1870:1930)
 w(7293:7331) = u(10)*w(1892:1930)
 w(7332:7337) = u(11)*w(436:441)
 w(7338:7343) = u(12)*w(436:441)
 w(7344:7349) = u(13)*w(436:441)
 w(7350:7355) = u(14)*w(436:441)
 w(7356:7361) = u(15)*w(436:441)
 w(7362:7367) = u(16)*w(436:441)
endif
! terms of degree 6
if (6.le.mxd) then
 w(7368:12804) = u(0)*w(1931:7367)
 w(12805:16752) = u(1)*w(3420:7367)
 w(16753:19569) = u(2)*w(4551:7367)
 w(19570:21541) = u(3)*w(5396:7367)
 w(21542:22893) = u(4)*w(6016:7367)
 w(22894:23799) = u(5)*w(6462:7367)
 w(23800:24391) = u(6)*w(6776:7367)
 w(24392:24767) = u(7)*w(6992:7367)
 w(24768:24998) = u(8)*w(7137:7367)
 w(24999:25134) = u(9)*w(7232:7367)
 w(25135:25209) = u(10)*w(7293:7367)
 w(25210:25235) = u(11)*w(1905:1930)
 w(25236:25255) = u(12)*w(1911:1930)
 w(25256:25270) = u(13)*w(1916:1930)
 w(25271:25281) = u(14)*w(1920:1930)
 w(25282:25289) = u(15)*w(1923:1930)
 w(25290:25295) = u(16)*w(1925:1930)
 w(25296:25301) = u(17)*w(436:441)
 w(25302:25306) = u(18)*w(437:441)
 w(25307:25310) = u(19)*w(438:441)
 w(25311:25313) = u(20)*w(439:441)
 w(25314:25315) = u(21)*w(440:441)
 w(25316) = u(22)*w(441)
endif
! terms of degree 7
if (7.le.mxd) then
 w(25317:43265) = u(0)*w(7368:25316)
 w(43266:55777) = u(1)*w(12805:25316)
 w(55778:64341) = u(2)*w(16753:25316)
 w(64342:70088) = u(3)*w(19570:25316)
 w(70089:73863) = u(4)*w(21542:25316)
 w(73864:76286) = u(5)*w(22894:25316)
 w(76287:77803) = u(6)*w(23800:25316)
 w(77804:78728) = u(7)*w(24392:25316)
 w(78729:79277) = u(8)*w(24768:25316)
 w(79278:79595) = u(9)*w(24999:25316)
 w(79596:79777) = u(10)*w(25135:25316)
 w(79778:79813) = u(11)*w(7332:7367)
 w(79814:79843) = u(12)*w(7338:7367)
 w(79844:79867) = u(13)*w(7344:7367)
 w(79868:79885) = u(14)*w(7350:7367)
 w(79886:79897) = u(15)*w(7356:7367)
 w(79898:79903) = u(16)*w(7362:7367)
 w(79904:79908) = u(17)*w(1926:1930)
 w(79909:79913) = u(18)*w(1926:1930)
 w(79914:79918) = u(19)*w(1926:1930)
 w(79919:79923) = u(20)*w(1926:1930)
 w(79924:79928) = u(21)*w(1926:1930)
 w(79929:79933) = u(22)*w(1926:1930)
endif
! terms of degree 8
if (8.le.mxd) then
 w(79934:134550) = u(0)*w(25317:79933)
 w(134551:171218) = u(1)*w(43266:79933)
 w(171219:195374) = u(2)*w(55778:79933)
 w(195375:210966) = u(3)*w(64342:79933)
 w(210967:220811) = u(4)*w(70089:79933)
 w(220812:226881) = u(5)*w(73864:79933)
 w(226882:230528) = u(6)*w(76287:79933)
 w(230529:232658) = u(7)*w(77804:79933)
 w(232659:233863) = u(8)*w(78729:79933)
 w(233864:234519) = u(9)*w(79278:79933)
 w(234520:234857) = u(10)*w(79596:79933)
 w(234858:234964) = u(11)*w(25210:25316)
 w(234965:235045) = u(12)*w(25236:25316)
 w(235046:235106) = u(13)*w(25256:25316)
 w(235107:235152) = u(14)*w(25271:25316)
 w(235153:235187) = u(15)*w(25282:25316)
 w(235188:235214) = u(16)*w(25290:25316)
 w(235215:235219) = u(23)*w(1926:1930)
 w(235220:235223) = u(24)*w(1927:1930)
 w(235224:235226) = u(25)*w(1928:1930)
 w(235227:235228) = u(26)*w(1929:1930)
 w(235229) = u(27)*w(1930)
endif
! terms of degree 9
if (9.le.mxd) then
 w(235230:390525) = u(0)*w(79934:235229)
 w(390526:491204) = u(1)*w(134551:235229)
 w(491205:555215) = u(2)*w(171219:235229)
 w(555216:595070) = u(3)*w(195375:235229)
 w(595071:619333) = u(4)*w(210967:235229)
 w(619334:633751) = u(5)*w(220812:235229)
 w(633752:642099) = u(6)*w(226882:235229)
 w(642100:646800) = u(7)*w(230529:235229)
 w(646801:649371) = u(8)*w(232659:235229)
 w(649372:650737) = u(9)*w(233864:235229)
 w(650738:651447) = u(10)*w(234520:235229)
 w(651448:651603) = u(11)*w(79778:79933)
 w(651604:651723) = u(12)*w(79814:79933)
 w(651724:651813) = u(13)*w(79844:79933)
 w(651814:651879) = u(14)*w(79868:79933)
 w(651880:651927) = u(15)*w(79886:79933)
 w(651928:651963) = u(16)*w(79898:79933)
 w(651964:651984) = u(17)*w(25296:25316)
 w(651985:651999) = u(18)*w(25302:25316)
 w(652000:652009) = u(19)*w(25307:25316)
 w(652010:652015) = u(20)*w(25311:25316)
 w(652016:652018) = u(21)*w(25314:25316)
 w(652019) = u(22)*w(25316)
endif
END SUBROUTINE mg41111_prib
