SUBROUTINE mg52111_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg52111_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg52111_prib: bad size u'
!! else if (size(w).ne.mg52111_npb(mxd)) then
!!  stop 'mg52111_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 12 11 6 7 6 2 0 0 0
! prib,  dnpb(0:*): 1 12 89 502 2368 9788 36519 125386 401715 1213284
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
 w(10) = u(9)*w(0)
 w(11) = u(10)*w(0)
 w(12) = u(11)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(13:24) = u(0)*w(1:12)
 w(25:35) = u(1)*w(2:12)
 w(36:45) = u(2)*w(3:12)
 w(46:54) = u(3)*w(4:12)
 w(55:62) = u(4)*w(5:12)
 w(63:69) = u(5)*w(6:12)
 w(70:75) = u(6)*w(7:12)
 w(76:80) = u(7)*w(8:12)
 w(81:84) = u(8)*w(9:12)
 w(85:87) = u(9)*w(10:12)
 w(88:89) = u(10)*w(11:12)
 w(90) = u(11)*w(12)
 w(91) = u(12)*w(0)
 w(92) = u(13)*w(0)
 w(93) = u(14)*w(0)
 w(94) = u(15)*w(0)
 w(95) = u(16)*w(0)
 w(96) = u(17)*w(0)
 w(97) = u(18)*w(0)
 w(98) = u(19)*w(0)
 w(99) = u(20)*w(0)
 w(100) = u(21)*w(0)
 w(101) = u(22)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(102:190) = u(0)*w(13:101)
 w(191:267) = u(1)*w(25:101)
 w(268:333) = u(2)*w(36:101)
 w(334:389) = u(3)*w(46:101)
 w(390:436) = u(4)*w(55:101)
 w(437:475) = u(5)*w(63:101)
 w(476:507) = u(6)*w(70:101)
 w(508:533) = u(7)*w(76:101)
 w(534:554) = u(8)*w(81:101)
 w(555:571) = u(9)*w(85:101)
 w(572:585) = u(10)*w(88:101)
 w(586:597) = u(11)*w(90:101)
 w(598) = u(23)*w(0)
 w(599) = u(24)*w(0)
 w(600) = u(25)*w(0)
 w(601) = u(26)*w(0)
 w(602) = u(27)*w(0)
 w(603) = u(28)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(604:1105) = u(0)*w(102:603)
 w(1106:1518) = u(1)*w(191:603)
 w(1519:1854) = u(2)*w(268:603)
 w(1855:2124) = u(3)*w(334:603)
 w(2125:2338) = u(4)*w(390:603)
 w(2339:2505) = u(5)*w(437:603)
 w(2506:2633) = u(6)*w(476:603)
 w(2634:2729) = u(7)*w(508:603)
 w(2730:2799) = u(8)*w(534:603)
 w(2800:2848) = u(9)*w(555:603)
 w(2849:2880) = u(10)*w(572:603)
 w(2881:2898) = u(11)*w(586:603)
 w(2899:2909) = u(12)*w(91:101)
 w(2910:2919) = u(13)*w(92:101)
 w(2920:2928) = u(14)*w(93:101)
 w(2929:2936) = u(15)*w(94:101)
 w(2937:2943) = u(16)*w(95:101)
 w(2944:2949) = u(17)*w(96:101)
 w(2950:2954) = u(18)*w(97:101)
 w(2955:2958) = u(19)*w(98:101)
 w(2959:2961) = u(20)*w(99:101)
 w(2962:2963) = u(21)*w(100:101)
 w(2964) = u(22)*w(101)
 w(2965) = u(29)*w(0)
 w(2966) = u(30)*w(0)
 w(2967) = u(31)*w(0)
 w(2968) = u(32)*w(0)
 w(2969) = u(33)*w(0)
 w(2970) = u(34)*w(0)
 w(2971) = u(35)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(2972:5339) = u(0)*w(604:2971)
 w(5340:7205) = u(1)*w(1106:2971)
 w(7206:8658) = u(2)*w(1519:2971)
 w(8659:9775) = u(3)*w(1855:2971)
 w(9776:10622) = u(4)*w(2125:2971)
 w(10623:11255) = u(5)*w(2339:2971)
 w(11256:11721) = u(6)*w(2506:2971)
 w(11722:12059) = u(7)*w(2634:2971)
 w(12060:12301) = u(8)*w(2730:2971)
 w(12302:12473) = u(9)*w(2800:2971)
 w(12474:12596) = u(10)*w(2849:2971)
 w(12597:12687) = u(11)*w(2881:2971)
 w(12688:12693) = u(12)*w(598:603)
 w(12694:12699) = u(13)*w(598:603)
 w(12700:12705) = u(14)*w(598:603)
 w(12706:12711) = u(15)*w(598:603)
 w(12712:12717) = u(16)*w(598:603)
 w(12718:12723) = u(17)*w(598:603)
 w(12724:12729) = u(18)*w(598:603)
 w(12730:12735) = u(19)*w(598:603)
 w(12736:12741) = u(20)*w(598:603)
 w(12742:12747) = u(21)*w(598:603)
 w(12748:12753) = u(22)*w(598:603)
 w(12754) = u(36)*w(0)
 w(12755) = u(37)*w(0)
 w(12756) = u(38)*w(0)
 w(12757) = u(39)*w(0)
 w(12758) = u(40)*w(0)
 w(12759) = u(41)*w(0)
endif
! terms of degree 6
if (6.le.mxd) then
 w(12760:22547) = u(0)*w(2972:12759)
 w(22548:29967) = u(1)*w(5340:12759)
 w(29968:35521) = u(2)*w(7206:12759)
 w(35522:39622) = u(3)*w(8659:12759)
 w(39623:42606) = u(4)*w(9776:12759)
 w(42607:44743) = u(5)*w(10623:12759)
 w(44744:46247) = u(6)*w(11256:12759)
 w(46248:47285) = u(7)*w(11722:12759)
 w(47286:47985) = u(8)*w(12060:12759)
 w(47986:48443) = u(9)*w(12302:12759)
 w(48444:48729) = u(10)*w(12474:12759)
 w(48730:48892) = u(11)*w(12597:12759)
 w(48893:48965) = u(12)*w(2899:2971)
 w(48966:49027) = u(13)*w(2910:2971)
 w(49028:49079) = u(14)*w(2920:2971)
 w(49080:49122) = u(15)*w(2929:2971)
 w(49123:49157) = u(16)*w(2937:2971)
 w(49158:49185) = u(17)*w(2944:2971)
 w(49186:49207) = u(18)*w(2950:2971)
 w(49208:49224) = u(19)*w(2955:2971)
 w(49225:49237) = u(20)*w(2959:2971)
 w(49238:49247) = u(21)*w(2962:2971)
 w(49248:49255) = u(22)*w(2964:2971)
 w(49256:49261) = u(23)*w(598:603)
 w(49262:49266) = u(24)*w(599:603)
 w(49267:49270) = u(25)*w(600:603)
 w(49271:49273) = u(26)*w(601:603)
 w(49274:49275) = u(27)*w(602:603)
 w(49276) = u(28)*w(603)
 w(49277) = u(42)*w(0)
 w(49278) = u(43)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(49279:85797) = u(0)*w(12760:49278)
 w(85798:112528) = u(1)*w(22548:49278)
 w(112529:131839) = u(2)*w(29968:49278)
 w(131840:145596) = u(3)*w(35522:49278)
 w(145597:155252) = u(4)*w(39623:49278)
 w(155253:161924) = u(5)*w(42607:49278)
 w(161925:166459) = u(6)*w(44744:49278)
 w(166460:169490) = u(7)*w(46248:49278)
 w(169491:171483) = u(8)*w(47286:49278)
 w(171484:172776) = u(9)*w(47986:49278)
 w(172777:173611) = u(10)*w(48444:49278)
 w(173612:174160) = u(11)*w(48730:49278)
 w(174161:174232) = u(12)*w(12688:12759)
 w(174233:174298) = u(13)*w(12694:12759)
 w(174299:174358) = u(14)*w(12700:12759)
 w(174359:174412) = u(15)*w(12706:12759)
 w(174413:174460) = u(16)*w(12712:12759)
 w(174461:174502) = u(17)*w(12718:12759)
 w(174503:174538) = u(18)*w(12724:12759)
 w(174539:174568) = u(19)*w(12730:12759)
 w(174569:174592) = u(20)*w(12736:12759)
 w(174593:174610) = u(21)*w(12742:12759)
 w(174611:174622) = u(22)*w(12748:12759)
 w(174623:174629) = u(23)*w(2965:2971)
 w(174630:174636) = u(24)*w(2965:2971)
 w(174637:174643) = u(25)*w(2965:2971)
 w(174644:174650) = u(26)*w(2965:2971)
 w(174651:174657) = u(27)*w(2965:2971)
 w(174658:174664) = u(28)*w(2965:2971)
endif
! terms of degree 8
if (8.le.mxd) then
 w(174665:300050) = u(0)*w(49279:174664)
 w(300051:388917) = u(1)*w(85798:174664)
 w(388918:451053) = u(2)*w(112529:174664)
 w(451054:493878) = u(3)*w(131840:174664)
 w(493879:522946) = u(4)*w(145597:174664)
 w(522947:542358) = u(5)*w(155253:174664)
 w(542359:555098) = u(6)*w(161925:174664)
 w(555099:563303) = u(7)*w(166460:174664)
 w(563304:568477) = u(8)*w(169491:174664)
 w(568478:571658) = u(9)*w(171484:174664)
 w(571659:573546) = u(10)*w(172777:174664)
 w(573547:574599) = u(11)*w(173612:174664)
 w(574600:574985) = u(12)*w(48893:49278)
 w(574986:575298) = u(13)*w(48966:49278)
 w(575299:575549) = u(14)*w(49028:49278)
 w(575550:575748) = u(15)*w(49080:49278)
 w(575749:575904) = u(16)*w(49123:49278)
 w(575905:576025) = u(17)*w(49158:49278)
 w(576026:576118) = u(18)*w(49186:49278)
 w(576119:576189) = u(19)*w(49208:49278)
 w(576190:576243) = u(20)*w(49225:49278)
 w(576244:576284) = u(21)*w(49238:49278)
 w(576285:576315) = u(22)*w(49248:49278)
 w(576316:576321) = u(23)*w(12754:12759)
 w(576322:576327) = u(24)*w(12754:12759)
 w(576328:576333) = u(25)*w(12754:12759)
 w(576334:576339) = u(26)*w(12754:12759)
 w(576340:576345) = u(27)*w(12754:12759)
 w(576346:576351) = u(28)*w(12754:12759)
 w(576352:576358) = u(29)*w(2965:2971)
 w(576359:576364) = u(30)*w(2966:2971)
 w(576365:576369) = u(31)*w(2967:2971)
 w(576370:576373) = u(32)*w(2968:2971)
 w(576374:576376) = u(33)*w(2969:2971)
 w(576377:576378) = u(34)*w(2970:2971)
 w(576379) = u(35)*w(2971)
endif
! terms of degree 9
if (9.le.mxd) then
 w(576380:978094) = u(0)*w(174665:576379)
 w(978095:1254423) = u(1)*w(300051:576379)
 w(1254424:1441885) = u(2)*w(388918:576379)
 w(1441886:1567211) = u(3)*w(451054:576379)
 w(1567212:1649712) = u(4)*w(493879:576379)
 w(1649713:1703145) = u(5)*w(522947:576379)
 w(1703146:1737166) = u(6)*w(542359:576379)
 w(1737167:1758447) = u(7)*w(555099:576379)
 w(1758448:1771523) = u(8)*w(563304:576379)
 w(1771524:1779425) = u(9)*w(568478:576379)
 w(1779426:1784146) = u(10)*w(571659:576379)
 w(1784147:1786979) = u(11)*w(573547:576379)
 w(1786980:1787483) = u(12)*w(174161:174664)
 w(1787484:1787915) = u(13)*w(174233:174664)
 w(1787916:1788281) = u(14)*w(174299:174664)
 w(1788282:1788587) = u(15)*w(174359:174664)
 w(1788588:1788839) = u(16)*w(174413:174664)
 w(1788840:1789043) = u(17)*w(174461:174664)
 w(1789044:1789205) = u(18)*w(174503:174664)
 w(1789206:1789331) = u(19)*w(174539:174664)
 w(1789332:1789427) = u(20)*w(174569:174664)
 w(1789428:1789499) = u(21)*w(174593:174664)
 w(1789500:1789553) = u(22)*w(174611:174664)
 w(1789554:1789576) = u(23)*w(49256:49278)
 w(1789577:1789593) = u(24)*w(49262:49278)
 w(1789594:1789605) = u(25)*w(49267:49278)
 w(1789606:1789613) = u(26)*w(49271:49278)
 w(1789614:1789618) = u(27)*w(49274:49278)
 w(1789619:1789621) = u(28)*w(49276:49278)
 w(1789622:1789627) = u(29)*w(12754:12759)
 w(1789628:1789633) = u(30)*w(12754:12759)
 w(1789634:1789639) = u(31)*w(12754:12759)
 w(1789640:1789645) = u(32)*w(12754:12759)
 w(1789646:1789651) = u(33)*w(12754:12759)
 w(1789652:1789657) = u(34)*w(12754:12759)
 w(1789658:1789663) = u(35)*w(12754:12759)
endif
END SUBROUTINE mg52111_prib
