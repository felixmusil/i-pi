SUBROUTINE mg2111_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg2111_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg2111_prib: bad size u'
!! else if (size(w).ne.mg2111_npb(mxd)) then
!!  stop 'mg2111_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 7 3 0 0 0 0 0 0 0
! prib,  dnpb(0:*): 1 7 31 105 300 756 1732 3676 7330 13870
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(8:14) = u(0)*w(1:7)
 w(15:20) = u(1)*w(2:7)
 w(21:25) = u(2)*w(3:7)
 w(26:29) = u(3)*w(4:7)
 w(30:32) = u(4)*w(5:7)
 w(33:34) = u(5)*w(6:7)
 w(35) = u(6)*w(7)
 w(36) = u(7)*w(0)
 w(37) = u(8)*w(0)
 w(38) = u(9)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(39:69) = u(0)*w(8:38)
 w(70:93) = u(1)*w(15:38)
 w(94:111) = u(2)*w(21:38)
 w(112:124) = u(3)*w(26:38)
 w(125:133) = u(4)*w(30:38)
 w(134:139) = u(5)*w(33:38)
 w(140:143) = u(6)*w(35:38)
endif
! terms of degree 4
if (4.le.mxd) then
 w(144:248) = u(0)*w(39:143)
 w(249:322) = u(1)*w(70:143)
 w(323:372) = u(2)*w(94:143)
 w(373:404) = u(3)*w(112:143)
 w(405:423) = u(4)*w(125:143)
 w(424:433) = u(5)*w(134:143)
 w(434:437) = u(6)*w(140:143)
 w(438:440) = u(7)*w(36:38)
 w(441:442) = u(8)*w(37:38)
 w(443) = u(9)*w(38)
endif
! terms of degree 5
if (5.le.mxd) then
 w(444:743) = u(0)*w(144:443)
 w(744:938) = u(1)*w(249:443)
 w(939:1059) = u(2)*w(323:443)
 w(1060:1130) = u(3)*w(373:443)
 w(1131:1169) = u(4)*w(405:443)
 w(1170:1189) = u(5)*w(424:443)
 w(1190:1199) = u(6)*w(434:443)
endif
! terms of degree 6
if (6.le.mxd) then
 w(1200:1955) = u(0)*w(444:1199)
 w(1956:2411) = u(1)*w(744:1199)
 w(2412:2672) = u(2)*w(939:1199)
 w(2673:2812) = u(3)*w(1060:1199)
 w(2813:2881) = u(4)*w(1131:1199)
 w(2882:2911) = u(5)*w(1170:1199)
 w(2912:2921) = u(6)*w(1190:1199)
 w(2922:2927) = u(7)*w(438:443)
 w(2928:2930) = u(8)*w(441:443)
 w(2931) = u(9)*w(443)
endif
! terms of degree 7
if (7.le.mxd) then
 w(2932:4663) = u(0)*w(1200:2931)
 w(4664:5639) = u(1)*w(1956:2931)
 w(5640:6159) = u(2)*w(2412:2931)
 w(6160:6418) = u(3)*w(2673:2931)
 w(6419:6537) = u(4)*w(2813:2931)
 w(6538:6587) = u(5)*w(2882:2931)
 w(6588:6607) = u(6)*w(2912:2931)
endif
! terms of degree 8
if (8.le.mxd) then
 w(6608:10283) = u(0)*w(2932:6607)
 w(10284:12227) = u(1)*w(4664:6607)
 w(12228:13195) = u(2)*w(5640:6607)
 w(13196:13643) = u(3)*w(6160:6607)
 w(13644:13832) = u(4)*w(6419:6607)
 w(13833:13902) = u(5)*w(6538:6607)
 w(13903:13922) = u(6)*w(6588:6607)
 w(13923:13932) = u(7)*w(2922:2931)
 w(13933:13936) = u(8)*w(2928:2931)
 w(13937) = u(9)*w(2931)
endif
! terms of degree 9
if (9.le.mxd) then
 w(13938:21267) = u(0)*w(6608:13937)
 w(21268:24921) = u(1)*w(10284:13937)
 w(24922:26631) = u(2)*w(12228:13937)
 w(26632:27373) = u(3)*w(13196:13937)
 w(27374:27667) = u(4)*w(13644:13937)
 w(27668:27772) = u(5)*w(13833:13937)
 w(27773:27807) = u(6)*w(13903:13937)
endif
END SUBROUTINE mg2111_prib
