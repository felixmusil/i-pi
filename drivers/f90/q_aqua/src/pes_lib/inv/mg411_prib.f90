SUBROUTINE mg411_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg411_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg411_prib: bad size u'
!! else if (size(w).ne.mg411_npb(mxd)) then
!!  stop 'mg411_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 4 4 4 3 0 0 0 0 0
! prib,  dnpb(0:*): 1 4 14 40 104 244 540 1124 2239 4276
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(5:8) = u(0)*w(1:4)
 w(9:11) = u(1)*w(2:4)
 w(12:13) = u(2)*w(3:4)
 w(14) = u(3)*w(4)
 w(15) = u(4)*w(0)
 w(16) = u(5)*w(0)
 w(17) = u(6)*w(0)
 w(18) = u(7)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(19:32) = u(0)*w(5:18)
 w(33:42) = u(1)*w(9:18)
 w(43:49) = u(2)*w(12:18)
 w(50:54) = u(3)*w(14:18)
 w(55) = u(8)*w(0)
 w(56) = u(9)*w(0)
 w(57) = u(10)*w(0)
 w(58) = u(11)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(59:98) = u(0)*w(19:58)
 w(99:124) = u(1)*w(33:58)
 w(125:140) = u(2)*w(43:58)
 w(141:149) = u(3)*w(50:58)
 w(150:153) = u(4)*w(15:18)
 w(154:156) = u(5)*w(16:18)
 w(157:158) = u(6)*w(17:18)
 w(159) = u(7)*w(18)
 w(160) = u(12)*w(0)
 w(161) = u(13)*w(0)
 w(162) = u(14)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(163:266) = u(0)*w(59:162)
 w(267:330) = u(1)*w(99:162)
 w(331:368) = u(2)*w(125:162)
 w(369:390) = u(3)*w(141:162)
 w(391:394) = u(4)*w(55:58)
 w(395:398) = u(5)*w(55:58)
 w(399:402) = u(6)*w(55:58)
 w(403:406) = u(7)*w(55:58)
endif
! terms of degree 6
if (6.le.mxd) then
 w(407:650) = u(0)*w(163:406)
 w(651:790) = u(1)*w(267:406)
 w(791:866) = u(2)*w(331:406)
 w(867:904) = u(3)*w(369:406)
 w(905:917) = u(4)*w(150:162)
 w(918:926) = u(5)*w(154:162)
 w(927:932) = u(6)*w(157:162)
 w(933:936) = u(7)*w(159:162)
 w(937:940) = u(8)*w(55:58)
 w(941:943) = u(9)*w(56:58)
 w(944:945) = u(10)*w(57:58)
 w(946) = u(11)*w(58)
endif
! terms of degree 7
if (7.le.mxd) then
 w(947:1486) = u(0)*w(407:946)
 w(1487:1782) = u(1)*w(651:946)
 w(1783:1938) = u(2)*w(791:946)
 w(1939:2018) = u(3)*w(867:946)
 w(2019:2034) = u(4)*w(391:406)
 w(2035:2046) = u(5)*w(395:406)
 w(2047:2054) = u(6)*w(399:406)
 w(2055:2058) = u(7)*w(403:406)
 w(2059:2061) = u(8)*w(160:162)
 w(2062:2064) = u(9)*w(160:162)
 w(2065:2067) = u(10)*w(160:162)
 w(2068:2070) = u(11)*w(160:162)
endif
! terms of degree 8
if (8.le.mxd) then
 w(2071:3194) = u(0)*w(947:2070)
 w(3195:3778) = u(1)*w(1487:2070)
 w(3779:4066) = u(2)*w(1783:2070)
 w(4067:4198) = u(3)*w(1939:2070)
 w(4199:4240) = u(4)*w(905:946)
 w(4241:4269) = u(5)*w(918:946)
 w(4270:4289) = u(6)*w(927:946)
 w(4290:4303) = u(7)*w(933:946)
 w(4304:4306) = u(12)*w(160:162)
 w(4307:4308) = u(13)*w(161:162)
 w(4309) = u(14)*w(162)
endif
! terms of degree 9
if (9.le.mxd) then
 w(4310:6548) = u(0)*w(2071:4309)
 w(6549:7663) = u(1)*w(3195:4309)
 w(7664:8194) = u(2)*w(3779:4309)
 w(8195:8437) = u(3)*w(4067:4309)
 w(8438:8489) = u(4)*w(2019:2070)
 w(8490:8525) = u(5)*w(2035:2070)
 w(8526:8549) = u(6)*w(2047:2070)
 w(8550:8565) = u(7)*w(2055:2070)
 w(8566:8575) = u(8)*w(937:946)
 w(8576:8581) = u(9)*w(941:946)
 w(8582:8584) = u(10)*w(944:946)
 w(8585) = u(11)*w(946)
endif
END SUBROUTINE mg411_prib
