SUBROUTINE mg61_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg61_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg61_prib: bad size u'
!! else if (size(w).ne.mg61_npb(mxd)) then
!!  stop 'mg61_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 2 3 5 4 4 3 0 0 0
! prib,  dnpb(0:*): 1 2 6 15 34 72 150 290 553 1016
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(3:4) = u(0)*w(1:2)
 w(5) = u(1)*w(2)
 w(6) = u(2)*w(0)
 w(7) = u(3)*w(0)
 w(8) = u(4)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(9:14) = u(0)*w(3:8)
 w(15:18) = u(1)*w(5:8)
 w(19) = u(5)*w(0)
 w(20) = u(6)*w(0)
 w(21) = u(7)*w(0)
 w(22) = u(8)*w(0)
 w(23) = u(9)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(24:38) = u(0)*w(9:23)
 w(39:47) = u(1)*w(15:23)
 w(48:50) = u(2)*w(6:8)
 w(51:52) = u(3)*w(7:8)
 w(53) = u(4)*w(8)
 w(54) = u(10)*w(0)
 w(55) = u(11)*w(0)
 w(56) = u(12)*w(0)
 w(57) = u(13)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(58:91) = u(0)*w(24:57)
 w(92:110) = u(1)*w(39:57)
 w(111:115) = u(2)*w(19:23)
 w(116:120) = u(3)*w(19:23)
 w(121:125) = u(4)*w(19:23)
 w(126) = u(14)*w(0)
 w(127) = u(15)*w(0)
 w(128) = u(16)*w(0)
 w(129) = u(17)*w(0)
endif
! terms of degree 6
if (6.le.mxd) then
 w(130:201) = u(0)*w(58:129)
 w(202:239) = u(1)*w(92:129)
 w(240:249) = u(2)*w(48:57)
 w(250:256) = u(3)*w(51:57)
 w(257:261) = u(4)*w(53:57)
 w(262:266) = u(5)*w(19:23)
 w(267:270) = u(6)*w(20:23)
 w(271:273) = u(7)*w(21:23)
 w(274:275) = u(8)*w(22:23)
 w(276) = u(9)*w(23)
 w(277) = u(18)*w(0)
 w(278) = u(19)*w(0)
 w(279) = u(20)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(280:429) = u(0)*w(130:279)
 w(430:507) = u(1)*w(202:279)
 w(508:526) = u(2)*w(111:129)
 w(527:540) = u(3)*w(116:129)
 w(541:549) = u(4)*w(121:129)
 w(550:553) = u(5)*w(54:57)
 w(554:557) = u(6)*w(54:57)
 w(558:561) = u(7)*w(54:57)
 w(562:565) = u(8)*w(54:57)
 w(566:569) = u(9)*w(54:57)
endif
! terms of degree 8
if (8.le.mxd) then
 w(570:859) = u(0)*w(280:569)
 w(860:999) = u(1)*w(430:569)
 w(1000:1039) = u(2)*w(240:279)
 w(1040:1069) = u(3)*w(250:279)
 w(1070:1092) = u(4)*w(257:279)
 w(1093:1096) = u(5)*w(126:129)
 w(1097:1100) = u(6)*w(126:129)
 w(1101:1104) = u(7)*w(126:129)
 w(1105:1108) = u(8)*w(126:129)
 w(1109:1112) = u(9)*w(126:129)
 w(1113:1116) = u(10)*w(54:57)
 w(1117:1119) = u(11)*w(55:57)
 w(1120:1121) = u(12)*w(56:57)
 w(1122) = u(13)*w(57)
endif
! terms of degree 9
if (9.le.mxd) then
 w(1123:1675) = u(0)*w(570:1122)
 w(1676:1938) = u(1)*w(860:1122)
 w(1939:2000) = u(2)*w(508:569)
 w(2001:2043) = u(3)*w(527:569)
 w(2044:2072) = u(4)*w(541:569)
 w(2073:2090) = u(5)*w(262:279)
 w(2091:2103) = u(6)*w(267:279)
 w(2104:2112) = u(7)*w(271:279)
 w(2113:2118) = u(8)*w(274:279)
 w(2119:2122) = u(9)*w(276:279)
 w(2123:2126) = u(10)*w(126:129)
 w(2127:2130) = u(11)*w(126:129)
 w(2131:2134) = u(12)*w(126:129)
 w(2135:2138) = u(13)*w(126:129)
endif
END SUBROUTINE mg61_prib
