SUBROUTINE cxv_bx (nki, nkj, pc, r, w)
integer, intent (in) :: nki(0:), nkj(0:)
type (cx_t), intent (in) :: pc
real (kind=wp), intent (in) :: r(0:,0:)
real (kind=wp), intent (out) :: w(0:,0:)
!-----------------------------------------------------------------------
integer :: ikv(0:size(nkj)-1), len
if (size(nki).lt.size(nkj)) then
 stop 'cxv_bx: bad dimension nki, nkj'
else if (size(r,1).ne.sum(nki).or.size(r,2).ne.sum(nki)) then
 stop 'cxv_bx: bad dimension nki, r'
else if (size(w,1).ne.sum(nki)) then
 stop 'cxv_bx: bad dimension w (1)'
!! else if (size(w,2).ne....) then
!!  stop 'cxv_bx: bad dimension w (2)'
endif
w = 0
if (any(nki(0:size(nkj)-1).lt.nkj)) then
 return
else if (2.le.sum(nkj).and.pc%dg.lt.0) then
 return
endif
ikv = cx_sort(nkj)
len = count(nkj.ne.0)
select case (mgx_id(nkj))
case (0)
case (1)
 call cxv_b1 (nki, ikv(0:len-1), w)
case (mg2_id)
 call cxv_b2 (nki, ikv(0:len-1), pc, r, w)
case (mg11_id)
 call cxv_b11 (nki, ikv(0:len-1), pc, r, w)
case (mg3_id)
 call cxv_b3 (nki, ikv(0:len-1), pc, r, w)
case (mg21_id)
 call cxv_b21 (nki, ikv(0:len-1), pc, r, w)
case (mg111_id)
 call cxv_b111 (nki, ikv(0:len-1), pc, r, w)
case (mg4_id)
 call cxv_b4 (nki, ikv(0:len-1), pc, r, w)
case (mg31_id)
 call cxv_b31 (nki, ikv(0:len-1), pc, r, w)
case (mg22_id)
 call cxv_b22 (nki, ikv(0:len-1), pc, r, w)
case (mg211_id)
 call cxv_b211 (nki, ikv(0:len-1), pc, r, w)
case (mg1111_id)
 call cxv_b1111 (nki, ikv(0:len-1), pc, r, w)
case (mg5_id)
 call cxv_b5 (nki, ikv(0:len-1), pc, r, w)
case (mg41_id)
 call cxv_b41 (nki, ikv(0:len-1), pc, r, w)
case (mg32_id)
 call cxv_b32 (nki, ikv(0:len-1), pc, r, w)
case (mg311_id)
 call cxv_b311 (nki, ikv(0:len-1), pc, r, w)
case (mg221_id)
 call cxv_b221 (nki, ikv(0:len-1), pc, r, w)
case (mg2111_id)
 call cxv_b2111 (nki, ikv(0:len-1), pc, r, w)
case (mg11111_id)
 call cxv_b11111 (nki, ikv(0:len-1), pc, r, w)
case (mg6_id)
 call cxv_b6 (nki, ikv(0:len-1), pc, r, w)
case (mg51_id)
 call cxv_b51 (nki, ikv(0:len-1), pc, r, w)
case (mg42_id)
 call cxv_b42 (nki, ikv(0:len-1), pc, r, w)
case (mg33_id)
 call cxv_b33 (nki, ikv(0:len-1), pc, r, w)
case (mg411_id)
 call cxv_b411 (nki, ikv(0:len-1), pc, r, w)
case (mg321_id)
 call cxv_b321 (nki, ikv(0:len-1), pc, r, w)
case (mg222_id)
 call cxv_b222 (nki, ikv(0:len-1), pc, r, w)
case (mg3111_id)
 call cxv_b3111 (nki, ikv(0:len-1), pc, r, w)
case (mg2211_id)
 call cxv_b2211 (nki, ikv(0:len-1), pc, r, w)
case (mg21111_id)
 call cxv_b21111 (nki, ikv(0:len-1), pc, r, w)
case (mg111111_id)
 call cxv_b111111 (nki, ikv(0:len-1), pc, r, w)
case (mg7_id)
 call cxv_b7 (nki, ikv(0:len-1), pc, r, w)
case (mg61_id)
 call cxv_b61 (nki, ikv(0:len-1), pc, r, w)
case (mg52_id)
 call cxv_b52 (nki, ikv(0:len-1), pc, r, w)
case (mg43_id)
 call cxv_b43 (nki, ikv(0:len-1), pc, r, w)
case (mg511_id)
 call cxv_b511 (nki, ikv(0:len-1), pc, r, w)
case (mg421_id)
 call cxv_b421 (nki, ikv(0:len-1), pc, r, w)
case (mg331_id)
 call cxv_b331 (nki, ikv(0:len-1), pc, r, w)
case (mg322_id)
 call cxv_b322 (nki, ikv(0:len-1), pc, r, w)
case (mg4111_id)
 call cxv_b4111 (nki, ikv(0:len-1), pc, r, w)
case (mg3211_id)
 call cxv_b3211 (nki, ikv(0:len-1), pc, r, w)
case (mg2221_id)
 call cxv_b2221 (nki, ikv(0:len-1), pc, r, w)
case (mg31111_id)
 call cxv_b31111 (nki, ikv(0:len-1), pc, r, w)
case (mg22111_id)
 call cxv_b22111 (nki, ikv(0:len-1), pc, r, w)
case (mg211111_id)
 call cxv_b211111 (nki, ikv(0:len-1), pc, r, w)
case (mg1111111_id)
 call cxv_b1111111 (nki, ikv(0:len-1), pc, r, w)
!! case (mg8_id)
!!  call cxv_b8 (nki, ikv(0:len-1), pc, r, w)
case (mg71_id)
 call cxv_b71 (nki, ikv(0:len-1), pc, r, w)
case (mg62_id)
 call cxv_b62 (nki, ikv(0:len-1), pc, r, w)
case (mg53_id)
 call cxv_b53 (nki, ikv(0:len-1), pc, r, w)
case (mg44_id)
 call cxv_b44 (nki, ikv(0:len-1), pc, r, w)
case (mg611_id)
 call cxv_b611 (nki, ikv(0:len-1), pc, r, w)
case (mg521_id)
 call cxv_b521 (nki, ikv(0:len-1), pc, r, w)
case (mg431_id)
 call cxv_b431 (nki, ikv(0:len-1), pc, r, w)
case (mg422_id)
 call cxv_b422 (nki, ikv(0:len-1), pc, r, w)
case (mg332_id)
 call cxv_b332 (nki, ikv(0:len-1), pc, r, w)
case (mg5111_id)
 call cxv_b5111 (nki, ikv(0:len-1), pc, r, w)
case (mg4211_id)
 call cxv_b4211 (nki, ikv(0:len-1), pc, r, w)
case (mg3311_id)
 call cxv_b3311 (nki, ikv(0:len-1), pc, r, w)
case (mg3221_id)
 call cxv_b3221 (nki, ikv(0:len-1), pc, r, w)
case (mg2222_id)
 call cxv_b2222 (nki, ikv(0:len-1), pc, r, w)
case (mg41111_id)
 call cxv_b41111 (nki, ikv(0:len-1), pc, r, w)
case (mg32111_id)
 call cxv_b32111 (nki, ikv(0:len-1), pc, r, w)
case (mg22211_id)
 call cxv_b22211 (nki, ikv(0:len-1), pc, r, w)
case (mg311111_id)
 call cxv_b311111 (nki, ikv(0:len-1), pc, r, w)
case (mg221111_id)
 call cxv_b221111 (nki, ikv(0:len-1), pc, r, w)
case (mg2111111_id)
 call cxv_b2111111 (nki, ikv(0:len-1), pc, r, w)
case (mg11111111_id)
 call cxv_b11111111 (nki, ikv(0:len-1), pc, r, w)
!! case (mg9_id)
!!  call cxv_b9 (nki, ikv(0:len-1), pc, r, w)
!! case (mg81_id)
!!  call cxv_b81 (nki, ikv(0:len-1), pc, r, w)
case (mg72_id)
 call cxv_b72 (nki, ikv(0:len-1), pc, r, w)
case (mg63_id)
 call cxv_b63 (nki, ikv(0:len-1), pc, r, w)
case (mg54_id)
 call cxv_b54 (nki, ikv(0:len-1), pc, r, w)
case (mg711_id)
 call cxv_b711 (nki, ikv(0:len-1), pc, r, w)
case (mg621_id)
 call cxv_b621 (nki, ikv(0:len-1), pc, r, w)
case (mg531_id)
 call cxv_b531 (nki, ikv(0:len-1), pc, r, w)
case (mg441_id)
 call cxv_b441 (nki, ikv(0:len-1), pc, r, w)
case (mg522_id)
 call cxv_b522 (nki, ikv(0:len-1), pc, r, w)
case (mg432_id)
 call cxv_b432 (nki, ikv(0:len-1), pc, r, w)
case (mg333_id)
 call cxv_b333 (nki, ikv(0:len-1), pc, r, w)
case (mg6111_id)
 call cxv_b6111 (nki, ikv(0:len-1), pc, r, w)
case (mg5211_id)
 call cxv_b5211 (nki, ikv(0:len-1), pc, r, w)
case (mg4311_id)
 call cxv_b4311 (nki, ikv(0:len-1), pc, r, w)
case (mg4221_id)
 call cxv_b4221 (nki, ikv(0:len-1), pc, r, w)
case (mg3321_id)
 call cxv_b3321 (nki, ikv(0:len-1), pc, r, w)
case (mg3222_id)
 call cxv_b3222 (nki, ikv(0:len-1), pc, r, w)
case (mg51111_id)
 call cxv_b51111 (nki, ikv(0:len-1), pc, r, w)
case (mg42111_id)
 call cxv_b42111 (nki, ikv(0:len-1), pc, r, w)
case (mg33111_id)
 call cxv_b33111 (nki, ikv(0:len-1), pc, r, w)
case (mg32211_id)
 call cxv_b32211 (nki, ikv(0:len-1), pc, r, w)
case (mg22221_id)
 call cxv_b22221 (nki, ikv(0:len-1), pc, r, w)
case (mg411111_id)
 call cxv_b411111 (nki, ikv(0:len-1), pc, r, w)
case (mg321111_id)
 call cxv_b321111 (nki, ikv(0:len-1), pc, r, w)
case (mg222111_id)
 call cxv_b222111 (nki, ikv(0:len-1), pc, r, w)
case (mg3111111_id)
 call cxv_b3111111 (nki, ikv(0:len-1), pc, r, w)
case (mg2211111_id)
 call cxv_b2211111 (nki, ikv(0:len-1), pc, r, w)
case (mg21111111_id)
 call cxv_b21111111 (nki, ikv(0:len-1), pc, r, w)
case (mg111111111_id)
 call cxv_b111111111 (nki, ikv(0:len-1), pc, r, w)
case (mg73_id)
 call cxv_b73 (nki, ikv(0:len-1), pc, r, w)
case (mg721_id)
 call cxv_b721 (nki, ikv(0:len-1), pc, r, w)
case (mg631_id)
 call cxv_b631 (nki, ikv(0:len-1), pc, r, w)
case (mg541_id)
 call cxv_b541 (nki, ikv(0:len-1), pc, r, w)
case (mg622_id)
 call cxv_b622 (nki, ikv(0:len-1), pc, r, w)
case (mg532_id)
 call cxv_b532 (nki, ikv(0:len-1), pc, r, w)
case (mg442_id)
 call cxv_b442 (nki, ikv(0:len-1), pc, r, w)
case (mg433_id)
 call cxv_b433 (nki, ikv(0:len-1), pc, r, w)
case (mg7111_id)
 call cxv_b7111 (nki, ikv(0:len-1), pc, r, w)
case (mg6211_id)
 call cxv_b6211 (nki, ikv(0:len-1), pc, r, w)
case (mg5311_id)
 call cxv_b5311 (nki, ikv(0:len-1), pc, r, w)
case (mg4411_id)
 call cxv_b4411 (nki, ikv(0:len-1), pc, r, w)
case (mg5221_id)
 call cxv_b5221 (nki, ikv(0:len-1), pc, r, w)
case (mg4321_id)
 call cxv_b4321 (nki, ikv(0:len-1), pc, r, w)
case (mg3331_id)
 call cxv_b3331 (nki, ikv(0:len-1), pc, r, w)
case (mg4222_id)
 call cxv_b4222 (nki, ikv(0:len-1), pc, r, w)
case (mg3322_id)
 call cxv_b3322 (nki, ikv(0:len-1), pc, r, w)
case (mg61111_id)
 call cxv_b61111 (nki, ikv(0:len-1), pc, r, w)
case (mg52111_id)
 call cxv_b52111 (nki, ikv(0:len-1), pc, r, w)
case (mg43111_id)
 call cxv_b43111 (nki, ikv(0:len-1), pc, r, w)
case (mg42211_id)
 call cxv_b42211 (nki, ikv(0:len-1), pc, r, w)
case (mg33211_id)
 call cxv_b33211 (nki, ikv(0:len-1), pc, r, w)
case (mg32221_id)
 call cxv_b32221 (nki, ikv(0:len-1), pc, r, w)
case (mg22222_id)
 call cxv_b22222 (nki, ikv(0:len-1), pc, r, w)
case (mg511111_id)
 call cxv_b511111 (nki, ikv(0:len-1), pc, r, w)
case (mg421111_id)
 call cxv_b421111 (nki, ikv(0:len-1), pc, r, w)
case (mg331111_id)
 call cxv_b331111 (nki, ikv(0:len-1), pc, r, w)
case (mg322111_id)
 call cxv_b322111 (nki, ikv(0:len-1), pc, r, w)
case (mg222211_id)
 call cxv_b222211 (nki, ikv(0:len-1), pc, r, w)
case (mg4111111_id)
 call cxv_b4111111 (nki, ikv(0:len-1), pc, r, w)
case (mg3211111_id)
 call cxv_b3211111 (nki, ikv(0:len-1), pc, r, w)
case (mg2221111_id)
 call cxv_b2221111 (nki, ikv(0:len-1), pc, r, w)
case (mg31111111_id)
 call cxv_b31111111 (nki, ikv(0:len-1), pc, r, w)
case (mg22111111_id)
 call cxv_b22111111 (nki, ikv(0:len-1), pc, r, w)
case (mg211111111_id)
 call cxv_b211111111 (nki, ikv(0:len-1), pc, r, w)
case (mg1111111111_id)
 call cxv_b1111111111 (nki, ikv(0:len-1), pc, r, w)
case default
 stop 'cxv_bx: bad nkj'
end select
return
END SUBROUTINE cxv_bx
