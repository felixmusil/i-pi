SUBROUTINE mg4221_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg4221_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg4221_prib: bad size u'
!! else if (size(w).ne.mg4221_npb(mxd)) then
!!  stop 'mg4221_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 9 14 5 6 0 2 0 0 0
! prib,  dnpb(0:*): 1 9 59 296 1281 4891 17044 54897 165851 473648
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(10:18) = u(0)*w(1:9)
 w(19:26) = u(1)*w(2:9)
 w(27:33) = u(2)*w(3:9)
 w(34:39) = u(3)*w(4:9)
 w(40:44) = u(4)*w(5:9)
 w(45:48) = u(5)*w(6:9)
 w(49:51) = u(6)*w(7:9)
 w(52:53) = u(7)*w(8:9)
 w(54) = u(8)*w(9)
 w(55) = u(9)*w(0)
 w(56) = u(10)*w(0)
 w(57) = u(11)*w(0)
 w(58) = u(12)*w(0)
 w(59) = u(13)*w(0)
 w(60) = u(14)*w(0)
 w(61) = u(15)*w(0)
 w(62) = u(16)*w(0)
 w(63) = u(17)*w(0)
 w(64) = u(18)*w(0)
 w(65) = u(19)*w(0)
 w(66) = u(20)*w(0)
 w(67) = u(21)*w(0)
 w(68) = u(22)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(69:127) = u(0)*w(10:68)
 w(128:177) = u(1)*w(19:68)
 w(178:219) = u(2)*w(27:68)
 w(220:254) = u(3)*w(34:68)
 w(255:283) = u(4)*w(40:68)
 w(284:307) = u(5)*w(45:68)
 w(308:327) = u(6)*w(49:68)
 w(328:344) = u(7)*w(52:68)
 w(345:359) = u(8)*w(54:68)
 w(360) = u(23)*w(0)
 w(361) = u(24)*w(0)
 w(362) = u(25)*w(0)
 w(363) = u(26)*w(0)
 w(364) = u(27)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(365:660) = u(0)*w(69:364)
 w(661:897) = u(1)*w(128:364)
 w(898:1084) = u(2)*w(178:364)
 w(1085:1229) = u(3)*w(220:364)
 w(1230:1339) = u(4)*w(255:364)
 w(1340:1420) = u(5)*w(284:364)
 w(1421:1477) = u(6)*w(308:364)
 w(1478:1514) = u(7)*w(328:364)
 w(1515:1534) = u(8)*w(345:364)
 w(1535:1548) = u(9)*w(55:68)
 w(1549:1561) = u(10)*w(56:68)
 w(1562:1573) = u(11)*w(57:68)
 w(1574:1584) = u(12)*w(58:68)
 w(1585:1594) = u(13)*w(59:68)
 w(1595:1603) = u(14)*w(60:68)
 w(1604:1611) = u(15)*w(61:68)
 w(1612:1618) = u(16)*w(62:68)
 w(1619:1624) = u(17)*w(63:68)
 w(1625:1629) = u(18)*w(64:68)
 w(1630:1633) = u(19)*w(65:68)
 w(1634:1636) = u(20)*w(66:68)
 w(1637:1638) = u(21)*w(67:68)
 w(1639) = u(22)*w(68)
 w(1640) = u(28)*w(0)
 w(1641) = u(29)*w(0)
 w(1642) = u(30)*w(0)
 w(1643) = u(31)*w(0)
 w(1644) = u(32)*w(0)
 w(1645) = u(33)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(1646:2926) = u(0)*w(365:1645)
 w(2927:3911) = u(1)*w(661:1645)
 w(3912:4659) = u(2)*w(898:1645)
 w(4660:5220) = u(3)*w(1085:1645)
 w(5221:5636) = u(4)*w(1230:1645)
 w(5637:5942) = u(5)*w(1340:1645)
 w(5943:6167) = u(6)*w(1421:1645)
 w(6168:6335) = u(7)*w(1478:1645)
 w(6336:6466) = u(8)*w(1515:1645)
 w(6467:6471) = u(9)*w(360:364)
 w(6472:6476) = u(10)*w(360:364)
 w(6477:6481) = u(11)*w(360:364)
 w(6482:6486) = u(12)*w(360:364)
 w(6487:6491) = u(13)*w(360:364)
 w(6492:6496) = u(14)*w(360:364)
 w(6497:6501) = u(15)*w(360:364)
 w(6502:6506) = u(16)*w(360:364)
 w(6507:6511) = u(17)*w(360:364)
 w(6512:6516) = u(18)*w(360:364)
 w(6517:6521) = u(19)*w(360:364)
 w(6522:6526) = u(20)*w(360:364)
 w(6527:6531) = u(21)*w(360:364)
 w(6532:6536) = u(22)*w(360:364)
endif
! terms of degree 6
if (6.le.mxd) then
 w(6537:11427) = u(0)*w(1646:6536)
 w(11428:15037) = u(1)*w(2927:6536)
 w(15038:17662) = u(2)*w(3912:6536)
 w(17663:19539) = u(3)*w(4660:6536)
 w(19540:20855) = u(4)*w(5221:6536)
 w(20856:21755) = u(5)*w(5637:6536)
 w(21756:22349) = u(6)*w(5943:6536)
 w(22350:22718) = u(7)*w(6168:6536)
 w(22719:22919) = u(8)*w(6336:6536)
 w(22920:23030) = u(9)*w(1535:1645)
 w(23031:23127) = u(10)*w(1549:1645)
 w(23128:23211) = u(11)*w(1562:1645)
 w(23212:23283) = u(12)*w(1574:1645)
 w(23284:23344) = u(13)*w(1585:1645)
 w(23345:23395) = u(14)*w(1595:1645)
 w(23396:23437) = u(15)*w(1604:1645)
 w(23438:23471) = u(16)*w(1612:1645)
 w(23472:23498) = u(17)*w(1619:1645)
 w(23499:23519) = u(18)*w(1625:1645)
 w(23520:23535) = u(19)*w(1630:1645)
 w(23536:23547) = u(20)*w(1634:1645)
 w(23548:23556) = u(21)*w(1637:1645)
 w(23557:23563) = u(22)*w(1639:1645)
 w(23564:23568) = u(23)*w(360:364)
 w(23569:23572) = u(24)*w(361:364)
 w(23573:23575) = u(25)*w(362:364)
 w(23576:23577) = u(26)*w(363:364)
 w(23578) = u(27)*w(364)
 w(23579) = u(34)*w(0)
 w(23580) = u(35)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(23581:40624) = u(0)*w(6537:23580)
 w(40625:52777) = u(1)*w(11428:23580)
 w(52778:61320) = u(2)*w(15038:23580)
 w(61321:67238) = u(3)*w(17663:23580)
 w(67239:71279) = u(4)*w(19540:23580)
 w(71280:74004) = u(5)*w(20856:23580)
 w(74005:75829) = u(6)*w(21756:23580)
 w(75830:77060) = u(7)*w(22350:23580)
 w(77061:77922) = u(8)*w(22719:23580)
 w(77923:77992) = u(9)*w(6467:6536)
 w(77993:78057) = u(10)*w(6472:6536)
 w(78058:78117) = u(11)*w(6477:6536)
 w(78118:78172) = u(12)*w(6482:6536)
 w(78173:78222) = u(13)*w(6487:6536)
 w(78223:78267) = u(14)*w(6492:6536)
 w(78268:78307) = u(15)*w(6497:6536)
 w(78308:78342) = u(16)*w(6502:6536)
 w(78343:78372) = u(17)*w(6507:6536)
 w(78373:78397) = u(18)*w(6512:6536)
 w(78398:78417) = u(19)*w(6517:6536)
 w(78418:78432) = u(20)*w(6522:6536)
 w(78433:78442) = u(21)*w(6527:6536)
 w(78443:78447) = u(22)*w(6532:6536)
 w(78448:78453) = u(23)*w(1640:1645)
 w(78454:78459) = u(24)*w(1640:1645)
 w(78460:78465) = u(25)*w(1640:1645)
 w(78466:78471) = u(26)*w(1640:1645)
 w(78472:78477) = u(27)*w(1640:1645)
endif
! terms of degree 8
if (8.le.mxd) then
 w(78478:133374) = u(0)*w(23581:78477)
 w(133375:171227) = u(1)*w(40625:78477)
 w(171228:196927) = u(2)*w(52778:78477)
 w(196928:214084) = u(3)*w(61321:78477)
 w(214085:225323) = u(4)*w(67239:78477)
 w(225324:232521) = u(5)*w(71280:78477)
 w(232522:236994) = u(6)*w(74005:78477)
 w(236995:239642) = u(7)*w(75830:78477)
 w(239643:241059) = u(8)*w(77061:78477)
 w(241060:241720) = u(9)*w(22920:23580)
 w(241721:242270) = u(10)*w(23031:23580)
 w(242271:242723) = u(11)*w(23128:23580)
 w(242724:243092) = u(12)*w(23212:23580)
 w(243093:243389) = u(13)*w(23284:23580)
 w(243390:243625) = u(14)*w(23345:23580)
 w(243626:243810) = u(15)*w(23396:23580)
 w(243811:243953) = u(16)*w(23438:23580)
 w(243954:244062) = u(17)*w(23472:23580)
 w(244063:244144) = u(18)*w(23499:23580)
 w(244145:244205) = u(19)*w(23520:23580)
 w(244206:244250) = u(20)*w(23536:23580)
 w(244251:244283) = u(21)*w(23548:23580)
 w(244284:244307) = u(22)*w(23557:23580)
 w(244308:244313) = u(28)*w(1640:1645)
 w(244314:244318) = u(29)*w(1641:1645)
 w(244319:244322) = u(30)*w(1642:1645)
 w(244323:244325) = u(31)*w(1643:1645)
 w(244326:244327) = u(32)*w(1644:1645)
 w(244328) = u(33)*w(1645)
endif
! terms of degree 9
if (9.le.mxd) then
 w(244329:410179) = u(0)*w(78478:244328)
 w(410180:521133) = u(1)*w(133375:244328)
 w(521134:594234) = u(2)*w(171228:244328)
 w(594235:641635) = u(3)*w(196928:244328)
 w(641636:671879) = u(4)*w(214085:244328)
 w(671880:690884) = u(5)*w(225324:244328)
 w(690885:702691) = u(6)*w(232522:244328)
 w(702692:710025) = u(7)*w(236995:244328)
 w(710026:714711) = u(8)*w(239643:244328)
 w(714712:715266) = u(9)*w(77923:78477)
 w(715267:715751) = u(10)*w(77993:78477)
 w(715752:716171) = u(11)*w(78058:78477)
 w(716172:716531) = u(12)*w(78118:78477)
 w(716532:716836) = u(13)*w(78173:78477)
 w(716837:717091) = u(14)*w(78223:78477)
 w(717092:717301) = u(15)*w(78268:78477)
 w(717302:717471) = u(16)*w(78308:78477)
 w(717472:717606) = u(17)*w(78343:78477)
 w(717607:717711) = u(18)*w(78373:78477)
 w(717712:717791) = u(19)*w(78398:78477)
 w(717792:717851) = u(20)*w(78418:78477)
 w(717852:717896) = u(21)*w(78433:78477)
 w(717897:717931) = u(22)*w(78443:78477)
 w(717932:717948) = u(23)*w(23564:23580)
 w(717949:717960) = u(24)*w(23569:23580)
 w(717961:717968) = u(25)*w(23573:23580)
 w(717969:717973) = u(26)*w(23576:23580)
 w(717974:717976) = u(27)*w(23578:23580)
endif
END SUBROUTINE mg4221_prib
