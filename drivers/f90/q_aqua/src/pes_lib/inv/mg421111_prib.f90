SUBROUTINE mg421111_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg421111_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg421111_prib: bad size u'
!! else if (size(w).ne.mg421111_npb(mxd)) then
!!  stop 'mg421111_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 17 13 7 7 0 1 0 0 0
! prib,  dnpb(0:*): 1 17 166 1197 7051 35774 161497 662955 2513371 8902104
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
 w(10) = u(9)*w(0)
 w(11) = u(10)*w(0)
 w(12) = u(11)*w(0)
 w(13) = u(12)*w(0)
 w(14) = u(13)*w(0)
 w(15) = u(14)*w(0)
 w(16) = u(15)*w(0)
 w(17) = u(16)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(18:34) = u(0)*w(1:17)
 w(35:50) = u(1)*w(2:17)
 w(51:65) = u(2)*w(3:17)
 w(66:79) = u(3)*w(4:17)
 w(80:92) = u(4)*w(5:17)
 w(93:104) = u(5)*w(6:17)
 w(105:115) = u(6)*w(7:17)
 w(116:125) = u(7)*w(8:17)
 w(126:134) = u(8)*w(9:17)
 w(135:142) = u(9)*w(10:17)
 w(143:149) = u(10)*w(11:17)
 w(150:155) = u(11)*w(12:17)
 w(156:160) = u(12)*w(13:17)
 w(161:164) = u(13)*w(14:17)
 w(165:167) = u(14)*w(15:17)
 w(168:169) = u(15)*w(16:17)
 w(170) = u(16)*w(17)
 w(171) = u(17)*w(0)
 w(172) = u(18)*w(0)
 w(173) = u(19)*w(0)
 w(174) = u(20)*w(0)
 w(175) = u(21)*w(0)
 w(176) = u(22)*w(0)
 w(177) = u(23)*w(0)
 w(178) = u(24)*w(0)
 w(179) = u(25)*w(0)
 w(180) = u(26)*w(0)
 w(181) = u(27)*w(0)
 w(182) = u(28)*w(0)
 w(183) = u(29)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(184:349) = u(0)*w(18:183)
 w(350:498) = u(1)*w(35:183)
 w(499:631) = u(2)*w(51:183)
 w(632:749) = u(3)*w(66:183)
 w(750:853) = u(4)*w(80:183)
 w(854:944) = u(5)*w(93:183)
 w(945:1023) = u(6)*w(105:183)
 w(1024:1091) = u(7)*w(116:183)
 w(1092:1149) = u(8)*w(126:183)
 w(1150:1198) = u(9)*w(135:183)
 w(1199:1239) = u(10)*w(143:183)
 w(1240:1273) = u(11)*w(150:183)
 w(1274:1301) = u(12)*w(156:183)
 w(1302:1324) = u(13)*w(161:183)
 w(1325:1343) = u(14)*w(165:183)
 w(1344:1359) = u(15)*w(168:183)
 w(1360:1373) = u(16)*w(170:183)
 w(1374) = u(30)*w(0)
 w(1375) = u(31)*w(0)
 w(1376) = u(32)*w(0)
 w(1377) = u(33)*w(0)
 w(1378) = u(34)*w(0)
 w(1379) = u(35)*w(0)
 w(1380) = u(36)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(1381:2577) = u(0)*w(184:1380)
 w(2578:3608) = u(1)*w(350:1380)
 w(3609:4490) = u(2)*w(499:1380)
 w(4491:5239) = u(3)*w(632:1380)
 w(5240:5870) = u(4)*w(750:1380)
 w(5871:6397) = u(5)*w(854:1380)
 w(6398:6833) = u(6)*w(945:1380)
 w(6834:7190) = u(7)*w(1024:1380)
 w(7191:7479) = u(8)*w(1092:1380)
 w(7480:7710) = u(9)*w(1150:1380)
 w(7711:7892) = u(10)*w(1199:1380)
 w(7893:8033) = u(11)*w(1240:1380)
 w(8034:8140) = u(12)*w(1274:1380)
 w(8141:8219) = u(13)*w(1302:1380)
 w(8220:8275) = u(14)*w(1325:1380)
 w(8276:8312) = u(15)*w(1344:1380)
 w(8313:8333) = u(16)*w(1360:1380)
 w(8334:8346) = u(17)*w(171:183)
 w(8347:8358) = u(18)*w(172:183)
 w(8359:8369) = u(19)*w(173:183)
 w(8370:8379) = u(20)*w(174:183)
 w(8380:8388) = u(21)*w(175:183)
 w(8389:8396) = u(22)*w(176:183)
 w(8397:8403) = u(23)*w(177:183)
 w(8404:8409) = u(24)*w(178:183)
 w(8410:8414) = u(25)*w(179:183)
 w(8415:8418) = u(26)*w(180:183)
 w(8419:8421) = u(27)*w(181:183)
 w(8422:8423) = u(28)*w(182:183)
 w(8424) = u(29)*w(183)
 w(8425) = u(37)*w(0)
 w(8426) = u(38)*w(0)
 w(8427) = u(39)*w(0)
 w(8428) = u(40)*w(0)
 w(8429) = u(41)*w(0)
 w(8430) = u(42)*w(0)
 w(8431) = u(43)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(8432:15482) = u(0)*w(1381:8431)
 w(15483:21336) = u(1)*w(2578:8431)
 w(21337:26159) = u(2)*w(3609:8431)
 w(26160:30100) = u(3)*w(4491:8431)
 w(30101:33292) = u(4)*w(5240:8431)
 w(33293:35853) = u(5)*w(5871:8431)
 w(35854:37887) = u(6)*w(6398:8431)
 w(37888:39485) = u(7)*w(6834:8431)
 w(39486:40726) = u(8)*w(7191:8431)
 w(40727:41678) = u(9)*w(7480:8431)
 w(41679:42399) = u(10)*w(7711:8431)
 w(42400:42938) = u(11)*w(7893:8431)
 w(42939:43336) = u(12)*w(8034:8431)
 w(43337:43627) = u(13)*w(8141:8431)
 w(43628:43839) = u(14)*w(8220:8431)
 w(43840:43995) = u(15)*w(8276:8431)
 w(43996:44114) = u(16)*w(8313:8431)
 w(44115:44121) = u(17)*w(1374:1380)
 w(44122:44128) = u(18)*w(1374:1380)
 w(44129:44135) = u(19)*w(1374:1380)
 w(44136:44142) = u(20)*w(1374:1380)
 w(44143:44149) = u(21)*w(1374:1380)
 w(44150:44156) = u(22)*w(1374:1380)
 w(44157:44163) = u(23)*w(1374:1380)
 w(44164:44170) = u(24)*w(1374:1380)
 w(44171:44177) = u(25)*w(1374:1380)
 w(44178:44184) = u(26)*w(1374:1380)
 w(44185:44191) = u(27)*w(1374:1380)
 w(44192:44198) = u(28)*w(1374:1380)
 w(44199:44205) = u(29)*w(1374:1380)
endif
! terms of degree 6
if (6.le.mxd) then
 w(44206:79979) = u(0)*w(8432:44205)
 w(79980:108702) = u(1)*w(15483:44205)
 w(108703:131571) = u(2)*w(21337:44205)
 w(131572:149617) = u(3)*w(26160:44205)
 w(149618:163722) = u(4)*w(30101:44205)
 w(163723:174635) = u(5)*w(33293:44205)
 w(174636:182987) = u(6)*w(35854:44205)
 w(182988:189305) = u(7)*w(37888:44205)
 w(189306:194025) = u(8)*w(39486:44205)
 w(194026:197504) = u(9)*w(40727:44205)
 w(197505:200031) = u(10)*w(41679:44205)
 w(200032:201837) = u(11)*w(42400:44205)
 w(201838:203104) = u(12)*w(42939:44205)
 w(203105:203973) = u(13)*w(43337:44205)
 w(203974:204551) = u(14)*w(43628:44205)
 w(204552:204917) = u(15)*w(43840:44205)
 w(204918:205127) = u(16)*w(43996:44205)
 w(205128:205225) = u(17)*w(8334:8431)
 w(205226:205310) = u(18)*w(8347:8431)
 w(205311:205383) = u(19)*w(8359:8431)
 w(205384:205445) = u(20)*w(8370:8431)
 w(205446:205497) = u(21)*w(8380:8431)
 w(205498:205540) = u(22)*w(8389:8431)
 w(205541:205575) = u(23)*w(8397:8431)
 w(205576:205603) = u(24)*w(8404:8431)
 w(205604:205625) = u(25)*w(8410:8431)
 w(205626:205642) = u(26)*w(8415:8431)
 w(205643:205655) = u(27)*w(8419:8431)
 w(205656:205665) = u(28)*w(8422:8431)
 w(205666:205673) = u(29)*w(8424:8431)
 w(205674:205680) = u(30)*w(1374:1380)
 w(205681:205686) = u(31)*w(1375:1380)
 w(205687:205691) = u(32)*w(1376:1380)
 w(205692:205695) = u(33)*w(1377:1380)
 w(205696:205698) = u(34)*w(1378:1380)
 w(205699:205700) = u(35)*w(1379:1380)
 w(205701) = u(36)*w(1380)
 w(205702) = u(44)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(205703:367199) = u(0)*w(44206:205702)
 w(367200:492922) = u(1)*w(79980:205702)
 w(492923:589922) = u(2)*w(108703:205702)
 w(589923:664053) = u(3)*w(131572:205702)
 w(664054:720138) = u(4)*w(149618:205702)
 w(720139:762118) = u(5)*w(163723:205702)
 w(762119:793185) = u(6)*w(174636:205702)
 w(793186:815900) = u(7)*w(182988:205702)
 w(815901:832297) = u(8)*w(189306:205702)
 w(832298:843974) = u(9)*w(194026:205702)
 w(843975:852172) = u(10)*w(197505:205702)
 w(852173:857843) = u(11)*w(200032:205702)
 w(857844:861708) = u(12)*w(201838:205702)
 w(861709:864306) = u(13)*w(203105:205702)
 w(864307:866035) = u(14)*w(203974:205702)
 w(866036:867186) = u(15)*w(204552:205702)
 w(867187:867971) = u(16)*w(204918:205702)
 w(867972:868062) = u(17)*w(44115:44205)
 w(868063:868146) = u(18)*w(44122:44205)
 w(868147:868223) = u(19)*w(44129:44205)
 w(868224:868293) = u(20)*w(44136:44205)
 w(868294:868356) = u(21)*w(44143:44205)
 w(868357:868412) = u(22)*w(44150:44205)
 w(868413:868461) = u(23)*w(44157:44205)
 w(868462:868503) = u(24)*w(44164:44205)
 w(868504:868538) = u(25)*w(44171:44205)
 w(868539:868566) = u(26)*w(44178:44205)
 w(868567:868587) = u(27)*w(44185:44205)
 w(868588:868601) = u(28)*w(44192:44205)
 w(868602:868608) = u(29)*w(44199:44205)
 w(868609:868615) = u(30)*w(8425:8431)
 w(868616:868622) = u(31)*w(8425:8431)
 w(868623:868629) = u(32)*w(8425:8431)
 w(868630:868636) = u(33)*w(8425:8431)
 w(868637:868643) = u(34)*w(8425:8431)
 w(868644:868650) = u(35)*w(8425:8431)
 w(868651:868657) = u(36)*w(8425:8431)
endif
! terms of degree 8
if (8.le.mxd) then
 w(868658:1531612) = u(0)*w(205703:868657)
 w(1531613:2033070) = u(1)*w(367200:868657)
 w(2033071:2408805) = u(2)*w(492923:868657)
 w(2408806:2687540) = u(3)*w(589923:868657)
 w(2687541:2892144) = u(4)*w(664054:868657)
 w(2892145:3040663) = u(5)*w(720139:868657)
 w(3040664:3147202) = u(6)*w(762119:868657)
 w(3147203:3222674) = u(7)*w(793186:868657)
 w(3222675:3275431) = u(8)*w(815901:868657)
 w(3275432:3311791) = u(9)*w(832298:868657)
 w(3311792:3336474) = u(10)*w(843975:868657)
 w(3336475:3352959) = u(11)*w(852173:868657)
 w(3352960:3363773) = u(12)*w(857844:868657)
 w(3363774:3370722) = u(13)*w(861709:868657)
 w(3370723:3375073) = u(14)*w(864307:868657)
 w(3375074:3377695) = u(15)*w(866036:868657)
 w(3377696:3379166) = u(16)*w(867187:868657)
 w(3379167:3379741) = u(17)*w(205128:205702)
 w(3379742:3380218) = u(18)*w(205226:205702)
 w(3380219:3380610) = u(19)*w(205311:205702)
 w(3380611:3380929) = u(20)*w(205384:205702)
 w(3380930:3381186) = u(21)*w(205446:205702)
 w(3381187:3381391) = u(22)*w(205498:205702)
 w(3381392:3381553) = u(23)*w(205541:205702)
 w(3381554:3381680) = u(24)*w(205576:205702)
 w(3381681:3381779) = u(25)*w(205604:205702)
 w(3381780:3381856) = u(26)*w(205626:205702)
 w(3381857:3381916) = u(27)*w(205643:205702)
 w(3381917:3381963) = u(28)*w(205656:205702)
 w(3381964:3382000) = u(29)*w(205666:205702)
 w(3382001:3382007) = u(37)*w(8425:8431)
 w(3382008:3382013) = u(38)*w(8426:8431)
 w(3382014:3382018) = u(39)*w(8427:8431)
 w(3382019:3382022) = u(40)*w(8428:8431)
 w(3382023:3382025) = u(41)*w(8429:8431)
 w(3382026:3382027) = u(42)*w(8430:8431)
 w(3382028) = u(43)*w(8431)
endif
! terms of degree 9
if (9.le.mxd) then
 w(3382029:5895399) = u(0)*w(868658:3382028)
 w(5895400:7745815) = u(1)*w(1531613:3382028)
 w(7745816:9094773) = u(2)*w(2033071:3382028)
 w(9094774:10067996) = u(3)*w(2408806:3382028)
 w(10067997:10762484) = u(4)*w(2687541:3382028)
 w(10762485:11252368) = u(5)*w(2892145:3382028)
 w(11252369:11593733) = u(6)*w(3040664:3382028)
 w(11593734:11828559) = u(7)*w(3147203:3382028)
 w(11828560:11987913) = u(8)*w(3222675:3382028)
 w(11987914:12094510) = u(9)*w(3275432:3382028)
 w(12094511:12164747) = u(10)*w(3311792:3382028)
 w(12164748:12210301) = u(11)*w(3336475:3382028)
 w(12210302:12239370) = u(12)*w(3352960:3382028)
 w(12239371:12257625) = u(13)*w(3363774:3382028)
 w(12257626:12268931) = u(14)*w(3370723:3382028)
 w(12268932:12275886) = u(15)*w(3375074:3382028)
 w(12275887:12280219) = u(16)*w(3377696:3382028)
 w(12280220:12280905) = u(17)*w(867972:868657)
 w(12280906:12281500) = u(18)*w(868063:868657)
 w(12281501:12282011) = u(19)*w(868147:868657)
 w(12282012:12282445) = u(20)*w(868224:868657)
 w(12282446:12282809) = u(21)*w(868294:868657)
 w(12282810:12283110) = u(22)*w(868357:868657)
 w(12283111:12283355) = u(23)*w(868413:868657)
 w(12283356:12283551) = u(24)*w(868462:868657)
 w(12283552:12283705) = u(25)*w(868504:868657)
 w(12283706:12283824) = u(26)*w(868539:868657)
 w(12283825:12283915) = u(27)*w(868567:868657)
 w(12283916:12283985) = u(28)*w(868588:868657)
 w(12283986:12284041) = u(29)*w(868602:868657)
 w(12284042:12284070) = u(30)*w(205674:205702)
 w(12284071:12284092) = u(31)*w(205681:205702)
 w(12284093:12284108) = u(32)*w(205687:205702)
 w(12284109:12284119) = u(33)*w(205692:205702)
 w(12284120:12284126) = u(34)*w(205696:205702)
 w(12284127:12284130) = u(35)*w(205699:205702)
 w(12284131:12284132) = u(36)*w(205701:205702)
endif
END SUBROUTINE mg421111_prib
