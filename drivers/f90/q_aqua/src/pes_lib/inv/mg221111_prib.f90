SUBROUTINE mg221111_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg221111_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg221111_prib: bad size u'
!! else if (size(w).ne.mg221111_npb(mxd)) then
!!  stop 'mg221111_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 17 11 0 0 0 0 0 0 0
! prib,  dnpb(0:*): 1 17 164 1156 6594 32130 138292 537812 1920743 6376887
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
 w(10) = u(9)*w(0)
 w(11) = u(10)*w(0)
 w(12) = u(11)*w(0)
 w(13) = u(12)*w(0)
 w(14) = u(13)*w(0)
 w(15) = u(14)*w(0)
 w(16) = u(15)*w(0)
 w(17) = u(16)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(18:34) = u(0)*w(1:17)
 w(35:50) = u(1)*w(2:17)
 w(51:65) = u(2)*w(3:17)
 w(66:79) = u(3)*w(4:17)
 w(80:92) = u(4)*w(5:17)
 w(93:104) = u(5)*w(6:17)
 w(105:115) = u(6)*w(7:17)
 w(116:125) = u(7)*w(8:17)
 w(126:134) = u(8)*w(9:17)
 w(135:142) = u(9)*w(10:17)
 w(143:149) = u(10)*w(11:17)
 w(150:155) = u(11)*w(12:17)
 w(156:160) = u(12)*w(13:17)
 w(161:164) = u(13)*w(14:17)
 w(165:167) = u(14)*w(15:17)
 w(168:169) = u(15)*w(16:17)
 w(170) = u(16)*w(17)
 w(171) = u(17)*w(0)
 w(172) = u(18)*w(0)
 w(173) = u(19)*w(0)
 w(174) = u(20)*w(0)
 w(175) = u(21)*w(0)
 w(176) = u(22)*w(0)
 w(177) = u(23)*w(0)
 w(178) = u(24)*w(0)
 w(179) = u(25)*w(0)
 w(180) = u(26)*w(0)
 w(181) = u(27)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(182:345) = u(0)*w(18:181)
 w(346:492) = u(1)*w(35:181)
 w(493:623) = u(2)*w(51:181)
 w(624:739) = u(3)*w(66:181)
 w(740:841) = u(4)*w(80:181)
 w(842:930) = u(5)*w(93:181)
 w(931:1007) = u(6)*w(105:181)
 w(1008:1073) = u(7)*w(116:181)
 w(1074:1129) = u(8)*w(126:181)
 w(1130:1176) = u(9)*w(135:181)
 w(1177:1215) = u(10)*w(143:181)
 w(1216:1247) = u(11)*w(150:181)
 w(1248:1273) = u(12)*w(156:181)
 w(1274:1294) = u(13)*w(161:181)
 w(1295:1311) = u(14)*w(165:181)
 w(1312:1325) = u(15)*w(168:181)
 w(1326:1337) = u(16)*w(170:181)
endif
! terms of degree 4
if (4.le.mxd) then
 w(1338:2493) = u(0)*w(182:1337)
 w(2494:3485) = u(1)*w(346:1337)
 w(3486:4330) = u(2)*w(493:1337)
 w(4331:5044) = u(3)*w(624:1337)
 w(5045:5642) = u(4)*w(740:1337)
 w(5643:6138) = u(5)*w(842:1337)
 w(6139:6545) = u(6)*w(931:1337)
 w(6546:6875) = u(7)*w(1008:1337)
 w(6876:7139) = u(8)*w(1074:1337)
 w(7140:7347) = u(9)*w(1130:1337)
 w(7348:7508) = u(10)*w(1177:1337)
 w(7509:7630) = u(11)*w(1216:1337)
 w(7631:7720) = u(12)*w(1248:1337)
 w(7721:7784) = u(13)*w(1274:1337)
 w(7785:7827) = u(14)*w(1295:1337)
 w(7828:7853) = u(15)*w(1312:1337)
 w(7854:7865) = u(16)*w(1326:1337)
 w(7866:7876) = u(17)*w(171:181)
 w(7877:7886) = u(18)*w(172:181)
 w(7887:7895) = u(19)*w(173:181)
 w(7896:7903) = u(20)*w(174:181)
 w(7904:7910) = u(21)*w(175:181)
 w(7911:7916) = u(22)*w(176:181)
 w(7917:7921) = u(23)*w(177:181)
 w(7922:7925) = u(24)*w(178:181)
 w(7926:7928) = u(25)*w(179:181)
 w(7929:7930) = u(26)*w(180:181)
 w(7931) = u(27)*w(181)
endif
! terms of degree 5
if (5.le.mxd) then
 w(7932:14525) = u(0)*w(1338:7931)
 w(14526:19963) = u(1)*w(2494:7931)
 w(19964:24409) = u(2)*w(3486:7931)
 w(24410:28010) = u(3)*w(4331:7931)
 w(28011:30897) = u(4)*w(5045:7931)
 w(30898:33186) = u(5)*w(5643:7931)
 w(33187:34979) = u(6)*w(6139:7931)
 w(34980:36365) = u(7)*w(6546:7931)
 w(36366:37421) = u(8)*w(6876:7931)
 w(37422:38213) = u(9)*w(7140:7931)
 w(38214:38797) = u(10)*w(7348:7931)
 w(38798:39220) = u(11)*w(7509:7931)
 w(39221:39521) = u(12)*w(7631:7931)
 w(39522:39732) = u(13)*w(7721:7931)
 w(39733:39879) = u(14)*w(7785:7931)
 w(39880:39983) = u(15)*w(7828:7931)
 w(39984:40061) = u(16)*w(7854:7931)
endif
! terms of degree 6
if (6.le.mxd) then
 w(40062:72191) = u(0)*w(7932:40061)
 w(72192:97727) = u(1)*w(14526:40061)
 w(97728:117825) = u(2)*w(19964:40061)
 w(117826:133477) = u(3)*w(24410:40061)
 w(133478:145528) = u(4)*w(28011:40061)
 w(145529:154692) = u(5)*w(30898:40061)
 w(154693:161567) = u(6)*w(33187:40061)
 w(161568:166649) = u(7)*w(34980:40061)
 w(166650:170345) = u(8)*w(36366:40061)
 w(170346:172985) = u(9)*w(37422:40061)
 w(172986:174833) = u(10)*w(38214:40061)
 w(174834:176097) = u(11)*w(38798:40061)
 w(176098:176938) = u(12)*w(39221:40061)
 w(176939:177478) = u(13)*w(39522:40061)
 w(177479:177807) = u(14)*w(39733:40061)
 w(177808:177989) = u(15)*w(39880:40061)
 w(177990:178067) = u(16)*w(39984:40061)
 w(178068:178133) = u(17)*w(7866:7931)
 w(178134:178188) = u(18)*w(7877:7931)
 w(178189:178233) = u(19)*w(7887:7931)
 w(178234:178269) = u(20)*w(7896:7931)
 w(178270:178297) = u(21)*w(7904:7931)
 w(178298:178318) = u(22)*w(7911:7931)
 w(178319:178333) = u(23)*w(7917:7931)
 w(178334:178343) = u(24)*w(7922:7931)
 w(178344:178349) = u(25)*w(7926:7931)
 w(178350:178352) = u(26)*w(7929:7931)
 w(178353) = u(27)*w(7931)
endif
! terms of degree 7
if (7.le.mxd) then
 w(178354:316645) = u(0)*w(40062:178353)
 w(316646:422807) = u(1)*w(72192:178353)
 w(422808:503433) = u(2)*w(97728:178353)
 w(503434:563961) = u(3)*w(117826:178353)
 w(563962:608837) = u(4)*w(133478:178353)
 w(608838:641662) = u(5)*w(145529:178353)
 w(641663:665323) = u(6)*w(154693:178353)
 w(665324:682109) = u(7)*w(161568:178353)
 w(682110:693813) = u(8)*w(166650:178353)
 w(693814:701821) = u(9)*w(170346:178353)
 w(701822:707189) = u(10)*w(172986:178353)
 w(707190:710709) = u(11)*w(174834:178353)
 w(710710:712965) = u(12)*w(176098:178353)
 w(712966:714380) = u(13)*w(176939:178353)
 w(714381:715255) = u(14)*w(177479:178353)
 w(715256:715801) = u(15)*w(177808:178353)
 w(715802:716165) = u(16)*w(177990:178353)
endif
! terms of degree 8
if (8.le.mxd) then
 w(716166:1253977) = u(0)*w(178354:716165)
 w(1253978:1653497) = u(1)*w(316646:716165)
 w(1653498:1946855) = u(2)*w(422808:716165)
 w(1946856:2159587) = u(3)*w(503434:716165)
 w(2159588:2311791) = u(4)*w(563962:716165)
 w(2311792:2419119) = u(5)*w(608838:716165)
 w(2419120:2493622) = u(6)*w(641663:716165)
 w(2493623:2544464) = u(7)*w(665324:716165)
 w(2544465:2578520) = u(8)*w(682110:716165)
 w(2578521:2600872) = u(9)*w(693814:716165)
 w(2600873:2615216) = u(10)*w(701822:716165)
 w(2615217:2624192) = u(11)*w(707190:716165)
 w(2624193:2629648) = u(12)*w(710710:716165)
 w(2629649:2632848) = u(13)*w(712966:716165)
 w(2632849:2634633) = u(14)*w(714381:716165)
 w(2634634:2635543) = u(15)*w(715256:716165)
 w(2635544:2635907) = u(16)*w(715802:716165)
 w(2635908:2636193) = u(17)*w(178068:178353)
 w(2636194:2636413) = u(18)*w(178134:178353)
 w(2636414:2636578) = u(19)*w(178189:178353)
 w(2636579:2636698) = u(20)*w(178234:178353)
 w(2636699:2636782) = u(21)*w(178270:178353)
 w(2636783:2636838) = u(22)*w(178298:178353)
 w(2636839:2636873) = u(23)*w(178319:178353)
 w(2636874:2636893) = u(24)*w(178334:178353)
 w(2636894:2636903) = u(25)*w(178344:178353)
 w(2636904:2636907) = u(26)*w(178350:178353)
 w(2636908) = u(27)*w(178353)
endif
! terms of degree 9
if (9.le.mxd) then
 w(2636909:4557651) = u(0)*w(716166:2636908)
 w(4557652:5940582) = u(1)*w(1253978:2636908)
 w(5940583:6923993) = u(2)*w(1653498:2636908)
 w(6923994:7614046) = u(3)*w(1946856:2636908)
 w(7614047:8091367) = u(4)*w(2159588:2636908)
 w(8091368:8416484) = u(5)*w(2311792:2636908)
 w(8416485:8634273) = u(6)*w(2419120:2636908)
 w(8634274:8777559) = u(7)*w(2493623:2636908)
 w(8777560:8870003) = u(8)*w(2544465:2636908)
 w(8870004:8928391) = u(9)*w(2578521:2636908)
 w(8928392:8964427) = u(10)*w(2600873:2636908)
 w(8964428:8986119) = u(11)*w(2615217:2636908)
 w(8986120:8998835) = u(12)*w(2624193:2636908)
 w(8998836:9006095) = u(13)*w(2629649:2636908)
 w(9006096:9010155) = u(14)*w(2632849:2636908)
 w(9010156:9012430) = u(15)*w(2634634:2636908)
 w(9012431:9013795) = u(16)*w(2635544:2636908)
endif
END SUBROUTINE mg221111_prib
