SUBROUTINE mg442_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg442_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg442_prib: bad size u'
!! else if (size(w).ne.mg442_npb(mxd)) then
!!  stop 'mg442_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 6 13 11 11 0 3 0 0 0
! prib,  dnpb(0:*): 1 6 34 145 567 1966 6383 19293 55448 151617
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(7:12) = u(0)*w(1:6)
 w(13:17) = u(1)*w(2:6)
 w(18:21) = u(2)*w(3:6)
 w(22:24) = u(3)*w(4:6)
 w(25:26) = u(4)*w(5:6)
 w(27) = u(5)*w(6)
 w(28) = u(6)*w(0)
 w(29) = u(7)*w(0)
 w(30) = u(8)*w(0)
 w(31) = u(9)*w(0)
 w(32) = u(10)*w(0)
 w(33) = u(11)*w(0)
 w(34) = u(12)*w(0)
 w(35) = u(13)*w(0)
 w(36) = u(14)*w(0)
 w(37) = u(15)*w(0)
 w(38) = u(16)*w(0)
 w(39) = u(17)*w(0)
 w(40) = u(18)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(41:74) = u(0)*w(7:40)
 w(75:102) = u(1)*w(13:40)
 w(103:125) = u(2)*w(18:40)
 w(126:144) = u(3)*w(22:40)
 w(145:160) = u(4)*w(25:40)
 w(161:174) = u(5)*w(27:40)
 w(175) = u(19)*w(0)
 w(176) = u(20)*w(0)
 w(177) = u(21)*w(0)
 w(178) = u(22)*w(0)
 w(179) = u(23)*w(0)
 w(180) = u(24)*w(0)
 w(181) = u(25)*w(0)
 w(182) = u(26)*w(0)
 w(183) = u(27)*w(0)
 w(184) = u(28)*w(0)
 w(185) = u(29)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(186:330) = u(0)*w(41:185)
 w(331:441) = u(1)*w(75:185)
 w(442:524) = u(2)*w(103:185)
 w(525:584) = u(3)*w(126:185)
 w(585:625) = u(4)*w(145:185)
 w(626:650) = u(5)*w(161:185)
 w(651:663) = u(6)*w(28:40)
 w(664:675) = u(7)*w(29:40)
 w(676:686) = u(8)*w(30:40)
 w(687:696) = u(9)*w(31:40)
 w(697:705) = u(10)*w(32:40)
 w(706:713) = u(11)*w(33:40)
 w(714:720) = u(12)*w(34:40)
 w(721:726) = u(13)*w(35:40)
 w(727:731) = u(14)*w(36:40)
 w(732:735) = u(15)*w(37:40)
 w(736:738) = u(16)*w(38:40)
 w(739:740) = u(17)*w(39:40)
 w(741) = u(18)*w(40)
 w(742) = u(30)*w(0)
 w(743) = u(31)*w(0)
 w(744) = u(32)*w(0)
 w(745) = u(33)*w(0)
 w(746) = u(34)*w(0)
 w(747) = u(35)*w(0)
 w(748) = u(36)*w(0)
 w(749) = u(37)*w(0)
 w(750) = u(38)*w(0)
 w(751) = u(39)*w(0)
 w(752) = u(40)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(753:1319) = u(0)*w(186:752)
 w(1320:1741) = u(1)*w(331:752)
 w(1742:2052) = u(2)*w(442:752)
 w(2053:2280) = u(3)*w(525:752)
 w(2281:2448) = u(4)*w(585:752)
 w(2449:2575) = u(5)*w(626:752)
 w(2576:2586) = u(6)*w(175:185)
 w(2587:2597) = u(7)*w(175:185)
 w(2598:2608) = u(8)*w(175:185)
 w(2609:2619) = u(9)*w(175:185)
 w(2620:2630) = u(10)*w(175:185)
 w(2631:2641) = u(11)*w(175:185)
 w(2642:2652) = u(12)*w(175:185)
 w(2653:2663) = u(13)*w(175:185)
 w(2664:2674) = u(14)*w(175:185)
 w(2675:2685) = u(15)*w(175:185)
 w(2686:2696) = u(16)*w(175:185)
 w(2697:2707) = u(17)*w(175:185)
 w(2708:2718) = u(18)*w(175:185)
endif
! terms of degree 6
if (6.le.mxd) then
 w(2719:4684) = u(0)*w(753:2718)
 w(4685:6083) = u(1)*w(1320:2718)
 w(6084:7060) = u(2)*w(1742:2718)
 w(7061:7726) = u(3)*w(2053:2718)
 w(7727:8164) = u(4)*w(2281:2718)
 w(8165:8434) = u(5)*w(2449:2718)
 w(8435:8536) = u(6)*w(651:752)
 w(8537:8625) = u(7)*w(664:752)
 w(8626:8702) = u(8)*w(676:752)
 w(8703:8768) = u(9)*w(687:752)
 w(8769:8824) = u(10)*w(697:752)
 w(8825:8871) = u(11)*w(706:752)
 w(8872:8910) = u(12)*w(714:752)
 w(8911:8942) = u(13)*w(721:752)
 w(8943:8968) = u(14)*w(727:752)
 w(8969:8989) = u(15)*w(732:752)
 w(8990:9006) = u(16)*w(736:752)
 w(9007:9020) = u(17)*w(739:752)
 w(9021:9032) = u(18)*w(741:752)
 w(9033:9043) = u(19)*w(175:185)
 w(9044:9053) = u(20)*w(176:185)
 w(9054:9062) = u(21)*w(177:185)
 w(9063:9070) = u(22)*w(178:185)
 w(9071:9077) = u(23)*w(179:185)
 w(9078:9083) = u(24)*w(180:185)
 w(9084:9088) = u(25)*w(181:185)
 w(9089:9092) = u(26)*w(182:185)
 w(9093:9095) = u(27)*w(183:185)
 w(9096:9097) = u(28)*w(184:185)
 w(9098) = u(29)*w(185)
 w(9099) = u(41)*w(0)
 w(9100) = u(42)*w(0)
 w(9101) = u(43)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(9102:15484) = u(0)*w(2719:9101)
 w(15485:19901) = u(1)*w(4685:9101)
 w(19902:22919) = u(2)*w(6084:9101)
 w(22920:24960) = u(3)*w(7061:9101)
 w(24961:26335) = u(4)*w(7727:9101)
 w(26336:27272) = u(5)*w(8165:9101)
 w(27273:27415) = u(6)*w(2576:2718)
 w(27416:27547) = u(7)*w(2587:2718)
 w(27548:27668) = u(8)*w(2598:2718)
 w(27669:27778) = u(9)*w(2609:2718)
 w(27779:27877) = u(10)*w(2620:2718)
 w(27878:27965) = u(11)*w(2631:2718)
 w(27966:28042) = u(12)*w(2642:2718)
 w(28043:28108) = u(13)*w(2653:2718)
 w(28109:28163) = u(14)*w(2664:2718)
 w(28164:28207) = u(15)*w(2675:2718)
 w(28208:28240) = u(16)*w(2686:2718)
 w(28241:28262) = u(17)*w(2697:2718)
 w(28263:28273) = u(18)*w(2708:2718)
 w(28274:28284) = u(19)*w(742:752)
 w(28285:28295) = u(20)*w(742:752)
 w(28296:28306) = u(21)*w(742:752)
 w(28307:28317) = u(22)*w(742:752)
 w(28318:28328) = u(23)*w(742:752)
 w(28329:28339) = u(24)*w(742:752)
 w(28340:28350) = u(25)*w(742:752)
 w(28351:28361) = u(26)*w(742:752)
 w(28362:28372) = u(27)*w(742:752)
 w(28373:28383) = u(28)*w(742:752)
 w(28384:28394) = u(29)*w(742:752)
endif
! terms of degree 8
if (8.le.mxd) then
 w(28395:47687) = u(0)*w(9102:28394)
 w(47688:60597) = u(1)*w(15485:28394)
 w(60598:69090) = u(2)*w(19902:28394)
 w(69091:74565) = u(3)*w(22920:28394)
 w(74566:77999) = u(4)*w(24961:28394)
 w(78000:80058) = u(5)*w(26336:28394)
 w(80059:80725) = u(6)*w(8435:9101)
 w(80726:81290) = u(7)*w(8537:9101)
 w(81291:81766) = u(8)*w(8626:9101)
 w(81767:82165) = u(9)*w(8703:9101)
 w(82166:82498) = u(10)*w(8769:9101)
 w(82499:82775) = u(11)*w(8825:9101)
 w(82776:83005) = u(12)*w(8872:9101)
 w(83006:83196) = u(13)*w(8911:9101)
 w(83197:83355) = u(14)*w(8943:9101)
 w(83356:83488) = u(15)*w(8969:9101)
 w(83489:83600) = u(16)*w(8990:9101)
 w(83601:83695) = u(17)*w(9007:9101)
 w(83696:83776) = u(18)*w(9021:9101)
 w(83777:83787) = u(30)*w(742:752)
 w(83788:83797) = u(31)*w(743:752)
 w(83798:83806) = u(32)*w(744:752)
 w(83807:83814) = u(33)*w(745:752)
 w(83815:83821) = u(34)*w(746:752)
 w(83822:83827) = u(35)*w(747:752)
 w(83828:83832) = u(36)*w(748:752)
 w(83833:83836) = u(37)*w(749:752)
 w(83837:83839) = u(38)*w(750:752)
 w(83840:83841) = u(39)*w(751:752)
 w(83842) = u(40)*w(752)
endif
! terms of degree 9
if (9.le.mxd) then
 w(83843:139290) = u(0)*w(28395:83842)
 w(139291:175445) = u(1)*w(47688:83842)
 w(175446:198690) = u(2)*w(60598:83842)
 w(198691:213442) = u(3)*w(69091:83842)
 w(213443:222719) = u(4)*w(74566:83842)
 w(222720:228562) = u(5)*w(78000:83842)
 w(228563:229684) = u(6)*w(27273:28394)
 w(229685:230663) = u(7)*w(27416:28394)
 w(230664:231510) = u(8)*w(27548:28394)
 w(231511:232236) = u(9)*w(27669:28394)
 w(232237:232852) = u(10)*w(27779:28394)
 w(232853:233369) = u(11)*w(27878:28394)
 w(233370:233798) = u(12)*w(27966:28394)
 w(233799:234150) = u(13)*w(28043:28394)
 w(234151:234436) = u(14)*w(28109:28394)
 w(234437:234667) = u(15)*w(28164:28394)
 w(234668:234854) = u(16)*w(28208:28394)
 w(234855:235008) = u(17)*w(28241:28394)
 w(235009:235140) = u(18)*w(28263:28394)
 w(235141:235209) = u(19)*w(9033:9101)
 w(235210:235267) = u(20)*w(9044:9101)
 w(235268:235315) = u(21)*w(9054:9101)
 w(235316:235354) = u(22)*w(9063:9101)
 w(235355:235385) = u(23)*w(9071:9101)
 w(235386:235409) = u(24)*w(9078:9101)
 w(235410:235427) = u(25)*w(9084:9101)
 w(235428:235440) = u(26)*w(9089:9101)
 w(235441:235449) = u(27)*w(9093:9101)
 w(235450:235455) = u(28)*w(9096:9101)
 w(235456:235459) = u(29)*w(9098:9101)
endif
END SUBROUTINE mg442_prib
