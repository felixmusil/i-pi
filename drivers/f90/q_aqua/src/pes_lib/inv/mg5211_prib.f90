SUBROUTINE mg5211_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg5211_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg5211_prib: bad size u'
!! else if (size(w).ne.mg5211_npb(mxd)) then
!!  stop 'mg5211_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 8 9 5 6 5 2 0 0 0
! prib,  dnpb(0:*): 1 8 45 197 745 2510 7758 22318 60529 156027
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(9:16) = u(0)*w(1:8)
 w(17:23) = u(1)*w(2:8)
 w(24:29) = u(2)*w(3:8)
 w(30:34) = u(3)*w(4:8)
 w(35:38) = u(4)*w(5:8)
 w(39:41) = u(5)*w(6:8)
 w(42:43) = u(6)*w(7:8)
 w(44) = u(7)*w(8)
 w(45) = u(8)*w(0)
 w(46) = u(9)*w(0)
 w(47) = u(10)*w(0)
 w(48) = u(11)*w(0)
 w(49) = u(12)*w(0)
 w(50) = u(13)*w(0)
 w(51) = u(14)*w(0)
 w(52) = u(15)*w(0)
 w(53) = u(16)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(54:98) = u(0)*w(9:53)
 w(99:135) = u(1)*w(17:53)
 w(136:165) = u(2)*w(24:53)
 w(166:189) = u(3)*w(30:53)
 w(190:208) = u(4)*w(35:53)
 w(209:223) = u(5)*w(39:53)
 w(224:235) = u(6)*w(42:53)
 w(236:245) = u(7)*w(44:53)
 w(246) = u(17)*w(0)
 w(247) = u(18)*w(0)
 w(248) = u(19)*w(0)
 w(249) = u(20)*w(0)
 w(250) = u(21)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(251:447) = u(0)*w(54:250)
 w(448:599) = u(1)*w(99:250)
 w(600:714) = u(2)*w(136:250)
 w(715:799) = u(3)*w(166:250)
 w(800:860) = u(4)*w(190:250)
 w(861:902) = u(5)*w(209:250)
 w(903:929) = u(6)*w(224:250)
 w(930:944) = u(7)*w(236:250)
 w(945:953) = u(8)*w(45:53)
 w(954:961) = u(9)*w(46:53)
 w(962:968) = u(10)*w(47:53)
 w(969:974) = u(11)*w(48:53)
 w(975:979) = u(12)*w(49:53)
 w(980:983) = u(13)*w(50:53)
 w(984:986) = u(14)*w(51:53)
 w(987:988) = u(15)*w(52:53)
 w(989) = u(16)*w(53)
 w(990) = u(22)*w(0)
 w(991) = u(23)*w(0)
 w(992) = u(24)*w(0)
 w(993) = u(25)*w(0)
 w(994) = u(26)*w(0)
 w(995) = u(27)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(996:1740) = u(0)*w(251:995)
 w(1741:2288) = u(1)*w(448:995)
 w(2289:2684) = u(2)*w(600:995)
 w(2685:2965) = u(3)*w(715:995)
 w(2966:3161) = u(4)*w(800:995)
 w(3162:3296) = u(5)*w(861:995)
 w(3297:3389) = u(6)*w(903:995)
 w(3390:3455) = u(7)*w(930:995)
 w(3456:3460) = u(8)*w(246:250)
 w(3461:3465) = u(9)*w(246:250)
 w(3466:3470) = u(10)*w(246:250)
 w(3471:3475) = u(11)*w(246:250)
 w(3476:3480) = u(12)*w(246:250)
 w(3481:3485) = u(13)*w(246:250)
 w(3486:3490) = u(14)*w(246:250)
 w(3491:3495) = u(15)*w(246:250)
 w(3496:3500) = u(16)*w(246:250)
 w(3501) = u(28)*w(0)
 w(3502) = u(29)*w(0)
 w(3503) = u(30)*w(0)
 w(3504) = u(31)*w(0)
 w(3505) = u(32)*w(0)
endif
! terms of degree 6
if (6.le.mxd) then
 w(3506:6015) = u(0)*w(996:3505)
 w(6016:7780) = u(1)*w(1741:3505)
 w(7781:8997) = u(2)*w(2289:3505)
 w(8998:9818) = u(3)*w(2685:3505)
 w(9819:10358) = u(4)*w(2966:3505)
 w(10359:10702) = u(5)*w(3162:3505)
 w(10703:10911) = u(6)*w(3297:3505)
 w(10912:11027) = u(7)*w(3390:3505)
 w(11028:11078) = u(8)*w(945:995)
 w(11079:11120) = u(9)*w(954:995)
 w(11121:11154) = u(10)*w(962:995)
 w(11155:11181) = u(11)*w(969:995)
 w(11182:11202) = u(12)*w(975:995)
 w(11203:11218) = u(13)*w(980:995)
 w(11219:11230) = u(14)*w(984:995)
 w(11231:11239) = u(15)*w(987:995)
 w(11240:11246) = u(16)*w(989:995)
 w(11247:11251) = u(17)*w(246:250)
 w(11252:11255) = u(18)*w(247:250)
 w(11256:11258) = u(19)*w(248:250)
 w(11259:11260) = u(20)*w(249:250)
 w(11261) = u(21)*w(250)
 w(11262) = u(33)*w(0)
 w(11263) = u(34)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(11264:19021) = u(0)*w(3506:11263)
 w(19022:24269) = u(1)*w(6016:11263)
 w(24270:27752) = u(2)*w(7781:11263)
 w(27753:30018) = u(3)*w(8998:11263)
 w(30019:31463) = u(4)*w(9819:11263)
 w(31464:32368) = u(5)*w(10359:11263)
 w(32369:32929) = u(6)*w(10703:11263)
 w(32930:33281) = u(7)*w(10912:11263)
 w(33282:33331) = u(8)*w(3456:3505)
 w(33332:33376) = u(9)*w(3461:3505)
 w(33377:33416) = u(10)*w(3466:3505)
 w(33417:33451) = u(11)*w(3471:3505)
 w(33452:33481) = u(12)*w(3476:3505)
 w(33482:33506) = u(13)*w(3481:3505)
 w(33507:33526) = u(14)*w(3486:3505)
 w(33527:33541) = u(15)*w(3491:3505)
 w(33542:33551) = u(16)*w(3496:3505)
 w(33552:33557) = u(17)*w(990:995)
 w(33558:33563) = u(18)*w(990:995)
 w(33564:33569) = u(19)*w(990:995)
 w(33570:33575) = u(20)*w(990:995)
 w(33576:33581) = u(21)*w(990:995)
endif
! terms of degree 8
if (8.le.mxd) then
 w(33582:55899) = u(0)*w(11264:33581)
 w(55900:70459) = u(1)*w(19022:33581)
 w(70460:79771) = u(2)*w(24270:33581)
 w(79772:85600) = u(3)*w(27753:33581)
 w(85601:89163) = u(4)*w(30019:33581)
 w(89164:91281) = u(5)*w(31464:33581)
 w(91282:92494) = u(6)*w(32369:33581)
 w(92495:93146) = u(7)*w(32930:33581)
 w(93147:93382) = u(8)*w(11028:11263)
 w(93383:93567) = u(9)*w(11079:11263)
 w(93568:93710) = u(10)*w(11121:11263)
 w(93711:93819) = u(11)*w(11155:11263)
 w(93820:93901) = u(12)*w(11182:11263)
 w(93902:93962) = u(13)*w(11203:11263)
 w(93963:94007) = u(14)*w(11219:11263)
 w(94008:94040) = u(15)*w(11231:11263)
 w(94041:94064) = u(16)*w(11240:11263)
 w(94065:94069) = u(17)*w(3501:3505)
 w(94070:94074) = u(18)*w(3501:3505)
 w(94075:94079) = u(19)*w(3501:3505)
 w(94080:94084) = u(20)*w(3501:3505)
 w(94085:94089) = u(21)*w(3501:3505)
 w(94090:94095) = u(22)*w(990:995)
 w(94096:94100) = u(23)*w(991:995)
 w(94101:94104) = u(24)*w(992:995)
 w(94105:94107) = u(25)*w(993:995)
 w(94108:94109) = u(26)*w(994:995)
 w(94110) = u(27)*w(995)
endif
! terms of degree 9
if (9.le.mxd) then
 w(94111:154639) = u(0)*w(33582:94110)
 w(154640:192850) = u(1)*w(55900:94110)
 w(192851:216501) = u(2)*w(70460:94110)
 w(216502:230840) = u(3)*w(79772:94110)
 w(230841:239350) = u(4)*w(85601:94110)
 w(239351:244297) = u(5)*w(89164:94110)
 w(244298:247126) = u(6)*w(91282:94110)
 w(247127:248742) = u(7)*w(92495:94110)
 w(248743:249042) = u(8)*w(33282:33581)
 w(249043:249292) = u(9)*w(33332:33581)
 w(249293:249497) = u(10)*w(33377:33581)
 w(249498:249662) = u(11)*w(33417:33581)
 w(249663:249792) = u(12)*w(33452:33581)
 w(249793:249892) = u(13)*w(33482:33581)
 w(249893:249967) = u(14)*w(33507:33581)
 w(249968:250022) = u(15)*w(33527:33581)
 w(250023:250062) = u(16)*w(33542:33581)
 w(250063:250079) = u(17)*w(11247:11263)
 w(250080:250091) = u(18)*w(11252:11263)
 w(250092:250099) = u(19)*w(11256:11263)
 w(250100:250104) = u(20)*w(11259:11263)
 w(250105:250107) = u(21)*w(11261:11263)
 w(250108:250112) = u(22)*w(3501:3505)
 w(250113:250117) = u(23)*w(3501:3505)
 w(250118:250122) = u(24)*w(3501:3505)
 w(250123:250127) = u(25)*w(3501:3505)
 w(250128:250132) = u(26)*w(3501:3505)
 w(250133:250137) = u(27)*w(3501:3505)
endif
END SUBROUTINE mg5211_prib
