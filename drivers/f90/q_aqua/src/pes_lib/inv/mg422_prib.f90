SUBROUTINE mg422_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg422_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg422_prib: bad size u'
!! else if (size(w).ne.mg422_npb(mxd)) then
!!  stop 'mg422_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 6 11 4 5 0 2 0 0 0
! prib,  dnpb(0:*): 1 6 32 126 452 1422 4180 11370 29382 71990
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(7:12) = u(0)*w(1:6)
 w(13:17) = u(1)*w(2:6)
 w(18:21) = u(2)*w(3:6)
 w(22:24) = u(3)*w(4:6)
 w(25:26) = u(4)*w(5:6)
 w(27) = u(5)*w(6)
 w(28) = u(6)*w(0)
 w(29) = u(7)*w(0)
 w(30) = u(8)*w(0)
 w(31) = u(9)*w(0)
 w(32) = u(10)*w(0)
 w(33) = u(11)*w(0)
 w(34) = u(12)*w(0)
 w(35) = u(13)*w(0)
 w(36) = u(14)*w(0)
 w(37) = u(15)*w(0)
 w(38) = u(16)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(39:70) = u(0)*w(7:38)
 w(71:96) = u(1)*w(13:38)
 w(97:117) = u(2)*w(18:38)
 w(118:134) = u(3)*w(22:38)
 w(135:148) = u(4)*w(25:38)
 w(149:160) = u(5)*w(27:38)
 w(161) = u(17)*w(0)
 w(162) = u(18)*w(0)
 w(163) = u(19)*w(0)
 w(164) = u(20)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(165:290) = u(0)*w(39:164)
 w(291:384) = u(1)*w(71:164)
 w(385:452) = u(2)*w(97:164)
 w(453:499) = u(3)*w(118:164)
 w(500:529) = u(4)*w(135:164)
 w(530:545) = u(5)*w(149:164)
 w(546:556) = u(6)*w(28:38)
 w(557:566) = u(7)*w(29:38)
 w(567:575) = u(8)*w(30:38)
 w(576:583) = u(9)*w(31:38)
 w(584:590) = u(10)*w(32:38)
 w(591:596) = u(11)*w(33:38)
 w(597:601) = u(12)*w(34:38)
 w(602:605) = u(13)*w(35:38)
 w(606:608) = u(14)*w(36:38)
 w(609:610) = u(15)*w(37:38)
 w(611) = u(16)*w(38)
 w(612) = u(21)*w(0)
 w(613) = u(22)*w(0)
 w(614) = u(23)*w(0)
 w(615) = u(24)*w(0)
 w(616) = u(25)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(617:1068) = u(0)*w(165:616)
 w(1069:1394) = u(1)*w(291:616)
 w(1395:1626) = u(2)*w(385:616)
 w(1627:1790) = u(3)*w(453:616)
 w(1791:1907) = u(4)*w(500:616)
 w(1908:1994) = u(5)*w(530:616)
 w(1995:1998) = u(6)*w(161:164)
 w(1999:2002) = u(7)*w(161:164)
 w(2003:2006) = u(8)*w(161:164)
 w(2007:2010) = u(9)*w(161:164)
 w(2011:2014) = u(10)*w(161:164)
 w(2015:2018) = u(11)*w(161:164)
 w(2019:2022) = u(12)*w(161:164)
 w(2023:2026) = u(13)*w(161:164)
 w(2027:2030) = u(14)*w(161:164)
 w(2031:2034) = u(15)*w(161:164)
 w(2035:2038) = u(16)*w(161:164)
endif
! terms of degree 6
if (6.le.mxd) then
 w(2039:3460) = u(0)*w(617:2038)
 w(3461:4430) = u(1)*w(1069:2038)
 w(4431:5074) = u(2)*w(1395:2038)
 w(5075:5486) = u(3)*w(1627:2038)
 w(5487:5734) = u(4)*w(1791:2038)
 w(5735:5865) = u(5)*w(1908:2038)
 w(5866:5936) = u(6)*w(546:616)
 w(5937:5996) = u(7)*w(557:616)
 w(5997:6046) = u(8)*w(567:616)
 w(6047:6087) = u(9)*w(576:616)
 w(6088:6120) = u(10)*w(584:616)
 w(6121:6146) = u(11)*w(591:616)
 w(6147:6166) = u(12)*w(597:616)
 w(6167:6181) = u(13)*w(602:616)
 w(6182:6192) = u(14)*w(606:616)
 w(6193:6200) = u(15)*w(609:616)
 w(6201:6206) = u(16)*w(611:616)
 w(6207:6210) = u(17)*w(161:164)
 w(6211:6213) = u(18)*w(162:164)
 w(6214:6215) = u(19)*w(163:164)
 w(6216) = u(20)*w(164)
 w(6217) = u(26)*w(0)
 w(6218) = u(27)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(6219:10398) = u(0)*w(2039:6218)
 w(10399:13156) = u(1)*w(3461:6218)
 w(13157:14944) = u(2)*w(4431:6218)
 w(14945:16088) = u(3)*w(5075:6218)
 w(16089:16820) = u(4)*w(5487:6218)
 w(16821:17304) = u(5)*w(5735:6218)
 w(17305:17348) = u(6)*w(1995:2038)
 w(17349:17388) = u(7)*w(1999:2038)
 w(17389:17424) = u(8)*w(2003:2038)
 w(17425:17456) = u(9)*w(2007:2038)
 w(17457:17484) = u(10)*w(2011:2038)
 w(17485:17508) = u(11)*w(2015:2038)
 w(17509:17528) = u(12)*w(2019:2038)
 w(17529:17544) = u(13)*w(2023:2038)
 w(17545:17556) = u(14)*w(2027:2038)
 w(17557:17564) = u(15)*w(2031:2038)
 w(17565:17568) = u(16)*w(2035:2038)
 w(17569:17573) = u(17)*w(612:616)
 w(17574:17578) = u(18)*w(612:616)
 w(17579:17583) = u(19)*w(612:616)
 w(17584:17588) = u(20)*w(612:616)
endif
! terms of degree 8
if (8.le.mxd) then
 w(17589:28958) = u(0)*w(6219:17588)
 w(28959:36148) = u(1)*w(10399:17588)
 w(36149:40580) = u(2)*w(13157:17588)
 w(40581:43224) = u(3)*w(14945:17588)
 w(43225:44724) = u(4)*w(16089:17588)
 w(44725:45492) = u(5)*w(16821:17588)
 w(45493:45845) = u(6)*w(5866:6218)
 w(45846:46127) = u(7)*w(5937:6218)
 w(46128:46349) = u(8)*w(5997:6218)
 w(46350:46521) = u(9)*w(6047:6218)
 w(46522:46652) = u(10)*w(6088:6218)
 w(46653:46750) = u(11)*w(6121:6218)
 w(46751:46822) = u(12)*w(6147:6218)
 w(46823:46874) = u(13)*w(6167:6218)
 w(46875:46911) = u(14)*w(6182:6218)
 w(46912:46937) = u(15)*w(6193:6218)
 w(46938:46955) = u(16)*w(6201:6218)
 w(46956:46960) = u(21)*w(612:616)
 w(46961:46964) = u(22)*w(613:616)
 w(46965:46967) = u(23)*w(614:616)
 w(46968:46969) = u(24)*w(615:616)
 w(46970) = u(25)*w(616)
endif
! terms of degree 9
if (9.le.mxd) then
 w(46971:76352) = u(0)*w(17589:46970)
 w(76353:94364) = u(1)*w(28959:46970)
 w(94365:105186) = u(2)*w(36149:46970)
 w(105187:111576) = u(3)*w(40581:46970)
 w(111577:115322) = u(4)*w(43225:46970)
 w(115323:117568) = u(5)*w(44725:46970)
 w(117569:117852) = u(6)*w(17305:17588)
 w(117853:118092) = u(7)*w(17349:17588)
 w(118093:118292) = u(8)*w(17389:17588)
 w(118293:118456) = u(9)*w(17425:17588)
 w(118457:118588) = u(10)*w(17457:17588)
 w(118589:118692) = u(11)*w(17485:17588)
 w(118693:118772) = u(12)*w(17509:17588)
 w(118773:118832) = u(13)*w(17529:17588)
 w(118833:118876) = u(14)*w(17545:17588)
 w(118877:118908) = u(15)*w(17557:17588)
 w(118909:118932) = u(16)*w(17565:17588)
 w(118933:118944) = u(17)*w(6207:6218)
 w(118945:118952) = u(18)*w(6211:6218)
 w(118953:118957) = u(19)*w(6214:6218)
 w(118958:118960) = u(20)*w(6216:6218)
endif
END SUBROUTINE mg422_prib
