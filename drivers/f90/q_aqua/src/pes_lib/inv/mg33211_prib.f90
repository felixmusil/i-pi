SUBROUTINE mg33211_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg33211_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg33211_prib: bad size u'
!! else if (size(w).ne.mg33211_npb(mxd)) then
!!  stop 'mg33211_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 13 17 11 1 0 3 0 0 0
! prib,  dnpb(0:*): 1 13 108 687 3664 17113 72009 278100 999190 3373602
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
 w(10) = u(9)*w(0)
 w(11) = u(10)*w(0)
 w(12) = u(11)*w(0)
 w(13) = u(12)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(14:26) = u(0)*w(1:13)
 w(27:38) = u(1)*w(2:13)
 w(39:49) = u(2)*w(3:13)
 w(50:59) = u(3)*w(4:13)
 w(60:68) = u(4)*w(5:13)
 w(69:76) = u(5)*w(6:13)
 w(77:83) = u(6)*w(7:13)
 w(84:89) = u(7)*w(8:13)
 w(90:94) = u(8)*w(9:13)
 w(95:98) = u(9)*w(10:13)
 w(99:101) = u(10)*w(11:13)
 w(102:103) = u(11)*w(12:13)
 w(104) = u(12)*w(13)
 w(105) = u(13)*w(0)
 w(106) = u(14)*w(0)
 w(107) = u(15)*w(0)
 w(108) = u(16)*w(0)
 w(109) = u(17)*w(0)
 w(110) = u(18)*w(0)
 w(111) = u(19)*w(0)
 w(112) = u(20)*w(0)
 w(113) = u(21)*w(0)
 w(114) = u(22)*w(0)
 w(115) = u(23)*w(0)
 w(116) = u(24)*w(0)
 w(117) = u(25)*w(0)
 w(118) = u(26)*w(0)
 w(119) = u(27)*w(0)
 w(120) = u(28)*w(0)
 w(121) = u(29)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(122:229) = u(0)*w(14:121)
 w(230:324) = u(1)*w(27:121)
 w(325:407) = u(2)*w(39:121)
 w(408:479) = u(3)*w(50:121)
 w(480:541) = u(4)*w(60:121)
 w(542:594) = u(5)*w(69:121)
 w(595:639) = u(6)*w(77:121)
 w(640:677) = u(7)*w(84:121)
 w(678:709) = u(8)*w(90:121)
 w(710:736) = u(9)*w(95:121)
 w(737:759) = u(10)*w(99:121)
 w(760:779) = u(11)*w(102:121)
 w(780:797) = u(12)*w(104:121)
 w(798) = u(30)*w(0)
 w(799) = u(31)*w(0)
 w(800) = u(32)*w(0)
 w(801) = u(33)*w(0)
 w(802) = u(34)*w(0)
 w(803) = u(35)*w(0)
 w(804) = u(36)*w(0)
 w(805) = u(37)*w(0)
 w(806) = u(38)*w(0)
 w(807) = u(39)*w(0)
 w(808) = u(40)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(809:1495) = u(0)*w(122:808)
 w(1496:2074) = u(1)*w(230:808)
 w(2075:2558) = u(2)*w(325:808)
 w(2559:2959) = u(3)*w(408:808)
 w(2960:3288) = u(4)*w(480:808)
 w(3289:3555) = u(5)*w(542:808)
 w(3556:3769) = u(6)*w(595:808)
 w(3770:3938) = u(7)*w(640:808)
 w(3939:4069) = u(8)*w(678:808)
 w(4070:4168) = u(9)*w(710:808)
 w(4169:4240) = u(10)*w(737:808)
 w(4241:4289) = u(11)*w(760:808)
 w(4290:4318) = u(12)*w(780:808)
 w(4319:4335) = u(13)*w(105:121)
 w(4336:4351) = u(14)*w(106:121)
 w(4352:4366) = u(15)*w(107:121)
 w(4367:4380) = u(16)*w(108:121)
 w(4381:4393) = u(17)*w(109:121)
 w(4394:4405) = u(18)*w(110:121)
 w(4406:4416) = u(19)*w(111:121)
 w(4417:4426) = u(20)*w(112:121)
 w(4427:4435) = u(21)*w(113:121)
 w(4436:4443) = u(22)*w(114:121)
 w(4444:4450) = u(23)*w(115:121)
 w(4451:4456) = u(24)*w(116:121)
 w(4457:4461) = u(25)*w(117:121)
 w(4462:4465) = u(26)*w(118:121)
 w(4466:4468) = u(27)*w(119:121)
 w(4469:4470) = u(28)*w(120:121)
 w(4471) = u(29)*w(121)
 w(4472) = u(41)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(4473:8136) = u(0)*w(809:4472)
 w(8137:11113) = u(1)*w(1496:4472)
 w(11114:13511) = u(2)*w(2075:4472)
 w(13512:15425) = u(3)*w(2559:4472)
 w(15426:16938) = u(4)*w(2960:4472)
 w(16939:18122) = u(5)*w(3289:4472)
 w(18123:19039) = u(6)*w(3556:4472)
 w(19040:19742) = u(7)*w(3770:4472)
 w(19743:20276) = u(8)*w(3939:4472)
 w(20277:20679) = u(9)*w(4070:4472)
 w(20680:20983) = u(10)*w(4169:4472)
 w(20984:21215) = u(11)*w(4241:4472)
 w(21216:21398) = u(12)*w(4290:4472)
 w(21399:21409) = u(13)*w(798:808)
 w(21410:21420) = u(14)*w(798:808)
 w(21421:21431) = u(15)*w(798:808)
 w(21432:21442) = u(16)*w(798:808)
 w(21443:21453) = u(17)*w(798:808)
 w(21454:21464) = u(18)*w(798:808)
 w(21465:21475) = u(19)*w(798:808)
 w(21476:21486) = u(20)*w(798:808)
 w(21487:21497) = u(21)*w(798:808)
 w(21498:21508) = u(22)*w(798:808)
 w(21509:21519) = u(23)*w(798:808)
 w(21520:21530) = u(24)*w(798:808)
 w(21531:21541) = u(25)*w(798:808)
 w(21542:21552) = u(26)*w(798:808)
 w(21553:21563) = u(27)*w(798:808)
 w(21564:21574) = u(28)*w(798:808)
 w(21575:21585) = u(29)*w(798:808)
endif
! terms of degree 6
if (6.le.mxd) then
 w(21586:38698) = u(0)*w(4473:21585)
 w(38699:52147) = u(1)*w(8137:21585)
 w(52148:62619) = u(2)*w(11114:21585)
 w(62620:70693) = u(3)*w(13512:21585)
 w(70694:76853) = u(4)*w(15426:21585)
 w(76854:81500) = u(5)*w(16939:21585)
 w(81501:84963) = u(6)*w(18123:21585)
 w(84964:87509) = u(7)*w(19040:21585)
 w(87510:89352) = u(8)*w(19743:21585)
 w(89353:90661) = u(9)*w(20277:21585)
 w(90662:91567) = u(10)*w(20680:21585)
 w(91568:92169) = u(11)*w(20984:21585)
 w(92170:92539) = u(12)*w(21216:21585)
 w(92540:92693) = u(13)*w(4319:4472)
 w(92694:92830) = u(14)*w(4336:4472)
 w(92831:92951) = u(15)*w(4352:4472)
 w(92952:93057) = u(16)*w(4367:4472)
 w(93058:93149) = u(17)*w(4381:4472)
 w(93150:93228) = u(18)*w(4394:4472)
 w(93229:93295) = u(19)*w(4406:4472)
 w(93296:93351) = u(20)*w(4417:4472)
 w(93352:93397) = u(21)*w(4427:4472)
 w(93398:93434) = u(22)*w(4436:4472)
 w(93435:93463) = u(23)*w(4444:4472)
 w(93464:93485) = u(24)*w(4451:4472)
 w(93486:93501) = u(25)*w(4457:4472)
 w(93502:93512) = u(26)*w(4462:4472)
 w(93513:93519) = u(27)*w(4466:4472)
 w(93520:93523) = u(28)*w(4469:4472)
 w(93524:93525) = u(29)*w(4471:4472)
 w(93526:93536) = u(30)*w(798:808)
 w(93537:93546) = u(31)*w(799:808)
 w(93547:93555) = u(32)*w(800:808)
 w(93556:93563) = u(33)*w(801:808)
 w(93564:93570) = u(34)*w(802:808)
 w(93571:93576) = u(35)*w(803:808)
 w(93577:93581) = u(36)*w(804:808)
 w(93582:93585) = u(37)*w(805:808)
 w(93586:93588) = u(38)*w(806:808)
 w(93589:93590) = u(39)*w(807:808)
 w(93591) = u(40)*w(808)
 w(93592) = u(42)*w(0)
 w(93593) = u(43)*w(0)
 w(93594) = u(44)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(93595:165603) = u(0)*w(21586:93594)
 w(165604:220499) = u(1)*w(38699:93594)
 w(220500:261946) = u(2)*w(52148:93594)
 w(261947:292921) = u(3)*w(62620:93594)
 w(292922:315822) = u(4)*w(70694:93594)
 w(315823:332563) = u(5)*w(76854:93594)
 w(332564:344657) = u(6)*w(81501:93594)
 w(344658:353288) = u(7)*w(84964:93594)
 w(353289:359373) = u(8)*w(87510:93594)
 w(359374:363615) = u(9)*w(89353:93594)
 w(363616:366548) = u(10)*w(90662:93594)
 w(366549:368575) = u(11)*w(91568:93594)
 w(368576:370000) = u(12)*w(92170:93594)
 w(370001:370187) = u(13)*w(21399:21585)
 w(370188:370363) = u(14)*w(21410:21585)
 w(370364:370528) = u(15)*w(21421:21585)
 w(370529:370682) = u(16)*w(21432:21585)
 w(370683:370825) = u(17)*w(21443:21585)
 w(370826:370957) = u(18)*w(21454:21585)
 w(370958:371078) = u(19)*w(21465:21585)
 w(371079:371188) = u(20)*w(21476:21585)
 w(371189:371287) = u(21)*w(21487:21585)
 w(371288:371375) = u(22)*w(21498:21585)
 w(371376:371452) = u(23)*w(21509:21585)
 w(371453:371518) = u(24)*w(21520:21585)
 w(371519:371573) = u(25)*w(21531:21585)
 w(371574:371617) = u(26)*w(21542:21585)
 w(371618:371650) = u(27)*w(21553:21585)
 w(371651:371672) = u(28)*w(21564:21585)
 w(371673:371683) = u(29)*w(21575:21585)
 w(371684) = u(30)*w(4472)
 w(371685) = u(31)*w(4472)
 w(371686) = u(32)*w(4472)
 w(371687) = u(33)*w(4472)
 w(371688) = u(34)*w(4472)
 w(371689) = u(35)*w(4472)
 w(371690) = u(36)*w(4472)
 w(371691) = u(37)*w(4472)
 w(371692) = u(38)*w(4472)
 w(371693) = u(39)*w(4472)
 w(371694) = u(40)*w(4472)
endif
! terms of degree 8
if (8.le.mxd) then
 w(371695:649794) = u(0)*w(93595:371694)
 w(649795:855885) = u(1)*w(165604:371694)
 w(855886:1007080) = u(2)*w(220500:371694)
 w(1007081:1116828) = u(3)*w(261947:371694)
 w(1116829:1195601) = u(4)*w(292922:371694)
 w(1195602:1251473) = u(5)*w(315823:371694)
 w(1251474:1290604) = u(6)*w(332564:371694)
 w(1290605:1317641) = u(7)*w(344658:371694)
 w(1317642:1336047) = u(8)*w(353289:371694)
 w(1336048:1348368) = u(9)*w(359374:371694)
 w(1348369:1356447) = u(10)*w(363616:371694)
 w(1356448:1361593) = u(11)*w(366549:371694)
 w(1361594:1364712) = u(12)*w(368576:371694)
 w(1364713:1365767) = u(13)*w(92540:93594)
 w(1365768:1366668) = u(14)*w(92694:93594)
 w(1366669:1367432) = u(15)*w(92831:93594)
 w(1367433:1368075) = u(16)*w(92952:93594)
 w(1368076:1368612) = u(17)*w(93058:93594)
 w(1368613:1369057) = u(18)*w(93150:93594)
 w(1369058:1369423) = u(19)*w(93229:93594)
 w(1369424:1369722) = u(20)*w(93296:93594)
 w(1369723:1369965) = u(21)*w(93352:93594)
 w(1369966:1370162) = u(22)*w(93398:93594)
 w(1370163:1370322) = u(23)*w(93435:93594)
 w(1370323:1370453) = u(24)*w(93464:93594)
 w(1370454:1370562) = u(25)*w(93486:93594)
 w(1370563:1370655) = u(26)*w(93502:93594)
 w(1370656:1370737) = u(27)*w(93513:93594)
 w(1370738:1370812) = u(28)*w(93520:93594)
 w(1370813:1370883) = u(29)*w(93524:93594)
 w(1370884) = u(41)*w(4472)
endif
! terms of degree 9
if (9.le.mxd) then
 w(1370885:2370074) = u(0)*w(371695:1370884)
 w(2370075:3091164) = u(1)*w(649795:1370884)
 w(3091165:3606163) = u(2)*w(855886:1370884)
 w(3606164:3969967) = u(3)*w(1007081:1370884)
 w(3969968:4224023) = u(4)*w(1116829:1370884)
 w(4224024:4399306) = u(5)*w(1195602:1370884)
 w(4399307:4518717) = u(6)*w(1251474:1370884)
 w(4518718:4598997) = u(7)*w(1290605:1370884)
 w(4598998:4652240) = u(8)*w(1317642:1370884)
 w(4652241:4687077) = u(9)*w(1336048:1370884)
 w(4687078:4709593) = u(10)*w(1348369:1370884)
 w(4709594:4724030) = u(11)*w(1356448:1370884)
 w(4724031:4733321) = u(12)*w(1361594:1370884)
 w(4733322:4735015) = u(13)*w(370001:371694)
 w(4735016:4736522) = u(14)*w(370188:371694)
 w(4736523:4737853) = u(15)*w(370364:371694)
 w(4737854:4739019) = u(16)*w(370529:371694)
 w(4739020:4740031) = u(17)*w(370683:371694)
 w(4740032:4740900) = u(18)*w(370826:371694)
 w(4740901:4741637) = u(19)*w(370958:371694)
 w(4741638:4742253) = u(20)*w(371079:371694)
 w(4742254:4742759) = u(21)*w(371189:371694)
 w(4742760:4743166) = u(22)*w(371288:371694)
 w(4743167:4743485) = u(23)*w(371376:371694)
 w(4743486:4743727) = u(24)*w(371453:371694)
 w(4743728:4743903) = u(25)*w(371519:371694)
 w(4743904:4744024) = u(26)*w(371574:371694)
 w(4744025:4744101) = u(27)*w(371618:371694)
 w(4744102:4744145) = u(28)*w(371651:371694)
 w(4744146:4744167) = u(29)*w(371673:371694)
 w(4744168:4744236) = u(30)*w(93526:93594)
 w(4744237:4744294) = u(31)*w(93537:93594)
 w(4744295:4744342) = u(32)*w(93547:93594)
 w(4744343:4744381) = u(33)*w(93556:93594)
 w(4744382:4744412) = u(34)*w(93564:93594)
 w(4744413:4744436) = u(35)*w(93571:93594)
 w(4744437:4744454) = u(36)*w(93577:93594)
 w(4744455:4744467) = u(37)*w(93582:93594)
 w(4744468:4744476) = u(38)*w(93586:93594)
 w(4744477:4744482) = u(39)*w(93589:93594)
 w(4744483:4744486) = u(40)*w(93591:93594)
endif
END SUBROUTINE mg33211_prib
