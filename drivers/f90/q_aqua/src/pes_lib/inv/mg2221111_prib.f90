SUBROUTINE mg2221111_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg2221111_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg2221111_prib: bad size u'
!! else if (size(w).ne.mg2221111_npb(mxd)) then
!!  stop 'mg2221111_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 24 21 0 0 0 0 0 0 0
! prib,  dnpb(0:*): 1 24 321 3104 24081 158424 914641 4742784 22460121 98362904
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
 w(10) = u(9)*w(0)
 w(11) = u(10)*w(0)
 w(12) = u(11)*w(0)
 w(13) = u(12)*w(0)
 w(14) = u(13)*w(0)
 w(15) = u(14)*w(0)
 w(16) = u(15)*w(0)
 w(17) = u(16)*w(0)
 w(18) = u(17)*w(0)
 w(19) = u(18)*w(0)
 w(20) = u(19)*w(0)
 w(21) = u(20)*w(0)
 w(22) = u(21)*w(0)
 w(23) = u(22)*w(0)
 w(24) = u(23)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(25:48) = u(0)*w(1:24)
 w(49:71) = u(1)*w(2:24)
 w(72:93) = u(2)*w(3:24)
 w(94:114) = u(3)*w(4:24)
 w(115:134) = u(4)*w(5:24)
 w(135:153) = u(5)*w(6:24)
 w(154:171) = u(6)*w(7:24)
 w(172:188) = u(7)*w(8:24)
 w(189:204) = u(8)*w(9:24)
 w(205:219) = u(9)*w(10:24)
 w(220:233) = u(10)*w(11:24)
 w(234:246) = u(11)*w(12:24)
 w(247:258) = u(12)*w(13:24)
 w(259:269) = u(13)*w(14:24)
 w(270:279) = u(14)*w(15:24)
 w(280:288) = u(15)*w(16:24)
 w(289:296) = u(16)*w(17:24)
 w(297:303) = u(17)*w(18:24)
 w(304:309) = u(18)*w(19:24)
 w(310:314) = u(19)*w(20:24)
 w(315:318) = u(20)*w(21:24)
 w(319:321) = u(21)*w(22:24)
 w(322:323) = u(22)*w(23:24)
 w(324) = u(23)*w(24)
 w(325) = u(24)*w(0)
 w(326) = u(25)*w(0)
 w(327) = u(26)*w(0)
 w(328) = u(27)*w(0)
 w(329) = u(28)*w(0)
 w(330) = u(29)*w(0)
 w(331) = u(30)*w(0)
 w(332) = u(31)*w(0)
 w(333) = u(32)*w(0)
 w(334) = u(33)*w(0)
 w(335) = u(34)*w(0)
 w(336) = u(35)*w(0)
 w(337) = u(36)*w(0)
 w(338) = u(37)*w(0)
 w(339) = u(38)*w(0)
 w(340) = u(39)*w(0)
 w(341) = u(40)*w(0)
 w(342) = u(41)*w(0)
 w(343) = u(42)*w(0)
 w(344) = u(43)*w(0)
 w(345) = u(44)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(346:666) = u(0)*w(25:345)
 w(667:963) = u(1)*w(49:345)
 w(964:1237) = u(2)*w(72:345)
 w(1238:1489) = u(3)*w(94:345)
 w(1490:1720) = u(4)*w(115:345)
 w(1721:1931) = u(5)*w(135:345)
 w(1932:2123) = u(6)*w(154:345)
 w(2124:2297) = u(7)*w(172:345)
 w(2298:2454) = u(8)*w(189:345)
 w(2455:2595) = u(9)*w(205:345)
 w(2596:2721) = u(10)*w(220:345)
 w(2722:2833) = u(11)*w(234:345)
 w(2834:2932) = u(12)*w(247:345)
 w(2933:3019) = u(13)*w(259:345)
 w(3020:3095) = u(14)*w(270:345)
 w(3096:3161) = u(15)*w(280:345)
 w(3162:3218) = u(16)*w(289:345)
 w(3219:3267) = u(17)*w(297:345)
 w(3268:3309) = u(18)*w(304:345)
 w(3310:3345) = u(19)*w(310:345)
 w(3346:3376) = u(20)*w(315:345)
 w(3377:3403) = u(21)*w(319:345)
 w(3404:3427) = u(22)*w(322:345)
 w(3428:3449) = u(23)*w(324:345)
endif
! terms of degree 4
if (4.le.mxd) then
 w(3450:6553) = u(0)*w(346:3449)
 w(6554:9336) = u(1)*w(667:3449)
 w(9337:11822) = u(2)*w(964:3449)
 w(11823:14034) = u(3)*w(1238:3449)
 w(14035:15994) = u(4)*w(1490:3449)
 w(15995:17723) = u(5)*w(1721:3449)
 w(17724:19241) = u(6)*w(1932:3449)
 w(19242:20567) = u(7)*w(2124:3449)
 w(20568:21719) = u(8)*w(2298:3449)
 w(21720:22714) = u(9)*w(2455:3449)
 w(22715:23568) = u(10)*w(2596:3449)
 w(23569:24296) = u(11)*w(2722:3449)
 w(24297:24912) = u(12)*w(2834:3449)
 w(24913:25429) = u(13)*w(2933:3449)
 w(25430:25859) = u(14)*w(3020:3449)
 w(25860:26213) = u(15)*w(3096:3449)
 w(26214:26501) = u(16)*w(3162:3449)
 w(26502:26732) = u(17)*w(3219:3449)
 w(26733:26914) = u(18)*w(3268:3449)
 w(26915:27054) = u(19)*w(3310:3449)
 w(27055:27158) = u(20)*w(3346:3449)
 w(27159:27231) = u(21)*w(3377:3449)
 w(27232:27277) = u(22)*w(3404:3449)
 w(27278:27299) = u(23)*w(3428:3449)
 w(27300:27320) = u(24)*w(325:345)
 w(27321:27340) = u(25)*w(326:345)
 w(27341:27359) = u(26)*w(327:345)
 w(27360:27377) = u(27)*w(328:345)
 w(27378:27394) = u(28)*w(329:345)
 w(27395:27410) = u(29)*w(330:345)
 w(27411:27425) = u(30)*w(331:345)
 w(27426:27439) = u(31)*w(332:345)
 w(27440:27452) = u(32)*w(333:345)
 w(27453:27464) = u(33)*w(334:345)
 w(27465:27475) = u(34)*w(335:345)
 w(27476:27485) = u(35)*w(336:345)
 w(27486:27494) = u(36)*w(337:345)
 w(27495:27502) = u(37)*w(338:345)
 w(27503:27509) = u(38)*w(339:345)
 w(27510:27515) = u(39)*w(340:345)
 w(27516:27520) = u(40)*w(341:345)
 w(27521:27524) = u(41)*w(342:345)
 w(27525:27527) = u(42)*w(343:345)
 w(27528:27529) = u(43)*w(344:345)
 w(27530) = u(44)*w(345)
endif
! terms of degree 5
if (5.le.mxd) then
 w(27531:51611) = u(0)*w(3450:27530)
 w(51612:72588) = u(1)*w(6554:27530)
 w(72589:90782) = u(2)*w(9337:27530)
 w(90783:106490) = u(3)*w(11823:27530)
 w(106491:119986) = u(4)*w(14035:27530)
 w(119987:131522) = u(5)*w(15995:27530)
 w(131523:141329) = u(6)*w(17724:27530)
 w(141330:149618) = u(7)*w(19242:27530)
 w(149619:156581) = u(8)*w(20568:27530)
 w(156582:162392) = u(9)*w(21720:27530)
 w(162393:167208) = u(10)*w(22715:27530)
 w(167209:171170) = u(11)*w(23569:27530)
 w(171171:174404) = u(12)*w(24297:27530)
 w(174405:177022) = u(13)*w(24913:27530)
 w(177023:179123) = u(14)*w(25430:27530)
 w(179124:180794) = u(15)*w(25860:27530)
 w(180795:182111) = u(16)*w(26214:27530)
 w(182112:183140) = u(17)*w(26502:27530)
 w(183141:183938) = u(18)*w(26733:27530)
 w(183939:184554) = u(19)*w(26915:27530)
 w(184555:185030) = u(20)*w(27055:27530)
 w(185031:185402) = u(21)*w(27159:27530)
 w(185403:185701) = u(22)*w(27232:27530)
 w(185702:185954) = u(23)*w(27278:27530)
endif
! terms of degree 6
if (6.le.mxd) then
 w(185955:344378) = u(0)*w(27531:185954)
 w(344379:478721) = u(1)*w(51612:185954)
 w(478722:592087) = u(2)*w(72589:185954)
 w(592088:687259) = u(3)*w(90783:185954)
 w(687260:766723) = u(4)*w(106491:185954)
 w(766724:832691) = u(5)*w(119987:185954)
 w(832692:887123) = u(6)*w(131523:185954)
 w(887124:931748) = u(7)*w(141330:185954)
 w(931749:968084) = u(8)*w(149619:185954)
 w(968085:997457) = u(9)*w(156582:185954)
 w(997458:1021019) = u(10)*w(162393:185954)
 w(1021020:1039765) = u(11)*w(167209:185954)
 w(1039766:1054549) = u(12)*w(171171:185954)
 w(1054550:1066099) = u(13)*w(174405:185954)
 w(1066100:1075031) = u(14)*w(177023:185954)
 w(1075032:1081862) = u(15)*w(179124:185954)
 w(1081863:1087022) = u(16)*w(180795:185954)
 w(1087023:1090865) = u(17)*w(182112:185954)
 w(1090866:1093679) = u(18)*w(183141:185954)
 w(1093680:1095695) = u(19)*w(183939:185954)
 w(1095696:1097095) = u(20)*w(184555:185954)
 w(1097096:1098019) = u(21)*w(185031:185954)
 w(1098020:1098571) = u(22)*w(185403:185954)
 w(1098572:1098824) = u(23)*w(185702:185954)
 w(1098825:1099055) = u(24)*w(27300:27530)
 w(1099056:1099265) = u(25)*w(27321:27530)
 w(1099266:1099455) = u(26)*w(27341:27530)
 w(1099456:1099626) = u(27)*w(27360:27530)
 w(1099627:1099779) = u(28)*w(27378:27530)
 w(1099780:1099915) = u(29)*w(27395:27530)
 w(1099916:1100035) = u(30)*w(27411:27530)
 w(1100036:1100140) = u(31)*w(27426:27530)
 w(1100141:1100231) = u(32)*w(27440:27530)
 w(1100232:1100309) = u(33)*w(27453:27530)
 w(1100310:1100375) = u(34)*w(27465:27530)
 w(1100376:1100430) = u(35)*w(27476:27530)
 w(1100431:1100475) = u(36)*w(27486:27530)
 w(1100476:1100511) = u(37)*w(27495:27530)
 w(1100512:1100539) = u(38)*w(27503:27530)
 w(1100540:1100560) = u(39)*w(27510:27530)
 w(1100561:1100575) = u(40)*w(27516:27530)
 w(1100576:1100585) = u(41)*w(27521:27530)
 w(1100586:1100591) = u(42)*w(27525:27530)
 w(1100592:1100594) = u(43)*w(27528:27530)
 w(1100595) = u(44)*w(27530)
endif
! terms of degree 7
if (7.le.mxd) then
 w(1100596:2015236) = u(0)*w(185955:1100595)
 w(2015237:2771453) = u(1)*w(344379:1100595)
 w(2771454:3393327) = u(2)*w(478722:1100595)
 w(3393328:3901835) = u(3)*w(592088:1100595)
 w(3901836:4315171) = u(4)*w(687260:1100595)
 w(4315172:4649043) = u(5)*w(766724:1100595)
 w(4649044:4916947) = u(6)*w(832692:1100595)
 w(4916948:5130419) = u(7)*w(887124:1100595)
 w(5130420:5299266) = u(8)*w(931749:1100595)
 w(5299267:5431777) = u(9)*w(968085:1100595)
 w(5431778:5534915) = u(10)*w(997458:1100595)
 w(5534916:5614491) = u(11)*w(1021020:1100595)
 w(5614492:5675321) = u(12)*w(1039766:1100595)
 w(5675322:5721367) = u(13)*w(1054550:1100595)
 w(5721368:5755863) = u(14)*w(1066100:1100595)
 w(5755864:5781427) = u(15)*w(1075032:1100595)
 w(5781428:5800160) = u(16)*w(1081863:1100595)
 w(5800161:5813733) = u(17)*w(1087023:1100595)
 w(5813734:5823463) = u(18)*w(1090866:1100595)
 w(5823464:5830379) = u(19)*w(1093680:1100595)
 w(5830380:5835279) = u(20)*w(1095696:1100595)
 w(5835280:5838779) = u(21)*w(1097096:1100595)
 w(5838780:5841355) = u(22)*w(1098020:1100595)
 w(5841356:5843379) = u(23)*w(1098572:1100595)
endif
! terms of degree 8
if (8.le.mxd) then
 w(5843380:10586163) = u(0)*w(1100596:5843379)
 w(10586164:14414306) = u(1)*w(2015237:5843379)
 w(14414307:17486232) = u(2)*w(2771454:5843379)
 w(17486233:19936284) = u(3)*w(3393328:5843379)
 w(19936285:21877828) = u(4)*w(3901836:5843379)
 w(21877829:23406036) = u(5)*w(4315172:5843379)
 w(23406037:24600372) = u(6)*w(4649044:5843379)
 w(24600373:25526804) = u(7)*w(4916948:5843379)
 w(25526805:26239764) = u(8)*w(5130420:5843379)
 w(26239765:26783877) = u(9)*w(5299267:5843379)
 w(26783878:27195479) = u(10)*w(5431778:5843379)
 w(27195480:27503943) = u(11)*w(5534916:5843379)
 w(27503944:27732831) = u(12)*w(5614492:5843379)
 w(27732832:27900889) = u(13)*w(5675322:5843379)
 w(27900890:28022901) = u(14)*w(5721368:5843379)
 w(28022902:28110417) = u(15)*w(5755864:5843379)
 w(28110418:28172369) = u(16)*w(5781428:5843379)
 w(28172370:28215588) = u(17)*w(5800161:5843379)
 w(28215589:28245234) = u(18)*w(5813734:5843379)
 w(28245235:28265150) = u(19)*w(5823464:5843379)
 w(28265151:28278150) = u(20)*w(5830380:5843379)
 w(28278151:28286250) = u(21)*w(5835280:5843379)
 w(28286251:28290850) = u(22)*w(5838780:5843379)
 w(28290851:28292874) = u(23)*w(5841356:5843379)
 w(28292875:28294645) = u(24)*w(1098825:1100595)
 w(28294646:28296185) = u(25)*w(1099056:1100595)
 w(28296186:28297515) = u(26)*w(1099266:1100595)
 w(28297516:28298655) = u(27)*w(1099456:1100595)
 w(28298656:28299624) = u(28)*w(1099627:1100595)
 w(28299625:28300440) = u(29)*w(1099780:1100595)
 w(28300441:28301120) = u(30)*w(1099916:1100595)
 w(28301121:28301680) = u(31)*w(1100036:1100595)
 w(28301681:28302135) = u(32)*w(1100141:1100595)
 w(28302136:28302499) = u(33)*w(1100232:1100595)
 w(28302500:28302785) = u(34)*w(1100310:1100595)
 w(28302786:28303005) = u(35)*w(1100376:1100595)
 w(28303006:28303170) = u(36)*w(1100431:1100595)
 w(28303171:28303290) = u(37)*w(1100476:1100595)
 w(28303291:28303374) = u(38)*w(1100512:1100595)
 w(28303375:28303430) = u(39)*w(1100540:1100595)
 w(28303431:28303465) = u(40)*w(1100561:1100595)
 w(28303466:28303485) = u(41)*w(1100576:1100595)
 w(28303486:28303495) = u(42)*w(1100586:1100595)
 w(28303496:28303499) = u(43)*w(1100592:1100595)
 w(28303500) = u(44)*w(1100595)
endif
! terms of degree 9
if (9.le.mxd) then
 w(28303501:50763621) = u(0)*w(5843380:28303500)
 w(50763622:68480958) = u(1)*w(10586164:28303500)
 w(68480959:82370152) = u(2)*w(14414307:28303500)
 w(82370153:93187420) = u(3)*w(17486233:28303500)
 w(93187421:101554636) = u(4)*w(19936285:28303500)
 w(101554637:107980308) = u(5)*w(21877829:28303500)
 w(107980309:112877772) = u(6)*w(23406037:28303500)
 w(112877773:116580900) = u(7)*w(24600373:28303500)
 w(116580901:119357596) = u(8)*w(25526805:28303500)
 w(119357597:121421332) = u(9)*w(26239765:28303500)
 w(121421333:122940955) = u(10)*w(26783878:28303500)
 w(122940956:124048976) = u(11)*w(27195480:28303500)
 w(124048977:124848533) = u(12)*w(27503944:28303500)
 w(124848534:125419202) = u(13)*w(27732832:28303500)
 w(125419203:125821813) = u(14)*w(27900890:28303500)
 w(125821814:126102412) = u(15)*w(28022902:28303500)
 w(126102413:126295495) = u(16)*w(28110418:28303500)
 w(126295496:126426626) = u(17)*w(28172370:28303500)
 w(126426627:126514538) = u(18)*w(28215589:28303500)
 w(126514539:126572804) = u(19)*w(28245235:28303500)
 w(126572805:126611154) = u(20)*w(28265151:28303500)
 w(126611155:126636504) = u(21)*w(28278151:28303500)
 w(126636505:126653754) = u(22)*w(28286251:28303500)
 w(126653755:126666404) = u(23)*w(28290851:28303500)
endif
END SUBROUTINE mg2221111_prib
