SUBROUTINE mg2111111_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg2111111_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg2111111_prib: bad size u'
!! else if (size(w).ne.mg2111111_npb(mxd)) then
!!  stop 'mg2111111_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 22 6 0 0 0 0 0 0 0
! prib,  dnpb(0:*): 1 22 259 2156 14189 78386 377279 1622456 6348149 22908886
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
 w(10) = u(9)*w(0)
 w(11) = u(10)*w(0)
 w(12) = u(11)*w(0)
 w(13) = u(12)*w(0)
 w(14) = u(13)*w(0)
 w(15) = u(14)*w(0)
 w(16) = u(15)*w(0)
 w(17) = u(16)*w(0)
 w(18) = u(17)*w(0)
 w(19) = u(18)*w(0)
 w(20) = u(19)*w(0)
 w(21) = u(20)*w(0)
 w(22) = u(21)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(23:44) = u(0)*w(1:22)
 w(45:65) = u(1)*w(2:22)
 w(66:85) = u(2)*w(3:22)
 w(86:104) = u(3)*w(4:22)
 w(105:122) = u(4)*w(5:22)
 w(123:139) = u(5)*w(6:22)
 w(140:155) = u(6)*w(7:22)
 w(156:170) = u(7)*w(8:22)
 w(171:184) = u(8)*w(9:22)
 w(185:197) = u(9)*w(10:22)
 w(198:209) = u(10)*w(11:22)
 w(210:220) = u(11)*w(12:22)
 w(221:230) = u(12)*w(13:22)
 w(231:239) = u(13)*w(14:22)
 w(240:247) = u(14)*w(15:22)
 w(248:254) = u(15)*w(16:22)
 w(255:260) = u(16)*w(17:22)
 w(261:265) = u(17)*w(18:22)
 w(266:269) = u(18)*w(19:22)
 w(270:272) = u(19)*w(20:22)
 w(273:274) = u(20)*w(21:22)
 w(275) = u(21)*w(22)
 w(276) = u(22)*w(0)
 w(277) = u(23)*w(0)
 w(278) = u(24)*w(0)
 w(279) = u(25)*w(0)
 w(280) = u(26)*w(0)
 w(281) = u(27)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(282:540) = u(0)*w(23:281)
 w(541:777) = u(1)*w(45:281)
 w(778:993) = u(2)*w(66:281)
 w(994:1189) = u(3)*w(86:281)
 w(1190:1366) = u(4)*w(105:281)
 w(1367:1525) = u(5)*w(123:281)
 w(1526:1667) = u(6)*w(140:281)
 w(1668:1793) = u(7)*w(156:281)
 w(1794:1904) = u(8)*w(171:281)
 w(1905:2001) = u(9)*w(185:281)
 w(2002:2085) = u(10)*w(198:281)
 w(2086:2157) = u(11)*w(210:281)
 w(2158:2218) = u(12)*w(221:281)
 w(2219:2269) = u(13)*w(231:281)
 w(2270:2311) = u(14)*w(240:281)
 w(2312:2345) = u(15)*w(248:281)
 w(2346:2372) = u(16)*w(255:281)
 w(2373:2393) = u(17)*w(261:281)
 w(2394:2409) = u(18)*w(266:281)
 w(2410:2421) = u(19)*w(270:281)
 w(2422:2430) = u(20)*w(273:281)
 w(2431:2437) = u(21)*w(275:281)
endif
! terms of degree 4
if (4.le.mxd) then
 w(2438:4593) = u(0)*w(282:2437)
 w(4594:6490) = u(1)*w(541:2437)
 w(6491:8150) = u(2)*w(778:2437)
 w(8151:9594) = u(3)*w(994:2437)
 w(9595:10842) = u(4)*w(1190:2437)
 w(10843:11913) = u(5)*w(1367:2437)
 w(11914:12825) = u(6)*w(1526:2437)
 w(12826:13595) = u(7)*w(1668:2437)
 w(13596:14239) = u(8)*w(1794:2437)
 w(14240:14772) = u(9)*w(1905:2437)
 w(14773:15208) = u(10)*w(2002:2437)
 w(15209:15560) = u(11)*w(2086:2437)
 w(15561:15840) = u(12)*w(2158:2437)
 w(15841:16059) = u(13)*w(2219:2437)
 w(16060:16227) = u(14)*w(2270:2437)
 w(16228:16353) = u(15)*w(2312:2437)
 w(16354:16445) = u(16)*w(2346:2437)
 w(16446:16510) = u(17)*w(2373:2437)
 w(16511:16554) = u(18)*w(2394:2437)
 w(16555:16582) = u(19)*w(2410:2437)
 w(16583:16598) = u(20)*w(2422:2437)
 w(16599:16605) = u(21)*w(2431:2437)
 w(16606:16611) = u(22)*w(276:281)
 w(16612:16616) = u(23)*w(277:281)
 w(16617:16620) = u(24)*w(278:281)
 w(16621:16623) = u(25)*w(279:281)
 w(16624:16625) = u(26)*w(280:281)
 w(16626) = u(27)*w(281)
endif
! terms of degree 5
if (5.le.mxd) then
 w(16627:30815) = u(0)*w(2438:16626)
 w(30816:42848) = u(1)*w(4594:16626)
 w(42849:52984) = u(2)*w(6491:16626)
 w(52985:61460) = u(3)*w(8151:16626)
 w(61461:68492) = u(4)*w(9595:16626)
 w(68493:74276) = u(5)*w(10843:16626)
 w(74277:78989) = u(6)*w(11914:16626)
 w(78990:82790) = u(7)*w(12826:16626)
 w(82791:85821) = u(8)*w(13596:16626)
 w(85822:88208) = u(9)*w(14240:16626)
 w(88209:90062) = u(10)*w(14773:16626)
 w(90063:91480) = u(11)*w(15209:16626)
 w(91481:92546) = u(12)*w(15561:16626)
 w(92547:93332) = u(13)*w(15841:16626)
 w(93333:93899) = u(14)*w(16060:16626)
 w(93900:94298) = u(15)*w(16228:16626)
 w(94299:94571) = u(16)*w(16354:16626)
 w(94572:94752) = u(17)*w(16446:16626)
 w(94753:94868) = u(18)*w(16511:16626)
 w(94869:94940) = u(19)*w(16555:16626)
 w(94941:94984) = u(20)*w(16583:16626)
 w(94985:95012) = u(21)*w(16599:16626)
endif
! terms of degree 6
if (6.le.mxd) then
 w(95013:173398) = u(0)*w(16627:95012)
 w(173399:237595) = u(1)*w(30816:95012)
 w(237596:289759) = u(2)*w(42849:95012)
 w(289760:331787) = u(3)*w(52985:95012)
 w(331788:365339) = u(4)*w(61461:95012)
 w(365340:391859) = u(5)*w(68493:95012)
 w(391860:412595) = u(6)*w(74277:95012)
 w(412596:428618) = u(7)*w(78990:95012)
 w(428619:440840) = u(8)*w(82791:95012)
 w(440841:450031) = u(9)*w(85822:95012)
 w(450032:456835) = u(10)*w(88209:95012)
 w(456836:461785) = u(11)*w(90063:95012)
 w(461786:465317) = u(12)*w(91481:95012)
 w(465318:467783) = u(13)*w(92547:95012)
 w(467784:469463) = u(14)*w(93333:95012)
 w(469464:470576) = u(15)*w(93900:95012)
 w(470577:471290) = u(16)*w(94299:95012)
 w(471291:471731) = u(17)*w(94572:95012)
 w(471732:471991) = u(18)*w(94753:95012)
 w(471992:472135) = u(19)*w(94869:95012)
 w(472136:472207) = u(20)*w(94941:95012)
 w(472208:472235) = u(21)*w(94985:95012)
 w(472236:472256) = u(22)*w(16606:16626)
 w(472257:472271) = u(23)*w(16612:16626)
 w(472272:472281) = u(24)*w(16617:16626)
 w(472282:472287) = u(25)*w(16621:16626)
 w(472288:472290) = u(26)*w(16624:16626)
 w(472291) = u(27)*w(16626)
endif
! terms of degree 7
if (7.le.mxd) then
 w(472292:849570) = u(0)*w(95013:472291)
 w(849571:1148463) = u(1)*w(173399:472291)
 w(1148464:1383159) = u(2)*w(237596:472291)
 w(1383160:1565691) = u(3)*w(289760:472291)
 w(1565692:1706195) = u(4)*w(331788:472291)
 w(1706196:1813147) = u(5)*w(365340:472291)
 w(1813148:1893579) = u(6)*w(391860:472291)
 w(1893580:1953275) = u(7)*w(412596:472291)
 w(1953276:1996948) = u(8)*w(428619:472291)
 w(1996949:2028399) = u(9)*w(440841:472291)
 w(2028400:2050659) = u(10)*w(450032:472291)
 w(2050660:2066115) = u(11)*w(456836:472291)
 w(2066116:2076621) = u(12)*w(461786:472291)
 w(2076622:2083595) = u(13)*w(465318:472291)
 w(2083596:2088103) = u(14)*w(467784:472291)
 w(2088104:2090931) = u(15)*w(469464:472291)
 w(2090932:2092646) = u(16)*w(470577:472291)
 w(2092647:2093647) = u(17)*w(471291:472291)
 w(2093648:2094207) = u(18)*w(471732:472291)
 w(2094208:2094507) = u(19)*w(471992:472291)
 w(2094508:2094663) = u(20)*w(472136:472291)
 w(2094664:2094747) = u(21)*w(472208:472291)
endif
! terms of degree 8
if (8.le.mxd) then
 w(2094748:3717203) = u(0)*w(472292:2094747)
 w(3717204:4962380) = u(1)*w(849571:2094747)
 w(4962381:5908664) = u(2)*w(1148464:2094747)
 w(5908665:6620252) = u(3)*w(1383160:2094747)
 w(6620253:7149308) = u(4)*w(1565692:2094747)
 w(7149309:7537860) = u(5)*w(1706196:2094747)
 w(7537861:7819460) = u(6)*w(1813148:2094747)
 w(7819461:8020628) = u(7)*w(1893580:2094747)
 w(8020629:8162100) = u(8)*w(1953276:2094747)
 w(8162101:8259899) = u(9)*w(1996949:2094747)
 w(8259900:8326247) = u(10)*w(2028400:2094747)
 w(8326248:8370335) = u(11)*w(2050660:2094747)
 w(8370336:8398967) = u(12)*w(2066116:2094747)
 w(8398968:8417093) = u(13)*w(2076622:2094747)
 w(8417094:8428245) = u(14)*w(2083596:2094747)
 w(8428246:8434889) = u(15)*w(2088104:2094747)
 w(8434890:8438705) = u(16)*w(2090932:2094747)
 w(8438706:8440806) = u(17)*w(2092647:2094747)
 w(8440807:8441906) = u(18)*w(2093648:2094747)
 w(8441907:8442446) = u(19)*w(2094208:2094747)
 w(8442447:8442686) = u(20)*w(2094508:2094747)
 w(8442687:8442770) = u(21)*w(2094664:2094747)
 w(8442771:8442826) = u(22)*w(472236:472291)
 w(8442827:8442861) = u(23)*w(472257:472291)
 w(8442862:8442881) = u(24)*w(472272:472291)
 w(8442882:8442891) = u(25)*w(472282:472291)
 w(8442892:8442895) = u(26)*w(472288:472291)
 w(8442896) = u(27)*w(472291)
endif
! terms of degree 9
if (9.le.mxd) then
 w(8442897:14791045) = u(0)*w(2094748:8442896)
 w(14791046:19516738) = u(1)*w(3717204:8442896)
 w(19516739:22997254) = u(2)*w(4962381:8442896)
 w(22997255:25531486) = u(3)*w(5908665:8442896)
 w(25531487:27354130) = u(4)*w(6620253:8442896)
 w(27354131:28647718) = u(5)*w(7149309:8442896)
 w(28647719:29552754) = u(6)*w(7537861:8442896)
 w(29552755:30176190) = u(7)*w(7819461:8442896)
 w(30176191:30598458) = u(8)*w(8020629:8442896)
 w(30598459:30879254) = u(9)*w(8162101:8442896)
 w(30879255:31062251) = u(10)*w(8259900:8442896)
 w(31062252:31178900) = u(11)*w(8326248:8442896)
 w(31178901:31251461) = u(12)*w(8370336:8442896)
 w(31251462:31295390) = u(13)*w(8398968:8442896)
 w(31295391:31321193) = u(14)*w(8417094:8442896)
 w(31321194:31335844) = u(15)*w(8428246:8442896)
 w(31335845:31343851) = u(16)*w(8434890:8442896)
 w(31343852:31348042) = u(17)*w(8438706:8442896)
 w(31348043:31350132) = u(18)*w(8440807:8442896)
 w(31350133:31351122) = u(19)*w(8441907:8442896)
 w(31351123:31351572) = u(20)*w(8442447:8442896)
 w(31351573:31351782) = u(21)*w(8442687:8442896)
endif
END SUBROUTINE mg2111111_prib
