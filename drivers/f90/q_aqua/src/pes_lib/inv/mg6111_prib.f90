SUBROUTINE mg6111_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg6111_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg6111_prib: bad size u'
!! else if (size(w).ne.mg6111_npb(mxd)) then
!!  stop 'mg6111_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 7 5 7 6 6 5 0 0 0
! prib,  dnpb(0:*): 1 7 33 126 420 1266 3535 9271 23082 54969
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(8:14) = u(0)*w(1:7)
 w(15:20) = u(1)*w(2:7)
 w(21:25) = u(2)*w(3:7)
 w(26:29) = u(3)*w(4:7)
 w(30:32) = u(4)*w(5:7)
 w(33:34) = u(5)*w(6:7)
 w(35) = u(6)*w(7)
 w(36) = u(7)*w(0)
 w(37) = u(8)*w(0)
 w(38) = u(9)*w(0)
 w(39) = u(10)*w(0)
 w(40) = u(11)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(41:73) = u(0)*w(8:40)
 w(74:99) = u(1)*w(15:40)
 w(100:119) = u(2)*w(21:40)
 w(120:134) = u(3)*w(26:40)
 w(135:145) = u(4)*w(30:40)
 w(146:153) = u(5)*w(33:40)
 w(154:159) = u(6)*w(35:40)
 w(160) = u(12)*w(0)
 w(161) = u(13)*w(0)
 w(162) = u(14)*w(0)
 w(163) = u(15)*w(0)
 w(164) = u(16)*w(0)
 w(165) = u(17)*w(0)
 w(166) = u(18)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(167:292) = u(0)*w(41:166)
 w(293:385) = u(1)*w(74:166)
 w(386:452) = u(2)*w(100:166)
 w(453:499) = u(3)*w(120:166)
 w(500:531) = u(4)*w(135:166)
 w(532:552) = u(5)*w(146:166)
 w(553:565) = u(6)*w(154:166)
 w(566:570) = u(7)*w(36:40)
 w(571:574) = u(8)*w(37:40)
 w(575:577) = u(9)*w(38:40)
 w(578:579) = u(10)*w(39:40)
 w(580) = u(11)*w(40)
 w(581) = u(19)*w(0)
 w(582) = u(20)*w(0)
 w(583) = u(21)*w(0)
 w(584) = u(22)*w(0)
 w(585) = u(23)*w(0)
 w(586) = u(24)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(587:1006) = u(0)*w(167:586)
 w(1007:1300) = u(1)*w(293:586)
 w(1301:1501) = u(2)*w(386:586)
 w(1502:1635) = u(3)*w(453:586)
 w(1636:1722) = u(4)*w(500:586)
 w(1723:1777) = u(5)*w(532:586)
 w(1778:1811) = u(6)*w(553:586)
 w(1812:1818) = u(7)*w(160:166)
 w(1819:1825) = u(8)*w(160:166)
 w(1826:1832) = u(9)*w(160:166)
 w(1833:1839) = u(10)*w(160:166)
 w(1840:1846) = u(11)*w(160:166)
 w(1847) = u(25)*w(0)
 w(1848) = u(26)*w(0)
 w(1849) = u(27)*w(0)
 w(1850) = u(28)*w(0)
 w(1851) = u(29)*w(0)
 w(1852) = u(30)*w(0)
endif
! terms of degree 6
if (6.le.mxd) then
 w(1853:3118) = u(0)*w(587:1852)
 w(3119:3964) = u(1)*w(1007:1852)
 w(3965:4516) = u(2)*w(1301:1852)
 w(4517:4867) = u(3)*w(1502:1852)
 w(4868:5084) = u(4)*w(1636:1852)
 w(5085:5214) = u(5)*w(1723:1852)
 w(5215:5289) = u(6)*w(1778:1852)
 w(5290:5310) = u(7)*w(566:586)
 w(5311:5326) = u(8)*w(571:586)
 w(5327:5338) = u(9)*w(575:586)
 w(5339:5347) = u(10)*w(578:586)
 w(5348:5354) = u(11)*w(580:586)
 w(5355:5361) = u(12)*w(160:166)
 w(5362:5367) = u(13)*w(161:166)
 w(5368:5372) = u(14)*w(162:166)
 w(5373:5376) = u(15)*w(163:166)
 w(5377:5379) = u(16)*w(164:166)
 w(5380:5381) = u(17)*w(165:166)
 w(5382) = u(18)*w(166)
 w(5383) = u(31)*w(0)
 w(5384) = u(32)*w(0)
 w(5385) = u(33)*w(0)
 w(5386) = u(34)*w(0)
 w(5387) = u(35)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(5388:8922) = u(0)*w(1853:5387)
 w(8923:11191) = u(1)*w(3119:5387)
 w(11192:12614) = u(2)*w(3965:5387)
 w(12615:13485) = u(3)*w(4517:5387)
 w(13486:14005) = u(4)*w(4868:5387)
 w(14006:14308) = u(5)*w(5085:5387)
 w(14309:14481) = u(6)*w(5215:5387)
 w(14482:14522) = u(7)*w(1812:1852)
 w(14523:14556) = u(8)*w(1819:1852)
 w(14557:14583) = u(9)*w(1826:1852)
 w(14584:14603) = u(10)*w(1833:1852)
 w(14604:14616) = u(11)*w(1840:1852)
 w(14617:14622) = u(12)*w(581:586)
 w(14623:14628) = u(13)*w(581:586)
 w(14629:14634) = u(14)*w(581:586)
 w(14635:14640) = u(15)*w(581:586)
 w(14641:14646) = u(16)*w(581:586)
 w(14647:14652) = u(17)*w(581:586)
 w(14653:14658) = u(18)*w(581:586)
endif
! terms of degree 8
if (8.le.mxd) then
 w(14659:23929) = u(0)*w(5388:14658)
 w(23930:29665) = u(1)*w(8923:14658)
 w(29666:33132) = u(2)*w(11192:14658)
 w(33133:35176) = u(3)*w(12615:14658)
 w(35177:36349) = u(4)*w(13486:14658)
 w(36350:37002) = u(5)*w(14006:14658)
 w(37003:37352) = u(6)*w(14309:14658)
 w(37353:37450) = u(7)*w(5290:5387)
 w(37451:37527) = u(8)*w(5311:5387)
 w(37528:37588) = u(9)*w(5327:5387)
 w(37589:37637) = u(10)*w(5339:5387)
 w(37638:37677) = u(11)*w(5348:5387)
 w(37678:37683) = u(12)*w(1847:1852)
 w(37684:37689) = u(13)*w(1847:1852)
 w(37690:37695) = u(14)*w(1847:1852)
 w(37696:37701) = u(15)*w(1847:1852)
 w(37702:37707) = u(16)*w(1847:1852)
 w(37708:37713) = u(17)*w(1847:1852)
 w(37714:37719) = u(18)*w(1847:1852)
 w(37720:37725) = u(19)*w(581:586)
 w(37726:37730) = u(20)*w(582:586)
 w(37731:37734) = u(21)*w(583:586)
 w(37735:37737) = u(22)*w(584:586)
 w(37738:37739) = u(23)*w(585:586)
 w(37740) = u(24)*w(586)
endif
! terms of degree 9
if (9.le.mxd) then
 w(37741:60822) = u(0)*w(14659:37740)
 w(60823:74633) = u(1)*w(23930:37740)
 w(74634:82708) = u(2)*w(29666:37740)
 w(82709:87316) = u(3)*w(33133:37740)
 w(87317:89880) = u(4)*w(35177:37740)
 w(89881:91271) = u(5)*w(36350:37740)
 w(91272:92009) = u(6)*w(37003:37740)
 w(92010:92186) = u(7)*w(14482:14658)
 w(92187:92322) = u(8)*w(14523:14658)
 w(92323:92424) = u(9)*w(14557:14658)
 w(92425:92499) = u(10)*w(14584:14658)
 w(92500:92554) = u(11)*w(14604:14658)
 w(92555:92587) = u(12)*w(5355:5387)
 w(92588:92613) = u(13)*w(5362:5387)
 w(92614:92633) = u(14)*w(5368:5387)
 w(92634:92648) = u(15)*w(5373:5387)
 w(92649:92659) = u(16)*w(5377:5387)
 w(92660:92667) = u(17)*w(5380:5387)
 w(92668:92673) = u(18)*w(5382:5387)
 w(92674:92679) = u(19)*w(1847:1852)
 w(92680:92685) = u(20)*w(1847:1852)
 w(92686:92691) = u(21)*w(1847:1852)
 w(92692:92697) = u(22)*w(1847:1852)
 w(92698:92703) = u(23)*w(1847:1852)
 w(92704:92709) = u(24)*w(1847:1852)
endif
END SUBROUTINE mg6111_prib
