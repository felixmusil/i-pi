SUBROUTINE mg22222_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg22222_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg22222_prib: bad size u'
!! else if (size(w).ne.mg22222_npb(mxd)) then
!!  stop 'mg22222_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 15 30 0 0 0 0 0 0 0
! prib,  dnpb(0:*): 1 15 150 1130 7125 39003 191320 855720 3541590 13699210
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
 w(10) = u(9)*w(0)
 w(11) = u(10)*w(0)
 w(12) = u(11)*w(0)
 w(13) = u(12)*w(0)
 w(14) = u(13)*w(0)
 w(15) = u(14)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(16:30) = u(0)*w(1:15)
 w(31:44) = u(1)*w(2:15)
 w(45:57) = u(2)*w(3:15)
 w(58:69) = u(3)*w(4:15)
 w(70:80) = u(4)*w(5:15)
 w(81:90) = u(5)*w(6:15)
 w(91:99) = u(6)*w(7:15)
 w(100:107) = u(7)*w(8:15)
 w(108:114) = u(8)*w(9:15)
 w(115:120) = u(9)*w(10:15)
 w(121:125) = u(10)*w(11:15)
 w(126:129) = u(11)*w(12:15)
 w(130:132) = u(12)*w(13:15)
 w(133:134) = u(13)*w(14:15)
 w(135) = u(14)*w(15)
 w(136) = u(15)*w(0)
 w(137) = u(16)*w(0)
 w(138) = u(17)*w(0)
 w(139) = u(18)*w(0)
 w(140) = u(19)*w(0)
 w(141) = u(20)*w(0)
 w(142) = u(21)*w(0)
 w(143) = u(22)*w(0)
 w(144) = u(23)*w(0)
 w(145) = u(24)*w(0)
 w(146) = u(25)*w(0)
 w(147) = u(26)*w(0)
 w(148) = u(27)*w(0)
 w(149) = u(28)*w(0)
 w(150) = u(29)*w(0)
 w(151) = u(30)*w(0)
 w(152) = u(31)*w(0)
 w(153) = u(32)*w(0)
 w(154) = u(33)*w(0)
 w(155) = u(34)*w(0)
 w(156) = u(35)*w(0)
 w(157) = u(36)*w(0)
 w(158) = u(37)*w(0)
 w(159) = u(38)*w(0)
 w(160) = u(39)*w(0)
 w(161) = u(40)*w(0)
 w(162) = u(41)*w(0)
 w(163) = u(42)*w(0)
 w(164) = u(43)*w(0)
 w(165) = u(44)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(166:315) = u(0)*w(16:165)
 w(316:450) = u(1)*w(31:165)
 w(451:571) = u(2)*w(45:165)
 w(572:679) = u(3)*w(58:165)
 w(680:775) = u(4)*w(70:165)
 w(776:860) = u(5)*w(81:165)
 w(861:935) = u(6)*w(91:165)
 w(936:1001) = u(7)*w(100:165)
 w(1002:1059) = u(8)*w(108:165)
 w(1060:1110) = u(9)*w(115:165)
 w(1111:1155) = u(10)*w(121:165)
 w(1156:1195) = u(11)*w(126:165)
 w(1196:1231) = u(12)*w(130:165)
 w(1232:1264) = u(13)*w(133:165)
 w(1265:1295) = u(14)*w(135:165)
endif
! terms of degree 4
if (4.le.mxd) then
 w(1296:2425) = u(0)*w(166:1295)
 w(2426:3405) = u(1)*w(316:1295)
 w(3406:4250) = u(2)*w(451:1295)
 w(4251:4974) = u(3)*w(572:1295)
 w(4975:5590) = u(4)*w(680:1295)
 w(5591:6110) = u(5)*w(776:1295)
 w(6111:6545) = u(6)*w(861:1295)
 w(6546:6905) = u(7)*w(936:1295)
 w(6906:7199) = u(8)*w(1002:1295)
 w(7200:7435) = u(9)*w(1060:1295)
 w(7436:7620) = u(10)*w(1111:1295)
 w(7621:7760) = u(11)*w(1156:1295)
 w(7761:7860) = u(12)*w(1196:1295)
 w(7861:7924) = u(13)*w(1232:1295)
 w(7925:7955) = u(14)*w(1265:1295)
 w(7956:7985) = u(15)*w(136:165)
 w(7986:8014) = u(16)*w(137:165)
 w(8015:8042) = u(17)*w(138:165)
 w(8043:8069) = u(18)*w(139:165)
 w(8070:8095) = u(19)*w(140:165)
 w(8096:8120) = u(20)*w(141:165)
 w(8121:8144) = u(21)*w(142:165)
 w(8145:8167) = u(22)*w(143:165)
 w(8168:8189) = u(23)*w(144:165)
 w(8190:8210) = u(24)*w(145:165)
 w(8211:8230) = u(25)*w(146:165)
 w(8231:8249) = u(26)*w(147:165)
 w(8250:8267) = u(27)*w(148:165)
 w(8268:8284) = u(28)*w(149:165)
 w(8285:8300) = u(29)*w(150:165)
 w(8301:8315) = u(30)*w(151:165)
 w(8316:8329) = u(31)*w(152:165)
 w(8330:8342) = u(32)*w(153:165)
 w(8343:8354) = u(33)*w(154:165)
 w(8355:8365) = u(34)*w(155:165)
 w(8366:8375) = u(35)*w(156:165)
 w(8376:8384) = u(36)*w(157:165)
 w(8385:8392) = u(37)*w(158:165)
 w(8393:8399) = u(38)*w(159:165)
 w(8400:8405) = u(39)*w(160:165)
 w(8406:8410) = u(40)*w(161:165)
 w(8411:8414) = u(41)*w(162:165)
 w(8415:8417) = u(42)*w(163:165)
 w(8418:8419) = u(43)*w(164:165)
 w(8420) = u(44)*w(165)
endif
! terms of degree 5
if (5.le.mxd) then
 w(8421:15545) = u(0)*w(1296:8420)
 w(15546:21540) = u(1)*w(2426:8420)
 w(21541:26555) = u(2)*w(3406:8420)
 w(26556:30725) = u(3)*w(4251:8420)
 w(30726:34171) = u(4)*w(4975:8420)
 w(34172:37001) = u(5)*w(5591:8420)
 w(37002:39311) = u(6)*w(6111:8420)
 w(39312:41186) = u(7)*w(6546:8420)
 w(41187:42701) = u(8)*w(6906:8420)
 w(42702:43922) = u(9)*w(7200:8420)
 w(43923:44907) = u(10)*w(7436:8420)
 w(44908:45707) = u(11)*w(7621:8420)
 w(45708:46367) = u(12)*w(7761:8420)
 w(46368:46927) = u(13)*w(7861:8420)
 w(46928:47423) = u(14)*w(7925:8420)
endif
! terms of degree 6
if (6.le.mxd) then
 w(47424:86426) = u(0)*w(8421:47423)
 w(86427:118304) = u(1)*w(15546:47423)
 w(118305:144187) = u(2)*w(21541:47423)
 w(144188:165055) = u(3)*w(26556:47423)
 w(165056:181753) = u(4)*w(30726:47423)
 w(181754:195005) = u(5)*w(34172:47423)
 w(195006:205427) = u(6)*w(37002:47423)
 w(205428:213539) = u(7)*w(39312:47423)
 w(213540:219776) = u(8)*w(41187:47423)
 w(219777:224498) = u(9)*w(42702:47423)
 w(224499:227999) = u(10)*w(43923:47423)
 w(228000:230515) = u(11)*w(44908:47423)
 w(230516:232231) = u(12)*w(45708:47423)
 w(232232:233287) = u(13)*w(46368:47423)
 w(233288:233783) = u(14)*w(46928:47423)
 w(233784:234248) = u(15)*w(7956:8420)
 w(234249:234683) = u(16)*w(7986:8420)
 w(234684:235089) = u(17)*w(8015:8420)
 w(235090:235467) = u(18)*w(8043:8420)
 w(235468:235818) = u(19)*w(8070:8420)
 w(235819:236143) = u(20)*w(8096:8420)
 w(236144:236443) = u(21)*w(8121:8420)
 w(236444:236719) = u(22)*w(8145:8420)
 w(236720:236972) = u(23)*w(8168:8420)
 w(236973:237203) = u(24)*w(8190:8420)
 w(237204:237413) = u(25)*w(8211:8420)
 w(237414:237603) = u(26)*w(8231:8420)
 w(237604:237774) = u(27)*w(8250:8420)
 w(237775:237927) = u(28)*w(8268:8420)
 w(237928:238063) = u(29)*w(8285:8420)
 w(238064:238183) = u(30)*w(8301:8420)
 w(238184:238288) = u(31)*w(8316:8420)
 w(238289:238379) = u(32)*w(8330:8420)
 w(238380:238457) = u(33)*w(8343:8420)
 w(238458:238523) = u(34)*w(8355:8420)
 w(238524:238578) = u(35)*w(8366:8420)
 w(238579:238623) = u(36)*w(8376:8420)
 w(238624:238659) = u(37)*w(8385:8420)
 w(238660:238687) = u(38)*w(8393:8420)
 w(238688:238708) = u(39)*w(8400:8420)
 w(238709:238723) = u(40)*w(8406:8420)
 w(238724:238733) = u(41)*w(8411:8420)
 w(238734:238739) = u(42)*w(8415:8420)
 w(238740:238742) = u(43)*w(8418:8420)
 w(238743) = u(44)*w(8420)
endif
! terms of degree 7
if (7.le.mxd) then
 w(238744:430063) = u(0)*w(47424:238743)
 w(430064:582380) = u(1)*w(86427:238743)
 w(582381:702819) = u(2)*w(118305:238743)
 w(702820:797375) = u(3)*w(144188:238743)
 w(797376:871063) = u(4)*w(165056:238743)
 w(871064:928053) = u(5)*w(181754:238743)
 w(928054:971791) = u(6)*w(195006:238743)
 w(971792:1005107) = u(7)*w(205428:238743)
 w(1005108:1030311) = u(8)*w(213540:238743)
 w(1030312:1049278) = u(9)*w(219777:238743)
 w(1049279:1063523) = u(10)*w(224499:238743)
 w(1063524:1074267) = u(11)*w(228000:238743)
 w(1074268:1082495) = u(12)*w(230516:238743)
 w(1082496:1089007) = u(13)*w(232232:238743)
 w(1089008:1094463) = u(14)*w(233288:238743)
endif
! terms of degree 8
if (8.le.mxd) then
 w(1094464:1950183) = u(0)*w(238744:1094463)
 w(1950184:2614583) = u(1)*w(430064:1094463)
 w(2614584:3126666) = u(2)*w(582381:1094463)
 w(3126667:3518310) = u(3)*w(702820:1094463)
 w(3518311:3815398) = u(4)*w(797376:1094463)
 w(3815399:4038798) = u(5)*w(871064:1094463)
 w(4038799:4205208) = u(6)*w(928054:1094463)
 w(4205209:4327880) = u(7)*w(971792:1094463)
 w(4327881:4417236) = u(8)*w(1005108:1094463)
 w(4417237:4481388) = u(9)*w(1030312:1094463)
 w(4481389:4526573) = u(10)*w(1049279:1094463)
 w(4526574:4557513) = u(11)*w(1063524:1094463)
 w(4557514:4577709) = u(12)*w(1074268:1094463)
 w(4577710:4589677) = u(13)*w(1082496:1094463)
 w(4589678:4595133) = u(14)*w(1089008:1094463)
 w(4595134:4600093) = u(15)*w(233784:238743)
 w(4600094:4604588) = u(16)*w(234249:238743)
 w(4604589:4608648) = u(17)*w(234684:238743)
 w(4608649:4612302) = u(18)*w(235090:238743)
 w(4612303:4615578) = u(19)*w(235468:238743)
 w(4615579:4618503) = u(20)*w(235819:238743)
 w(4618504:4621103) = u(21)*w(236144:238743)
 w(4621104:4623403) = u(22)*w(236444:238743)
 w(4623404:4625427) = u(23)*w(236720:238743)
 w(4625428:4627198) = u(24)*w(236973:238743)
 w(4627199:4628738) = u(25)*w(237204:238743)
 w(4628739:4630068) = u(26)*w(237414:238743)
 w(4630069:4631208) = u(27)*w(237604:238743)
 w(4631209:4632177) = u(28)*w(237775:238743)
 w(4632178:4632993) = u(29)*w(237928:238743)
 w(4632994:4633673) = u(30)*w(238064:238743)
 w(4633674:4634233) = u(31)*w(238184:238743)
 w(4634234:4634688) = u(32)*w(238289:238743)
 w(4634689:4635052) = u(33)*w(238380:238743)
 w(4635053:4635338) = u(34)*w(238458:238743)
 w(4635339:4635558) = u(35)*w(238524:238743)
 w(4635559:4635723) = u(36)*w(238579:238743)
 w(4635724:4635843) = u(37)*w(238624:238743)
 w(4635844:4635927) = u(38)*w(238660:238743)
 w(4635928:4635983) = u(39)*w(238688:238743)
 w(4635984:4636018) = u(40)*w(238709:238743)
 w(4636019:4636038) = u(41)*w(238724:238743)
 w(4636039:4636048) = u(42)*w(238734:238743)
 w(4636049:4636052) = u(43)*w(238740:238743)
 w(4636053) = u(44)*w(238743)
endif
! terms of degree 9
if (9.le.mxd) then
 w(4636054:8177643) = u(0)*w(1094464:4636053)
 w(8177644:10863513) = u(1)*w(1950184:4636053)
 w(10863514:12884983) = u(2)*w(2614584:4636053)
 w(12884984:14394370) = u(3)*w(3126667:4636053)
 w(14394371:15512113) = u(4)*w(3518311:4636053)
 w(15512114:16332768) = u(5)*w(3815399:4636053)
 w(16332769:16930023) = u(6)*w(4038799:4636053)
 w(16930024:17360868) = u(7)*w(4205209:4636053)
 w(17360869:17669041) = u(8)*w(4327881:4636053)
 w(17669042:17887858) = u(9)*w(4417237:4636053)
 w(17887859:18042523) = u(10)*w(4481389:4636053)
 w(18042524:18152003) = u(11)*w(4526574:4636053)
 w(18152004:18230543) = u(12)*w(4557514:4636053)
 w(18230544:18288887) = u(13)*w(4577710:4636053)
 w(18288888:18335263) = u(14)*w(4589678:4636053)
endif
END SUBROUTINE mg22222_prib
