SUBROUTINE mg4211_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg4211_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg4211_prib: bad size u'
!! else if (size(w).ne.mg4211_npb(mxd)) then
!!  stop 'mg4211_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 8 9 5 5 0 1 0 0 0
! prib,  dnpb(0:*): 1 8 45 197 744 2497 7672 21888 58754 149600
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(9:16) = u(0)*w(1:8)
 w(17:23) = u(1)*w(2:8)
 w(24:29) = u(2)*w(3:8)
 w(30:34) = u(3)*w(4:8)
 w(35:38) = u(4)*w(5:8)
 w(39:41) = u(5)*w(6:8)
 w(42:43) = u(6)*w(7:8)
 w(44) = u(7)*w(8)
 w(45) = u(8)*w(0)
 w(46) = u(9)*w(0)
 w(47) = u(10)*w(0)
 w(48) = u(11)*w(0)
 w(49) = u(12)*w(0)
 w(50) = u(13)*w(0)
 w(51) = u(14)*w(0)
 w(52) = u(15)*w(0)
 w(53) = u(16)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(54:98) = u(0)*w(9:53)
 w(99:135) = u(1)*w(17:53)
 w(136:165) = u(2)*w(24:53)
 w(166:189) = u(3)*w(30:53)
 w(190:208) = u(4)*w(35:53)
 w(209:223) = u(5)*w(39:53)
 w(224:235) = u(6)*w(42:53)
 w(236:245) = u(7)*w(44:53)
 w(246) = u(17)*w(0)
 w(247) = u(18)*w(0)
 w(248) = u(19)*w(0)
 w(249) = u(20)*w(0)
 w(250) = u(21)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(251:447) = u(0)*w(54:250)
 w(448:599) = u(1)*w(99:250)
 w(600:714) = u(2)*w(136:250)
 w(715:799) = u(3)*w(166:250)
 w(800:860) = u(4)*w(190:250)
 w(861:902) = u(5)*w(209:250)
 w(903:929) = u(6)*w(224:250)
 w(930:944) = u(7)*w(236:250)
 w(945:953) = u(8)*w(45:53)
 w(954:961) = u(9)*w(46:53)
 w(962:968) = u(10)*w(47:53)
 w(969:974) = u(11)*w(48:53)
 w(975:979) = u(12)*w(49:53)
 w(980:983) = u(13)*w(50:53)
 w(984:986) = u(14)*w(51:53)
 w(987:988) = u(15)*w(52:53)
 w(989) = u(16)*w(53)
 w(990) = u(22)*w(0)
 w(991) = u(23)*w(0)
 w(992) = u(24)*w(0)
 w(993) = u(25)*w(0)
 w(994) = u(26)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(995:1738) = u(0)*w(251:994)
 w(1739:2285) = u(1)*w(448:994)
 w(2286:2680) = u(2)*w(600:994)
 w(2681:2960) = u(3)*w(715:994)
 w(2961:3155) = u(4)*w(800:994)
 w(3156:3289) = u(5)*w(861:994)
 w(3290:3381) = u(6)*w(903:994)
 w(3382:3446) = u(7)*w(930:994)
 w(3447:3451) = u(8)*w(246:250)
 w(3452:3456) = u(9)*w(246:250)
 w(3457:3461) = u(10)*w(246:250)
 w(3462:3466) = u(11)*w(246:250)
 w(3467:3471) = u(12)*w(246:250)
 w(3472:3476) = u(13)*w(246:250)
 w(3477:3481) = u(14)*w(246:250)
 w(3482:3486) = u(15)*w(246:250)
 w(3487:3491) = u(16)*w(246:250)
endif
! terms of degree 6
if (6.le.mxd) then
 w(3492:5988) = u(0)*w(995:3491)
 w(5989:7741) = u(1)*w(1739:3491)
 w(7742:8947) = u(2)*w(2286:3491)
 w(8948:9758) = u(3)*w(2681:3491)
 w(9759:10289) = u(4)*w(2961:3491)
 w(10290:10625) = u(5)*w(3156:3491)
 w(10626:10827) = u(6)*w(3290:3491)
 w(10828:10937) = u(7)*w(3382:3491)
 w(10938:10987) = u(8)*w(945:994)
 w(10988:11028) = u(9)*w(954:994)
 w(11029:11061) = u(10)*w(962:994)
 w(11062:11087) = u(11)*w(969:994)
 w(11088:11107) = u(12)*w(975:994)
 w(11108:11122) = u(13)*w(980:994)
 w(11123:11133) = u(14)*w(984:994)
 w(11134:11141) = u(15)*w(987:994)
 w(11142:11147) = u(16)*w(989:994)
 w(11148:11152) = u(17)*w(246:250)
 w(11153:11156) = u(18)*w(247:250)
 w(11157:11159) = u(19)*w(248:250)
 w(11160:11161) = u(20)*w(249:250)
 w(11162) = u(21)*w(250)
 w(11163) = u(27)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(11164:18835) = u(0)*w(3492:11163)
 w(18836:24010) = u(1)*w(5989:11163)
 w(24011:27432) = u(2)*w(7742:11163)
 w(27433:29648) = u(3)*w(8948:11163)
 w(29649:31053) = u(4)*w(9759:11163)
 w(31054:31927) = u(5)*w(10290:11163)
 w(31928:32465) = u(6)*w(10626:11163)
 w(32466:32801) = u(7)*w(10828:11163)
 w(32802:32846) = u(8)*w(3447:3491)
 w(32847:32886) = u(9)*w(3452:3491)
 w(32887:32921) = u(10)*w(3457:3491)
 w(32922:32951) = u(11)*w(3462:3491)
 w(32952:32976) = u(12)*w(3467:3491)
 w(32977:32996) = u(13)*w(3472:3491)
 w(32997:33011) = u(14)*w(3477:3491)
 w(33012:33021) = u(15)*w(3482:3491)
 w(33022:33026) = u(16)*w(3487:3491)
 w(33027:33031) = u(17)*w(990:994)
 w(33032:33036) = u(18)*w(990:994)
 w(33037:33041) = u(19)*w(990:994)
 w(33042:33046) = u(20)*w(990:994)
 w(33047:33051) = u(21)*w(990:994)
endif
! terms of degree 8
if (8.le.mxd) then
 w(33052:54939) = u(0)*w(11164:33051)
 w(54940:69155) = u(1)*w(18836:33051)
 w(69156:78196) = u(2)*w(24011:33051)
 w(78197:83815) = u(3)*w(27433:33051)
 w(83816:87218) = u(4)*w(29649:33051)
 w(87219:89216) = u(5)*w(31054:33051)
 w(89217:90340) = u(6)*w(31928:33051)
 w(90341:90926) = u(7)*w(32466:33051)
 w(90927:91152) = u(8)*w(10938:11163)
 w(91153:91328) = u(9)*w(10988:11163)
 w(91329:91463) = u(10)*w(11029:11163)
 w(91464:91565) = u(11)*w(11062:11163)
 w(91566:91641) = u(12)*w(11088:11163)
 w(91642:91697) = u(13)*w(11108:11163)
 w(91698:91738) = u(14)*w(11123:11163)
 w(91739:91768) = u(15)*w(11134:11163)
 w(91769:91790) = u(16)*w(11142:11163)
 w(91791:91795) = u(22)*w(990:994)
 w(91796:91799) = u(23)*w(991:994)
 w(91800:91802) = u(24)*w(992:994)
 w(91803:91804) = u(25)*w(993:994)
 w(91805) = u(26)*w(994)
endif
! terms of degree 9
if (9.le.mxd) then
 w(91806:150559) = u(0)*w(33052:91805)
 w(150560:187425) = u(1)*w(54940:91805)
 w(187426:210075) = u(2)*w(69156:91805)
 w(210076:223684) = u(3)*w(78197:91805)
 w(223685:231674) = u(4)*w(83816:91805)
 w(231675:236261) = u(5)*w(87219:91805)
 w(236262:238850) = u(6)*w(89217:91805)
 w(238851:240315) = u(7)*w(90341:91805)
 w(240316:240565) = u(8)*w(32802:33051)
 w(240566:240770) = u(9)*w(32847:33051)
 w(240771:240935) = u(10)*w(32887:33051)
 w(240936:241065) = u(11)*w(32922:33051)
 w(241066:241165) = u(12)*w(32952:33051)
 w(241166:241240) = u(13)*w(32977:33051)
 w(241241:241295) = u(14)*w(32997:33051)
 w(241296:241335) = u(15)*w(33012:33051)
 w(241336:241365) = u(16)*w(33022:33051)
 w(241366:241381) = u(17)*w(11148:11163)
 w(241382:241392) = u(18)*w(11153:11163)
 w(241393:241399) = u(19)*w(11157:11163)
 w(241400:241403) = u(20)*w(11160:11163)
 w(241404:241405) = u(21)*w(11162:11163)
endif
END SUBROUTINE mg4211_prib
