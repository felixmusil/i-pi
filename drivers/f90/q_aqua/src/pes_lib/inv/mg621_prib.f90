SUBROUTINE mg621_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg621_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg621_prib: bad size u'
!! else if (size(w).ne.mg621_npb(mxd)) then
!!  stop 'mg621_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 5 7 7 6 5 5 0 0 0
! prib,  dnpb(0:*): 1 5 22 77 244 700 1884 4770 11532 26715
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(6:10) = u(0)*w(1:5)
 w(11:14) = u(1)*w(2:5)
 w(15:17) = u(2)*w(3:5)
 w(18:19) = u(3)*w(4:5)
 w(20) = u(4)*w(5)
 w(21) = u(5)*w(0)
 w(22) = u(6)*w(0)
 w(23) = u(7)*w(0)
 w(24) = u(8)*w(0)
 w(25) = u(9)*w(0)
 w(26) = u(10)*w(0)
 w(27) = u(11)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(28:49) = u(0)*w(6:27)
 w(50:66) = u(1)*w(11:27)
 w(67:79) = u(2)*w(15:27)
 w(80:89) = u(3)*w(18:27)
 w(90:97) = u(4)*w(20:27)
 w(98) = u(12)*w(0)
 w(99) = u(13)*w(0)
 w(100) = u(14)*w(0)
 w(101) = u(15)*w(0)
 w(102) = u(16)*w(0)
 w(103) = u(17)*w(0)
 w(104) = u(18)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(105:181) = u(0)*w(28:104)
 w(182:236) = u(1)*w(50:104)
 w(237:274) = u(2)*w(67:104)
 w(275:299) = u(3)*w(80:104)
 w(300:314) = u(4)*w(90:104)
 w(315:321) = u(5)*w(21:27)
 w(322:327) = u(6)*w(22:27)
 w(328:332) = u(7)*w(23:27)
 w(333:336) = u(8)*w(24:27)
 w(337:339) = u(9)*w(25:27)
 w(340:341) = u(10)*w(26:27)
 w(342) = u(11)*w(27)
 w(343) = u(19)*w(0)
 w(344) = u(20)*w(0)
 w(345) = u(21)*w(0)
 w(346) = u(22)*w(0)
 w(347) = u(23)*w(0)
 w(348) = u(24)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(349:592) = u(0)*w(105:348)
 w(593:759) = u(1)*w(182:348)
 w(760:871) = u(2)*w(237:348)
 w(872:945) = u(3)*w(275:348)
 w(946:994) = u(4)*w(300:348)
 w(995:1001) = u(5)*w(98:104)
 w(1002:1008) = u(6)*w(98:104)
 w(1009:1015) = u(7)*w(98:104)
 w(1016:1022) = u(8)*w(98:104)
 w(1023:1029) = u(9)*w(98:104)
 w(1030:1036) = u(10)*w(98:104)
 w(1037:1043) = u(11)*w(98:104)
 w(1044) = u(25)*w(0)
 w(1045) = u(26)*w(0)
 w(1046) = u(27)*w(0)
 w(1047) = u(28)*w(0)
 w(1048) = u(29)*w(0)
endif
! terms of degree 6
if (6.le.mxd) then
 w(1049:1748) = u(0)*w(349:1048)
 w(1749:2204) = u(1)*w(593:1048)
 w(2205:2493) = u(2)*w(760:1048)
 w(2494:2670) = u(3)*w(872:1048)
 w(2671:2773) = u(4)*w(946:1048)
 w(2774:2807) = u(5)*w(315:348)
 w(2808:2834) = u(6)*w(322:348)
 w(2835:2855) = u(7)*w(328:348)
 w(2856:2871) = u(8)*w(333:348)
 w(2872:2883) = u(9)*w(337:348)
 w(2884:2892) = u(10)*w(340:348)
 w(2893:2899) = u(11)*w(342:348)
 w(2900:2906) = u(12)*w(98:104)
 w(2907:2912) = u(13)*w(99:104)
 w(2913:2917) = u(14)*w(100:104)
 w(2918:2921) = u(15)*w(101:104)
 w(2922:2924) = u(16)*w(102:104)
 w(2925:2926) = u(17)*w(103:104)
 w(2927) = u(18)*w(104)
 w(2928) = u(30)*w(0)
 w(2929) = u(31)*w(0)
 w(2930) = u(32)*w(0)
 w(2931) = u(33)*w(0)
 w(2932) = u(34)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(2933:4816) = u(0)*w(1049:2932)
 w(4817:6000) = u(1)*w(1749:2932)
 w(6001:6728) = u(2)*w(2205:2932)
 w(6729:7167) = u(3)*w(2494:2932)
 w(7168:7429) = u(4)*w(2671:2932)
 w(7430:7483) = u(5)*w(995:1048)
 w(7484:7530) = u(6)*w(1002:1048)
 w(7531:7570) = u(7)*w(1009:1048)
 w(7571:7603) = u(8)*w(1016:1048)
 w(7604:7629) = u(9)*w(1023:1048)
 w(7630:7648) = u(10)*w(1030:1048)
 w(7649:7660) = u(11)*w(1037:1048)
 w(7661:7666) = u(12)*w(343:348)
 w(7667:7672) = u(13)*w(343:348)
 w(7673:7678) = u(14)*w(343:348)
 w(7679:7684) = u(15)*w(343:348)
 w(7685:7690) = u(16)*w(343:348)
 w(7691:7696) = u(17)*w(343:348)
 w(7697:7702) = u(18)*w(343:348)
endif
! terms of degree 8
if (8.le.mxd) then
 w(7703:12472) = u(0)*w(2933:7702)
 w(12473:15358) = u(1)*w(4817:7702)
 w(15359:17060) = u(2)*w(6001:7702)
 w(17061:18034) = u(3)*w(6729:7702)
 w(18035:18569) = u(4)*w(7168:7702)
 w(18570:18728) = u(5)*w(2774:2932)
 w(18729:18853) = u(6)*w(2808:2932)
 w(18854:18951) = u(7)*w(2835:2932)
 w(18952:19028) = u(8)*w(2856:2932)
 w(19029:19089) = u(9)*w(2872:2932)
 w(19090:19138) = u(10)*w(2884:2932)
 w(19139:19178) = u(11)*w(2893:2932)
 w(19179:19183) = u(12)*w(1044:1048)
 w(19184:19188) = u(13)*w(1044:1048)
 w(19189:19193) = u(14)*w(1044:1048)
 w(19194:19198) = u(15)*w(1044:1048)
 w(19199:19203) = u(16)*w(1044:1048)
 w(19204:19208) = u(17)*w(1044:1048)
 w(19209:19213) = u(18)*w(1044:1048)
 w(19214:19219) = u(19)*w(343:348)
 w(19220:19224) = u(20)*w(344:348)
 w(19225:19228) = u(21)*w(345:348)
 w(19229:19231) = u(22)*w(346:348)
 w(19232:19233) = u(23)*w(347:348)
 w(19234) = u(24)*w(348)
endif
! terms of degree 9
if (9.le.mxd) then
 w(19235:30766) = u(0)*w(7703:19234)
 w(30767:37528) = u(1)*w(12473:19234)
 w(37529:41404) = u(2)*w(15359:19234)
 w(41405:43578) = u(3)*w(17061:19234)
 w(43579:44778) = u(4)*w(18035:19234)
 w(44779:45051) = u(5)*w(7430:7702)
 w(45052:45270) = u(6)*w(7484:7702)
 w(45271:45442) = u(7)*w(7531:7702)
 w(45443:45574) = u(8)*w(7571:7702)
 w(45575:45673) = u(9)*w(7604:7702)
 w(45674:45746) = u(10)*w(7630:7702)
 w(45747:45800) = u(11)*w(7649:7702)
 w(45801:45833) = u(12)*w(2900:2932)
 w(45834:45859) = u(13)*w(2907:2932)
 w(45860:45879) = u(14)*w(2913:2932)
 w(45880:45894) = u(15)*w(2918:2932)
 w(45895:45905) = u(16)*w(2922:2932)
 w(45906:45913) = u(17)*w(2925:2932)
 w(45914:45919) = u(18)*w(2927:2932)
 w(45920:45924) = u(19)*w(1044:1048)
 w(45925:45929) = u(20)*w(1044:1048)
 w(45930:45934) = u(21)*w(1044:1048)
 w(45935:45939) = u(22)*w(1044:1048)
 w(45940:45944) = u(23)*w(1044:1048)
 w(45945:45949) = u(24)*w(1044:1048)
endif
END SUBROUTINE mg621_prib
