SUBROUTINE mg622_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg622_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg622_prib: bad size u'
!! else if (size(w).ne.mg622_npb(mxd)) then
!!  stop 'mg622_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 6 11 8 7 5 6 0 0 0
! prib,  dnpb(0:*): 1 6 32 130 478 1567 4792 13682 37123 96018
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(7:12) = u(0)*w(1:6)
 w(13:17) = u(1)*w(2:6)
 w(18:21) = u(2)*w(3:6)
 w(22:24) = u(3)*w(4:6)
 w(25:26) = u(4)*w(5:6)
 w(27) = u(5)*w(6)
 w(28) = u(6)*w(0)
 w(29) = u(7)*w(0)
 w(30) = u(8)*w(0)
 w(31) = u(9)*w(0)
 w(32) = u(10)*w(0)
 w(33) = u(11)*w(0)
 w(34) = u(12)*w(0)
 w(35) = u(13)*w(0)
 w(36) = u(14)*w(0)
 w(37) = u(15)*w(0)
 w(38) = u(16)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(39:70) = u(0)*w(7:38)
 w(71:96) = u(1)*w(13:38)
 w(97:117) = u(2)*w(18:38)
 w(118:134) = u(3)*w(22:38)
 w(135:148) = u(4)*w(25:38)
 w(149:160) = u(5)*w(27:38)
 w(161) = u(17)*w(0)
 w(162) = u(18)*w(0)
 w(163) = u(19)*w(0)
 w(164) = u(20)*w(0)
 w(165) = u(21)*w(0)
 w(166) = u(22)*w(0)
 w(167) = u(23)*w(0)
 w(168) = u(24)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(169:298) = u(0)*w(39:168)
 w(299:396) = u(1)*w(71:168)
 w(397:468) = u(2)*w(97:168)
 w(469:519) = u(3)*w(118:168)
 w(520:553) = u(4)*w(135:168)
 w(554:573) = u(5)*w(149:168)
 w(574:584) = u(6)*w(28:38)
 w(585:594) = u(7)*w(29:38)
 w(595:603) = u(8)*w(30:38)
 w(604:611) = u(9)*w(31:38)
 w(612:618) = u(10)*w(32:38)
 w(619:624) = u(11)*w(33:38)
 w(625:629) = u(12)*w(34:38)
 w(630:633) = u(13)*w(35:38)
 w(634:636) = u(14)*w(36:38)
 w(637:638) = u(15)*w(37:38)
 w(639) = u(16)*w(38)
 w(640) = u(25)*w(0)
 w(641) = u(26)*w(0)
 w(642) = u(27)*w(0)
 w(643) = u(28)*w(0)
 w(644) = u(29)*w(0)
 w(645) = u(30)*w(0)
 w(646) = u(31)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(647:1124) = u(0)*w(169:646)
 w(1125:1472) = u(1)*w(299:646)
 w(1473:1722) = u(2)*w(397:646)
 w(1723:1900) = u(3)*w(469:646)
 w(1901:2027) = u(4)*w(520:646)
 w(2028:2120) = u(5)*w(554:646)
 w(2121:2128) = u(6)*w(161:168)
 w(2129:2136) = u(7)*w(161:168)
 w(2137:2144) = u(8)*w(161:168)
 w(2145:2152) = u(9)*w(161:168)
 w(2153:2160) = u(10)*w(161:168)
 w(2161:2168) = u(11)*w(161:168)
 w(2169:2176) = u(12)*w(161:168)
 w(2177:2184) = u(13)*w(161:168)
 w(2185:2192) = u(14)*w(161:168)
 w(2193:2200) = u(15)*w(161:168)
 w(2201:2208) = u(16)*w(161:168)
 w(2209) = u(32)*w(0)
 w(2210) = u(33)*w(0)
 w(2211) = u(34)*w(0)
 w(2212) = u(35)*w(0)
 w(2213) = u(36)*w(0)
endif
! terms of degree 6
if (6.le.mxd) then
 w(2214:3780) = u(0)*w(647:2213)
 w(3781:4869) = u(1)*w(1125:2213)
 w(4870:5610) = u(2)*w(1473:2213)
 w(5611:6101) = u(3)*w(1723:2213)
 w(6102:6414) = u(4)*w(1901:2213)
 w(6415:6600) = u(5)*w(2028:2213)
 w(6601:6673) = u(6)*w(574:646)
 w(6674:6735) = u(7)*w(585:646)
 w(6736:6787) = u(8)*w(595:646)
 w(6788:6830) = u(9)*w(604:646)
 w(6831:6865) = u(10)*w(612:646)
 w(6866:6893) = u(11)*w(619:646)
 w(6894:6915) = u(12)*w(625:646)
 w(6916:6932) = u(13)*w(630:646)
 w(6933:6945) = u(14)*w(634:646)
 w(6946:6955) = u(15)*w(637:646)
 w(6956:6963) = u(16)*w(639:646)
 w(6964:6971) = u(17)*w(161:168)
 w(6972:6978) = u(18)*w(162:168)
 w(6979:6984) = u(19)*w(163:168)
 w(6985:6989) = u(20)*w(164:168)
 w(6990:6993) = u(21)*w(165:168)
 w(6994:6996) = u(22)*w(166:168)
 w(6997:6998) = u(23)*w(167:168)
 w(6999) = u(24)*w(168)
 w(7000) = u(37)*w(0)
 w(7001) = u(38)*w(0)
 w(7002) = u(39)*w(0)
 w(7003) = u(40)*w(0)
 w(7004) = u(41)*w(0)
 w(7005) = u(42)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(7006:11797) = u(0)*w(2214:7005)
 w(11798:15022) = u(1)*w(3781:7005)
 w(15023:17158) = u(2)*w(4870:7005)
 w(17159:18553) = u(3)*w(5611:7005)
 w(18554:19457) = u(4)*w(6102:7005)
 w(19458:20048) = u(5)*w(6415:7005)
 w(20049:20141) = u(6)*w(2121:2213)
 w(20142:20226) = u(7)*w(2129:2213)
 w(20227:20303) = u(8)*w(2137:2213)
 w(20304:20372) = u(9)*w(2145:2213)
 w(20373:20433) = u(10)*w(2153:2213)
 w(20434:20486) = u(11)*w(2161:2213)
 w(20487:20531) = u(12)*w(2169:2213)
 w(20532:20568) = u(13)*w(2177:2213)
 w(20569:20597) = u(14)*w(2185:2213)
 w(20598:20618) = u(15)*w(2193:2213)
 w(20619:20631) = u(16)*w(2201:2213)
 w(20632:20638) = u(17)*w(640:646)
 w(20639:20645) = u(18)*w(640:646)
 w(20646:20652) = u(19)*w(640:646)
 w(20653:20659) = u(20)*w(640:646)
 w(20660:20666) = u(21)*w(640:646)
 w(20667:20673) = u(22)*w(640:646)
 w(20674:20680) = u(23)*w(640:646)
 w(20681:20687) = u(24)*w(640:646)
endif
! terms of degree 8
if (8.le.mxd) then
 w(20688:34369) = u(0)*w(7006:20687)
 w(34370:43259) = u(1)*w(11798:20687)
 w(43260:48924) = u(2)*w(15023:20687)
 w(48925:52453) = u(3)*w(17159:20687)
 w(52454:54587) = u(4)*w(18554:20687)
 w(54588:55817) = u(5)*w(19458:20687)
 w(55818:56222) = u(6)*w(6601:7005)
 w(56223:56554) = u(7)*w(6674:7005)
 w(56555:56824) = u(8)*w(6736:7005)
 w(56825:57042) = u(9)*w(6788:7005)
 w(57043:57217) = u(10)*w(6831:7005)
 w(57218:57357) = u(11)*w(6866:7005)
 w(57358:57469) = u(12)*w(6894:7005)
 w(57470:57559) = u(13)*w(6916:7005)
 w(57560:57632) = u(14)*w(6933:7005)
 w(57633:57692) = u(15)*w(6946:7005)
 w(57693:57742) = u(16)*w(6956:7005)
 w(57743:57747) = u(17)*w(2209:2213)
 w(57748:57752) = u(18)*w(2209:2213)
 w(57753:57757) = u(19)*w(2209:2213)
 w(57758:57762) = u(20)*w(2209:2213)
 w(57763:57767) = u(21)*w(2209:2213)
 w(57768:57772) = u(22)*w(2209:2213)
 w(57773:57777) = u(23)*w(2209:2213)
 w(57778:57782) = u(24)*w(2209:2213)
 w(57783:57789) = u(25)*w(640:646)
 w(57790:57795) = u(26)*w(641:646)
 w(57796:57800) = u(27)*w(642:646)
 w(57801:57804) = u(28)*w(643:646)
 w(57805:57807) = u(29)*w(644:646)
 w(57808:57809) = u(30)*w(645:646)
 w(57810) = u(31)*w(646)
endif
! terms of degree 9
if (9.le.mxd) then
 w(57811:94933) = u(0)*w(20688:57810)
 w(94934:118374) = u(1)*w(34370:57810)
 w(118375:132925) = u(2)*w(43260:57810)
 w(132926:141811) = u(3)*w(48925:57810)
 w(141812:147168) = u(4)*w(52454:57810)
 w(147169:150391) = u(5)*w(54588:57810)
 w(150392:151030) = u(6)*w(20049:20687)
 w(151031:151576) = u(7)*w(20142:20687)
 w(151577:152037) = u(8)*w(20227:20687)
 w(152038:152421) = u(9)*w(20304:20687)
 w(152422:152736) = u(10)*w(20373:20687)
 w(152737:152990) = u(11)*w(20434:20687)
 w(152991:153191) = u(12)*w(20487:20687)
 w(153192:153347) = u(13)*w(20532:20687)
 w(153348:153466) = u(14)*w(20569:20687)
 w(153467:153556) = u(15)*w(20598:20687)
 w(153557:153625) = u(16)*w(20619:20687)
 w(153626:153667) = u(17)*w(6964:7005)
 w(153668:153701) = u(18)*w(6972:7005)
 w(153702:153728) = u(19)*w(6979:7005)
 w(153729:153749) = u(20)*w(6985:7005)
 w(153750:153765) = u(21)*w(6990:7005)
 w(153766:153777) = u(22)*w(6994:7005)
 w(153778:153786) = u(23)*w(6997:7005)
 w(153787:153793) = u(24)*w(6999:7005)
 w(153794:153798) = u(25)*w(2209:2213)
 w(153799:153803) = u(26)*w(2209:2213)
 w(153804:153808) = u(27)*w(2209:2213)
 w(153809:153813) = u(28)*w(2209:2213)
 w(153814:153818) = u(29)*w(2209:2213)
 w(153819:153823) = u(30)*w(2209:2213)
 w(153824:153828) = u(31)*w(2209:2213)
endif
END SUBROUTINE mg622_prib
