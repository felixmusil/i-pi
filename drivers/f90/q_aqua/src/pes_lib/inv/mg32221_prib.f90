SUBROUTINE mg32221_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg32221_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg32221_prib: bad size u'
!! else if (size(w).ne.mg32221_npb(mxd)) then
!!  stop 'mg32221_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 14 23 5 0 0 3 0 0 0
! prib,  dnpb(0:*): 1 14 128 887 5141 25952 117580 486951 1869720 6724134
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
 w(10) = u(9)*w(0)
 w(11) = u(10)*w(0)
 w(12) = u(11)*w(0)
 w(13) = u(12)*w(0)
 w(14) = u(13)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(15:28) = u(0)*w(1:14)
 w(29:41) = u(1)*w(2:14)
 w(42:53) = u(2)*w(3:14)
 w(54:64) = u(3)*w(4:14)
 w(65:74) = u(4)*w(5:14)
 w(75:83) = u(5)*w(6:14)
 w(84:91) = u(6)*w(7:14)
 w(92:98) = u(7)*w(8:14)
 w(99:104) = u(8)*w(9:14)
 w(105:109) = u(9)*w(10:14)
 w(110:113) = u(10)*w(11:14)
 w(114:116) = u(11)*w(12:14)
 w(117:118) = u(12)*w(13:14)
 w(119) = u(13)*w(14)
 w(120) = u(14)*w(0)
 w(121) = u(15)*w(0)
 w(122) = u(16)*w(0)
 w(123) = u(17)*w(0)
 w(124) = u(18)*w(0)
 w(125) = u(19)*w(0)
 w(126) = u(20)*w(0)
 w(127) = u(21)*w(0)
 w(128) = u(22)*w(0)
 w(129) = u(23)*w(0)
 w(130) = u(24)*w(0)
 w(131) = u(25)*w(0)
 w(132) = u(26)*w(0)
 w(133) = u(27)*w(0)
 w(134) = u(28)*w(0)
 w(135) = u(29)*w(0)
 w(136) = u(30)*w(0)
 w(137) = u(31)*w(0)
 w(138) = u(32)*w(0)
 w(139) = u(33)*w(0)
 w(140) = u(34)*w(0)
 w(141) = u(35)*w(0)
 w(142) = u(36)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(143:270) = u(0)*w(15:142)
 w(271:384) = u(1)*w(29:142)
 w(385:485) = u(2)*w(42:142)
 w(486:574) = u(3)*w(54:142)
 w(575:652) = u(4)*w(65:142)
 w(653:720) = u(5)*w(75:142)
 w(721:779) = u(6)*w(84:142)
 w(780:830) = u(7)*w(92:142)
 w(831:874) = u(8)*w(99:142)
 w(875:912) = u(9)*w(105:142)
 w(913:945) = u(10)*w(110:142)
 w(946:974) = u(11)*w(114:142)
 w(975:1000) = u(12)*w(117:142)
 w(1001:1024) = u(13)*w(119:142)
 w(1025) = u(37)*w(0)
 w(1026) = u(38)*w(0)
 w(1027) = u(39)*w(0)
 w(1028) = u(40)*w(0)
 w(1029) = u(41)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(1030:1916) = u(0)*w(143:1029)
 w(1917:2675) = u(1)*w(271:1029)
 w(2676:3320) = u(2)*w(385:1029)
 w(3321:3864) = u(3)*w(486:1029)
 w(3865:4319) = u(4)*w(575:1029)
 w(4320:4696) = u(5)*w(653:1029)
 w(4697:5005) = u(6)*w(721:1029)
 w(5006:5255) = u(7)*w(780:1029)
 w(5256:5454) = u(8)*w(831:1029)
 w(5455:5609) = u(9)*w(875:1029)
 w(5610:5726) = u(10)*w(913:1029)
 w(5727:5810) = u(11)*w(946:1029)
 w(5811:5865) = u(12)*w(975:1029)
 w(5866:5894) = u(13)*w(1001:1029)
 w(5895:5917) = u(14)*w(120:142)
 w(5918:5939) = u(15)*w(121:142)
 w(5940:5960) = u(16)*w(122:142)
 w(5961:5980) = u(17)*w(123:142)
 w(5981:5999) = u(18)*w(124:142)
 w(6000:6017) = u(19)*w(125:142)
 w(6018:6034) = u(20)*w(126:142)
 w(6035:6050) = u(21)*w(127:142)
 w(6051:6065) = u(22)*w(128:142)
 w(6066:6079) = u(23)*w(129:142)
 w(6080:6092) = u(24)*w(130:142)
 w(6093:6104) = u(25)*w(131:142)
 w(6105:6115) = u(26)*w(132:142)
 w(6116:6125) = u(27)*w(133:142)
 w(6126:6134) = u(28)*w(134:142)
 w(6135:6142) = u(29)*w(135:142)
 w(6143:6149) = u(30)*w(136:142)
 w(6150:6155) = u(31)*w(137:142)
 w(6156:6160) = u(32)*w(138:142)
 w(6161:6164) = u(33)*w(139:142)
 w(6165:6167) = u(34)*w(140:142)
 w(6168:6169) = u(35)*w(141:142)
 w(6170) = u(36)*w(142)
endif
! terms of degree 5
if (5.le.mxd) then
 w(6171:11311) = u(0)*w(1030:6170)
 w(11312:15565) = u(1)*w(1917:6170)
 w(15566:19060) = u(2)*w(2676:6170)
 w(19061:21910) = u(3)*w(3321:6170)
 w(21911:24216) = u(4)*w(3865:6170)
 w(24217:26067) = u(5)*w(4320:6170)
 w(26068:27541) = u(6)*w(4697:6170)
 w(27542:28706) = u(7)*w(5006:6170)
 w(28707:29621) = u(8)*w(5256:6170)
 w(29622:30337) = u(9)*w(5455:6170)
 w(30338:30898) = u(10)*w(5610:6170)
 w(30899:31342) = u(11)*w(5727:6170)
 w(31343:31702) = u(12)*w(5811:6170)
 w(31703:32007) = u(13)*w(5866:6170)
 w(32008:32012) = u(14)*w(1025:1029)
 w(32013:32017) = u(15)*w(1025:1029)
 w(32018:32022) = u(16)*w(1025:1029)
 w(32023:32027) = u(17)*w(1025:1029)
 w(32028:32032) = u(18)*w(1025:1029)
 w(32033:32037) = u(19)*w(1025:1029)
 w(32038:32042) = u(20)*w(1025:1029)
 w(32043:32047) = u(21)*w(1025:1029)
 w(32048:32052) = u(22)*w(1025:1029)
 w(32053:32057) = u(23)*w(1025:1029)
 w(32058:32062) = u(24)*w(1025:1029)
 w(32063:32067) = u(25)*w(1025:1029)
 w(32068:32072) = u(26)*w(1025:1029)
 w(32073:32077) = u(27)*w(1025:1029)
 w(32078:32082) = u(28)*w(1025:1029)
 w(32083:32087) = u(29)*w(1025:1029)
 w(32088:32092) = u(30)*w(1025:1029)
 w(32093:32097) = u(31)*w(1025:1029)
 w(32098:32102) = u(32)*w(1025:1029)
 w(32103:32107) = u(33)*w(1025:1029)
 w(32108:32112) = u(34)*w(1025:1029)
 w(32113:32117) = u(35)*w(1025:1029)
 w(32118:32122) = u(36)*w(1025:1029)
endif
! terms of degree 6
if (6.le.mxd) then
 w(32123:58074) = u(0)*w(6171:32122)
 w(58075:78885) = u(1)*w(11312:32122)
 w(78886:95442) = u(2)*w(15566:32122)
 w(95443:108504) = u(3)*w(19061:32122)
 w(108505:118716) = u(4)*w(21911:32122)
 w(118717:126622) = u(5)*w(24217:32122)
 w(126623:132677) = u(6)*w(26068:32122)
 w(132678:137258) = u(7)*w(27542:32122)
 w(137259:140674) = u(8)*w(28707:32122)
 w(140675:143175) = u(9)*w(29622:32122)
 w(143176:144960) = u(10)*w(30338:32122)
 w(144961:146184) = u(11)*w(30899:32122)
 w(146185:146964) = u(12)*w(31343:32122)
 w(146965:147384) = u(13)*w(31703:32122)
 w(147385:147660) = u(14)*w(5895:6170)
 w(147661:147913) = u(15)*w(5918:6170)
 w(147914:148144) = u(16)*w(5940:6170)
 w(148145:148354) = u(17)*w(5961:6170)
 w(148355:148544) = u(18)*w(5981:6170)
 w(148545:148715) = u(19)*w(6000:6170)
 w(148716:148868) = u(20)*w(6018:6170)
 w(148869:149004) = u(21)*w(6035:6170)
 w(149005:149124) = u(22)*w(6051:6170)
 w(149125:149229) = u(23)*w(6066:6170)
 w(149230:149320) = u(24)*w(6080:6170)
 w(149321:149398) = u(25)*w(6093:6170)
 w(149399:149464) = u(26)*w(6105:6170)
 w(149465:149519) = u(27)*w(6116:6170)
 w(149520:149564) = u(28)*w(6126:6170)
 w(149565:149600) = u(29)*w(6135:6170)
 w(149601:149628) = u(30)*w(6143:6170)
 w(149629:149649) = u(31)*w(6150:6170)
 w(149650:149664) = u(32)*w(6156:6170)
 w(149665:149674) = u(33)*w(6161:6170)
 w(149675:149680) = u(34)*w(6165:6170)
 w(149681:149683) = u(35)*w(6168:6170)
 w(149684) = u(36)*w(6170)
 w(149685:149689) = u(37)*w(1025:1029)
 w(149690:149693) = u(38)*w(1026:1029)
 w(149694:149696) = u(39)*w(1027:1029)
 w(149697:149698) = u(40)*w(1028:1029)
 w(149699) = u(41)*w(1029)
 w(149700) = u(42)*w(0)
 w(149701) = u(43)*w(0)
 w(149702) = u(44)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(149703:267282) = u(0)*w(32123:149702)
 w(267283:358910) = u(1)*w(58075:149702)
 w(358911:429727) = u(2)*w(78886:149702)
 w(429728:483987) = u(3)*w(95443:149702)
 w(483988:525185) = u(4)*w(108505:149702)
 w(525186:556171) = u(5)*w(118717:149702)
 w(556172:579251) = u(6)*w(126623:149702)
 w(579252:596276) = u(7)*w(132678:149702)
 w(596277:608720) = u(8)*w(137259:149702)
 w(608721:617748) = u(9)*w(140675:149702)
 w(617749:624275) = u(10)*w(143176:149702)
 w(624276:629017) = u(11)*w(144961:149702)
 w(629018:632535) = u(12)*w(146185:149702)
 w(632536:635273) = u(13)*w(146965:149702)
 w(635274:635388) = u(14)*w(32008:32122)
 w(635389:635498) = u(15)*w(32013:32122)
 w(635499:635603) = u(16)*w(32018:32122)
 w(635604:635703) = u(17)*w(32023:32122)
 w(635704:635798) = u(18)*w(32028:32122)
 w(635799:635888) = u(19)*w(32033:32122)
 w(635889:635973) = u(20)*w(32038:32122)
 w(635974:636053) = u(21)*w(32043:32122)
 w(636054:636128) = u(22)*w(32048:32122)
 w(636129:636198) = u(23)*w(32053:32122)
 w(636199:636263) = u(24)*w(32058:32122)
 w(636264:636323) = u(25)*w(32063:32122)
 w(636324:636378) = u(26)*w(32068:32122)
 w(636379:636428) = u(27)*w(32073:32122)
 w(636429:636473) = u(28)*w(32078:32122)
 w(636474:636513) = u(29)*w(32083:32122)
 w(636514:636548) = u(30)*w(32088:32122)
 w(636549:636578) = u(31)*w(32093:32122)
 w(636579:636603) = u(32)*w(32098:32122)
 w(636604:636623) = u(33)*w(32103:32122)
 w(636624:636638) = u(34)*w(32108:32122)
 w(636639:636648) = u(35)*w(32113:32122)
 w(636649:636653) = u(36)*w(32118:32122)
endif
! terms of degree 8
if (8.le.mxd) then
 w(636654:1123604) = u(0)*w(149703:636653)
 w(1123605:1492975) = u(1)*w(267283:636653)
 w(1492976:1770718) = u(2)*w(358911:636653)
 w(1770719:1977644) = u(3)*w(429728:636653)
 w(1977645:2130310) = u(4)*w(483988:636653)
 w(2130311:2241778) = u(5)*w(525186:636653)
 w(2241779:2322260) = u(6)*w(556172:636653)
 w(2322261:2379662) = u(7)*w(579252:636653)
 w(2379663:2420039) = u(8)*w(596277:636653)
 w(2420040:2447972) = u(9)*w(608721:636653)
 w(2447973:2466877) = u(10)*w(617749:636653)
 w(2466878:2479255) = u(11)*w(624276:636653)
 w(2479256:2486891) = u(12)*w(629018:636653)
 w(2486892:2491009) = u(13)*w(632536:636653)
 w(2491010:2493327) = u(14)*w(147385:149702)
 w(2493328:2495369) = u(15)*w(147661:149702)
 w(2495370:2497158) = u(16)*w(147914:149702)
 w(2497159:2498716) = u(17)*w(148145:149702)
 w(2498717:2500064) = u(18)*w(148355:149702)
 w(2500065:2501222) = u(19)*w(148545:149702)
 w(2501223:2502209) = u(20)*w(148716:149702)
 w(2502210:2503043) = u(21)*w(148869:149702)
 w(2503044:2503741) = u(22)*w(149005:149702)
 w(2503742:2504319) = u(23)*w(149125:149702)
 w(2504320:2504792) = u(24)*w(149230:149702)
 w(2504793:2505174) = u(25)*w(149321:149702)
 w(2505175:2505478) = u(26)*w(149399:149702)
 w(2505479:2505716) = u(27)*w(149465:149702)
 w(2505717:2505899) = u(28)*w(149520:149702)
 w(2505900:2506037) = u(29)*w(149565:149702)
 w(2506038:2506139) = u(30)*w(149601:149702)
 w(2506140:2506213) = u(31)*w(149629:149702)
 w(2506214:2506266) = u(32)*w(149650:149702)
 w(2506267:2506304) = u(33)*w(149665:149702)
 w(2506305:2506332) = u(34)*w(149675:149702)
 w(2506333:2506354) = u(35)*w(149681:149702)
 w(2506355:2506373) = u(36)*w(149684:149702)
endif
! terms of degree 9
if (9.le.mxd) then
 w(2506374:4376093) = u(0)*w(636654:2506373)
 w(4376094:5758862) = u(1)*w(1123605:2506373)
 w(5758863:6772260) = u(2)*w(1492976:2506373)
 w(6772261:7507915) = u(3)*w(1770719:2506373)
 w(7507916:8036644) = u(4)*w(1977645:2506373)
 w(8036645:8412707) = u(5)*w(2130311:2506373)
 w(8412708:8677302) = u(6)*w(2241779:2506373)
 w(8677303:8861415) = u(7)*w(2322261:2506373)
 w(8861416:8988126) = u(8)*w(2379663:2506373)
 w(8988127:9074460) = u(9)*w(2420040:2506373)
 w(9074461:9132861) = u(10)*w(2447973:2506373)
 w(9132862:9172357) = u(11)*w(2466878:2506373)
 w(9172358:9199475) = u(12)*w(2479256:2506373)
 w(9199476:9218957) = u(13)*w(2486892:2506373)
 w(9218958:9220337) = u(14)*w(635274:636653)
 w(9220338:9221602) = u(15)*w(635389:636653)
 w(9221603:9222757) = u(16)*w(635499:636653)
 w(9222758:9223807) = u(17)*w(635604:636653)
 w(9223808:9224757) = u(18)*w(635704:636653)
 w(9224758:9225612) = u(19)*w(635799:636653)
 w(9225613:9226377) = u(20)*w(635889:636653)
 w(9226378:9227057) = u(21)*w(635974:636653)
 w(9227058:9227657) = u(22)*w(636054:636653)
 w(9227658:9228182) = u(23)*w(636129:636653)
 w(9228183:9228637) = u(24)*w(636199:636653)
 w(9228638:9229027) = u(25)*w(636264:636653)
 w(9229028:9229357) = u(26)*w(636324:636653)
 w(9229358:9229632) = u(27)*w(636379:636653)
 w(9229633:9229857) = u(28)*w(636429:636653)
 w(9229858:9230037) = u(29)*w(636474:636653)
 w(9230038:9230177) = u(30)*w(636514:636653)
 w(9230178:9230282) = u(31)*w(636549:636653)
 w(9230283:9230357) = u(32)*w(636579:636653)
 w(9230358:9230407) = u(33)*w(636604:636653)
 w(9230408:9230437) = u(34)*w(636624:636653)
 w(9230438:9230452) = u(35)*w(636639:636653)
 w(9230453:9230457) = u(36)*w(636649:636653)
 w(9230458:9230475) = u(37)*w(149685:149702)
 w(9230476:9230488) = u(38)*w(149690:149702)
 w(9230489:9230497) = u(39)*w(149694:149702)
 w(9230498:9230503) = u(40)*w(149697:149702)
 w(9230504:9230507) = u(41)*w(149699:149702)
endif
END SUBROUTINE mg32221_prib
