SUBROUTINE mg532_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg532_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg532_prib: bad size u'
!! else if (size(w).ne.mg532_npb(mxd)) then
!!  stop 'mg532_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 6 12 8 7 4 4 0 0 0
! prib,  dnpb(0:*): 1 6 33 136 511 1702 5295 15340 42224 110620
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(7:12) = u(0)*w(1:6)
 w(13:17) = u(1)*w(2:6)
 w(18:21) = u(2)*w(3:6)
 w(22:24) = u(3)*w(4:6)
 w(25:26) = u(4)*w(5:6)
 w(27) = u(5)*w(6)
 w(28) = u(6)*w(0)
 w(29) = u(7)*w(0)
 w(30) = u(8)*w(0)
 w(31) = u(9)*w(0)
 w(32) = u(10)*w(0)
 w(33) = u(11)*w(0)
 w(34) = u(12)*w(0)
 w(35) = u(13)*w(0)
 w(36) = u(14)*w(0)
 w(37) = u(15)*w(0)
 w(38) = u(16)*w(0)
 w(39) = u(17)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(40:72) = u(0)*w(7:39)
 w(73:99) = u(1)*w(13:39)
 w(100:121) = u(2)*w(18:39)
 w(122:139) = u(3)*w(22:39)
 w(140:154) = u(4)*w(25:39)
 w(155:167) = u(5)*w(27:39)
 w(168) = u(18)*w(0)
 w(169) = u(19)*w(0)
 w(170) = u(20)*w(0)
 w(171) = u(21)*w(0)
 w(172) = u(22)*w(0)
 w(173) = u(23)*w(0)
 w(174) = u(24)*w(0)
 w(175) = u(25)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(176:311) = u(0)*w(40:175)
 w(312:414) = u(1)*w(73:175)
 w(415:490) = u(2)*w(100:175)
 w(491:544) = u(3)*w(122:175)
 w(545:580) = u(4)*w(140:175)
 w(581:601) = u(5)*w(155:175)
 w(602:613) = u(6)*w(28:39)
 w(614:624) = u(7)*w(29:39)
 w(625:634) = u(8)*w(30:39)
 w(635:643) = u(9)*w(31:39)
 w(644:651) = u(10)*w(32:39)
 w(652:658) = u(11)*w(33:39)
 w(659:664) = u(12)*w(34:39)
 w(665:669) = u(13)*w(35:39)
 w(670:673) = u(14)*w(36:39)
 w(674:676) = u(15)*w(37:39)
 w(677:678) = u(16)*w(38:39)
 w(679) = u(17)*w(39)
 w(680) = u(26)*w(0)
 w(681) = u(27)*w(0)
 w(682) = u(28)*w(0)
 w(683) = u(29)*w(0)
 w(684) = u(30)*w(0)
 w(685) = u(31)*w(0)
 w(686) = u(32)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(687:1197) = u(0)*w(176:686)
 w(1198:1572) = u(1)*w(312:686)
 w(1573:1844) = u(2)*w(415:686)
 w(1845:2040) = u(3)*w(491:686)
 w(2041:2182) = u(4)*w(545:686)
 w(2183:2288) = u(5)*w(581:686)
 w(2289:2296) = u(6)*w(168:175)
 w(2297:2304) = u(7)*w(168:175)
 w(2305:2312) = u(8)*w(168:175)
 w(2313:2320) = u(9)*w(168:175)
 w(2321:2328) = u(10)*w(168:175)
 w(2329:2336) = u(11)*w(168:175)
 w(2337:2344) = u(12)*w(168:175)
 w(2345:2352) = u(13)*w(168:175)
 w(2353:2360) = u(14)*w(168:175)
 w(2361:2368) = u(15)*w(168:175)
 w(2369:2376) = u(16)*w(168:175)
 w(2377:2384) = u(17)*w(168:175)
 w(2385) = u(33)*w(0)
 w(2386) = u(34)*w(0)
 w(2387) = u(35)*w(0)
 w(2388) = u(36)*w(0)
endif
! terms of degree 6
if (6.le.mxd) then
 w(2389:4090) = u(0)*w(687:2388)
 w(4091:5281) = u(1)*w(1198:2388)
 w(5282:6097) = u(2)*w(1573:2388)
 w(6098:6641) = u(3)*w(1845:2388)
 w(6642:6989) = u(4)*w(2041:2388)
 w(6990:7195) = u(5)*w(2183:2388)
 w(7196:7280) = u(6)*w(602:686)
 w(7281:7353) = u(7)*w(614:686)
 w(7354:7415) = u(8)*w(625:686)
 w(7416:7467) = u(9)*w(635:686)
 w(7468:7510) = u(10)*w(644:686)
 w(7511:7545) = u(11)*w(652:686)
 w(7546:7573) = u(12)*w(659:686)
 w(7574:7595) = u(13)*w(665:686)
 w(7596:7612) = u(14)*w(670:686)
 w(7613:7625) = u(15)*w(674:686)
 w(7626:7635) = u(16)*w(677:686)
 w(7636:7643) = u(17)*w(679:686)
 w(7644:7651) = u(18)*w(168:175)
 w(7652:7658) = u(19)*w(169:175)
 w(7659:7664) = u(20)*w(170:175)
 w(7665:7669) = u(21)*w(171:175)
 w(7670:7673) = u(22)*w(172:175)
 w(7674:7676) = u(23)*w(173:175)
 w(7677:7678) = u(24)*w(174:175)
 w(7679) = u(25)*w(175)
 w(7680) = u(37)*w(0)
 w(7681) = u(38)*w(0)
 w(7682) = u(39)*w(0)
 w(7683) = u(40)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(7684:12978) = u(0)*w(2389:7683)
 w(12979:16571) = u(1)*w(4091:7683)
 w(16572:18973) = u(2)*w(5282:7683)
 w(18974:20559) = u(3)*w(6098:7683)
 w(20560:21601) = u(4)*w(6642:7683)
 w(21602:22295) = u(5)*w(6990:7683)
 w(22296:22395) = u(6)*w(2289:2388)
 w(22396:22487) = u(7)*w(2297:2388)
 w(22488:22571) = u(8)*w(2305:2388)
 w(22572:22647) = u(9)*w(2313:2388)
 w(22648:22715) = u(10)*w(2321:2388)
 w(22716:22775) = u(11)*w(2329:2388)
 w(22776:22827) = u(12)*w(2337:2388)
 w(22828:22871) = u(13)*w(2345:2388)
 w(22872:22907) = u(14)*w(2353:2388)
 w(22908:22935) = u(15)*w(2361:2388)
 w(22936:22955) = u(16)*w(2369:2388)
 w(22956:22967) = u(17)*w(2377:2388)
 w(22968:22974) = u(18)*w(680:686)
 w(22975:22981) = u(19)*w(680:686)
 w(22982:22988) = u(20)*w(680:686)
 w(22989:22995) = u(21)*w(680:686)
 w(22996:23002) = u(22)*w(680:686)
 w(23003:23009) = u(23)*w(680:686)
 w(23010:23016) = u(24)*w(680:686)
 w(23017:23023) = u(25)*w(680:686)
endif
! terms of degree 8
if (8.le.mxd) then
 w(23024:38363) = u(0)*w(7684:23023)
 w(38364:48408) = u(1)*w(12979:23023)
 w(48409:54860) = u(2)*w(16572:23023)
 w(54861:58910) = u(3)*w(18974:23023)
 w(58911:61374) = u(4)*w(20560:23023)
 w(61375:62796) = u(5)*w(21602:23023)
 w(62797:63284) = u(6)*w(7196:7683)
 w(63285:63687) = u(7)*w(7281:7683)
 w(63688:64017) = u(8)*w(7354:7683)
 w(64018:64285) = u(9)*w(7416:7683)
 w(64286:64501) = u(10)*w(7468:7683)
 w(64502:64674) = u(11)*w(7511:7683)
 w(64675:64812) = u(12)*w(7546:7683)
 w(64813:64922) = u(13)*w(7574:7683)
 w(64923:65010) = u(14)*w(7596:7683)
 w(65011:65081) = u(15)*w(7613:7683)
 w(65082:65139) = u(16)*w(7626:7683)
 w(65140:65187) = u(17)*w(7636:7683)
 w(65188:65191) = u(18)*w(2385:2388)
 w(65192:65195) = u(19)*w(2385:2388)
 w(65196:65199) = u(20)*w(2385:2388)
 w(65200:65203) = u(21)*w(2385:2388)
 w(65204:65207) = u(22)*w(2385:2388)
 w(65208:65211) = u(23)*w(2385:2388)
 w(65212:65215) = u(24)*w(2385:2388)
 w(65216:65219) = u(25)*w(2385:2388)
 w(65220:65226) = u(26)*w(680:686)
 w(65227:65232) = u(27)*w(681:686)
 w(65233:65237) = u(28)*w(682:686)
 w(65238:65241) = u(29)*w(683:686)
 w(65242:65244) = u(30)*w(684:686)
 w(65245:65246) = u(31)*w(685:686)
 w(65247) = u(32)*w(686)
endif
! terms of degree 9
if (9.le.mxd) then
 w(65248:107471) = u(0)*w(23024:65247)
 w(107472:134355) = u(1)*w(38364:65247)
 w(134356:151194) = u(2)*w(48409:65247)
 w(151195:161581) = u(3)*w(54861:65247)
 w(161582:167918) = u(4)*w(58911:65247)
 w(167919:171791) = u(5)*w(61375:65247)
 w(171792:172519) = u(6)*w(22296:23023)
 w(172520:173147) = u(7)*w(22396:23023)
 w(173148:173683) = u(8)*w(22488:23023)
 w(173684:174135) = u(9)*w(22572:23023)
 w(174136:174511) = u(10)*w(22648:23023)
 w(174512:174819) = u(11)*w(22716:23023)
 w(174820:175067) = u(12)*w(22776:23023)
 w(175068:175263) = u(13)*w(22828:23023)
 w(175264:175415) = u(14)*w(22872:23023)
 w(175416:175531) = u(15)*w(22908:23023)
 w(175532:175619) = u(16)*w(22936:23023)
 w(175620:175687) = u(17)*w(22956:23023)
 w(175688:175727) = u(18)*w(7644:7683)
 w(175728:175759) = u(19)*w(7652:7683)
 w(175760:175784) = u(20)*w(7659:7683)
 w(175785:175803) = u(21)*w(7665:7683)
 w(175804:175817) = u(22)*w(7670:7683)
 w(175818:175827) = u(23)*w(7674:7683)
 w(175828:175834) = u(24)*w(7677:7683)
 w(175835:175839) = u(25)*w(7679:7683)
 w(175840:175843) = u(26)*w(2385:2388)
 w(175844:175847) = u(27)*w(2385:2388)
 w(175848:175851) = u(28)*w(2385:2388)
 w(175852:175855) = u(29)*w(2385:2388)
 w(175856:175859) = u(30)*w(2385:2388)
 w(175860:175863) = u(31)*w(2385:2388)
 w(175864:175867) = u(32)*w(2385:2388)
endif
END SUBROUTINE mg532_prib
