SUBROUTINE mg1111_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg1111_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg1111_prib: bad size u'
!! else if (size(w).ne.mg1111_npb(mxd)) then
!!  stop 'mg1111_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 6 0 0 0 0 0 0 0 0 &
!   0 0 0 0 0 0 0 0 0 0
! prib,  dnpb(0:*): 1 6 21 56 126 252 462 792 1287 2002 &
!   3003 4368 6188 8568 11628 15504 20349 26334 33649 42504
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(7:12) = u(0)*w(1:6)
 w(13:17) = u(1)*w(2:6)
 w(18:21) = u(2)*w(3:6)
 w(22:24) = u(3)*w(4:6)
 w(25:26) = u(4)*w(5:6)
 w(27) = u(5)*w(6)
endif
! terms of degree 3
if (3.le.mxd) then
 w(28:48) = u(0)*w(7:27)
 w(49:63) = u(1)*w(13:27)
 w(64:73) = u(2)*w(18:27)
 w(74:79) = u(3)*w(22:27)
 w(80:82) = u(4)*w(25:27)
 w(83) = u(5)*w(27)
endif
! terms of degree 4
if (4.le.mxd) then
 w(84:139) = u(0)*w(28:83)
 w(140:174) = u(1)*w(49:83)
 w(175:194) = u(2)*w(64:83)
 w(195:204) = u(3)*w(74:83)
 w(205:208) = u(4)*w(80:83)
 w(209) = u(5)*w(83)
endif
! terms of degree 5
if (5.le.mxd) then
 w(210:335) = u(0)*w(84:209)
 w(336:405) = u(1)*w(140:209)
 w(406:440) = u(2)*w(175:209)
 w(441:455) = u(3)*w(195:209)
 w(456:460) = u(4)*w(205:209)
 w(461) = u(5)*w(209)
endif
! terms of degree 6
if (6.le.mxd) then
 w(462:713) = u(0)*w(210:461)
 w(714:839) = u(1)*w(336:461)
 w(840:895) = u(2)*w(406:461)
 w(896:916) = u(3)*w(441:461)
 w(917:922) = u(4)*w(456:461)
 w(923) = u(5)*w(461)
endif
! terms of degree 7
if (7.le.mxd) then
 w(924:1385) = u(0)*w(462:923)
 w(1386:1595) = u(1)*w(714:923)
 w(1596:1679) = u(2)*w(840:923)
 w(1680:1707) = u(3)*w(896:923)
 w(1708:1714) = u(4)*w(917:923)
 w(1715) = u(5)*w(923)
endif
! terms of degree 8
if (8.le.mxd) then
 w(1716:2507) = u(0)*w(924:1715)
 w(2508:2837) = u(1)*w(1386:1715)
 w(2838:2957) = u(2)*w(1596:1715)
 w(2958:2993) = u(3)*w(1680:1715)
 w(2994:3001) = u(4)*w(1708:1715)
 w(3002) = u(5)*w(1715)
endif
! terms of degree 9
if (9.le.mxd) then
 w(3003:4289) = u(0)*w(1716:3002)
 w(4290:4784) = u(1)*w(2508:3002)
 w(4785:4949) = u(2)*w(2838:3002)
 w(4950:4994) = u(3)*w(2958:3002)
 w(4995:5003) = u(4)*w(2994:3002)
 w(5004) = u(5)*w(3002)
endif
! terms of degree 10
if (10.le.mxd) then
 w(5005:7006) = u(0)*w(3003:5004)
 w(7007:7721) = u(1)*w(4290:5004)
 w(7722:7941) = u(2)*w(4785:5004)
 w(7942:7996) = u(3)*w(4950:5004)
 w(7997:8006) = u(4)*w(4995:5004)
 w(8007) = u(5)*w(5004)
endif
! terms of degree 11
if (11.le.mxd) then
 w(8008:11010) = u(0)*w(5005:8007)
 w(11011:12011) = u(1)*w(7007:8007)
 w(12012:12297) = u(2)*w(7722:8007)
 w(12298:12363) = u(3)*w(7942:8007)
 w(12364:12374) = u(4)*w(7997:8007)
 w(12375) = u(5)*w(8007)
endif
! terms of degree 12
if (12.le.mxd) then
 w(12376:16743) = u(0)*w(8008:12375)
 w(16744:18108) = u(1)*w(11011:12375)
 w(18109:18472) = u(2)*w(12012:12375)
 w(18473:18550) = u(3)*w(12298:12375)
 w(18551:18562) = u(4)*w(12364:12375)
 w(18563) = u(5)*w(12375)
endif
! terms of degree 13
if (13.le.mxd) then
 w(18564:24751) = u(0)*w(12376:18563)
 w(24752:26571) = u(1)*w(16744:18563)
 w(26572:27026) = u(2)*w(18109:18563)
 w(27027:27117) = u(3)*w(18473:18563)
 w(27118:27130) = u(4)*w(18551:18563)
 w(27131) = u(5)*w(18563)
endif
! terms of degree 14
if (14.le.mxd) then
 w(27132:35699) = u(0)*w(18564:27131)
 w(35700:38079) = u(1)*w(24752:27131)
 w(38080:38639) = u(2)*w(26572:27131)
 w(38640:38744) = u(3)*w(27027:27131)
 w(38745:38758) = u(4)*w(27118:27131)
 w(38759) = u(5)*w(27131)
endif
! terms of degree 15
if (15.le.mxd) then
 w(38760:50387) = u(0)*w(27132:38759)
 w(50388:53447) = u(1)*w(35700:38759)
 w(53448:54127) = u(2)*w(38080:38759)
 w(54128:54247) = u(3)*w(38640:38759)
 w(54248:54262) = u(4)*w(38745:38759)
 w(54263) = u(5)*w(38759)
endif
! terms of degree 16
if (16.le.mxd) then
 w(54264:69767) = u(0)*w(38760:54263)
 w(69768:73643) = u(1)*w(50388:54263)
 w(73644:74459) = u(2)*w(53448:54263)
 w(74460:74595) = u(3)*w(54128:54263)
 w(74596:74611) = u(4)*w(54248:54263)
 w(74612) = u(5)*w(54263)
endif
! terms of degree 17
if (17.le.mxd) then
 w(74613:94961) = u(0)*w(54264:74612)
 w(94962:99806) = u(1)*w(69768:74612)
 w(99807:100775) = u(2)*w(73644:74612)
 w(100776:100928) = u(3)*w(74460:74612)
 w(100929:100945) = u(4)*w(74596:74612)
 w(100946) = u(5)*w(74612)
endif
! terms of degree 18
if (18.le.mxd) then
 w(100947:127280) = u(0)*w(74613:100946)
 w(127281:133265) = u(1)*w(94962:100946)
 w(133266:134405) = u(2)*w(99807:100946)
 w(134406:134576) = u(3)*w(100776:100946)
 w(134577:134594) = u(4)*w(100929:100946)
 w(134595) = u(5)*w(100946)
endif
! terms of degree 19
if (19.le.mxd) then
 w(134596:168244) = u(0)*w(100947:134595)
 w(168245:175559) = u(1)*w(127281:134595)
 w(175560:176889) = u(2)*w(133266:134595)
 w(176890:177079) = u(3)*w(134406:134595)
 w(177080:177098) = u(4)*w(134577:134595)
 w(177099) = u(5)*w(134595)
endif
END SUBROUTINE mg1111_prib
