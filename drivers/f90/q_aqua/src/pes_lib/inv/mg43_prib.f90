SUBROUTINE mg43_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg43_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg43_prib: bad size u'
!! else if (size(w).ne.mg43_npb(mxd)) then
!!  stop 'mg43_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 3 6 6 4 0 1 0 0 0
! prib,  dnpb(0:*): 1 3 12 34 94 228 538 1174 2488 5022
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(4:6) = u(0)*w(1:3)
 w(7:8) = u(1)*w(2:3)
 w(9) = u(2)*w(3)
 w(10) = u(3)*w(0)
 w(11) = u(4)*w(0)
 w(12) = u(5)*w(0)
 w(13) = u(6)*w(0)
 w(14) = u(7)*w(0)
 w(15) = u(8)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(16:27) = u(0)*w(4:15)
 w(28:36) = u(1)*w(7:15)
 w(37:43) = u(2)*w(9:15)
 w(44) = u(9)*w(0)
 w(45) = u(10)*w(0)
 w(46) = u(11)*w(0)
 w(47) = u(12)*w(0)
 w(48) = u(13)*w(0)
 w(49) = u(14)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(50:83) = u(0)*w(16:49)
 w(84:105) = u(1)*w(28:49)
 w(106:118) = u(2)*w(37:49)
 w(119:124) = u(3)*w(10:15)
 w(125:129) = u(4)*w(11:15)
 w(130:133) = u(5)*w(12:15)
 w(134:136) = u(6)*w(13:15)
 w(137:138) = u(7)*w(14:15)
 w(139) = u(8)*w(15)
 w(140) = u(15)*w(0)
 w(141) = u(16)*w(0)
 w(142) = u(17)*w(0)
 w(143) = u(18)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(144:237) = u(0)*w(50:143)
 w(238:297) = u(1)*w(84:143)
 w(298:335) = u(2)*w(106:143)
 w(336:341) = u(3)*w(44:49)
 w(342:347) = u(4)*w(44:49)
 w(348:353) = u(5)*w(44:49)
 w(354:359) = u(6)*w(44:49)
 w(360:365) = u(7)*w(44:49)
 w(366:371) = u(8)*w(44:49)
endif
! terms of degree 6
if (6.le.mxd) then
 w(372:599) = u(0)*w(144:371)
 w(600:733) = u(1)*w(238:371)
 w(734:807) = u(2)*w(298:371)
 w(808:832) = u(3)*w(119:143)
 w(833:851) = u(4)*w(125:143)
 w(852:865) = u(5)*w(130:143)
 w(866:875) = u(6)*w(134:143)
 w(876:882) = u(7)*w(137:143)
 w(883:887) = u(8)*w(139:143)
 w(888:893) = u(9)*w(44:49)
 w(894:898) = u(10)*w(45:49)
 w(899:902) = u(11)*w(46:49)
 w(903:905) = u(12)*w(47:49)
 w(906:907) = u(13)*w(48:49)
 w(908) = u(14)*w(49)
 w(909) = u(19)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(910:1447) = u(0)*w(372:909)
 w(1448:1757) = u(1)*w(600:909)
 w(1758:1933) = u(2)*w(734:909)
 w(1934:1969) = u(3)*w(336:371)
 w(1970:1999) = u(4)*w(342:371)
 w(2000:2023) = u(5)*w(348:371)
 w(2024:2041) = u(6)*w(354:371)
 w(2042:2053) = u(7)*w(360:371)
 w(2054:2059) = u(8)*w(366:371)
 w(2060:2063) = u(9)*w(140:143)
 w(2064:2067) = u(10)*w(140:143)
 w(2068:2071) = u(11)*w(140:143)
 w(2072:2075) = u(12)*w(140:143)
 w(2076:2079) = u(13)*w(140:143)
 w(2080:2083) = u(14)*w(140:143)
endif
! terms of degree 8
if (8.le.mxd) then
 w(2084:3257) = u(0)*w(910:2083)
 w(3258:3893) = u(1)*w(1448:2083)
 w(3894:4219) = u(2)*w(1758:2083)
 w(4220:4321) = u(3)*w(808:909)
 w(4322:4398) = u(4)*w(833:909)
 w(4399:4456) = u(5)*w(852:909)
 w(4457:4500) = u(6)*w(866:909)
 w(4501:4534) = u(7)*w(876:909)
 w(4535:4561) = u(8)*w(883:909)
 w(4562:4565) = u(15)*w(140:143)
 w(4566:4568) = u(16)*w(141:143)
 w(4569:4570) = u(17)*w(142:143)
 w(4571) = u(18)*w(143)
endif
! terms of degree 9
if (9.le.mxd) then
 w(4572:7059) = u(0)*w(2084:4571)
 w(7060:8373) = u(1)*w(3258:4571)
 w(8374:9051) = u(2)*w(3894:4571)
 w(9052:9201) = u(3)*w(1934:2083)
 w(9202:9315) = u(4)*w(1970:2083)
 w(9316:9399) = u(5)*w(2000:2083)
 w(9400:9459) = u(6)*w(2024:2083)
 w(9460:9501) = u(7)*w(2042:2083)
 w(9502:9531) = u(8)*w(2054:2083)
 w(9532:9553) = u(9)*w(888:909)
 w(9554:9569) = u(10)*w(894:909)
 w(9570:9580) = u(11)*w(899:909)
 w(9581:9587) = u(12)*w(903:909)
 w(9588:9591) = u(13)*w(906:909)
 w(9592:9593) = u(14)*w(908:909)
endif
END SUBROUTINE mg43_prib
