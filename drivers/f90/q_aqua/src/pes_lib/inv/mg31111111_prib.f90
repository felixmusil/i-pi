SUBROUTINE mg31111111_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg31111111_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg31111111_prib: bad size u'
!! else if (size(w).ne.mg31111111_npb(mxd)) then
!!  stop 'mg31111111_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 29 8 8 0 0 0 0 0 0
! prib,  dnpb(0:*): 1 29 443 4735 39708 277884 1686216 9105360 44577330 200650050
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
 w(10) = u(9)*w(0)
 w(11) = u(10)*w(0)
 w(12) = u(11)*w(0)
 w(13) = u(12)*w(0)
 w(14) = u(13)*w(0)
 w(15) = u(14)*w(0)
 w(16) = u(15)*w(0)
 w(17) = u(16)*w(0)
 w(18) = u(17)*w(0)
 w(19) = u(18)*w(0)
 w(20) = u(19)*w(0)
 w(21) = u(20)*w(0)
 w(22) = u(21)*w(0)
 w(23) = u(22)*w(0)
 w(24) = u(23)*w(0)
 w(25) = u(24)*w(0)
 w(26) = u(25)*w(0)
 w(27) = u(26)*w(0)
 w(28) = u(27)*w(0)
 w(29) = u(28)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(30:58) = u(0)*w(1:29)
 w(59:86) = u(1)*w(2:29)
 w(87:113) = u(2)*w(3:29)
 w(114:139) = u(3)*w(4:29)
 w(140:164) = u(4)*w(5:29)
 w(165:188) = u(5)*w(6:29)
 w(189:211) = u(6)*w(7:29)
 w(212:233) = u(7)*w(8:29)
 w(234:254) = u(8)*w(9:29)
 w(255:274) = u(9)*w(10:29)
 w(275:293) = u(10)*w(11:29)
 w(294:311) = u(11)*w(12:29)
 w(312:328) = u(12)*w(13:29)
 w(329:344) = u(13)*w(14:29)
 w(345:359) = u(14)*w(15:29)
 w(360:373) = u(15)*w(16:29)
 w(374:386) = u(16)*w(17:29)
 w(387:398) = u(17)*w(18:29)
 w(399:409) = u(18)*w(19:29)
 w(410:419) = u(19)*w(20:29)
 w(420:428) = u(20)*w(21:29)
 w(429:436) = u(21)*w(22:29)
 w(437:443) = u(22)*w(23:29)
 w(444:449) = u(23)*w(24:29)
 w(450:454) = u(24)*w(25:29)
 w(455:458) = u(25)*w(26:29)
 w(459:461) = u(26)*w(27:29)
 w(462:463) = u(27)*w(28:29)
 w(464) = u(28)*w(29)
 w(465) = u(29)*w(0)
 w(466) = u(30)*w(0)
 w(467) = u(31)*w(0)
 w(468) = u(32)*w(0)
 w(469) = u(33)*w(0)
 w(470) = u(34)*w(0)
 w(471) = u(35)*w(0)
 w(472) = u(36)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(473:915) = u(0)*w(30:472)
 w(916:1329) = u(1)*w(59:472)
 w(1330:1715) = u(2)*w(87:472)
 w(1716:2074) = u(3)*w(114:472)
 w(2075:2407) = u(4)*w(140:472)
 w(2408:2715) = u(5)*w(165:472)
 w(2716:2999) = u(6)*w(189:472)
 w(3000:3260) = u(7)*w(212:472)
 w(3261:3499) = u(8)*w(234:472)
 w(3500:3717) = u(9)*w(255:472)
 w(3718:3915) = u(10)*w(275:472)
 w(3916:4094) = u(11)*w(294:472)
 w(4095:4255) = u(12)*w(312:472)
 w(4256:4399) = u(13)*w(329:472)
 w(4400:4527) = u(14)*w(345:472)
 w(4528:4640) = u(15)*w(360:472)
 w(4641:4739) = u(16)*w(374:472)
 w(4740:4825) = u(17)*w(387:472)
 w(4826:4899) = u(18)*w(399:472)
 w(4900:4962) = u(19)*w(410:472)
 w(4963:5015) = u(20)*w(420:472)
 w(5016:5059) = u(21)*w(429:472)
 w(5060:5095) = u(22)*w(437:472)
 w(5096:5124) = u(23)*w(444:472)
 w(5125:5147) = u(24)*w(450:472)
 w(5148:5165) = u(25)*w(455:472)
 w(5166:5179) = u(26)*w(459:472)
 w(5180:5190) = u(27)*w(462:472)
 w(5191:5199) = u(28)*w(464:472)
 w(5200) = u(37)*w(0)
 w(5201) = u(38)*w(0)
 w(5202) = u(39)*w(0)
 w(5203) = u(40)*w(0)
 w(5204) = u(41)*w(0)
 w(5205) = u(42)*w(0)
 w(5206) = u(43)*w(0)
 w(5207) = u(44)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(5208:9942) = u(0)*w(473:5207)
 w(9943:14234) = u(1)*w(916:5207)
 w(14235:18112) = u(2)*w(1330:5207)
 w(18113:21604) = u(3)*w(1716:5207)
 w(21605:24737) = u(4)*w(2075:5207)
 w(24738:27537) = u(5)*w(2408:5207)
 w(27538:30029) = u(6)*w(2716:5207)
 w(30030:32237) = u(7)*w(3000:5207)
 w(32238:34184) = u(8)*w(3261:5207)
 w(34185:35892) = u(9)*w(3500:5207)
 w(35893:37382) = u(10)*w(3718:5207)
 w(37383:38674) = u(11)*w(3916:5207)
 w(38675:39787) = u(12)*w(4095:5207)
 w(39788:40739) = u(13)*w(4256:5207)
 w(40740:41547) = u(14)*w(4400:5207)
 w(41548:42227) = u(15)*w(4528:5207)
 w(42228:42794) = u(16)*w(4641:5207)
 w(42795:43262) = u(17)*w(4740:5207)
 w(43263:43644) = u(18)*w(4826:5207)
 w(43645:43952) = u(19)*w(4900:5207)
 w(43953:44197) = u(20)*w(4963:5207)
 w(44198:44389) = u(21)*w(5016:5207)
 w(44390:44537) = u(22)*w(5060:5207)
 w(44538:44649) = u(23)*w(5096:5207)
 w(44650:44732) = u(24)*w(5125:5207)
 w(44733:44792) = u(25)*w(5148:5207)
 w(44793:44834) = u(26)*w(5166:5207)
 w(44835:44862) = u(27)*w(5180:5207)
 w(44863:44879) = u(28)*w(5191:5207)
 w(44880:44887) = u(29)*w(465:472)
 w(44888:44894) = u(30)*w(466:472)
 w(44895:44900) = u(31)*w(467:472)
 w(44901:44905) = u(32)*w(468:472)
 w(44906:44909) = u(33)*w(469:472)
 w(44910:44912) = u(34)*w(470:472)
 w(44913:44914) = u(35)*w(471:472)
 w(44915) = u(36)*w(472)
endif
! terms of degree 5
if (5.le.mxd) then
 w(44916:84623) = u(0)*w(5208:44915)
 w(84624:119596) = u(1)*w(9943:44915)
 w(119597:150277) = u(2)*w(14235:44915)
 w(150278:177080) = u(3)*w(18113:44915)
 w(177081:200391) = u(4)*w(21605:44915)
 w(200392:220569) = u(5)*w(24738:44915)
 w(220570:237947) = u(6)*w(27538:44915)
 w(237948:252833) = u(7)*w(30030:44915)
 w(252834:265511) = u(8)*w(32238:44915)
 w(265512:276242) = u(9)*w(34185:44915)
 w(276243:285265) = u(10)*w(35893:44915)
 w(285266:292798) = u(11)*w(37383:44915)
 w(292799:299039) = u(12)*w(38675:44915)
 w(299040:304167) = u(13)*w(39788:44915)
 w(304168:308343) = u(14)*w(40740:44915)
 w(308344:311711) = u(15)*w(41548:44915)
 w(311712:314399) = u(16)*w(42228:44915)
 w(314400:316520) = u(17)*w(42795:44915)
 w(316521:318173) = u(18)*w(43263:44915)
 w(318174:319444) = u(19)*w(43645:44915)
 w(319445:320407) = u(20)*w(43953:44915)
 w(320408:321125) = u(21)*w(44198:44915)
 w(321126:321651) = u(22)*w(44390:44915)
 w(321652:322029) = u(23)*w(44538:44915)
 w(322030:322295) = u(24)*w(44650:44915)
 w(322296:322478) = u(25)*w(44733:44915)
 w(322479:322601) = u(26)*w(44793:44915)
 w(322602:322682) = u(27)*w(44835:44915)
 w(322683:322735) = u(28)*w(44863:44915)
 w(322736:322743) = u(29)*w(5200:5207)
 w(322744:322751) = u(30)*w(5200:5207)
 w(322752:322759) = u(31)*w(5200:5207)
 w(322760:322767) = u(32)*w(5200:5207)
 w(322768:322775) = u(33)*w(5200:5207)
 w(322776:322783) = u(34)*w(5200:5207)
 w(322784:322791) = u(35)*w(5200:5207)
 w(322792:322799) = u(36)*w(5200:5207)
endif
! terms of degree 6
if (6.le.mxd) then
 w(322800:600683) = u(0)*w(44916:322799)
 w(600684:838859) = u(1)*w(84624:322799)
 w(838860:1042062) = u(2)*w(119597:322799)
 w(1042063:1214584) = u(3)*w(150278:322799)
 w(1214585:1360303) = u(4)*w(177081:322799)
 w(1360304:1482711) = u(5)*w(200392:322799)
 w(1482712:1584941) = u(6)*w(220570:322799)
 w(1584942:1669793) = u(7)*w(237948:322799)
 w(1669794:1739759) = u(8)*w(252834:322799)
 w(1739760:1797047) = u(9)*w(265512:322799)
 w(1797048:1843604) = u(10)*w(276243:322799)
 w(1843605:1881138) = u(11)*w(285266:322799)
 w(1881139:1911139) = u(12)*w(292799:322799)
 w(1911140:1934899) = u(13)*w(299040:322799)
 w(1934900:1953531) = u(14)*w(304168:322799)
 w(1953532:1967987) = u(15)*w(308344:322799)
 w(1967988:1979075) = u(16)*w(311712:322799)
 w(1979076:1987475) = u(17)*w(314400:322799)
 w(1987476:1993754) = u(18)*w(316521:322799)
 w(1993755:1998380) = u(19)*w(318174:322799)
 w(1998381:2001735) = u(20)*w(319445:322799)
 w(2001736:2004127) = u(21)*w(320408:322799)
 w(2004128:2005801) = u(22)*w(321126:322799)
 w(2005802:2006949) = u(23)*w(321652:322799)
 w(2006950:2007719) = u(24)*w(322030:322799)
 w(2007720:2008223) = u(25)*w(322296:322799)
 w(2008224:2008544) = u(26)*w(322479:322799)
 w(2008545:2008742) = u(27)*w(322602:322799)
 w(2008743:2008859) = u(28)*w(322683:322799)
 w(2008860:2008895) = u(29)*w(44880:44915)
 w(2008896:2008923) = u(30)*w(44888:44915)
 w(2008924:2008944) = u(31)*w(44895:44915)
 w(2008945:2008959) = u(32)*w(44901:44915)
 w(2008960:2008969) = u(33)*w(44906:44915)
 w(2008970:2008975) = u(34)*w(44910:44915)
 w(2008976:2008978) = u(35)*w(44913:44915)
 w(2008979) = u(36)*w(44915)
 w(2008980:2008987) = u(37)*w(5200:5207)
 w(2008988:2008994) = u(38)*w(5201:5207)
 w(2008995:2009000) = u(39)*w(5202:5207)
 w(2009001:2009005) = u(40)*w(5203:5207)
 w(2009006:2009009) = u(41)*w(5204:5207)
 w(2009010:2009012) = u(42)*w(5205:5207)
 w(2009013:2009014) = u(43)*w(5206:5207)
 w(2009015) = u(44)*w(5207)
endif
! terms of degree 7
if (7.le.mxd) then
 w(2009016:3695231) = u(0)*w(322800:2009015)
 w(3695232:5103563) = u(1)*w(600684:2009015)
 w(5103564:6273719) = u(2)*w(838860:2009015)
 w(6273720:7240672) = u(3)*w(1042063:2009015)
 w(7240673:8035103) = u(4)*w(1214585:2009015)
 w(8035104:8683815) = u(5)*w(1360304:2009015)
 w(8683816:9210119) = u(6)*w(1482712:2009015)
 w(9210120:9634193) = u(7)*w(1584942:2009015)
 w(9634194:9973415) = u(8)*w(1669794:2009015)
 w(9973416:10242671) = u(9)*w(1739760:2009015)
 w(10242672:10454639) = u(10)*w(1797048:2009015)
 w(10454640:10620050) = u(11)*w(1843605:2009015)
 w(10620051:10747927) = u(12)*w(1881139:2009015)
 w(10747928:10845803) = u(13)*w(1911140:2009015)
 w(10845804:10919919) = u(14)*w(1934900:2009015)
 w(10919920:10975403) = u(15)*w(1953532:2009015)
 w(10975404:11016431) = u(16)*w(1967988:2009015)
 w(11016432:11046371) = u(17)*w(1979076:2009015)
 w(11046372:11067911) = u(18)*w(1987476:2009015)
 w(11067912:11083172) = u(19)*w(1993755:2009015)
 w(11083173:11093807) = u(20)*w(1998381:2009015)
 w(11093808:11101087) = u(21)*w(2001736:2009015)
 w(11101088:11105975) = u(22)*w(2004128:2009015)
 w(11105976:11109189) = u(23)*w(2005802:2009015)
 w(11109190:11111255) = u(24)*w(2006950:2009015)
 w(11111256:11112551) = u(25)*w(2007720:2009015)
 w(11112552:11113343) = u(26)*w(2008224:2009015)
 w(11113344:11113814) = u(27)*w(2008545:2009015)
 w(11113815:11114087) = u(28)*w(2008743:2009015)
 w(11114088:11114151) = u(29)*w(322736:322799)
 w(11114152:11114207) = u(30)*w(322744:322799)
 w(11114208:11114255) = u(31)*w(322752:322799)
 w(11114256:11114295) = u(32)*w(322760:322799)
 w(11114296:11114327) = u(33)*w(322768:322799)
 w(11114328:11114351) = u(34)*w(322776:322799)
 w(11114352:11114367) = u(35)*w(322784:322799)
 w(11114368:11114375) = u(36)*w(322792:322799)
endif
! terms of degree 8
if (8.le.mxd) then
 w(11114376:20219735) = u(0)*w(2009016:11114375)
 w(20219736:27638879) = u(1)*w(3695232:11114375)
 w(27638880:33649691) = u(2)*w(5103564:11114375)
 w(33649692:38490347) = u(3)*w(6273720:11114375)
 w(38490348:42364050) = u(4)*w(7240673:11114375)
 w(42364051:45443322) = u(5)*w(8035104:11114375)
 w(45443323:47873882) = u(6)*w(8683816:11114375)
 w(47873883:49778138) = u(7)*w(9210120:11114375)
 w(49778139:51258320) = u(8)*w(9634194:11114375)
 w(51258321:52399280) = u(9)*w(9973416:11114375)
 w(52399281:53270984) = u(10)*w(10242672:11114375)
 w(53270985:53930720) = u(11)*w(10454640:11114375)
 w(53930721:54425045) = u(12)*w(10620051:11114375)
 w(54425046:54791493) = u(13)*w(10747928:11114375)
 w(54791494:55060065) = u(14)*w(10845804:11114375)
 w(55060066:55254521) = u(15)*w(10919920:11114375)
 w(55254522:55393493) = u(16)*w(10975404:11114375)
 w(55393494:55491437) = u(17)*w(11016432:11114375)
 w(55491438:55559441) = u(18)*w(11046372:11114375)
 w(55559442:55605905) = u(19)*w(11067912:11114375)
 w(55605906:55637108) = u(20)*w(11083173:11114375)
 w(55637109:55657676) = u(21)*w(11093808:11114375)
 w(55657677:55670964) = u(22)*w(11101088:11114375)
 w(55670965:55679364) = u(23)*w(11105976:11114375)
 w(55679365:55684550) = u(24)*w(11109190:11114375)
 w(55684551:55687670) = u(25)*w(11111256:11114375)
 w(55687671:55689494) = u(26)*w(11112552:11114375)
 w(55689495:55690526) = u(27)*w(11113344:11114375)
 w(55690527:55691087) = u(28)*w(11113815:11114375)
 w(55691088:55691243) = u(29)*w(2008860:2009015)
 w(55691244:55691363) = u(30)*w(2008896:2009015)
 w(55691364:55691455) = u(31)*w(2008924:2009015)
 w(55691456:55691526) = u(32)*w(2008945:2009015)
 w(55691527:55691582) = u(33)*w(2008960:2009015)
 w(55691583:55691628) = u(34)*w(2008970:2009015)
 w(55691629:55691668) = u(35)*w(2008976:2009015)
 w(55691669:55691705) = u(36)*w(2008979:2009015)
endif
! terms of degree 9
if (9.le.mxd) then
 w(55691706:100269035) = u(0)*w(11114376:55691705)
 w(100269036:135741005) = u(1)*w(20219736:55691705)
 w(135741006:163793831) = u(2)*w(27638880:55691705)
 w(163793832:185835845) = u(3)*w(33649692:55691705)
 w(185835846:203037203) = u(4)*w(38490348:55691705)
 w(203037204:216364858) = u(5)*w(42364051:55691705)
 w(216364859:226613241) = u(6)*w(45443323:55691705)
 w(226613242:234431064) = u(7)*w(47873883:55691705)
 w(234431065:240344631) = u(8)*w(49778139:55691705)
 w(240344632:244778016) = u(9)*w(51258321:55691705)
 w(244778017:248070441) = u(10)*w(52399281:55691705)
 w(248070442:250491162) = u(11)*w(53270985:55691705)
 w(250491163:252252147) = u(12)*w(53930721:55691705)
 w(252252148:253518807) = u(13)*w(54425046:55691705)
 w(253518808:254419019) = u(14)*w(54791494:55691705)
 w(254419020:255050659) = u(15)*w(55060066:55691705)
 w(255050660:255487843) = u(16)*w(55254522:55691705)
 w(255487844:255786055) = u(17)*w(55393494:55691705)
 w(255786056:255986323) = u(18)*w(55491438:55691705)
 w(255986324:256118587) = u(19)*w(55559442:55691705)
 w(256118588:256204387) = u(20)*w(55605906:55691705)
 w(256204388:256258984) = u(21)*w(55637109:55691705)
 w(256258985:256293013) = u(22)*w(55657677:55691705)
 w(256293014:256313754) = u(23)*w(55670965:55691705)
 w(256313755:256326095) = u(24)*w(55679365:55691705)
 w(256326096:256333250) = u(25)*w(55684551:55691705)
 w(256333251:256337285) = u(26)*w(55687671:55691705)
 w(256337286:256339496) = u(27)*w(55689495:55691705)
 w(256339497:256340675) = u(28)*w(55690527:55691705)
 w(256340676:256340963) = u(29)*w(11114088:11114375)
 w(256340964:256341187) = u(30)*w(11114152:11114375)
 w(256341188:256341355) = u(31)*w(11114208:11114375)
 w(256341356:256341475) = u(32)*w(11114256:11114375)
 w(256341476:256341555) = u(33)*w(11114296:11114375)
 w(256341556:256341603) = u(34)*w(11114328:11114375)
 w(256341604:256341627) = u(35)*w(11114352:11114375)
 w(256341628:256341635) = u(36)*w(11114368:11114375)
 w(256341636:256341671) = u(37)*w(2008980:2009015)
 w(256341672:256341699) = u(38)*w(2008988:2009015)
 w(256341700:256341720) = u(39)*w(2008995:2009015)
 w(256341721:256341735) = u(40)*w(2009001:2009015)
 w(256341736:256341745) = u(41)*w(2009006:2009015)
 w(256341746:256341751) = u(42)*w(2009010:2009015)
 w(256341752:256341754) = u(43)*w(2009013:2009015)
 w(256341755) = u(44)*w(2009015)
endif
END SUBROUTINE mg31111111_prib
