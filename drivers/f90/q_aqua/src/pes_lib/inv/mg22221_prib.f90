SUBROUTINE mg22221_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg22221_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg22221_prib: bad size u'
!! else if (size(w).ne.mg22221_npb(mxd)) then
!!  stop 'mg22221_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 14 22 0 0 0 0 0 0 0
! prib,  dnpb(0:*): 1 14 127 868 4943 24430 108081 436032 1627704 5681104
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
 w(10) = u(9)*w(0)
 w(11) = u(10)*w(0)
 w(12) = u(11)*w(0)
 w(13) = u(12)*w(0)
 w(14) = u(13)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(15:28) = u(0)*w(1:14)
 w(29:41) = u(1)*w(2:14)
 w(42:53) = u(2)*w(3:14)
 w(54:64) = u(3)*w(4:14)
 w(65:74) = u(4)*w(5:14)
 w(75:83) = u(5)*w(6:14)
 w(84:91) = u(6)*w(7:14)
 w(92:98) = u(7)*w(8:14)
 w(99:104) = u(8)*w(9:14)
 w(105:109) = u(9)*w(10:14)
 w(110:113) = u(10)*w(11:14)
 w(114:116) = u(11)*w(12:14)
 w(117:118) = u(12)*w(13:14)
 w(119) = u(13)*w(14)
 w(120) = u(14)*w(0)
 w(121) = u(15)*w(0)
 w(122) = u(16)*w(0)
 w(123) = u(17)*w(0)
 w(124) = u(18)*w(0)
 w(125) = u(19)*w(0)
 w(126) = u(20)*w(0)
 w(127) = u(21)*w(0)
 w(128) = u(22)*w(0)
 w(129) = u(23)*w(0)
 w(130) = u(24)*w(0)
 w(131) = u(25)*w(0)
 w(132) = u(26)*w(0)
 w(133) = u(27)*w(0)
 w(134) = u(28)*w(0)
 w(135) = u(29)*w(0)
 w(136) = u(30)*w(0)
 w(137) = u(31)*w(0)
 w(138) = u(32)*w(0)
 w(139) = u(33)*w(0)
 w(140) = u(34)*w(0)
 w(141) = u(35)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(142:268) = u(0)*w(15:141)
 w(269:381) = u(1)*w(29:141)
 w(382:481) = u(2)*w(42:141)
 w(482:569) = u(3)*w(54:141)
 w(570:646) = u(4)*w(65:141)
 w(647:713) = u(5)*w(75:141)
 w(714:771) = u(6)*w(84:141)
 w(772:821) = u(7)*w(92:141)
 w(822:864) = u(8)*w(99:141)
 w(865:901) = u(9)*w(105:141)
 w(902:933) = u(10)*w(110:141)
 w(934:961) = u(11)*w(114:141)
 w(962:986) = u(12)*w(117:141)
 w(987:1009) = u(13)*w(119:141)
endif
! terms of degree 4
if (4.le.mxd) then
 w(1010:1877) = u(0)*w(142:1009)
 w(1878:2618) = u(1)*w(269:1009)
 w(2619:3246) = u(2)*w(382:1009)
 w(3247:3774) = u(3)*w(482:1009)
 w(3775:4214) = u(4)*w(570:1009)
 w(4215:4577) = u(5)*w(647:1009)
 w(4578:4873) = u(6)*w(714:1009)
 w(4874:5111) = u(7)*w(772:1009)
 w(5112:5299) = u(8)*w(822:1009)
 w(5300:5444) = u(9)*w(865:1009)
 w(5445:5552) = u(10)*w(902:1009)
 w(5553:5628) = u(11)*w(934:1009)
 w(5629:5676) = u(12)*w(962:1009)
 w(5677:5699) = u(13)*w(987:1009)
 w(5700:5721) = u(14)*w(120:141)
 w(5722:5742) = u(15)*w(121:141)
 w(5743:5762) = u(16)*w(122:141)
 w(5763:5781) = u(17)*w(123:141)
 w(5782:5799) = u(18)*w(124:141)
 w(5800:5816) = u(19)*w(125:141)
 w(5817:5832) = u(20)*w(126:141)
 w(5833:5847) = u(21)*w(127:141)
 w(5848:5861) = u(22)*w(128:141)
 w(5862:5874) = u(23)*w(129:141)
 w(5875:5886) = u(24)*w(130:141)
 w(5887:5897) = u(25)*w(131:141)
 w(5898:5907) = u(26)*w(132:141)
 w(5908:5916) = u(27)*w(133:141)
 w(5917:5924) = u(28)*w(134:141)
 w(5925:5931) = u(29)*w(135:141)
 w(5932:5937) = u(30)*w(136:141)
 w(5938:5942) = u(31)*w(137:141)
 w(5943:5946) = u(32)*w(138:141)
 w(5947:5949) = u(33)*w(139:141)
 w(5950:5951) = u(34)*w(140:141)
 w(5952) = u(35)*w(141)
endif
! terms of degree 5
if (5.le.mxd) then
 w(5953:10895) = u(0)*w(1010:5952)
 w(10896:14970) = u(1)*w(1878:5952)
 w(14971:18304) = u(2)*w(2619:5952)
 w(18305:21010) = u(3)*w(3247:5952)
 w(21011:23188) = u(4)*w(3775:5952)
 w(23189:24926) = u(5)*w(4215:5952)
 w(24927:26301) = u(6)*w(4578:5952)
 w(26302:27380) = u(7)*w(4874:5952)
 w(27381:28221) = u(8)*w(5112:5952)
 w(28222:28874) = u(9)*w(5300:5952)
 w(28875:29382) = u(10)*w(5445:5952)
 w(29383:29782) = u(11)*w(5553:5952)
 w(29783:30106) = u(12)*w(5629:5952)
 w(30107:30382) = u(13)*w(5677:5952)
endif
! terms of degree 6
if (6.le.mxd) then
 w(30383:54812) = u(0)*w(5953:30382)
 w(54813:74299) = u(1)*w(10896:30382)
 w(74300:89711) = u(2)*w(14971:30382)
 w(89712:101789) = u(3)*w(18305:30382)
 w(101790:111161) = u(4)*w(21011:30382)
 w(111162:118355) = u(5)*w(23189:30382)
 w(118356:123811) = u(6)*w(24927:30382)
 w(123812:127892) = u(7)*w(26302:30382)
 w(127893:130894) = u(8)*w(27381:30382)
 w(130895:133055) = u(9)*w(28222:30382)
 w(133056:134563) = u(10)*w(28875:30382)
 w(134564:135563) = u(11)*w(29383:30382)
 w(135564:136163) = u(12)*w(29783:30382)
 w(136164:136439) = u(13)*w(30107:30382)
 w(136440:136692) = u(14)*w(5700:5952)
 w(136693:136923) = u(15)*w(5722:5952)
 w(136924:137133) = u(16)*w(5743:5952)
 w(137134:137323) = u(17)*w(5763:5952)
 w(137324:137494) = u(18)*w(5782:5952)
 w(137495:137647) = u(19)*w(5800:5952)
 w(137648:137783) = u(20)*w(5817:5952)
 w(137784:137903) = u(21)*w(5833:5952)
 w(137904:138008) = u(22)*w(5848:5952)
 w(138009:138099) = u(23)*w(5862:5952)
 w(138100:138177) = u(24)*w(5875:5952)
 w(138178:138243) = u(25)*w(5887:5952)
 w(138244:138298) = u(26)*w(5898:5952)
 w(138299:138343) = u(27)*w(5908:5952)
 w(138344:138379) = u(28)*w(5917:5952)
 w(138380:138407) = u(29)*w(5925:5952)
 w(138408:138428) = u(30)*w(5932:5952)
 w(138429:138443) = u(31)*w(5938:5952)
 w(138444:138453) = u(32)*w(5943:5952)
 w(138454:138459) = u(33)*w(5947:5952)
 w(138460:138462) = u(34)*w(5950:5952)
 w(138463) = u(35)*w(5952)
endif
! terms of degree 7
if (7.le.mxd) then
 w(138464:246544) = u(0)*w(30383:138463)
 w(246545:330195) = u(1)*w(54813:138463)
 w(330196:394359) = u(2)*w(74300:138463)
 w(394360:443111) = u(3)*w(89712:138463)
 w(443112:479785) = u(4)*w(101790:138463)
 w(479786:507087) = u(5)*w(111162:138463)
 w(507088:527195) = u(6)*w(118356:138463)
 w(527196:541847) = u(7)*w(123812:138463)
 w(541848:552418) = u(8)*w(127893:138463)
 w(552419:559987) = u(9)*w(130895:138463)
 w(559988:565395) = u(10)*w(133056:138463)
 w(565396:569295) = u(11)*w(134564:138463)
 w(569296:572195) = u(12)*w(135564:138463)
 w(572196:574495) = u(13)*w(136164:138463)
endif
! terms of degree 8
if (8.le.mxd) then
 w(574496:1010527) = u(0)*w(138464:574495)
 w(1010528:1338478) = u(1)*w(246545:574495)
 w(1338479:1582778) = u(2)*w(330196:574495)
 w(1582779:1762914) = u(3)*w(394360:574495)
 w(1762915:1894298) = u(4)*w(443112:574495)
 w(1894299:1989008) = u(5)*w(479786:574495)
 w(1989009:2056416) = u(6)*w(507088:574495)
 w(2056417:2103716) = u(7)*w(527196:574495)
 w(2103717:2136364) = u(8)*w(541848:574495)
 w(2136365:2158441) = u(9)*w(552419:574495)
 w(2158442:2172949) = u(10)*w(559988:574495)
 w(2172950:2182049) = u(11)*w(565396:574495)
 w(2182050:2187249) = u(12)*w(569296:574495)
 w(2187250:2189549) = u(13)*w(572196:574495)
 w(2189550:2191573) = u(14)*w(136440:138463)
 w(2191574:2193344) = u(15)*w(136693:138463)
 w(2193345:2194884) = u(16)*w(136924:138463)
 w(2194885:2196214) = u(17)*w(137134:138463)
 w(2196215:2197354) = u(18)*w(137324:138463)
 w(2197355:2198323) = u(19)*w(137495:138463)
 w(2198324:2199139) = u(20)*w(137648:138463)
 w(2199140:2199819) = u(21)*w(137784:138463)
 w(2199820:2200379) = u(22)*w(137904:138463)
 w(2200380:2200834) = u(23)*w(138009:138463)
 w(2200835:2201198) = u(24)*w(138100:138463)
 w(2201199:2201484) = u(25)*w(138178:138463)
 w(2201485:2201704) = u(26)*w(138244:138463)
 w(2201705:2201869) = u(27)*w(138299:138463)
 w(2201870:2201989) = u(28)*w(138344:138463)
 w(2201990:2202073) = u(29)*w(138380:138463)
 w(2202074:2202129) = u(30)*w(138408:138463)
 w(2202130:2202164) = u(31)*w(138429:138463)
 w(2202165:2202184) = u(32)*w(138444:138463)
 w(2202185:2202194) = u(33)*w(138454:138463)
 w(2202195:2202198) = u(34)*w(138460:138463)
 w(2202199) = u(35)*w(138463)
endif
! terms of degree 9
if (9.le.mxd) then
 w(2202200:3829903) = u(0)*w(574496:2202199)
 w(3829904:5021575) = u(1)*w(1010528:2202199)
 w(5021576:5885296) = u(2)*w(1338479:2202199)
 w(5885297:6504717) = u(3)*w(1582779:2202199)
 w(6504718:6944002) = u(4)*w(1762915:2202199)
 w(6944003:7251903) = u(5)*w(1894299:2202199)
 w(7251904:7465094) = u(6)*w(1989009:2202199)
 w(7465095:7610877) = u(7)*w(2056417:2202199)
 w(7610878:7709360) = u(8)*w(2103717:2202199)
 w(7709361:7775195) = u(9)*w(2136365:2202199)
 w(7775196:7818953) = u(10)*w(2158442:2202199)
 w(7818954:7848203) = u(11)*w(2172950:2202199)
 w(7848204:7868353) = u(12)*w(2182050:2202199)
 w(7868354:7883303) = u(13)*w(2187250:2202199)
endif
END SUBROUTINE mg22221_prib
