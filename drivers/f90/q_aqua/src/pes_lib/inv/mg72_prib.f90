SUBROUTINE mg72_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg72_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg72_prib: bad size u'
!! else if (size(w).ne.mg72_npb(mxd)) then
!!  stop 'mg72_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 3 5 7 5 4 4 4 0 0
! prib,  dnpb(0:*): 1 3 11 32 86 212 502 1120 2414 5016
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(4:6) = u(0)*w(1:3)
 w(7:8) = u(1)*w(2:3)
 w(9) = u(2)*w(3)
 w(10) = u(3)*w(0)
 w(11) = u(4)*w(0)
 w(12) = u(5)*w(0)
 w(13) = u(6)*w(0)
 w(14) = u(7)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(15:25) = u(0)*w(4:14)
 w(26:33) = u(1)*w(7:14)
 w(34:39) = u(2)*w(9:14)
 w(40) = u(8)*w(0)
 w(41) = u(9)*w(0)
 w(42) = u(10)*w(0)
 w(43) = u(11)*w(0)
 w(44) = u(12)*w(0)
 w(45) = u(13)*w(0)
 w(46) = u(14)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(47:78) = u(0)*w(15:46)
 w(79:99) = u(1)*w(26:46)
 w(100:112) = u(2)*w(34:46)
 w(113:117) = u(3)*w(10:14)
 w(118:121) = u(4)*w(11:14)
 w(122:124) = u(5)*w(12:14)
 w(125:126) = u(6)*w(13:14)
 w(127) = u(7)*w(14)
 w(128) = u(15)*w(0)
 w(129) = u(16)*w(0)
 w(130) = u(17)*w(0)
 w(131) = u(18)*w(0)
 w(132) = u(19)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(133:218) = u(0)*w(47:132)
 w(219:272) = u(1)*w(79:132)
 w(273:305) = u(2)*w(100:132)
 w(306:312) = u(3)*w(40:46)
 w(313:319) = u(4)*w(40:46)
 w(320:326) = u(5)*w(40:46)
 w(327:333) = u(6)*w(40:46)
 w(334:340) = u(7)*w(40:46)
 w(341) = u(20)*w(0)
 w(342) = u(21)*w(0)
 w(343) = u(22)*w(0)
 w(344) = u(23)*w(0)
endif
! terms of degree 6
if (6.le.mxd) then
 w(345:556) = u(0)*w(133:344)
 w(557:682) = u(1)*w(219:344)
 w(683:754) = u(2)*w(273:344)
 w(755:774) = u(3)*w(113:132)
 w(775:789) = u(4)*w(118:132)
 w(790:800) = u(5)*w(122:132)
 w(801:808) = u(6)*w(125:132)
 w(809:814) = u(7)*w(127:132)
 w(815:821) = u(8)*w(40:46)
 w(822:827) = u(9)*w(41:46)
 w(828:832) = u(10)*w(42:46)
 w(833:836) = u(11)*w(43:46)
 w(837:839) = u(12)*w(44:46)
 w(840:841) = u(13)*w(45:46)
 w(842) = u(14)*w(46)
 w(843) = u(24)*w(0)
 w(844) = u(25)*w(0)
 w(845) = u(26)*w(0)
 w(846) = u(27)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(847:1348) = u(0)*w(345:846)
 w(1349:1638) = u(1)*w(557:846)
 w(1639:1802) = u(2)*w(683:846)
 w(1803:1841) = u(3)*w(306:344)
 w(1842:1873) = u(4)*w(313:344)
 w(1874:1898) = u(5)*w(320:344)
 w(1899:1916) = u(6)*w(327:344)
 w(1917:1927) = u(7)*w(334:344)
 w(1928:1932) = u(8)*w(128:132)
 w(1933:1937) = u(9)*w(128:132)
 w(1938:1942) = u(10)*w(128:132)
 w(1943:1947) = u(11)*w(128:132)
 w(1948:1952) = u(12)*w(128:132)
 w(1953:1957) = u(13)*w(128:132)
 w(1958:1962) = u(14)*w(128:132)
 w(1963) = u(28)*w(0)
 w(1964) = u(29)*w(0)
 w(1965) = u(30)*w(0)
 w(1966) = u(31)*w(0)
endif
! terms of degree 8
if (8.le.mxd) then
 w(1967:3086) = u(0)*w(847:1966)
 w(3087:3704) = u(1)*w(1349:1966)
 w(3705:4032) = u(2)*w(1639:1966)
 w(4033:4124) = u(3)*w(755:846)
 w(4125:4196) = u(4)*w(775:846)
 w(4197:4253) = u(5)*w(790:846)
 w(4254:4299) = u(6)*w(801:846)
 w(4300:4337) = u(7)*w(809:846)
 w(4338:4341) = u(8)*w(341:344)
 w(4342:4345) = u(9)*w(341:344)
 w(4346:4349) = u(10)*w(341:344)
 w(4350:4353) = u(11)*w(341:344)
 w(4354:4357) = u(12)*w(341:344)
 w(4358:4361) = u(13)*w(341:344)
 w(4362:4365) = u(14)*w(341:344)
 w(4366:4370) = u(15)*w(128:132)
 w(4371:4374) = u(16)*w(129:132)
 w(4375:4377) = u(17)*w(130:132)
 w(4378:4379) = u(18)*w(131:132)
 w(4380) = u(19)*w(132)
endif
! terms of degree 9
if (9.le.mxd) then
 w(4381:6794) = u(0)*w(1967:4380)
 w(6795:8088) = u(1)*w(3087:4380)
 w(8089:8764) = u(2)*w(3705:4380)
 w(8765:8928) = u(3)*w(1803:1966)
 w(8929:9053) = u(4)*w(1842:1966)
 w(9054:9146) = u(5)*w(1874:1966)
 w(9147:9214) = u(6)*w(1899:1966)
 w(9215:9264) = u(7)*w(1917:1966)
 w(9265:9296) = u(8)*w(815:846)
 w(9297:9321) = u(9)*w(822:846)
 w(9322:9340) = u(10)*w(828:846)
 w(9341:9354) = u(11)*w(833:846)
 w(9355:9364) = u(12)*w(837:846)
 w(9365:9371) = u(13)*w(840:846)
 w(9372:9376) = u(14)*w(842:846)
 w(9377:9380) = u(15)*w(341:344)
 w(9381:9384) = u(16)*w(341:344)
 w(9385:9388) = u(17)*w(341:344)
 w(9389:9392) = u(18)*w(341:344)
 w(9393:9396) = u(19)*w(341:344)
endif
END SUBROUTINE mg72_prib
