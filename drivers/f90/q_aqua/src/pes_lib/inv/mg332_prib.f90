SUBROUTINE mg332_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg332_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg332_prib: bad size u'
!! else if (size(w).ne.mg332_npb(mxd)) then
!!  stop 'mg332_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 6 11 7 1 0 3 0 0 0
! prib,  dnpb(0:*): 1 6 32 129 466 1494 4437 12252 31998 79389
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(7:12) = u(0)*w(1:6)
 w(13:17) = u(1)*w(2:6)
 w(18:21) = u(2)*w(3:6)
 w(22:24) = u(3)*w(4:6)
 w(25:26) = u(4)*w(5:6)
 w(27) = u(5)*w(6)
 w(28) = u(6)*w(0)
 w(29) = u(7)*w(0)
 w(30) = u(8)*w(0)
 w(31) = u(9)*w(0)
 w(32) = u(10)*w(0)
 w(33) = u(11)*w(0)
 w(34) = u(12)*w(0)
 w(35) = u(13)*w(0)
 w(36) = u(14)*w(0)
 w(37) = u(15)*w(0)
 w(38) = u(16)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(39:70) = u(0)*w(7:38)
 w(71:96) = u(1)*w(13:38)
 w(97:117) = u(2)*w(18:38)
 w(118:134) = u(3)*w(22:38)
 w(135:148) = u(4)*w(25:38)
 w(149:160) = u(5)*w(27:38)
 w(161) = u(17)*w(0)
 w(162) = u(18)*w(0)
 w(163) = u(19)*w(0)
 w(164) = u(20)*w(0)
 w(165) = u(21)*w(0)
 w(166) = u(22)*w(0)
 w(167) = u(23)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(168:296) = u(0)*w(39:167)
 w(297:393) = u(1)*w(71:167)
 w(394:464) = u(2)*w(97:167)
 w(465:514) = u(3)*w(118:167)
 w(515:547) = u(4)*w(135:167)
 w(548:566) = u(5)*w(149:167)
 w(567:577) = u(6)*w(28:38)
 w(578:587) = u(7)*w(29:38)
 w(588:596) = u(8)*w(30:38)
 w(597:604) = u(9)*w(31:38)
 w(605:611) = u(10)*w(32:38)
 w(612:617) = u(11)*w(33:38)
 w(618:622) = u(12)*w(34:38)
 w(623:626) = u(13)*w(35:38)
 w(627:629) = u(14)*w(36:38)
 w(630:631) = u(15)*w(37:38)
 w(632) = u(16)*w(38)
 w(633) = u(24)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(634:1099) = u(0)*w(168:633)
 w(1100:1436) = u(1)*w(297:633)
 w(1437:1676) = u(2)*w(394:633)
 w(1677:1845) = u(3)*w(465:633)
 w(1846:1964) = u(4)*w(515:633)
 w(1965:2050) = u(5)*w(548:633)
 w(2051:2057) = u(6)*w(161:167)
 w(2058:2064) = u(7)*w(161:167)
 w(2065:2071) = u(8)*w(161:167)
 w(2072:2078) = u(9)*w(161:167)
 w(2079:2085) = u(10)*w(161:167)
 w(2086:2092) = u(11)*w(161:167)
 w(2093:2099) = u(12)*w(161:167)
 w(2100:2106) = u(13)*w(161:167)
 w(2107:2113) = u(14)*w(161:167)
 w(2114:2120) = u(15)*w(161:167)
 w(2121:2127) = u(16)*w(161:167)
endif
! terms of degree 6
if (6.le.mxd) then
 w(2128:3621) = u(0)*w(634:2127)
 w(3622:4649) = u(1)*w(1100:2127)
 w(4650:5340) = u(2)*w(1437:2127)
 w(5341:5791) = u(3)*w(1677:2127)
 w(5792:6073) = u(4)*w(1846:2127)
 w(6074:6236) = u(5)*w(1965:2127)
 w(6237:6303) = u(6)*w(567:633)
 w(6304:6359) = u(7)*w(578:633)
 w(6360:6405) = u(8)*w(588:633)
 w(6406:6442) = u(9)*w(597:633)
 w(6443:6471) = u(10)*w(605:633)
 w(6472:6493) = u(11)*w(612:633)
 w(6494:6509) = u(12)*w(618:633)
 w(6510:6520) = u(13)*w(623:633)
 w(6521:6527) = u(14)*w(627:633)
 w(6528:6531) = u(15)*w(630:633)
 w(6532:6533) = u(16)*w(632:633)
 w(6534:6540) = u(17)*w(161:167)
 w(6541:6546) = u(18)*w(162:167)
 w(6547:6551) = u(19)*w(163:167)
 w(6552:6555) = u(20)*w(164:167)
 w(6556:6558) = u(21)*w(165:167)
 w(6559:6560) = u(22)*w(166:167)
 w(6561) = u(23)*w(167)
 w(6562) = u(25)*w(0)
 w(6563) = u(26)*w(0)
 w(6564) = u(27)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(6565:11001) = u(0)*w(2128:6564)
 w(11002:13944) = u(1)*w(3622:6564)
 w(13945:15859) = u(2)*w(4650:6564)
 w(15860:17083) = u(3)*w(5341:6564)
 w(17084:17856) = u(4)*w(5792:6564)
 w(17857:18347) = u(5)*w(6074:6564)
 w(18348:18424) = u(6)*w(2051:2127)
 w(18425:18494) = u(7)*w(2058:2127)
 w(18495:18557) = u(8)*w(2065:2127)
 w(18558:18613) = u(9)*w(2072:2127)
 w(18614:18662) = u(10)*w(2079:2127)
 w(18663:18704) = u(11)*w(2086:2127)
 w(18705:18739) = u(12)*w(2093:2127)
 w(18740:18767) = u(13)*w(2100:2127)
 w(18768:18788) = u(14)*w(2107:2127)
 w(18789:18802) = u(15)*w(2114:2127)
 w(18803:18809) = u(16)*w(2121:2127)
 w(18810) = u(17)*w(633)
 w(18811) = u(18)*w(633)
 w(18812) = u(19)*w(633)
 w(18813) = u(20)*w(633)
 w(18814) = u(21)*w(633)
 w(18815) = u(22)*w(633)
 w(18816) = u(23)*w(633)
endif
! terms of degree 8
if (8.le.mxd) then
 w(18817:31068) = u(0)*w(6565:18816)
 w(31069:38883) = u(1)*w(11002:18816)
 w(38884:43755) = u(2)*w(13945:18816)
 w(43756:46712) = u(3)*w(15860:18816)
 w(46713:48445) = u(4)*w(17084:18816)
 w(48446:49405) = u(5)*w(17857:18816)
 w(49406:49733) = u(6)*w(6237:6564)
 w(49734:49994) = u(7)*w(6304:6564)
 w(49995:50199) = u(8)*w(6360:6564)
 w(50200:50358) = u(9)*w(6406:6564)
 w(50359:50480) = u(10)*w(6443:6564)
 w(50481:50573) = u(11)*w(6472:6564)
 w(50574:50644) = u(12)*w(6494:6564)
 w(50645:50699) = u(13)*w(6510:6564)
 w(50700:50743) = u(14)*w(6521:6564)
 w(50744:50780) = u(15)*w(6528:6564)
 w(50781:50813) = u(16)*w(6532:6564)
 w(50814) = u(24)*w(633)
endif
! terms of degree 9
if (9.le.mxd) then
 w(50815:82812) = u(0)*w(18817:50814)
 w(82813:102558) = u(1)*w(31069:50814)
 w(102559:114489) = u(2)*w(38884:50814)
 w(114490:121548) = u(3)*w(43756:50814)
 w(121549:125650) = u(4)*w(46713:50814)
 w(125651:128019) = u(5)*w(48446:50814)
 w(128020:128488) = u(6)*w(18348:18816)
 w(128489:128880) = u(7)*w(18425:18816)
 w(128881:129202) = u(8)*w(18495:18816)
 w(129203:129461) = u(9)*w(18558:18816)
 w(129462:129664) = u(10)*w(18614:18816)
 w(129665:129818) = u(11)*w(18663:18816)
 w(129819:129930) = u(12)*w(18705:18816)
 w(129931:130007) = u(13)*w(18740:18816)
 w(130008:130056) = u(14)*w(18768:18816)
 w(130057:130084) = u(15)*w(18789:18816)
 w(130085:130098) = u(16)*w(18803:18816)
 w(130099:130129) = u(17)*w(6534:6564)
 w(130130:130153) = u(18)*w(6541:6564)
 w(130154:130171) = u(19)*w(6547:6564)
 w(130172:130184) = u(20)*w(6552:6564)
 w(130185:130193) = u(21)*w(6556:6564)
 w(130194:130199) = u(22)*w(6559:6564)
 w(130200:130203) = u(23)*w(6561:6564)
endif
END SUBROUTINE mg332_prib
