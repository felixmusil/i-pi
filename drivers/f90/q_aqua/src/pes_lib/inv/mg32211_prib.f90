SUBROUTINE mg32211_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg32211_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg32211_prib: bad size u'
!! else if (size(w).ne.mg32211_npb(mxd)) then
!!  stop 'mg32211_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 13 16 5 0 0 2 0 0 0
! prib,  dnpb(0:*): 1 13 107 668 3477 15771 64208 239165 826645 2679070
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
 w(10) = u(9)*w(0)
 w(11) = u(10)*w(0)
 w(12) = u(11)*w(0)
 w(13) = u(12)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(14:26) = u(0)*w(1:13)
 w(27:38) = u(1)*w(2:13)
 w(39:49) = u(2)*w(3:13)
 w(50:59) = u(3)*w(4:13)
 w(60:68) = u(4)*w(5:13)
 w(69:76) = u(5)*w(6:13)
 w(77:83) = u(6)*w(7:13)
 w(84:89) = u(7)*w(8:13)
 w(90:94) = u(8)*w(9:13)
 w(95:98) = u(9)*w(10:13)
 w(99:101) = u(10)*w(11:13)
 w(102:103) = u(11)*w(12:13)
 w(104) = u(12)*w(13)
 w(105) = u(13)*w(0)
 w(106) = u(14)*w(0)
 w(107) = u(15)*w(0)
 w(108) = u(16)*w(0)
 w(109) = u(17)*w(0)
 w(110) = u(18)*w(0)
 w(111) = u(19)*w(0)
 w(112) = u(20)*w(0)
 w(113) = u(21)*w(0)
 w(114) = u(22)*w(0)
 w(115) = u(23)*w(0)
 w(116) = u(24)*w(0)
 w(117) = u(25)*w(0)
 w(118) = u(26)*w(0)
 w(119) = u(27)*w(0)
 w(120) = u(28)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(121:227) = u(0)*w(14:120)
 w(228:321) = u(1)*w(27:120)
 w(322:403) = u(2)*w(39:120)
 w(404:474) = u(3)*w(50:120)
 w(475:535) = u(4)*w(60:120)
 w(536:587) = u(5)*w(69:120)
 w(588:631) = u(6)*w(77:120)
 w(632:668) = u(7)*w(84:120)
 w(669:699) = u(8)*w(90:120)
 w(700:725) = u(9)*w(95:120)
 w(726:747) = u(10)*w(99:120)
 w(748:766) = u(11)*w(102:120)
 w(767:783) = u(12)*w(104:120)
 w(784) = u(29)*w(0)
 w(785) = u(30)*w(0)
 w(786) = u(31)*w(0)
 w(787) = u(32)*w(0)
 w(788) = u(33)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(789:1456) = u(0)*w(121:788)
 w(1457:2017) = u(1)*w(228:788)
 w(2018:2484) = u(2)*w(322:788)
 w(2485:2869) = u(3)*w(404:788)
 w(2870:3183) = u(4)*w(475:788)
 w(3184:3436) = u(5)*w(536:788)
 w(3437:3637) = u(6)*w(588:788)
 w(3638:3794) = u(7)*w(632:788)
 w(3795:3914) = u(8)*w(669:788)
 w(3915:4003) = u(9)*w(700:788)
 w(4004:4066) = u(10)*w(726:788)
 w(4067:4107) = u(11)*w(748:788)
 w(4108:4129) = u(12)*w(767:788)
 w(4130:4145) = u(13)*w(105:120)
 w(4146:4160) = u(14)*w(106:120)
 w(4161:4174) = u(15)*w(107:120)
 w(4175:4187) = u(16)*w(108:120)
 w(4188:4199) = u(17)*w(109:120)
 w(4200:4210) = u(18)*w(110:120)
 w(4211:4220) = u(19)*w(111:120)
 w(4221:4229) = u(20)*w(112:120)
 w(4230:4237) = u(21)*w(113:120)
 w(4238:4244) = u(22)*w(114:120)
 w(4245:4250) = u(23)*w(115:120)
 w(4251:4255) = u(24)*w(116:120)
 w(4256:4259) = u(25)*w(117:120)
 w(4260:4262) = u(26)*w(118:120)
 w(4263:4264) = u(27)*w(119:120)
 w(4265) = u(28)*w(120)
endif
! terms of degree 5
if (5.le.mxd) then
 w(4266:7742) = u(0)*w(789:4265)
 w(7743:10551) = u(1)*w(1457:4265)
 w(10552:12799) = u(2)*w(2018:4265)
 w(12800:14580) = u(3)*w(2485:4265)
 w(14581:15976) = u(4)*w(2870:4265)
 w(15977:17058) = u(5)*w(3184:4265)
 w(17059:17887) = u(6)*w(3437:4265)
 w(17888:18515) = u(7)*w(3638:4265)
 w(18516:18986) = u(8)*w(3795:4265)
 w(18987:19337) = u(9)*w(3915:4265)
 w(19338:19599) = u(10)*w(4004:4265)
 w(19600:19798) = u(11)*w(4067:4265)
 w(19799:19956) = u(12)*w(4108:4265)
 w(19957:19961) = u(13)*w(784:788)
 w(19962:19966) = u(14)*w(784:788)
 w(19967:19971) = u(15)*w(784:788)
 w(19972:19976) = u(16)*w(784:788)
 w(19977:19981) = u(17)*w(784:788)
 w(19982:19986) = u(18)*w(784:788)
 w(19987:19991) = u(19)*w(784:788)
 w(19992:19996) = u(20)*w(784:788)
 w(19997:20001) = u(21)*w(784:788)
 w(20002:20006) = u(22)*w(784:788)
 w(20007:20011) = u(23)*w(784:788)
 w(20012:20016) = u(24)*w(784:788)
 w(20017:20021) = u(25)*w(784:788)
 w(20022:20026) = u(26)*w(784:788)
 w(20027:20031) = u(27)*w(784:788)
 w(20032:20036) = u(28)*w(784:788)
endif
! terms of degree 6
if (6.le.mxd) then
 w(20037:35807) = u(0)*w(4266:20036)
 w(35808:48101) = u(1)*w(7743:20036)
 w(48102:57586) = u(2)*w(10552:20036)
 w(57587:64823) = u(3)*w(12800:20036)
 w(64824:70279) = u(4)*w(14581:20036)
 w(70280:74339) = u(5)*w(15977:20036)
 w(74340:77317) = u(6)*w(17059:20036)
 w(77318:79466) = u(7)*w(17888:20036)
 w(79467:80987) = u(8)*w(18516:20036)
 w(80988:82037) = u(9)*w(18987:20036)
 w(82038:82736) = u(10)*w(19338:20036)
 w(82737:83173) = u(11)*w(19600:20036)
 w(83174:83411) = u(12)*w(19799:20036)
 w(83412:83547) = u(13)*w(4130:4265)
 w(83548:83667) = u(14)*w(4146:4265)
 w(83668:83772) = u(15)*w(4161:4265)
 w(83773:83863) = u(16)*w(4175:4265)
 w(83864:83941) = u(17)*w(4188:4265)
 w(83942:84007) = u(18)*w(4200:4265)
 w(84008:84062) = u(19)*w(4211:4265)
 w(84063:84107) = u(20)*w(4221:4265)
 w(84108:84143) = u(21)*w(4230:4265)
 w(84144:84171) = u(22)*w(4238:4265)
 w(84172:84192) = u(23)*w(4245:4265)
 w(84193:84207) = u(24)*w(4251:4265)
 w(84208:84217) = u(25)*w(4256:4265)
 w(84218:84223) = u(26)*w(4260:4265)
 w(84224:84226) = u(27)*w(4263:4265)
 w(84227) = u(28)*w(4265)
 w(84228:84232) = u(29)*w(784:788)
 w(84233:84236) = u(30)*w(785:788)
 w(84237:84239) = u(31)*w(786:788)
 w(84240:84241) = u(32)*w(787:788)
 w(84242) = u(33)*w(788)
 w(84243) = u(34)*w(0)
 w(84244) = u(35)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(84245:148452) = u(0)*w(20037:84244)
 w(148453:196889) = u(1)*w(35808:84244)
 w(196890:233032) = u(2)*w(48102:84244)
 w(233033:259690) = u(3)*w(57587:84244)
 w(259691:279111) = u(4)*w(64824:84244)
 w(279112:293076) = u(5)*w(70280:84244)
 w(293077:302981) = u(6)*w(74340:84244)
 w(302982:309908) = u(7)*w(77318:84244)
 w(309909:314686) = u(8)*w(79467:84244)
 w(314687:317943) = u(9)*w(80988:84244)
 w(317944:320150) = u(10)*w(82038:84244)
 w(320151:321658) = u(11)*w(82737:84244)
 w(321659:322729) = u(12)*w(83174:84244)
 w(322730:322809) = u(13)*w(19957:20036)
 w(322810:322884) = u(14)*w(19962:20036)
 w(322885:322954) = u(15)*w(19967:20036)
 w(322955:323019) = u(16)*w(19972:20036)
 w(323020:323079) = u(17)*w(19977:20036)
 w(323080:323134) = u(18)*w(19982:20036)
 w(323135:323184) = u(19)*w(19987:20036)
 w(323185:323229) = u(20)*w(19992:20036)
 w(323230:323269) = u(21)*w(19997:20036)
 w(323270:323304) = u(22)*w(20002:20036)
 w(323305:323334) = u(23)*w(20007:20036)
 w(323335:323359) = u(24)*w(20012:20036)
 w(323360:323379) = u(25)*w(20017:20036)
 w(323380:323394) = u(26)*w(20022:20036)
 w(323395:323404) = u(27)*w(20027:20036)
 w(323405:323409) = u(28)*w(20032:20036)
endif
! terms of degree 8
if (8.le.mxd) then
 w(323410:562574) = u(0)*w(84245:323409)
 w(562575:737531) = u(1)*w(148453:323409)
 w(737532:864051) = u(2)*w(196890:323409)
 w(864052:954428) = u(3)*w(233033:323409)
 w(954429:1018147) = u(4)*w(259691:323409)
 w(1018148:1062445) = u(5)*w(279112:323409)
 w(1062446:1092778) = u(6)*w(293077:323409)
 w(1092779:1113206) = u(7)*w(302982:323409)
 w(1113207:1126707) = u(8)*w(309909:323409)
 w(1126708:1135430) = u(9)*w(314687:323409)
 w(1135431:1140896) = u(10)*w(317944:323409)
 w(1140897:1144155) = u(11)*w(320151:323409)
 w(1144156:1145906) = u(12)*w(321659:323409)
 w(1145907:1146739) = u(13)*w(83412:84244)
 w(1146740:1147436) = u(14)*w(83548:84244)
 w(1147437:1148013) = u(15)*w(83668:84244)
 w(1148014:1148485) = u(16)*w(83773:84244)
 w(1148486:1148866) = u(17)*w(83864:84244)
 w(1148867:1149169) = u(18)*w(83942:84244)
 w(1149170:1149406) = u(19)*w(84008:84244)
 w(1149407:1149588) = u(20)*w(84063:84244)
 w(1149589:1149725) = u(21)*w(84108:84244)
 w(1149726:1149826) = u(22)*w(84144:84244)
 w(1149827:1149899) = u(23)*w(84172:84244)
 w(1149900:1149951) = u(24)*w(84193:84244)
 w(1149952:1149988) = u(25)*w(84208:84244)
 w(1149989:1150015) = u(26)*w(84218:84244)
 w(1150016:1150036) = u(27)*w(84224:84244)
 w(1150037:1150054) = u(28)*w(84227:84244)
endif
! terms of degree 9
if (9.le.mxd) then
 w(1150055:1976699) = u(0)*w(323410:1150054)
 w(1976700:2564179) = u(1)*w(562575:1150054)
 w(2564180:2976702) = u(2)*w(737532:1150054)
 w(2976703:3262705) = u(3)*w(864052:1150054)
 w(3262706:3458331) = u(4)*w(954429:1150054)
 w(3458332:3590238) = u(5)*w(1018148:1150054)
 w(3590239:3677847) = u(6)*w(1062446:1150054)
 w(3677848:3735123) = u(7)*w(1092779:1150054)
 w(3735124:3771971) = u(8)*w(1113207:1150054)
 w(3771972:3795318) = u(9)*w(1126708:1150054)
 w(3795319:3809942) = u(10)*w(1135431:1150054)
 w(3809943:3819100) = u(11)*w(1140897:1150054)
 w(3819101:3824999) = u(12)*w(1144156:1150054)
 w(3825000:3825679) = u(13)*w(322730:323409)
 w(3825680:3826279) = u(14)*w(322810:323409)
 w(3826280:3826804) = u(15)*w(322885:323409)
 w(3826805:3827259) = u(16)*w(322955:323409)
 w(3827260:3827649) = u(17)*w(323020:323409)
 w(3827650:3827979) = u(18)*w(323080:323409)
 w(3827980:3828254) = u(19)*w(323135:323409)
 w(3828255:3828479) = u(20)*w(323185:323409)
 w(3828480:3828659) = u(21)*w(323230:323409)
 w(3828660:3828799) = u(22)*w(323270:323409)
 w(3828800:3828904) = u(23)*w(323305:323409)
 w(3828905:3828979) = u(24)*w(323335:323409)
 w(3828980:3829029) = u(25)*w(323360:323409)
 w(3829030:3829059) = u(26)*w(323380:323409)
 w(3829060:3829074) = u(27)*w(323395:323409)
 w(3829075:3829079) = u(28)*w(323405:323409)
 w(3829080:3829096) = u(29)*w(84228:84244)
 w(3829097:3829108) = u(30)*w(84233:84244)
 w(3829109:3829116) = u(31)*w(84237:84244)
 w(3829117:3829121) = u(32)*w(84240:84244)
 w(3829122:3829124) = u(33)*w(84242:84244)
endif
END SUBROUTINE mg32211_prib
