SUBROUTINE mg3321_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg3321_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg3321_prib: bad size u'
!! else if (size(w).ne.mg3321_npb(mxd)) then
!!  stop 'mg3321_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 9 14 9 1 0 3 0 0 0
! prib,  dnpb(0:*): 1 9 59 300 1312 5082 17944 58620 179489 519559
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(10:18) = u(0)*w(1:9)
 w(19:26) = u(1)*w(2:9)
 w(27:33) = u(2)*w(3:9)
 w(34:39) = u(3)*w(4:9)
 w(40:44) = u(4)*w(5:9)
 w(45:48) = u(5)*w(6:9)
 w(49:51) = u(6)*w(7:9)
 w(52:53) = u(7)*w(8:9)
 w(54) = u(8)*w(9)
 w(55) = u(9)*w(0)
 w(56) = u(10)*w(0)
 w(57) = u(11)*w(0)
 w(58) = u(12)*w(0)
 w(59) = u(13)*w(0)
 w(60) = u(14)*w(0)
 w(61) = u(15)*w(0)
 w(62) = u(16)*w(0)
 w(63) = u(17)*w(0)
 w(64) = u(18)*w(0)
 w(65) = u(19)*w(0)
 w(66) = u(20)*w(0)
 w(67) = u(21)*w(0)
 w(68) = u(22)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(69:127) = u(0)*w(10:68)
 w(128:177) = u(1)*w(19:68)
 w(178:219) = u(2)*w(27:68)
 w(220:254) = u(3)*w(34:68)
 w(255:283) = u(4)*w(40:68)
 w(284:307) = u(5)*w(45:68)
 w(308:327) = u(6)*w(49:68)
 w(328:344) = u(7)*w(52:68)
 w(345:359) = u(8)*w(54:68)
 w(360) = u(23)*w(0)
 w(361) = u(24)*w(0)
 w(362) = u(25)*w(0)
 w(363) = u(26)*w(0)
 w(364) = u(27)*w(0)
 w(365) = u(28)*w(0)
 w(366) = u(29)*w(0)
 w(367) = u(30)*w(0)
 w(368) = u(31)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(369:668) = u(0)*w(69:368)
 w(669:909) = u(1)*w(128:368)
 w(910:1100) = u(2)*w(178:368)
 w(1101:1249) = u(3)*w(220:368)
 w(1250:1363) = u(4)*w(255:368)
 w(1364:1448) = u(5)*w(284:368)
 w(1449:1509) = u(6)*w(308:368)
 w(1510:1550) = u(7)*w(328:368)
 w(1551:1574) = u(8)*w(345:368)
 w(1575:1588) = u(9)*w(55:68)
 w(1589:1601) = u(10)*w(56:68)
 w(1602:1613) = u(11)*w(57:68)
 w(1614:1624) = u(12)*w(58:68)
 w(1625:1634) = u(13)*w(59:68)
 w(1635:1643) = u(14)*w(60:68)
 w(1644:1651) = u(15)*w(61:68)
 w(1652:1658) = u(16)*w(62:68)
 w(1659:1664) = u(17)*w(63:68)
 w(1665:1669) = u(18)*w(64:68)
 w(1670:1673) = u(19)*w(65:68)
 w(1674:1676) = u(20)*w(66:68)
 w(1677:1678) = u(21)*w(67:68)
 w(1679) = u(22)*w(68)
 w(1680) = u(32)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(1681:2992) = u(0)*w(369:1680)
 w(2993:4004) = u(1)*w(669:1680)
 w(4005:4775) = u(2)*w(910:1680)
 w(4776:5355) = u(3)*w(1101:1680)
 w(5356:5786) = u(4)*w(1250:1680)
 w(5787:6103) = u(5)*w(1364:1680)
 w(6104:6335) = u(6)*w(1449:1680)
 w(6336:6506) = u(7)*w(1510:1680)
 w(6507:6636) = u(8)*w(1551:1680)
 w(6637:6645) = u(9)*w(360:368)
 w(6646:6654) = u(10)*w(360:368)
 w(6655:6663) = u(11)*w(360:368)
 w(6664:6672) = u(12)*w(360:368)
 w(6673:6681) = u(13)*w(360:368)
 w(6682:6690) = u(14)*w(360:368)
 w(6691:6699) = u(15)*w(360:368)
 w(6700:6708) = u(16)*w(360:368)
 w(6709:6717) = u(17)*w(360:368)
 w(6718:6726) = u(18)*w(360:368)
 w(6727:6735) = u(19)*w(360:368)
 w(6736:6744) = u(20)*w(360:368)
 w(6745:6753) = u(21)*w(360:368)
 w(6754:6762) = u(22)*w(360:368)
endif
! terms of degree 6
if (6.le.mxd) then
 w(6763:11844) = u(0)*w(1681:6762)
 w(11845:15614) = u(1)*w(2993:6762)
 w(15615:18372) = u(2)*w(4005:6762)
 w(18373:20359) = u(3)*w(4776:6762)
 w(20360:21766) = u(4)*w(5356:6762)
 w(21767:22742) = u(5)*w(5787:6762)
 w(22743:23401) = u(6)*w(6104:6762)
 w(23402:23828) = u(7)*w(6336:6762)
 w(23829:24084) = u(8)*w(6507:6762)
 w(24085:24190) = u(9)*w(1575:1680)
 w(24191:24282) = u(10)*w(1589:1680)
 w(24283:24361) = u(11)*w(1602:1680)
 w(24362:24428) = u(12)*w(1614:1680)
 w(24429:24484) = u(13)*w(1625:1680)
 w(24485:24530) = u(14)*w(1635:1680)
 w(24531:24567) = u(15)*w(1644:1680)
 w(24568:24596) = u(16)*w(1652:1680)
 w(24597:24618) = u(17)*w(1659:1680)
 w(24619:24634) = u(18)*w(1665:1680)
 w(24635:24645) = u(19)*w(1670:1680)
 w(24646:24652) = u(20)*w(1674:1680)
 w(24653:24656) = u(21)*w(1677:1680)
 w(24657:24658) = u(22)*w(1679:1680)
 w(24659:24667) = u(23)*w(360:368)
 w(24668:24675) = u(24)*w(361:368)
 w(24676:24682) = u(25)*w(362:368)
 w(24683:24688) = u(26)*w(363:368)
 w(24689:24693) = u(27)*w(364:368)
 w(24694:24697) = u(28)*w(365:368)
 w(24698:24700) = u(29)*w(366:368)
 w(24701:24702) = u(30)*w(367:368)
 w(24703) = u(31)*w(368)
 w(24704) = u(33)*w(0)
 w(24705) = u(34)*w(0)
 w(24706) = u(35)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(24707:42650) = u(0)*w(6763:24706)
 w(42651:55512) = u(1)*w(11845:24706)
 w(55513:64604) = u(2)*w(15615:24706)
 w(64605:70938) = u(3)*w(18373:24706)
 w(70939:75285) = u(4)*w(20360:24706)
 w(75286:78225) = u(5)*w(21767:24706)
 w(78226:80189) = u(6)*w(22743:24706)
 w(80190:81494) = u(7)*w(23402:24706)
 w(81495:82372) = u(8)*w(23829:24706)
 w(82373:82498) = u(9)*w(6637:6762)
 w(82499:82615) = u(10)*w(6646:6762)
 w(82616:82723) = u(11)*w(6655:6762)
 w(82724:82822) = u(12)*w(6664:6762)
 w(82823:82912) = u(13)*w(6673:6762)
 w(82913:82993) = u(14)*w(6682:6762)
 w(82994:83065) = u(15)*w(6691:6762)
 w(83066:83128) = u(16)*w(6700:6762)
 w(83129:83182) = u(17)*w(6709:6762)
 w(83183:83227) = u(18)*w(6718:6762)
 w(83228:83263) = u(19)*w(6727:6762)
 w(83264:83290) = u(20)*w(6736:6762)
 w(83291:83308) = u(21)*w(6745:6762)
 w(83309:83317) = u(22)*w(6754:6762)
 w(83318) = u(23)*w(1680)
 w(83319) = u(24)*w(1680)
 w(83320) = u(25)*w(1680)
 w(83321) = u(26)*w(1680)
 w(83322) = u(27)*w(1680)
 w(83323) = u(28)*w(1680)
 w(83324) = u(29)*w(1680)
 w(83325) = u(30)*w(1680)
 w(83326) = u(31)*w(1680)
endif
! terms of degree 8
if (8.le.mxd) then
 w(83327:141946) = u(0)*w(24707:83326)
 w(141947:182622) = u(1)*w(42651:83326)
 w(182623:210436) = u(2)*w(55513:83326)
 w(210437:229158) = u(3)*w(64605:83326)
 w(229159:241546) = u(4)*w(70939:83326)
 w(241547:249587) = u(5)*w(75286:83326)
 w(249588:254688) = u(6)*w(78226:83326)
 w(254689:257825) = u(7)*w(80190:83326)
 w(257826:259657) = u(8)*w(81495:83326)
 w(259658:260279) = u(9)*w(24085:24706)
 w(260280:260795) = u(10)*w(24191:24706)
 w(260796:261219) = u(11)*w(24283:24706)
 w(261220:261564) = u(12)*w(24362:24706)
 w(261565:261842) = u(13)*w(24429:24706)
 w(261843:262064) = u(14)*w(24485:24706)
 w(262065:262240) = u(15)*w(24531:24706)
 w(262241:262379) = u(16)*w(24568:24706)
 w(262380:262489) = u(17)*w(24597:24706)
 w(262490:262577) = u(18)*w(24619:24706)
 w(262578:262649) = u(19)*w(24635:24706)
 w(262650:262710) = u(20)*w(24646:24706)
 w(262711:262764) = u(21)*w(24653:24706)
 w(262765:262814) = u(22)*w(24657:24706)
 w(262815) = u(32)*w(1680)
endif
! terms of degree 9
if (9.le.mxd) then
 w(262816:442304) = u(0)*w(83327:262815)
 w(442305:563173) = u(1)*w(141947:262815)
 w(563174:643366) = u(2)*w(182623:262815)
 w(643367:695745) = u(3)*w(210437:262815)
 w(695746:729402) = u(4)*w(229159:262815)
 w(729403:750671) = u(5)*w(241547:262815)
 w(750672:763899) = u(6)*w(249588:262815)
 w(763900:772026) = u(7)*w(254689:262815)
 w(772027:777016) = u(8)*w(257826:262815)
 w(777017:777970) = u(9)*w(82373:83326)
 w(777971:778798) = u(10)*w(82499:83326)
 w(778799:779509) = u(11)*w(82616:83326)
 w(779510:780112) = u(12)*w(82724:83326)
 w(780113:780616) = u(13)*w(82823:83326)
 w(780617:781030) = u(14)*w(82913:83326)
 w(781031:781363) = u(15)*w(82994:83326)
 w(781364:781624) = u(16)*w(83066:83326)
 w(781625:781822) = u(17)*w(83129:83326)
 w(781823:781966) = u(18)*w(83183:83326)
 w(781967:782065) = u(19)*w(83228:83326)
 w(782066:782128) = u(20)*w(83264:83326)
 w(782129:782164) = u(21)*w(83291:83326)
 w(782165:782182) = u(22)*w(83309:83326)
 w(782183:782230) = u(23)*w(24659:24706)
 w(782231:782269) = u(24)*w(24668:24706)
 w(782270:782300) = u(25)*w(24676:24706)
 w(782301:782324) = u(26)*w(24683:24706)
 w(782325:782342) = u(27)*w(24689:24706)
 w(782343:782355) = u(28)*w(24694:24706)
 w(782356:782364) = u(29)*w(24698:24706)
 w(782365:782370) = u(30)*w(24701:24706)
 w(782371:782374) = u(31)*w(24703:24706)
endif
END SUBROUTINE mg3321_prib
