SUBROUTINE mg31111_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg31111_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg31111_prib: bad size u'
!! else if (size(w).ne.mg31111_npb(mxd)) then
!!  stop 'mg31111_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 11 5 5 0 0 0 0 0 0
! prib,  dnpb(0:*): 1 11 71 346 1401 4953 15758 46033 125248 320783
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
 w(10) = u(9)*w(0)
 w(11) = u(10)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(12:22) = u(0)*w(1:11)
 w(23:32) = u(1)*w(2:11)
 w(33:41) = u(2)*w(3:11)
 w(42:49) = u(3)*w(4:11)
 w(50:56) = u(4)*w(5:11)
 w(57:62) = u(5)*w(6:11)
 w(63:67) = u(6)*w(7:11)
 w(68:71) = u(7)*w(8:11)
 w(72:74) = u(8)*w(9:11)
 w(75:76) = u(9)*w(10:11)
 w(77) = u(10)*w(11)
 w(78) = u(11)*w(0)
 w(79) = u(12)*w(0)
 w(80) = u(13)*w(0)
 w(81) = u(14)*w(0)
 w(82) = u(15)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(83:153) = u(0)*w(12:82)
 w(154:213) = u(1)*w(23:82)
 w(214:263) = u(2)*w(33:82)
 w(264:304) = u(3)*w(42:82)
 w(305:337) = u(4)*w(50:82)
 w(338:363) = u(5)*w(57:82)
 w(364:383) = u(6)*w(63:82)
 w(384:398) = u(7)*w(68:82)
 w(399:409) = u(8)*w(72:82)
 w(410:417) = u(9)*w(75:82)
 w(418:423) = u(10)*w(77:82)
 w(424) = u(16)*w(0)
 w(425) = u(17)*w(0)
 w(426) = u(18)*w(0)
 w(427) = u(19)*w(0)
 w(428) = u(20)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(429:774) = u(0)*w(83:428)
 w(775:1049) = u(1)*w(154:428)
 w(1050:1264) = u(2)*w(214:428)
 w(1265:1429) = u(3)*w(264:428)
 w(1430:1553) = u(4)*w(305:428)
 w(1554:1644) = u(5)*w(338:428)
 w(1645:1709) = u(6)*w(364:428)
 w(1710:1754) = u(7)*w(384:428)
 w(1755:1784) = u(8)*w(399:428)
 w(1785:1803) = u(9)*w(410:428)
 w(1804:1814) = u(10)*w(418:428)
 w(1815:1819) = u(11)*w(78:82)
 w(1820:1823) = u(12)*w(79:82)
 w(1824:1826) = u(13)*w(80:82)
 w(1827:1828) = u(14)*w(81:82)
 w(1829) = u(15)*w(82)
endif
! terms of degree 5
if (5.le.mxd) then
 w(1830:3230) = u(0)*w(429:1829)
 w(3231:4285) = u(1)*w(775:1829)
 w(4286:5065) = u(2)*w(1050:1829)
 w(5066:5630) = u(3)*w(1265:1829)
 w(5631:6030) = u(4)*w(1430:1829)
 w(6031:6306) = u(5)*w(1554:1829)
 w(6307:6491) = u(6)*w(1645:1829)
 w(6492:6611) = u(7)*w(1710:1829)
 w(6612:6686) = u(8)*w(1755:1829)
 w(6687:6731) = u(9)*w(1785:1829)
 w(6732:6757) = u(10)*w(1804:1829)
 w(6758:6762) = u(11)*w(424:428)
 w(6763:6767) = u(12)*w(424:428)
 w(6768:6772) = u(13)*w(424:428)
 w(6773:6777) = u(14)*w(424:428)
 w(6778:6782) = u(15)*w(424:428)
endif
! terms of degree 6
if (6.le.mxd) then
 w(6783:11735) = u(0)*w(1830:6782)
 w(11736:15287) = u(1)*w(3231:6782)
 w(15288:17784) = u(2)*w(4286:6782)
 w(17785:19501) = u(3)*w(5066:6782)
 w(19502:20653) = u(4)*w(5631:6782)
 w(20654:21405) = u(5)*w(6031:6782)
 w(21406:21881) = u(6)*w(6307:6782)
 w(21882:22172) = u(7)*w(6492:6782)
 w(22173:22343) = u(8)*w(6612:6782)
 w(22344:22439) = u(9)*w(6687:6782)
 w(22440:22490) = u(10)*w(6732:6782)
 w(22491:22505) = u(11)*w(1815:1829)
 w(22506:22515) = u(12)*w(1820:1829)
 w(22516:22521) = u(13)*w(1824:1829)
 w(22522:22524) = u(14)*w(1827:1829)
 w(22525) = u(15)*w(1829)
 w(22526:22530) = u(16)*w(424:428)
 w(22531:22534) = u(17)*w(425:428)
 w(22535:22537) = u(18)*w(426:428)
 w(22538:22539) = u(19)*w(427:428)
 w(22540) = u(20)*w(428)
endif
! terms of degree 7
if (7.le.mxd) then
 w(22541:38298) = u(0)*w(6783:22540)
 w(38299:49103) = u(1)*w(11736:22540)
 w(49104:56356) = u(2)*w(15288:22540)
 w(56357:61112) = u(3)*w(17785:22540)
 w(61113:64151) = u(4)*w(19502:22540)
 w(64152:66038) = u(5)*w(20654:22540)
 w(66039:67173) = u(6)*w(21406:22540)
 w(67174:67832) = u(7)*w(21882:22540)
 w(67833:68200) = u(8)*w(22173:22540)
 w(68201:68397) = u(9)*w(22344:22540)
 w(68398:68498) = u(10)*w(22440:22540)
 w(68499:68523) = u(11)*w(6758:6782)
 w(68524:68543) = u(12)*w(6763:6782)
 w(68544:68558) = u(13)*w(6768:6782)
 w(68559:68568) = u(14)*w(6773:6782)
 w(68569:68573) = u(15)*w(6778:6782)
endif
! terms of degree 8
if (8.le.mxd) then
 w(68574:114606) = u(0)*w(22541:68573)
 w(114607:144881) = u(1)*w(38299:68573)
 w(144882:164351) = u(2)*w(49104:68573)
 w(164352:176568) = u(3)*w(56357:68573)
 w(176569:184029) = u(4)*w(61113:68573)
 w(184030:188451) = u(5)*w(64152:68573)
 w(188452:190986) = u(6)*w(66039:68573)
 w(190987:192386) = u(7)*w(67174:68573)
 w(192387:193127) = u(8)*w(67833:68573)
 w(193128:193500) = u(9)*w(68201:68573)
 w(193501:193676) = u(10)*w(68398:68573)
 w(193677:193726) = u(11)*w(22491:22540)
 w(193727:193761) = u(12)*w(22506:22540)
 w(193762:193786) = u(13)*w(22516:22540)
 w(193787:193805) = u(14)*w(22522:22540)
 w(193806:193821) = u(15)*w(22525:22540)
endif
! terms of degree 9
if (9.le.mxd) then
 w(193822:319069) = u(0)*w(68574:193821)
 w(319070:398284) = u(1)*w(114607:193821)
 w(398285:447224) = u(2)*w(144882:193821)
 w(447225:476694) = u(3)*w(164352:193821)
 w(476695:493947) = u(4)*w(176569:193821)
 w(493948:503739) = u(5)*w(184030:193821)
 w(503740:509109) = u(6)*w(188452:193821)
 w(509110:511944) = u(7)*w(190987:193821)
 w(511945:513379) = u(8)*w(192387:193821)
 w(513380:514073) = u(9)*w(193128:193821)
 w(514074:514394) = u(10)*w(193501:193821)
 w(514395:514469) = u(11)*w(68499:68573)
 w(514470:514519) = u(12)*w(68524:68573)
 w(514520:514549) = u(13)*w(68544:68573)
 w(514550:514564) = u(14)*w(68559:68573)
 w(514565:514569) = u(15)*w(68569:68573)
 w(514570:514584) = u(16)*w(22526:22540)
 w(514585:514594) = u(17)*w(22531:22540)
 w(514595:514600) = u(18)*w(22535:22540)
 w(514601:514603) = u(19)*w(22538:22540)
 w(514604) = u(20)*w(22540)
endif
END SUBROUTINE mg31111_prib
