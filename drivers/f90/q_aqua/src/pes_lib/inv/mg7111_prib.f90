SUBROUTINE mg7111_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg7111_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg7111_prib: bad size u'
!! else if (size(w).ne.mg7111_npb(mxd)) then
!!  stop 'mg7111_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 7 5 8 6 6 5 6 0 0
! prib,  dnpb(0:*): 1 7 33 127 427 1299 3662 9704 24423 58829
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(8:14) = u(0)*w(1:7)
 w(15:20) = u(1)*w(2:7)
 w(21:25) = u(2)*w(3:7)
 w(26:29) = u(3)*w(4:7)
 w(30:32) = u(4)*w(5:7)
 w(33:34) = u(5)*w(6:7)
 w(35) = u(6)*w(7)
 w(36) = u(7)*w(0)
 w(37) = u(8)*w(0)
 w(38) = u(9)*w(0)
 w(39) = u(10)*w(0)
 w(40) = u(11)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(41:73) = u(0)*w(8:40)
 w(74:99) = u(1)*w(15:40)
 w(100:119) = u(2)*w(21:40)
 w(120:134) = u(3)*w(26:40)
 w(135:145) = u(4)*w(30:40)
 w(146:153) = u(5)*w(33:40)
 w(154:159) = u(6)*w(35:40)
 w(160) = u(12)*w(0)
 w(161) = u(13)*w(0)
 w(162) = u(14)*w(0)
 w(163) = u(15)*w(0)
 w(164) = u(16)*w(0)
 w(165) = u(17)*w(0)
 w(166) = u(18)*w(0)
 w(167) = u(19)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(168:294) = u(0)*w(41:167)
 w(295:388) = u(1)*w(74:167)
 w(389:456) = u(2)*w(100:167)
 w(457:504) = u(3)*w(120:167)
 w(505:537) = u(4)*w(135:167)
 w(538:559) = u(5)*w(146:167)
 w(560:573) = u(6)*w(154:167)
 w(574:578) = u(7)*w(36:40)
 w(579:582) = u(8)*w(37:40)
 w(583:585) = u(9)*w(38:40)
 w(586:587) = u(10)*w(39:40)
 w(588) = u(11)*w(40)
 w(589) = u(20)*w(0)
 w(590) = u(21)*w(0)
 w(591) = u(22)*w(0)
 w(592) = u(23)*w(0)
 w(593) = u(24)*w(0)
 w(594) = u(25)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(595:1021) = u(0)*w(168:594)
 w(1022:1321) = u(1)*w(295:594)
 w(1322:1527) = u(2)*w(389:594)
 w(1528:1665) = u(3)*w(457:594)
 w(1666:1755) = u(4)*w(505:594)
 w(1756:1812) = u(5)*w(538:594)
 w(1813:1847) = u(6)*w(560:594)
 w(1848:1855) = u(7)*w(160:167)
 w(1856:1863) = u(8)*w(160:167)
 w(1864:1871) = u(9)*w(160:167)
 w(1872:1879) = u(10)*w(160:167)
 w(1880:1887) = u(11)*w(160:167)
 w(1888) = u(26)*w(0)
 w(1889) = u(27)*w(0)
 w(1890) = u(28)*w(0)
 w(1891) = u(29)*w(0)
 w(1892) = u(30)*w(0)
 w(1893) = u(31)*w(0)
endif
! terms of degree 6
if (6.le.mxd) then
 w(1894:3192) = u(0)*w(595:1893)
 w(3193:4064) = u(1)*w(1022:1893)
 w(4065:4636) = u(2)*w(1322:1893)
 w(4637:5002) = u(3)*w(1528:1893)
 w(5003:5230) = u(4)*w(1666:1893)
 w(5231:5368) = u(5)*w(1756:1893)
 w(5369:5449) = u(6)*w(1813:1893)
 w(5450:5470) = u(7)*w(574:594)
 w(5471:5486) = u(8)*w(579:594)
 w(5487:5498) = u(9)*w(583:594)
 w(5499:5507) = u(10)*w(586:594)
 w(5508:5514) = u(11)*w(588:594)
 w(5515:5522) = u(12)*w(160:167)
 w(5523:5529) = u(13)*w(161:167)
 w(5530:5535) = u(14)*w(162:167)
 w(5536:5540) = u(15)*w(163:167)
 w(5541:5544) = u(16)*w(164:167)
 w(5545:5547) = u(17)*w(165:167)
 w(5548:5549) = u(18)*w(166:167)
 w(5550) = u(19)*w(167)
 w(5551) = u(32)*w(0)
 w(5552) = u(33)*w(0)
 w(5553) = u(34)*w(0)
 w(5554) = u(35)*w(0)
 w(5555) = u(36)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(5556:9217) = u(0)*w(1894:5555)
 w(9218:11580) = u(1)*w(3193:5555)
 w(11581:13071) = u(2)*w(4065:5555)
 w(13072:13990) = u(3)*w(4637:5555)
 w(13991:14543) = u(4)*w(5003:5555)
 w(14544:14868) = u(5)*w(5231:5555)
 w(14869:15055) = u(6)*w(5369:5555)
 w(15056:15101) = u(7)*w(1848:1893)
 w(15102:15139) = u(8)*w(1856:1893)
 w(15140:15169) = u(9)*w(1864:1893)
 w(15170:15191) = u(10)*w(1872:1893)
 w(15192:15205) = u(11)*w(1880:1893)
 w(15206:15211) = u(12)*w(589:594)
 w(15212:15217) = u(13)*w(589:594)
 w(15218:15223) = u(14)*w(589:594)
 w(15224:15229) = u(15)*w(589:594)
 w(15230:15235) = u(16)*w(589:594)
 w(15236:15241) = u(17)*w(589:594)
 w(15242:15247) = u(18)*w(589:594)
 w(15248:15253) = u(19)*w(589:594)
 w(15254) = u(37)*w(0)
 w(15255) = u(38)*w(0)
 w(15256) = u(39)*w(0)
 w(15257) = u(40)*w(0)
 w(15258) = u(41)*w(0)
 w(15259) = u(42)*w(0)
endif
! terms of degree 8
if (8.le.mxd) then
 w(15260:24963) = u(0)*w(5556:15259)
 w(24964:31005) = u(1)*w(9218:15259)
 w(31006:34684) = u(2)*w(11581:15259)
 w(34685:36872) = u(3)*w(13072:15259)
 w(36873:38141) = u(4)*w(13991:15259)
 w(38142:38857) = u(5)*w(14544:15259)
 w(38858:39248) = u(6)*w(14869:15259)
 w(39249:39354) = u(7)*w(5450:5555)
 w(39355:39439) = u(8)*w(5471:5555)
 w(39440:39508) = u(9)*w(5487:5555)
 w(39509:39565) = u(10)*w(5499:5555)
 w(39566:39613) = u(11)*w(5508:5555)
 w(39614:39619) = u(12)*w(1888:1893)
 w(39620:39625) = u(13)*w(1888:1893)
 w(39626:39631) = u(14)*w(1888:1893)
 w(39632:39637) = u(15)*w(1888:1893)
 w(39638:39643) = u(16)*w(1888:1893)
 w(39644:39649) = u(17)*w(1888:1893)
 w(39650:39655) = u(18)*w(1888:1893)
 w(39656:39661) = u(19)*w(1888:1893)
 w(39662:39667) = u(20)*w(589:594)
 w(39668:39672) = u(21)*w(590:594)
 w(39673:39676) = u(22)*w(591:594)
 w(39677:39679) = u(23)*w(592:594)
 w(39680:39681) = u(24)*w(593:594)
 w(39682) = u(25)*w(594)
endif
! terms of degree 9
if (9.le.mxd) then
 w(39683:64105) = u(0)*w(15260:39682)
 w(64106:78824) = u(1)*w(24964:39682)
 w(78825:87501) = u(2)*w(31006:39682)
 w(87502:92499) = u(3)*w(34685:39682)
 w(92500:95309) = u(4)*w(36873:39682)
 w(95310:96850) = u(5)*w(38142:39682)
 w(96851:97675) = u(6)*w(38858:39682)
 w(97676:97879) = u(7)*w(15056:15259)
 w(97880:98037) = u(8)*w(15102:15259)
 w(98038:98157) = u(9)*w(15140:15259)
 w(98158:98247) = u(10)*w(15170:15259)
 w(98248:98315) = u(11)*w(15192:15259)
 w(98316:98356) = u(12)*w(5515:5555)
 w(98357:98389) = u(13)*w(5523:5555)
 w(98390:98415) = u(14)*w(5530:5555)
 w(98416:98435) = u(15)*w(5536:5555)
 w(98436:98450) = u(16)*w(5541:5555)
 w(98451:98461) = u(17)*w(5545:5555)
 w(98462:98469) = u(18)*w(5548:5555)
 w(98470:98475) = u(19)*w(5550:5555)
 w(98476:98481) = u(20)*w(1888:1893)
 w(98482:98487) = u(21)*w(1888:1893)
 w(98488:98493) = u(22)*w(1888:1893)
 w(98494:98499) = u(23)*w(1888:1893)
 w(98500:98505) = u(24)*w(1888:1893)
 w(98506:98511) = u(25)*w(1888:1893)
endif
END SUBROUTINE mg7111_prib
