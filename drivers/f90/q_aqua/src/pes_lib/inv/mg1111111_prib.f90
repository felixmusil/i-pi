SUBROUTINE mg1111111_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg1111111_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg1111111_prib: bad size u'
!! else if (size(w).ne.mg1111111_npb(mxd)) then
!!  stop 'mg1111111_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 21 0 0 0 0 0 0 0 0
! prib,  dnpb(0:*): 1 21 231 1771 10626 53130 230230 888030 3108105 10015005
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
 w(10) = u(9)*w(0)
 w(11) = u(10)*w(0)
 w(12) = u(11)*w(0)
 w(13) = u(12)*w(0)
 w(14) = u(13)*w(0)
 w(15) = u(14)*w(0)
 w(16) = u(15)*w(0)
 w(17) = u(16)*w(0)
 w(18) = u(17)*w(0)
 w(19) = u(18)*w(0)
 w(20) = u(19)*w(0)
 w(21) = u(20)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(22:42) = u(0)*w(1:21)
 w(43:62) = u(1)*w(2:21)
 w(63:81) = u(2)*w(3:21)
 w(82:99) = u(3)*w(4:21)
 w(100:116) = u(4)*w(5:21)
 w(117:132) = u(5)*w(6:21)
 w(133:147) = u(6)*w(7:21)
 w(148:161) = u(7)*w(8:21)
 w(162:174) = u(8)*w(9:21)
 w(175:186) = u(9)*w(10:21)
 w(187:197) = u(10)*w(11:21)
 w(198:207) = u(11)*w(12:21)
 w(208:216) = u(12)*w(13:21)
 w(217:224) = u(13)*w(14:21)
 w(225:231) = u(14)*w(15:21)
 w(232:237) = u(15)*w(16:21)
 w(238:242) = u(16)*w(17:21)
 w(243:246) = u(17)*w(18:21)
 w(247:249) = u(18)*w(19:21)
 w(250:251) = u(19)*w(20:21)
 w(252) = u(20)*w(21)
endif
! terms of degree 3
if (3.le.mxd) then
 w(253:483) = u(0)*w(22:252)
 w(484:693) = u(1)*w(43:252)
 w(694:883) = u(2)*w(63:252)
 w(884:1054) = u(3)*w(82:252)
 w(1055:1207) = u(4)*w(100:252)
 w(1208:1343) = u(5)*w(117:252)
 w(1344:1463) = u(6)*w(133:252)
 w(1464:1568) = u(7)*w(148:252)
 w(1569:1659) = u(8)*w(162:252)
 w(1660:1737) = u(9)*w(175:252)
 w(1738:1803) = u(10)*w(187:252)
 w(1804:1858) = u(11)*w(198:252)
 w(1859:1903) = u(12)*w(208:252)
 w(1904:1939) = u(13)*w(217:252)
 w(1940:1967) = u(14)*w(225:252)
 w(1968:1988) = u(15)*w(232:252)
 w(1989:2003) = u(16)*w(238:252)
 w(2004:2013) = u(17)*w(243:252)
 w(2014:2019) = u(18)*w(247:252)
 w(2020:2022) = u(19)*w(250:252)
 w(2023) = u(20)*w(252)
endif
! terms of degree 4
if (4.le.mxd) then
 w(2024:3794) = u(0)*w(253:2023)
 w(3795:5334) = u(1)*w(484:2023)
 w(5335:6664) = u(2)*w(694:2023)
 w(6665:7804) = u(3)*w(884:2023)
 w(7805:8773) = u(4)*w(1055:2023)
 w(8774:9589) = u(5)*w(1208:2023)
 w(9590:10269) = u(6)*w(1344:2023)
 w(10270:10829) = u(7)*w(1464:2023)
 w(10830:11284) = u(8)*w(1569:2023)
 w(11285:11648) = u(9)*w(1660:2023)
 w(11649:11934) = u(10)*w(1738:2023)
 w(11935:12154) = u(11)*w(1804:2023)
 w(12155:12319) = u(12)*w(1859:2023)
 w(12320:12439) = u(13)*w(1904:2023)
 w(12440:12523) = u(14)*w(1940:2023)
 w(12524:12579) = u(15)*w(1968:2023)
 w(12580:12614) = u(16)*w(1989:2023)
 w(12615:12634) = u(17)*w(2004:2023)
 w(12635:12644) = u(18)*w(2014:2023)
 w(12645:12648) = u(19)*w(2020:2023)
 w(12649) = u(20)*w(2023)
endif
! terms of degree 5
if (5.le.mxd) then
 w(12650:23275) = u(0)*w(2024:12649)
 w(23276:32130) = u(1)*w(3795:12649)
 w(32131:39445) = u(2)*w(5335:12649)
 w(39446:45430) = u(3)*w(6665:12649)
 w(45431:50275) = u(4)*w(7805:12649)
 w(50276:54151) = u(5)*w(8774:12649)
 w(54152:57211) = u(6)*w(9590:12649)
 w(57212:59591) = u(7)*w(10270:12649)
 w(59592:61411) = u(8)*w(10830:12649)
 w(61412:62776) = u(9)*w(11285:12649)
 w(62777:63777) = u(10)*w(11649:12649)
 w(63778:64492) = u(11)*w(11935:12649)
 w(64493:64987) = u(12)*w(12155:12649)
 w(64988:65317) = u(13)*w(12320:12649)
 w(65318:65527) = u(14)*w(12440:12649)
 w(65528:65653) = u(15)*w(12524:12649)
 w(65654:65723) = u(16)*w(12580:12649)
 w(65724:65758) = u(17)*w(12615:12649)
 w(65759:65773) = u(18)*w(12635:12649)
 w(65774:65778) = u(19)*w(12645:12649)
 w(65779) = u(20)*w(12649)
endif
! terms of degree 6
if (6.le.mxd) then
 w(65780:118909) = u(0)*w(12650:65779)
 w(118910:161413) = u(1)*w(23276:65779)
 w(161414:195062) = u(2)*w(32131:65779)
 w(195063:221396) = u(3)*w(39446:65779)
 w(221397:241745) = u(4)*w(45431:65779)
 w(241746:257249) = u(5)*w(50276:65779)
 w(257250:268877) = u(6)*w(54152:65779)
 w(268878:277445) = u(7)*w(57212:65779)
 w(277446:283633) = u(8)*w(59592:65779)
 w(283634:288001) = u(9)*w(61412:65779)
 w(288002:291004) = u(10)*w(62777:65779)
 w(291005:293006) = u(11)*w(63778:65779)
 w(293007:294293) = u(12)*w(64493:65779)
 w(294294:295085) = u(13)*w(64988:65779)
 w(295086:295547) = u(14)*w(65318:65779)
 w(295548:295799) = u(15)*w(65528:65779)
 w(295800:295925) = u(16)*w(65654:65779)
 w(295926:295981) = u(17)*w(65724:65779)
 w(295982:296002) = u(18)*w(65759:65779)
 w(296003:296008) = u(19)*w(65774:65779)
 w(296009) = u(20)*w(65779)
endif
! terms of degree 7
if (7.le.mxd) then
 w(296010:526239) = u(0)*w(65780:296009)
 w(526240:703339) = u(1)*w(118910:296009)
 w(703340:837935) = u(2)*w(161414:296009)
 w(837936:938882) = u(3)*w(195063:296009)
 w(938883:1013495) = u(4)*w(221397:296009)
 w(1013496:1067759) = u(5)*w(241746:296009)
 w(1067760:1106519) = u(6)*w(257250:296009)
 w(1106520:1133651) = u(7)*w(268878:296009)
 w(1133652:1152215) = u(8)*w(277446:296009)
 w(1152216:1164591) = u(9)*w(283634:296009)
 w(1164592:1172599) = u(10)*w(288002:296009)
 w(1172600:1177604) = u(11)*w(291005:296009)
 w(1177605:1180607) = u(12)*w(293007:296009)
 w(1180608:1182323) = u(13)*w(294294:296009)
 w(1182324:1183247) = u(14)*w(295086:296009)
 w(1183248:1183709) = u(15)*w(295548:296009)
 w(1183710:1183919) = u(16)*w(295800:296009)
 w(1183920:1184003) = u(17)*w(295926:296009)
 w(1184004:1184031) = u(18)*w(295982:296009)
 w(1184032:1184038) = u(19)*w(296003:296009)
 w(1184039) = u(20)*w(296009)
endif
! terms of degree 8
if (8.le.mxd) then
 w(1184040:2072069) = u(0)*w(296010:1184039)
 w(2072070:2729869) = u(1)*w(526240:1184039)
 w(2729870:3210569) = u(2)*w(703340:1184039)
 w(3210570:3556673) = u(3)*w(837936:1184039)
 w(3556674:3801830) = u(4)*w(938883:1184039)
 w(3801831:3972374) = u(5)*w(1013496:1184039)
 w(3972375:4088654) = u(6)*w(1067760:1184039)
 w(4088655:4166174) = u(7)*w(1106520:1184039)
 w(4166175:4216562) = u(8)*w(1133652:1184039)
 w(4216563:4248386) = u(9)*w(1152216:1184039)
 w(4248387:4267834) = u(10)*w(1164592:1184039)
 w(4267835:4279274) = u(11)*w(1172600:1184039)
 w(4279275:4285709) = u(12)*w(1177605:1184039)
 w(4285710:4289141) = u(13)*w(1180608:1184039)
 w(4289142:4290857) = u(14)*w(1182324:1184039)
 w(4290858:4291649) = u(15)*w(1183248:1184039)
 w(4291650:4291979) = u(16)*w(1183710:1184039)
 w(4291980:4292099) = u(17)*w(1183920:1184039)
 w(4292100:4292135) = u(18)*w(1184004:1184039)
 w(4292136:4292143) = u(19)*w(1184032:1184039)
 w(4292144) = u(20)*w(1184039)
endif
! terms of degree 9
if (9.le.mxd) then
 w(4292145:7400249) = u(0)*w(1184040:4292144)
 w(7400250:9620324) = u(1)*w(2072070:4292144)
 w(9620325:11182599) = u(2)*w(2729870:4292144)
 w(11182600:12264174) = u(3)*w(3210570:4292144)
 w(12264175:12999645) = u(4)*w(3556674:4292144)
 w(12999646:13489959) = u(5)*w(3801831:4292144)
 w(13489960:13809729) = u(6)*w(3972375:4292144)
 w(13809730:14013219) = u(7)*w(4088655:4292144)
 w(14013220:14139189) = u(8)*w(4166175:4292144)
 w(14139190:14214771) = u(9)*w(4216563:4292144)
 w(14214772:14258529) = u(10)*w(4248387:4292144)
 w(14258530:14282839) = u(11)*w(4267835:4292144)
 w(14282840:14295709) = u(12)*w(4279275:4292144)
 w(14295710:14302144) = u(13)*w(4285710:4292144)
 w(14302145:14305147) = u(14)*w(4289142:4292144)
 w(14305148:14306434) = u(15)*w(4290858:4292144)
 w(14306435:14306929) = u(16)*w(4291650:4292144)
 w(14306930:14307094) = u(17)*w(4291980:4292144)
 w(14307095:14307139) = u(18)*w(4292100:4292144)
 w(14307140:14307148) = u(19)*w(4292136:4292144)
 w(14307149) = u(20)*w(4292144)
endif
END SUBROUTINE mg1111111_prib
