SUBROUTINE mg211_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg211_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg211_prib: bad size u'
!! else if (size(w).ne.mg211_npb(mxd)) then
!!  stop 'mg211_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 4 2 0 0 0 0 0 0 0 &
!   0 0 0 0 0 0 0 0 0 0
! prib,  dnpb(0:*): 1 4 12 28 58 108 188 308 483 728 &
!   1064 1512 2100 2856 3816 5016 6501 8316 10516 13156
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(5:8) = u(0)*w(1:4)
 w(9:11) = u(1)*w(2:4)
 w(12:13) = u(2)*w(3:4)
 w(14) = u(3)*w(4)
 w(15) = u(4)*w(0)
 w(16) = u(5)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(17:28) = u(0)*w(5:16)
 w(29:36) = u(1)*w(9:16)
 w(37:41) = u(2)*w(12:16)
 w(42:44) = u(3)*w(14:16)
endif
! terms of degree 4
if (4.le.mxd) then
 w(45:72) = u(0)*w(17:44)
 w(73:88) = u(1)*w(29:44)
 w(89:96) = u(2)*w(37:44)
 w(97:99) = u(3)*w(42:44)
 w(100:101) = u(4)*w(15:16)
 w(102) = u(5)*w(16)
endif
! terms of degree 5
if (5.le.mxd) then
 w(103:160) = u(0)*w(45:102)
 w(161:190) = u(1)*w(73:102)
 w(191:204) = u(2)*w(89:102)
 w(205:210) = u(3)*w(97:102)
endif
! terms of degree 6
if (6.le.mxd) then
 w(211:318) = u(0)*w(103:210)
 w(319:368) = u(1)*w(161:210)
 w(369:388) = u(2)*w(191:210)
 w(389:394) = u(3)*w(205:210)
 w(395:397) = u(4)*w(100:102)
 w(398) = u(5)*w(102)
endif
! terms of degree 7
if (7.le.mxd) then
 w(399:586) = u(0)*w(211:398)
 w(587:666) = u(1)*w(319:398)
 w(667:696) = u(2)*w(369:398)
 w(697:706) = u(3)*w(389:398)
endif
! terms of degree 8
if (8.le.mxd) then
 w(707:1014) = u(0)*w(399:706)
 w(1015:1134) = u(1)*w(587:706)
 w(1135:1174) = u(2)*w(667:706)
 w(1175:1184) = u(3)*w(697:706)
 w(1185:1188) = u(4)*w(395:398)
 w(1189) = u(5)*w(398)
endif
! terms of degree 9
if (9.le.mxd) then
 w(1190:1672) = u(0)*w(707:1189)
 w(1673:1847) = u(1)*w(1015:1189)
 w(1848:1902) = u(2)*w(1135:1189)
 w(1903:1917) = u(3)*w(1175:1189)
endif
! terms of degree 10
if (10.le.mxd) then
 w(1918:2645) = u(0)*w(1190:1917)
 w(2646:2890) = u(1)*w(1673:1917)
 w(2891:2960) = u(2)*w(1848:1917)
 w(2961:2975) = u(3)*w(1903:1917)
 w(2976:2980) = u(4)*w(1185:1189)
 w(2981) = u(5)*w(1189)
endif
! terms of degree 11
if (11.le.mxd) then
 w(2982:4045) = u(0)*w(1918:2981)
 w(4046:4381) = u(1)*w(2646:2981)
 w(4382:4472) = u(2)*w(2891:2981)
 w(4473:4493) = u(3)*w(2961:2981)
endif
! terms of degree 12
if (12.le.mxd) then
 w(4494:6005) = u(0)*w(2982:4493)
 w(6006:6453) = u(1)*w(4046:4493)
 w(6454:6565) = u(2)*w(4382:4493)
 w(6566:6586) = u(3)*w(4473:4493)
 w(6587:6592) = u(4)*w(2976:2981)
 w(6593) = u(5)*w(2981)
endif
! terms of degree 13
if (13.le.mxd) then
 w(6594:8693) = u(0)*w(4494:6593)
 w(8694:9281) = u(1)*w(6006:6593)
 w(9282:9421) = u(2)*w(6454:6593)
 w(9422:9449) = u(3)*w(6566:6593)
endif
! terms of degree 14
if (14.le.mxd) then
 w(9450:12305) = u(0)*w(6594:9449)
 w(12306:13061) = u(1)*w(8694:9449)
 w(13062:13229) = u(2)*w(9282:9449)
 w(13230:13257) = u(3)*w(9422:9449)
 w(13258:13264) = u(4)*w(6587:6593)
 w(13265) = u(5)*w(6593)
endif
! terms of degree 15
if (15.le.mxd) then
 w(13266:17081) = u(0)*w(9450:13265)
 w(17082:18041) = u(1)*w(12306:13265)
 w(18042:18245) = u(2)*w(13062:13265)
 w(18246:18281) = u(3)*w(13230:13265)
endif
! terms of degree 16
if (16.le.mxd) then
 w(18282:23297) = u(0)*w(13266:18281)
 w(23298:24497) = u(1)*w(17082:18281)
 w(24498:24737) = u(2)*w(18042:18281)
 w(24738:24773) = u(3)*w(18246:18281)
 w(24774:24781) = u(4)*w(13258:13265)
 w(24782) = u(5)*w(13265)
endif
! terms of degree 17
if (17.le.mxd) then
 w(24783:31283) = u(0)*w(18282:24782)
 w(31284:32768) = u(1)*w(23298:24782)
 w(32769:33053) = u(2)*w(24498:24782)
 w(33054:33098) = u(3)*w(24738:24782)
endif
! terms of degree 18
if (18.le.mxd) then
 w(33099:41414) = u(0)*w(24783:33098)
 w(41415:43229) = u(1)*w(31284:33098)
 w(43230:43559) = u(2)*w(32769:33098)
 w(43560:43604) = u(3)*w(33054:33098)
 w(43605:43613) = u(4)*w(24774:24782)
 w(43614) = u(5)*w(24782)
endif
! terms of degree 19
if (19.le.mxd) then
 w(43615:54130) = u(0)*w(33099:43614)
 w(54131:56330) = u(1)*w(41415:43614)
 w(56331:56715) = u(2)*w(43230:43614)
 w(56716:56770) = u(3)*w(43560:43614)
endif
END SUBROUTINE mg211_prib
