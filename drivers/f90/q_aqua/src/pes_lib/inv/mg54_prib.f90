SUBROUTINE mg54_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg54_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg54_prib: bad size u'
!! else if (size(w).ne.mg54_npb(mxd)) then
!!  stop 'mg54_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 3 7 9 8 3 2 0 0 0
! prib,  dnpb(0:*): 1 3 13 40 120 319 824 1980 4613 10274
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(4:6) = u(0)*w(1:3)
 w(7:8) = u(1)*w(2:3)
 w(9) = u(2)*w(3)
 w(10) = u(3)*w(0)
 w(11) = u(4)*w(0)
 w(12) = u(5)*w(0)
 w(13) = u(6)*w(0)
 w(14) = u(7)*w(0)
 w(15) = u(8)*w(0)
 w(16) = u(9)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(17:29) = u(0)*w(4:16)
 w(30:39) = u(1)*w(7:16)
 w(40:47) = u(2)*w(9:16)
 w(48) = u(10)*w(0)
 w(49) = u(11)*w(0)
 w(50) = u(12)*w(0)
 w(51) = u(13)*w(0)
 w(52) = u(14)*w(0)
 w(53) = u(15)*w(0)
 w(54) = u(16)*w(0)
 w(55) = u(17)*w(0)
 w(56) = u(18)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(57:96) = u(0)*w(17:56)
 w(97:123) = u(1)*w(30:56)
 w(124:140) = u(2)*w(40:56)
 w(141:147) = u(3)*w(10:16)
 w(148:153) = u(4)*w(11:16)
 w(154:158) = u(5)*w(12:16)
 w(159:162) = u(6)*w(13:16)
 w(163:165) = u(7)*w(14:16)
 w(166:167) = u(8)*w(15:16)
 w(168) = u(9)*w(16)
 w(169) = u(19)*w(0)
 w(170) = u(20)*w(0)
 w(171) = u(21)*w(0)
 w(172) = u(22)*w(0)
 w(173) = u(23)*w(0)
 w(174) = u(24)*w(0)
 w(175) = u(25)*w(0)
 w(176) = u(26)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(177:296) = u(0)*w(57:176)
 w(297:376) = u(1)*w(97:176)
 w(377:429) = u(2)*w(124:176)
 w(430:438) = u(3)*w(48:56)
 w(439:447) = u(4)*w(48:56)
 w(448:456) = u(5)*w(48:56)
 w(457:465) = u(6)*w(48:56)
 w(466:474) = u(7)*w(48:56)
 w(475:483) = u(8)*w(48:56)
 w(484:492) = u(9)*w(48:56)
 w(493) = u(27)*w(0)
 w(494) = u(28)*w(0)
 w(495) = u(29)*w(0)
endif
! terms of degree 6
if (6.le.mxd) then
 w(496:814) = u(0)*w(177:495)
 w(815:1013) = u(1)*w(297:495)
 w(1014:1132) = u(2)*w(377:495)
 w(1133:1168) = u(3)*w(141:176)
 w(1169:1197) = u(4)*w(148:176)
 w(1198:1220) = u(5)*w(154:176)
 w(1221:1238) = u(6)*w(159:176)
 w(1239:1252) = u(7)*w(163:176)
 w(1253:1263) = u(8)*w(166:176)
 w(1264:1272) = u(9)*w(168:176)
 w(1273:1281) = u(10)*w(48:56)
 w(1282:1289) = u(11)*w(49:56)
 w(1290:1296) = u(12)*w(50:56)
 w(1297:1302) = u(13)*w(51:56)
 w(1303:1307) = u(14)*w(52:56)
 w(1308:1311) = u(15)*w(53:56)
 w(1312:1314) = u(16)*w(54:56)
 w(1315:1316) = u(17)*w(55:56)
 w(1317) = u(18)*w(56)
 w(1318) = u(30)*w(0)
 w(1319) = u(31)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(1320:2143) = u(0)*w(496:1319)
 w(2144:2648) = u(1)*w(815:1319)
 w(2649:2954) = u(2)*w(1014:1319)
 w(2955:3020) = u(3)*w(430:495)
 w(3021:3077) = u(4)*w(439:495)
 w(3078:3125) = u(5)*w(448:495)
 w(3126:3164) = u(6)*w(457:495)
 w(3165:3194) = u(7)*w(466:495)
 w(3195:3215) = u(8)*w(475:495)
 w(3216:3227) = u(9)*w(484:495)
 w(3228:3235) = u(10)*w(169:176)
 w(3236:3243) = u(11)*w(169:176)
 w(3244:3251) = u(12)*w(169:176)
 w(3252:3259) = u(13)*w(169:176)
 w(3260:3267) = u(14)*w(169:176)
 w(3268:3275) = u(15)*w(169:176)
 w(3276:3283) = u(16)*w(169:176)
 w(3284:3291) = u(17)*w(169:176)
 w(3292:3299) = u(18)*w(169:176)
endif
! terms of degree 8
if (8.le.mxd) then
 w(3300:5279) = u(0)*w(1320:3299)
 w(5280:6435) = u(1)*w(2144:3299)
 w(6436:7086) = u(2)*w(2649:3299)
 w(7087:7273) = u(3)*w(1133:1319)
 w(7274:7424) = u(4)*w(1169:1319)
 w(7425:7546) = u(5)*w(1198:1319)
 w(7547:7645) = u(6)*w(1221:1319)
 w(7646:7726) = u(7)*w(1239:1319)
 w(7727:7793) = u(8)*w(1253:1319)
 w(7794:7849) = u(9)*w(1264:1319)
 w(7850:7852) = u(10)*w(493:495)
 w(7853:7855) = u(11)*w(493:495)
 w(7856:7858) = u(12)*w(493:495)
 w(7859:7861) = u(13)*w(493:495)
 w(7862:7864) = u(14)*w(493:495)
 w(7865:7867) = u(15)*w(493:495)
 w(7868:7870) = u(16)*w(493:495)
 w(7871:7873) = u(17)*w(493:495)
 w(7874:7876) = u(18)*w(493:495)
 w(7877:7884) = u(19)*w(169:176)
 w(7885:7891) = u(20)*w(170:176)
 w(7892:7897) = u(21)*w(171:176)
 w(7898:7902) = u(22)*w(172:176)
 w(7903:7906) = u(23)*w(173:176)
 w(7907:7909) = u(24)*w(174:176)
 w(7910:7911) = u(25)*w(175:176)
 w(7912) = u(26)*w(176)
endif
! terms of degree 9
if (9.le.mxd) then
 w(7913:12525) = u(0)*w(3300:7912)
 w(12526:15158) = u(1)*w(5280:7912)
 w(15159:16635) = u(2)*w(6436:7912)
 w(16636:16980) = u(3)*w(2955:3299)
 w(16981:17259) = u(4)*w(3021:3299)
 w(17260:17481) = u(5)*w(3078:3299)
 w(17482:17655) = u(6)*w(3126:3299)
 w(17656:17790) = u(7)*w(3165:3299)
 w(17791:17895) = u(8)*w(3195:3299)
 w(17896:17979) = u(9)*w(3216:3299)
 w(17980:18026) = u(10)*w(1273:1319)
 w(18027:18064) = u(11)*w(1282:1319)
 w(18065:18094) = u(12)*w(1290:1319)
 w(18095:18117) = u(13)*w(1297:1319)
 w(18118:18134) = u(14)*w(1303:1319)
 w(18135:18146) = u(15)*w(1308:1319)
 w(18147:18154) = u(16)*w(1312:1319)
 w(18155:18159) = u(17)*w(1315:1319)
 w(18160:18162) = u(18)*w(1317:1319)
 w(18163:18165) = u(19)*w(493:495)
 w(18166:18168) = u(20)*w(493:495)
 w(18169:18171) = u(21)*w(493:495)
 w(18172:18174) = u(22)*w(493:495)
 w(18175:18177) = u(23)*w(493:495)
 w(18178:18180) = u(24)*w(493:495)
 w(18181:18183) = u(25)*w(493:495)
 w(18184:18186) = u(26)*w(493:495)
endif
END SUBROUTINE mg54_prib
