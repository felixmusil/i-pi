SUBROUTINE mg4111_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg4111_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg4111_prib: bad size u'
!! else if (size(w).ne.mg4111_npb(mxd)) then
!!  stop 'mg4111_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 7 5 5 4 0 0 0 0 0
! prib,  dnpb(0:*): 1 7 33 124 404 1180 3171 7957 18863 42588
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(8:14) = u(0)*w(1:7)
 w(15:20) = u(1)*w(2:7)
 w(21:25) = u(2)*w(3:7)
 w(26:29) = u(3)*w(4:7)
 w(30:32) = u(4)*w(5:7)
 w(33:34) = u(5)*w(6:7)
 w(35) = u(6)*w(7)
 w(36) = u(7)*w(0)
 w(37) = u(8)*w(0)
 w(38) = u(9)*w(0)
 w(39) = u(10)*w(0)
 w(40) = u(11)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(41:73) = u(0)*w(8:40)
 w(74:99) = u(1)*w(15:40)
 w(100:119) = u(2)*w(21:40)
 w(120:134) = u(3)*w(26:40)
 w(135:145) = u(4)*w(30:40)
 w(146:153) = u(5)*w(33:40)
 w(154:159) = u(6)*w(35:40)
 w(160) = u(12)*w(0)
 w(161) = u(13)*w(0)
 w(162) = u(14)*w(0)
 w(163) = u(15)*w(0)
 w(164) = u(16)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(165:288) = u(0)*w(41:164)
 w(289:379) = u(1)*w(74:164)
 w(380:444) = u(2)*w(100:164)
 w(445:489) = u(3)*w(120:164)
 w(490:519) = u(4)*w(135:164)
 w(520:538) = u(5)*w(146:164)
 w(539:549) = u(6)*w(154:164)
 w(550:554) = u(7)*w(36:40)
 w(555:558) = u(8)*w(37:40)
 w(559:561) = u(9)*w(38:40)
 w(562:563) = u(10)*w(39:40)
 w(564) = u(11)*w(40)
 w(565) = u(17)*w(0)
 w(566) = u(18)*w(0)
 w(567) = u(19)*w(0)
 w(568) = u(20)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(569:972) = u(0)*w(165:568)
 w(973:1252) = u(1)*w(289:568)
 w(1253:1441) = u(2)*w(380:568)
 w(1442:1565) = u(3)*w(445:568)
 w(1566:1644) = u(4)*w(490:568)
 w(1645:1693) = u(5)*w(520:568)
 w(1694:1723) = u(6)*w(539:568)
 w(1724:1728) = u(7)*w(160:164)
 w(1729:1733) = u(8)*w(160:164)
 w(1734:1738) = u(9)*w(160:164)
 w(1739:1743) = u(10)*w(160:164)
 w(1744:1748) = u(11)*w(160:164)
endif
! terms of degree 6
if (6.le.mxd) then
 w(1749:2928) = u(0)*w(569:1748)
 w(2929:3704) = u(1)*w(973:1748)
 w(3705:4200) = u(2)*w(1253:1748)
 w(4201:4507) = u(3)*w(1442:1748)
 w(4508:4690) = u(4)*w(1566:1748)
 w(4691:4794) = u(5)*w(1645:1748)
 w(4795:4849) = u(6)*w(1694:1748)
 w(4850:4868) = u(7)*w(550:568)
 w(4869:4882) = u(8)*w(555:568)
 w(4883:4892) = u(9)*w(559:568)
 w(4893:4899) = u(10)*w(562:568)
 w(4900:4904) = u(11)*w(564:568)
 w(4905:4909) = u(12)*w(160:164)
 w(4910:4913) = u(13)*w(161:164)
 w(4914:4916) = u(14)*w(162:164)
 w(4917:4918) = u(15)*w(163:164)
 w(4919) = u(16)*w(164)
endif
! terms of degree 7
if (7.le.mxd) then
 w(4920:8090) = u(0)*w(1749:4919)
 w(8091:10081) = u(1)*w(2929:4919)
 w(10082:11296) = u(2)*w(3705:4919)
 w(11297:12015) = u(3)*w(4201:4919)
 w(12016:12427) = u(4)*w(4508:4919)
 w(12428:12656) = u(5)*w(4691:4919)
 w(12657:12781) = u(6)*w(4795:4919)
 w(12782:12806) = u(7)*w(1724:1748)
 w(12807:12826) = u(8)*w(1729:1748)
 w(12827:12841) = u(9)*w(1734:1748)
 w(12842:12851) = u(10)*w(1739:1748)
 w(12852:12856) = u(11)*w(1744:1748)
 w(12857:12860) = u(12)*w(565:568)
 w(12861:12864) = u(13)*w(565:568)
 w(12865:12868) = u(14)*w(565:568)
 w(12869:12872) = u(15)*w(565:568)
 w(12873:12876) = u(16)*w(565:568)
endif
! terms of degree 8
if (8.le.mxd) then
 w(12877:20833) = u(0)*w(4920:12876)
 w(20834:25619) = u(1)*w(8091:12876)
 w(25620:28414) = u(2)*w(10082:12876)
 w(28415:29994) = u(3)*w(11297:12876)
 w(29995:30855) = u(4)*w(12016:12876)
 w(30856:31304) = u(5)*w(12428:12876)
 w(31305:31524) = u(6)*w(12657:12876)
 w(31525:31594) = u(7)*w(4850:4919)
 w(31595:31645) = u(8)*w(4869:4919)
 w(31646:31682) = u(9)*w(4883:4919)
 w(31683:31709) = u(10)*w(4893:4919)
 w(31710:31729) = u(11)*w(4900:4919)
 w(31730:31733) = u(17)*w(565:568)
 w(31734:31736) = u(18)*w(566:568)
 w(31737:31738) = u(19)*w(567:568)
 w(31739) = u(20)*w(568)
endif
! terms of degree 9
if (9.le.mxd) then
 w(31740:50602) = u(0)*w(12877:31739)
 w(50603:61508) = u(1)*w(20834:31739)
 w(61509:67628) = u(2)*w(25620:31739)
 w(67629:70953) = u(3)*w(28415:31739)
 w(70954:72698) = u(4)*w(29995:31739)
 w(72699:73582) = u(5)*w(30856:31739)
 w(73583:74017) = u(6)*w(31305:31739)
 w(74018:74112) = u(7)*w(12782:12876)
 w(74113:74182) = u(8)*w(12807:12876)
 w(74183:74232) = u(9)*w(12827:12876)
 w(74233:74267) = u(10)*w(12842:12876)
 w(74268:74292) = u(11)*w(12852:12876)
 w(74293:74307) = u(12)*w(4905:4919)
 w(74308:74317) = u(13)*w(4910:4919)
 w(74318:74323) = u(14)*w(4914:4919)
 w(74324:74326) = u(15)*w(4917:4919)
 w(74327) = u(16)*w(4919)
endif
END SUBROUTINE mg4111_prib
