SUBROUTINE mg411111_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg411111_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg411111_prib: bad size u'
!! else if (size(w).ne.mg411111_npb(mxd)) then
!!  stop 'mg411111_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 16 7 7 6 0 0 0 0 0
! prib,  dnpb(0:*): 1 16 143 935 4974 22761 92670 343314 1175805 3766738
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
 w(10) = u(9)*w(0)
 w(11) = u(10)*w(0)
 w(12) = u(11)*w(0)
 w(13) = u(12)*w(0)
 w(14) = u(13)*w(0)
 w(15) = u(14)*w(0)
 w(16) = u(15)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(17:32) = u(0)*w(1:16)
 w(33:47) = u(1)*w(2:16)
 w(48:61) = u(2)*w(3:16)
 w(62:74) = u(3)*w(4:16)
 w(75:86) = u(4)*w(5:16)
 w(87:97) = u(5)*w(6:16)
 w(98:107) = u(6)*w(7:16)
 w(108:116) = u(7)*w(8:16)
 w(117:124) = u(8)*w(9:16)
 w(125:131) = u(9)*w(10:16)
 w(132:137) = u(10)*w(11:16)
 w(138:142) = u(11)*w(12:16)
 w(143:146) = u(12)*w(13:16)
 w(147:149) = u(13)*w(14:16)
 w(150:151) = u(14)*w(15:16)
 w(152) = u(15)*w(16)
 w(153) = u(16)*w(0)
 w(154) = u(17)*w(0)
 w(155) = u(18)*w(0)
 w(156) = u(19)*w(0)
 w(157) = u(20)*w(0)
 w(158) = u(21)*w(0)
 w(159) = u(22)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(160:302) = u(0)*w(17:159)
 w(303:429) = u(1)*w(33:159)
 w(430:541) = u(2)*w(48:159)
 w(542:639) = u(3)*w(62:159)
 w(640:724) = u(4)*w(75:159)
 w(725:797) = u(5)*w(87:159)
 w(798:859) = u(6)*w(98:159)
 w(860:911) = u(7)*w(108:159)
 w(912:954) = u(8)*w(117:159)
 w(955:989) = u(9)*w(125:159)
 w(990:1017) = u(10)*w(132:159)
 w(1018:1039) = u(11)*w(138:159)
 w(1040:1056) = u(12)*w(143:159)
 w(1057:1069) = u(13)*w(147:159)
 w(1070:1079) = u(14)*w(150:159)
 w(1080:1087) = u(15)*w(152:159)
 w(1088) = u(23)*w(0)
 w(1089) = u(24)*w(0)
 w(1090) = u(25)*w(0)
 w(1091) = u(26)*w(0)
 w(1092) = u(27)*w(0)
 w(1093) = u(28)*w(0)
 w(1094) = u(29)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(1095:2029) = u(0)*w(160:1094)
 w(2030:2821) = u(1)*w(303:1094)
 w(2822:3486) = u(2)*w(430:1094)
 w(3487:4039) = u(3)*w(542:1094)
 w(4040:4494) = u(4)*w(640:1094)
 w(4495:4864) = u(5)*w(725:1094)
 w(4865:5161) = u(6)*w(798:1094)
 w(5162:5396) = u(7)*w(860:1094)
 w(5397:5579) = u(8)*w(912:1094)
 w(5580:5719) = u(9)*w(955:1094)
 w(5720:5824) = u(10)*w(990:1094)
 w(5825:5901) = u(11)*w(1018:1094)
 w(5902:5956) = u(12)*w(1040:1094)
 w(5957:5994) = u(13)*w(1057:1094)
 w(5995:6019) = u(14)*w(1070:1094)
 w(6020:6034) = u(15)*w(1080:1094)
 w(6035:6041) = u(16)*w(153:159)
 w(6042:6047) = u(17)*w(154:159)
 w(6048:6052) = u(18)*w(155:159)
 w(6053:6056) = u(19)*w(156:159)
 w(6057:6059) = u(20)*w(157:159)
 w(6060:6061) = u(21)*w(158:159)
 w(6062) = u(22)*w(159)
 w(6063) = u(30)*w(0)
 w(6064) = u(31)*w(0)
 w(6065) = u(32)*w(0)
 w(6066) = u(33)*w(0)
 w(6067) = u(34)*w(0)
 w(6068) = u(35)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(6069:11042) = u(0)*w(1095:6068)
 w(11043:15081) = u(1)*w(2030:6068)
 w(15082:18328) = u(2)*w(2822:6068)
 w(18329:20910) = u(3)*w(3487:6068)
 w(20911:22939) = u(4)*w(4040:6068)
 w(22940:24513) = u(5)*w(4495:6068)
 w(24514:25717) = u(6)*w(4865:6068)
 w(25718:26624) = u(7)*w(5162:6068)
 w(26625:27296) = u(8)*w(5397:6068)
 w(27297:27785) = u(9)*w(5580:6068)
 w(27786:28134) = u(10)*w(5720:6068)
 w(28135:28378) = u(11)*w(5825:6068)
 w(28379:28545) = u(12)*w(5902:6068)
 w(28546:28657) = u(13)*w(5957:6068)
 w(28658:28731) = u(14)*w(5995:6068)
 w(28732:28780) = u(15)*w(6020:6068)
 w(28781:28787) = u(16)*w(1088:1094)
 w(28788:28794) = u(17)*w(1088:1094)
 w(28795:28801) = u(18)*w(1088:1094)
 w(28802:28808) = u(19)*w(1088:1094)
 w(28809:28815) = u(20)*w(1088:1094)
 w(28816:28822) = u(21)*w(1088:1094)
 w(28823:28829) = u(22)*w(1088:1094)
endif
! terms of degree 6
if (6.le.mxd) then
 w(28830:51590) = u(0)*w(6069:28829)
 w(51591:69377) = u(1)*w(11043:28829)
 w(69378:83125) = u(2)*w(15082:28829)
 w(83126:93626) = u(3)*w(18329:28829)
 w(93627:101545) = u(4)*w(20911:28829)
 w(101546:107435) = u(5)*w(22940:28829)
 w(107436:111751) = u(6)*w(24514:28829)
 w(111752:114863) = u(7)*w(25718:28829)
 w(114864:117068) = u(8)*w(26625:28829)
 w(117069:118601) = u(9)*w(27297:28829)
 w(118602:119645) = u(10)*w(27786:28829)
 w(119646:120340) = u(11)*w(28135:28829)
 w(120341:120791) = u(12)*w(28379:28829)
 w(120792:121075) = u(13)*w(28546:28829)
 w(121076:121247) = u(14)*w(28658:28829)
 w(121248:121345) = u(15)*w(28732:28829)
 w(121346:121379) = u(16)*w(6035:6068)
 w(121380:121406) = u(17)*w(6042:6068)
 w(121407:121427) = u(18)*w(6048:6068)
 w(121428:121443) = u(19)*w(6053:6068)
 w(121444:121455) = u(20)*w(6057:6068)
 w(121456:121464) = u(21)*w(6060:6068)
 w(121465:121471) = u(22)*w(6062:6068)
 w(121472:121478) = u(23)*w(1088:1094)
 w(121479:121484) = u(24)*w(1089:1094)
 w(121485:121489) = u(25)*w(1090:1094)
 w(121490:121493) = u(26)*w(1091:1094)
 w(121494:121496) = u(27)*w(1092:1094)
 w(121497:121498) = u(28)*w(1093:1094)
 w(121499) = u(29)*w(1094)
endif
! terms of degree 7
if (7.le.mxd) then
 w(121500:214169) = u(0)*w(28830:121499)
 w(214170:284078) = u(1)*w(51591:121499)
 w(284079:336200) = u(2)*w(69378:121499)
 w(336201:374574) = u(3)*w(83126:121499)
 w(374575:402447) = u(4)*w(93627:121499)
 w(402448:422401) = u(5)*w(101546:121499)
 w(422402:436465) = u(6)*w(107436:121499)
 w(436466:446213) = u(7)*w(111752:121499)
 w(446214:452849) = u(8)*w(114864:121499)
 w(452850:457280) = u(9)*w(117069:121499)
 w(457281:460178) = u(10)*w(118602:121499)
 w(460179:462032) = u(11)*w(119646:121499)
 w(462033:463191) = u(12)*w(120341:121499)
 w(463192:463899) = u(13)*w(120792:121499)
 w(463900:464323) = u(14)*w(121076:121499)
 w(464324:464575) = u(15)*w(121248:121499)
 w(464576:464624) = u(16)*w(28781:28829)
 w(464625:464666) = u(17)*w(28788:28829)
 w(464667:464701) = u(18)*w(28795:28829)
 w(464702:464729) = u(19)*w(28802:28829)
 w(464730:464750) = u(20)*w(28809:28829)
 w(464751:464764) = u(21)*w(28816:28829)
 w(464765:464771) = u(22)*w(28823:28829)
 w(464772:464777) = u(23)*w(6063:6068)
 w(464778:464783) = u(24)*w(6063:6068)
 w(464784:464789) = u(25)*w(6063:6068)
 w(464790:464795) = u(26)*w(6063:6068)
 w(464796:464801) = u(27)*w(6063:6068)
 w(464802:464807) = u(28)*w(6063:6068)
 w(464808:464813) = u(29)*w(6063:6068)
endif
! terms of degree 8
if (8.le.mxd) then
 w(464814:808127) = u(0)*w(121500:464813)
 w(808128:1058771) = u(1)*w(214170:464813)
 w(1058772:1239506) = u(2)*w(284079:464813)
 w(1239507:1368119) = u(3)*w(336201:464813)
 w(1368120:1458358) = u(4)*w(374575:464813)
 w(1458359:1520724) = u(5)*w(402448:464813)
 w(1520725:1563136) = u(6)*w(422402:464813)
 w(1563137:1591484) = u(7)*w(436466:464813)
 w(1591485:1610084) = u(8)*w(446214:464813)
 w(1610085:1622048) = u(9)*w(452850:464813)
 w(1622049:1629581) = u(10)*w(457281:464813)
 w(1629582:1634216) = u(11)*w(460179:464813)
 w(1634217:1636997) = u(12)*w(462033:464813)
 w(1636998:1638619) = u(13)*w(463192:464813)
 w(1638620:1639533) = u(14)*w(463900:464813)
 w(1639534:1640023) = u(15)*w(464324:464813)
 w(1640024:1640177) = u(16)*w(121346:121499)
 w(1640178:1640297) = u(17)*w(121380:121499)
 w(1640298:1640390) = u(18)*w(121407:121499)
 w(1640391:1640462) = u(19)*w(121428:121499)
 w(1640463:1640518) = u(20)*w(121444:121499)
 w(1640519:1640562) = u(21)*w(121456:121499)
 w(1640563:1640597) = u(22)*w(121465:121499)
 w(1640598:1640603) = u(30)*w(6063:6068)
 w(1640604:1640608) = u(31)*w(6064:6068)
 w(1640609:1640612) = u(32)*w(6065:6068)
 w(1640613:1640615) = u(33)*w(6066:6068)
 w(1640616:1640617) = u(34)*w(6067:6068)
 w(1640618) = u(35)*w(6068)
endif
! terms of degree 9
if (9.le.mxd) then
 w(1640619:2816423) = u(0)*w(464814:1640618)
 w(2816424:3648914) = u(1)*w(808128:1640618)
 w(3648915:4230761) = u(2)*w(1058772:1640618)
 w(4230762:4631873) = u(3)*w(1239507:1640618)
 w(4631874:4904372) = u(4)*w(1368120:1640618)
 w(4904373:5086632) = u(5)*w(1458359:1640618)
 w(5086633:5206526) = u(6)*w(1520725:1640618)
 w(5206527:5284008) = u(7)*w(1563137:1640618)
 w(5284009:5333142) = u(8)*w(1591485:1640618)
 w(5333143:5363676) = u(9)*w(1610085:1640618)
 w(5363677:5382246) = u(10)*w(1622049:1640618)
 w(5382247:5393283) = u(11)*w(1629582:1640618)
 w(5393284:5399685) = u(12)*w(1634217:1640618)
 w(5399686:5403306) = u(13)*w(1636998:1640618)
 w(5403307:5405305) = u(14)*w(1638620:1640618)
 w(5405306:5406390) = u(15)*w(1639534:1640618)
 w(5406391:5406628) = u(16)*w(464576:464813)
 w(5406629:5406817) = u(17)*w(464625:464813)
 w(5406818:5406964) = u(18)*w(464667:464813)
 w(5406965:5407076) = u(19)*w(464702:464813)
 w(5407077:5407160) = u(20)*w(464730:464813)
 w(5407161:5407223) = u(21)*w(464751:464813)
 w(5407224:5407272) = u(22)*w(464765:464813)
 w(5407273:5407300) = u(23)*w(121472:121499)
 w(5407301:5407321) = u(24)*w(121479:121499)
 w(5407322:5407336) = u(25)*w(121485:121499)
 w(5407337:5407346) = u(26)*w(121490:121499)
 w(5407347:5407352) = u(27)*w(121494:121499)
 w(5407353:5407355) = u(28)*w(121497:121499)
 w(5407356) = u(29)*w(121499)
endif
END SUBROUTINE mg411111_prib
