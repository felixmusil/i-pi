SUBROUTINE mg431_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg431_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg431_prib: bad size u'
!! else if (size(w).ne.mg431_npb(mxd)) then
!!  stop 'mg431_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 5 8 8 5 0 1 0 0 0
! prib,  dnpb(0:*): 1 5 23 83 271 795 2182 5606 13709 32009
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(6:10) = u(0)*w(1:5)
 w(11:14) = u(1)*w(2:5)
 w(15:17) = u(2)*w(3:5)
 w(18:19) = u(3)*w(4:5)
 w(20) = u(4)*w(5)
 w(21) = u(5)*w(0)
 w(22) = u(6)*w(0)
 w(23) = u(7)*w(0)
 w(24) = u(8)*w(0)
 w(25) = u(9)*w(0)
 w(26) = u(10)*w(0)
 w(27) = u(11)*w(0)
 w(28) = u(12)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(29:51) = u(0)*w(6:28)
 w(52:69) = u(1)*w(11:28)
 w(70:83) = u(2)*w(15:28)
 w(84:94) = u(3)*w(18:28)
 w(95:103) = u(4)*w(20:28)
 w(104) = u(13)*w(0)
 w(105) = u(14)*w(0)
 w(106) = u(15)*w(0)
 w(107) = u(16)*w(0)
 w(108) = u(17)*w(0)
 w(109) = u(18)*w(0)
 w(110) = u(19)*w(0)
 w(111) = u(20)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(112:194) = u(0)*w(29:111)
 w(195:254) = u(1)*w(52:111)
 w(255:296) = u(2)*w(70:111)
 w(297:324) = u(3)*w(84:111)
 w(325:341) = u(4)*w(95:111)
 w(342:349) = u(5)*w(21:28)
 w(350:356) = u(6)*w(22:28)
 w(357:362) = u(7)*w(23:28)
 w(363:367) = u(8)*w(24:28)
 w(368:371) = u(9)*w(25:28)
 w(372:374) = u(10)*w(26:28)
 w(375:376) = u(11)*w(27:28)
 w(377) = u(12)*w(28)
 w(378) = u(21)*w(0)
 w(379) = u(22)*w(0)
 w(380) = u(23)*w(0)
 w(381) = u(24)*w(0)
 w(382) = u(25)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(383:653) = u(0)*w(112:382)
 w(654:841) = u(1)*w(195:382)
 w(842:969) = u(2)*w(255:382)
 w(970:1055) = u(3)*w(297:382)
 w(1056:1113) = u(4)*w(325:382)
 w(1114:1121) = u(5)*w(104:111)
 w(1122:1129) = u(6)*w(104:111)
 w(1130:1137) = u(7)*w(104:111)
 w(1138:1145) = u(8)*w(104:111)
 w(1146:1153) = u(9)*w(104:111)
 w(1154:1161) = u(10)*w(104:111)
 w(1162:1169) = u(11)*w(104:111)
 w(1170:1177) = u(12)*w(104:111)
endif
! terms of degree 6
if (6.le.mxd) then
 w(1178:1972) = u(0)*w(383:1177)
 w(1973:2496) = u(1)*w(654:1177)
 w(2497:2832) = u(2)*w(842:1177)
 w(2833:3040) = u(3)*w(970:1177)
 w(3041:3162) = u(4)*w(1056:1177)
 w(3163:3203) = u(5)*w(342:382)
 w(3204:3236) = u(6)*w(350:382)
 w(3237:3262) = u(7)*w(357:382)
 w(3263:3282) = u(8)*w(363:382)
 w(3283:3297) = u(9)*w(368:382)
 w(3298:3308) = u(10)*w(372:382)
 w(3309:3316) = u(11)*w(375:382)
 w(3317:3322) = u(12)*w(377:382)
 w(3323:3330) = u(13)*w(104:111)
 w(3331:3337) = u(14)*w(105:111)
 w(3338:3343) = u(15)*w(106:111)
 w(3344:3348) = u(16)*w(107:111)
 w(3349:3352) = u(17)*w(108:111)
 w(3353:3355) = u(18)*w(109:111)
 w(3356:3357) = u(19)*w(110:111)
 w(3358) = u(20)*w(111)
 w(3359) = u(26)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(3360:5541) = u(0)*w(1178:3359)
 w(5542:6928) = u(1)*w(1973:3359)
 w(6929:7791) = u(2)*w(2497:3359)
 w(7792:8318) = u(3)*w(2833:3359)
 w(8319:8637) = u(4)*w(3041:3359)
 w(8638:8701) = u(5)*w(1114:1177)
 w(8702:8757) = u(6)*w(1122:1177)
 w(8758:8805) = u(7)*w(1130:1177)
 w(8806:8845) = u(8)*w(1138:1177)
 w(8846:8877) = u(9)*w(1146:1177)
 w(8878:8901) = u(10)*w(1154:1177)
 w(8902:8917) = u(11)*w(1162:1177)
 w(8918:8925) = u(12)*w(1170:1177)
 w(8926:8930) = u(13)*w(378:382)
 w(8931:8935) = u(14)*w(378:382)
 w(8936:8940) = u(15)*w(378:382)
 w(8941:8945) = u(16)*w(378:382)
 w(8946:8950) = u(17)*w(378:382)
 w(8951:8955) = u(18)*w(378:382)
 w(8956:8960) = u(19)*w(378:382)
 w(8961:8965) = u(20)*w(378:382)
endif
! terms of degree 8
if (8.le.mxd) then
 w(8966:14571) = u(0)*w(3360:8965)
 w(14572:17995) = u(1)*w(5542:8965)
 w(17996:20032) = u(2)*w(6929:8965)
 w(20033:21206) = u(3)*w(7792:8965)
 w(21207:21853) = u(4)*w(8319:8965)
 w(21854:22050) = u(5)*w(3163:3359)
 w(22051:22206) = u(6)*w(3204:3359)
 w(22207:22329) = u(7)*w(3237:3359)
 w(22330:22426) = u(8)*w(3263:3359)
 w(22427:22503) = u(9)*w(3283:3359)
 w(22504:22565) = u(10)*w(3298:3359)
 w(22566:22616) = u(11)*w(3309:3359)
 w(22617:22659) = u(12)*w(3317:3359)
 w(22660:22664) = u(21)*w(378:382)
 w(22665:22668) = u(22)*w(379:382)
 w(22669:22671) = u(23)*w(380:382)
 w(22672:22673) = u(24)*w(381:382)
 w(22674) = u(25)*w(382)
endif
! terms of degree 9
if (9.le.mxd) then
 w(22675:36383) = u(0)*w(8966:22674)
 w(36384:44486) = u(1)*w(14572:22674)
 w(44487:49165) = u(2)*w(17996:22674)
 w(49166:51807) = u(3)*w(20033:22674)
 w(51808:53275) = u(4)*w(21207:22674)
 w(53276:53603) = u(5)*w(8638:8965)
 w(53604:53867) = u(6)*w(8702:8965)
 w(53868:54075) = u(7)*w(8758:8965)
 w(54076:54235) = u(8)*w(8806:8965)
 w(54236:54355) = u(9)*w(8846:8965)
 w(54356:54443) = u(10)*w(8878:8965)
 w(54444:54507) = u(11)*w(8902:8965)
 w(54508:54555) = u(12)*w(8918:8965)
 w(54556:54592) = u(13)*w(3323:3359)
 w(54593:54621) = u(14)*w(3331:3359)
 w(54622:54643) = u(15)*w(3338:3359)
 w(54644:54659) = u(16)*w(3344:3359)
 w(54660:54670) = u(17)*w(3349:3359)
 w(54671:54677) = u(18)*w(3353:3359)
 w(54678:54681) = u(19)*w(3356:3359)
 w(54682:54683) = u(20)*w(3358:3359)
endif
END SUBROUTINE mg431_prib
