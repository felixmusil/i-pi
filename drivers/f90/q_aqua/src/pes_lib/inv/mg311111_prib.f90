SUBROUTINE mg311111_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg311111_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg311111_prib: bad size u'
!! else if (size(w).ne.mg311111_npb(mxd)) then
!!  stop 'mg311111_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 16 6 6 0 0 0 0 0 0
! prib,  dnpb(0:*): 1 16 142 918 4809 21588 85925 310214 1032434 3205864
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
 w(10) = u(9)*w(0)
 w(11) = u(10)*w(0)
 w(12) = u(11)*w(0)
 w(13) = u(12)*w(0)
 w(14) = u(13)*w(0)
 w(15) = u(14)*w(0)
 w(16) = u(15)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(17:32) = u(0)*w(1:16)
 w(33:47) = u(1)*w(2:16)
 w(48:61) = u(2)*w(3:16)
 w(62:74) = u(3)*w(4:16)
 w(75:86) = u(4)*w(5:16)
 w(87:97) = u(5)*w(6:16)
 w(98:107) = u(6)*w(7:16)
 w(108:116) = u(7)*w(8:16)
 w(117:124) = u(8)*w(9:16)
 w(125:131) = u(9)*w(10:16)
 w(132:137) = u(10)*w(11:16)
 w(138:142) = u(11)*w(12:16)
 w(143:146) = u(12)*w(13:16)
 w(147:149) = u(13)*w(14:16)
 w(150:151) = u(14)*w(15:16)
 w(152) = u(15)*w(16)
 w(153) = u(16)*w(0)
 w(154) = u(17)*w(0)
 w(155) = u(18)*w(0)
 w(156) = u(19)*w(0)
 w(157) = u(20)*w(0)
 w(158) = u(21)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(159:300) = u(0)*w(17:158)
 w(301:426) = u(1)*w(33:158)
 w(427:537) = u(2)*w(48:158)
 w(538:634) = u(3)*w(62:158)
 w(635:718) = u(4)*w(75:158)
 w(719:790) = u(5)*w(87:158)
 w(791:851) = u(6)*w(98:158)
 w(852:902) = u(7)*w(108:158)
 w(903:944) = u(8)*w(117:158)
 w(945:978) = u(9)*w(125:158)
 w(979:1005) = u(10)*w(132:158)
 w(1006:1026) = u(11)*w(138:158)
 w(1027:1042) = u(12)*w(143:158)
 w(1043:1054) = u(13)*w(147:158)
 w(1055:1063) = u(14)*w(150:158)
 w(1064:1070) = u(15)*w(152:158)
 w(1071) = u(22)*w(0)
 w(1072) = u(23)*w(0)
 w(1073) = u(24)*w(0)
 w(1074) = u(25)*w(0)
 w(1075) = u(26)*w(0)
 w(1076) = u(27)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(1077:1994) = u(0)*w(159:1076)
 w(1995:2770) = u(1)*w(301:1076)
 w(2771:3420) = u(2)*w(427:1076)
 w(3421:3959) = u(3)*w(538:1076)
 w(3960:4401) = u(4)*w(635:1076)
 w(4402:4759) = u(5)*w(719:1076)
 w(4760:5045) = u(6)*w(791:1076)
 w(5046:5270) = u(7)*w(852:1076)
 w(5271:5444) = u(8)*w(903:1076)
 w(5445:5576) = u(9)*w(945:1076)
 w(5577:5674) = u(10)*w(979:1076)
 w(5675:5745) = u(11)*w(1006:1076)
 w(5746:5795) = u(12)*w(1027:1076)
 w(5796:5829) = u(13)*w(1043:1076)
 w(5830:5851) = u(14)*w(1055:1076)
 w(5852:5864) = u(15)*w(1064:1076)
 w(5865:5870) = u(16)*w(153:158)
 w(5871:5875) = u(17)*w(154:158)
 w(5876:5879) = u(18)*w(155:158)
 w(5880:5882) = u(19)*w(156:158)
 w(5883:5884) = u(20)*w(157:158)
 w(5885) = u(21)*w(158)
endif
! terms of degree 5
if (5.le.mxd) then
 w(5886:10694) = u(0)*w(1077:5885)
 w(10695:14585) = u(1)*w(1995:5885)
 w(14586:17700) = u(2)*w(2771:5885)
 w(17701:20165) = u(3)*w(3421:5885)
 w(20166:22091) = u(4)*w(3960:5885)
 w(22092:23575) = u(5)*w(4402:5885)
 w(23576:24701) = u(6)*w(4760:5885)
 w(24702:25541) = u(7)*w(5046:5885)
 w(25542:26156) = u(8)*w(5271:5885)
 w(26157:26597) = u(9)*w(5445:5885)
 w(26598:26906) = u(10)*w(5577:5885)
 w(26907:27117) = u(11)*w(5675:5885)
 w(27118:27257) = u(12)*w(5746:5885)
 w(27258:27347) = u(13)*w(5796:5885)
 w(27348:27403) = u(14)*w(5830:5885)
 w(27404:27437) = u(15)*w(5852:5885)
 w(27438:27443) = u(16)*w(1071:1076)
 w(27444:27449) = u(17)*w(1071:1076)
 w(27450:27455) = u(18)*w(1071:1076)
 w(27456:27461) = u(19)*w(1071:1076)
 w(27462:27467) = u(20)*w(1071:1076)
 w(27468:27473) = u(21)*w(1071:1076)
endif
! terms of degree 6
if (6.le.mxd) then
 w(27474:49061) = u(0)*w(5886:27473)
 w(49062:65840) = u(1)*w(10695:27473)
 w(65841:78728) = u(2)*w(14586:27473)
 w(78729:88501) = u(3)*w(17701:27473)
 w(88502:95809) = u(4)*w(20166:27473)
 w(95810:101191) = u(5)*w(22092:27473)
 w(101192:105089) = u(6)*w(23576:27473)
 w(105090:107861) = u(7)*w(24702:27473)
 w(107862:109793) = u(8)*w(25542:27473)
 w(109794:111110) = u(9)*w(26157:27473)
 w(111111:111986) = u(10)*w(26598:27473)
 w(111987:112553) = u(11)*w(26907:27473)
 w(112554:112909) = u(12)*w(27118:27473)
 w(112910:113125) = u(13)*w(27258:27473)
 w(113126:113251) = u(14)*w(27348:27473)
 w(113252:113321) = u(15)*w(27404:27473)
 w(113322:113342) = u(16)*w(5865:5885)
 w(113343:113357) = u(17)*w(5871:5885)
 w(113358:113367) = u(18)*w(5876:5885)
 w(113368:113373) = u(19)*w(5880:5885)
 w(113374:113376) = u(20)*w(5883:5885)
 w(113377) = u(21)*w(5885)
 w(113378:113383) = u(22)*w(1071:1076)
 w(113384:113388) = u(23)*w(1072:1076)
 w(113389:113392) = u(24)*w(1073:1076)
 w(113393:113395) = u(25)*w(1074:1076)
 w(113396:113397) = u(26)*w(1075:1076)
 w(113398) = u(27)*w(1076)
endif
! terms of degree 7
if (7.le.mxd) then
 w(113399:199323) = u(0)*w(27474:113398)
 w(199324:263660) = u(1)*w(49062:113398)
 w(263661:311218) = u(2)*w(65841:113398)
 w(311219:345888) = u(3)*w(78729:113398)
 w(345889:370785) = u(4)*w(88502:113398)
 w(370786:388374) = u(5)*w(95810:113398)
 w(388375:400581) = u(6)*w(101192:113398)
 w(400582:408890) = u(7)*w(105090:113398)
 w(408891:414427) = u(8)*w(107862:113398)
 w(414428:418032) = u(9)*w(109794:113398)
 w(418033:420320) = u(10)*w(111111:113398)
 w(420321:421732) = u(11)*w(111987:113398)
 w(421733:422577) = u(12)*w(112554:113398)
 w(422578:423066) = u(13)*w(112910:113398)
 w(423067:423339) = u(14)*w(113126:113398)
 w(423340:423486) = u(15)*w(113252:113398)
 w(423487:423522) = u(16)*w(27438:27473)
 w(423523:423552) = u(17)*w(27444:27473)
 w(423553:423576) = u(18)*w(27450:27473)
 w(423577:423594) = u(19)*w(27456:27473)
 w(423595:423606) = u(20)*w(27462:27473)
 w(423607:423612) = u(21)*w(27468:27473)
endif
! terms of degree 8
if (8.le.mxd) then
 w(423613:733826) = u(0)*w(113399:423612)
 w(733827:958115) = u(1)*w(199324:423612)
 w(958116:1118067) = u(2)*w(263661:423612)
 w(1118068:1230461) = u(3)*w(311219:423612)
 w(1230462:1308185) = u(4)*w(345889:423612)
 w(1308186:1361012) = u(5)*w(370786:423612)
 w(1361013:1396250) = u(6)*w(388375:423612)
 w(1396251:1419281) = u(7)*w(400582:423612)
 w(1419282:1434003) = u(8)*w(408891:423612)
 w(1434004:1443188) = u(9)*w(414428:423612)
 w(1443189:1448768) = u(10)*w(418033:423612)
 w(1448769:1452060) = u(11)*w(420321:423612)
 w(1452061:1453940) = u(12)*w(421733:423612)
 w(1453941:1454975) = u(13)*w(422578:423612)
 w(1454976:1455521) = u(14)*w(423067:423612)
 w(1455522:1455794) = u(15)*w(423340:423612)
 w(1455795:1455871) = u(16)*w(113322:113398)
 w(1455872:1455927) = u(17)*w(113343:113398)
 w(1455928:1455968) = u(18)*w(113358:113398)
 w(1455969:1455999) = u(19)*w(113368:113398)
 w(1456000:1456024) = u(20)*w(113374:113398)
 w(1456025:1456046) = u(21)*w(113377:113398)
endif
! terms of degree 9
if (9.le.mxd) then
 w(1456047:2488480) = u(0)*w(423613:1456046)
 w(2488481:3210700) = u(1)*w(733827:1456046)
 w(3210701:3708631) = u(2)*w(958116:1456046)
 w(3708632:4046610) = u(3)*w(1118068:1456046)
 w(4046611:4272195) = u(4)*w(1230462:1456046)
 w(4272196:4420056) = u(5)*w(1308186:1456046)
 w(4420057:4515090) = u(6)*w(1361013:1456046)
 w(4515091:4574886) = u(7)*w(1396251:1456046)
 w(4574887:4611651) = u(8)*w(1419282:1456046)
 w(4611652:4633694) = u(9)*w(1434004:1456046)
 w(4633695:4646552) = u(10)*w(1443189:1456046)
 w(4646553:4653830) = u(11)*w(1448769:1456046)
 w(4653831:4657816) = u(12)*w(1452061:1456046)
 w(4657817:4659922) = u(13)*w(1453941:1456046)
 w(4659923:4660993) = u(14)*w(1454976:1456046)
 w(4660994:4661518) = u(15)*w(1455522:1456046)
 w(4661519:4661644) = u(16)*w(423487:423612)
 w(4661645:4661734) = u(17)*w(423523:423612)
 w(4661735:4661794) = u(18)*w(423553:423612)
 w(4661795:4661830) = u(19)*w(423577:423612)
 w(4661831:4661848) = u(20)*w(423595:423612)
 w(4661849:4661854) = u(21)*w(423607:423612)
 w(4661855:4661875) = u(22)*w(113378:113398)
 w(4661876:4661890) = u(23)*w(113384:113398)
 w(4661891:4661900) = u(24)*w(113389:113398)
 w(4661901:4661906) = u(25)*w(113393:113398)
 w(4661907:4661909) = u(26)*w(113396:113398)
 w(4661910) = u(27)*w(113398)
endif
END SUBROUTINE mg311111_prib
