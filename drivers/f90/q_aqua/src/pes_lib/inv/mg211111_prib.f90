SUBROUTINE mg211111_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg211111_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg211111_prib: bad size u'
!! else if (size(w).ne.mg211111_npb(mxd)) then
!!  stop 'mg211111_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 16 5 0 0 0 0 0 0 0
! prib,  dnpb(0:*): 1 16 141 896 4571 19824 75719 260864 824604 2422464
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
 w(10) = u(9)*w(0)
 w(11) = u(10)*w(0)
 w(12) = u(11)*w(0)
 w(13) = u(12)*w(0)
 w(14) = u(13)*w(0)
 w(15) = u(14)*w(0)
 w(16) = u(15)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(17:32) = u(0)*w(1:16)
 w(33:47) = u(1)*w(2:16)
 w(48:61) = u(2)*w(3:16)
 w(62:74) = u(3)*w(4:16)
 w(75:86) = u(4)*w(5:16)
 w(87:97) = u(5)*w(6:16)
 w(98:107) = u(6)*w(7:16)
 w(108:116) = u(7)*w(8:16)
 w(117:124) = u(8)*w(9:16)
 w(125:131) = u(9)*w(10:16)
 w(132:137) = u(10)*w(11:16)
 w(138:142) = u(11)*w(12:16)
 w(143:146) = u(12)*w(13:16)
 w(147:149) = u(13)*w(14:16)
 w(150:151) = u(14)*w(15:16)
 w(152) = u(15)*w(16)
 w(153) = u(16)*w(0)
 w(154) = u(17)*w(0)
 w(155) = u(18)*w(0)
 w(156) = u(19)*w(0)
 w(157) = u(20)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(158:298) = u(0)*w(17:157)
 w(299:423) = u(1)*w(33:157)
 w(424:533) = u(2)*w(48:157)
 w(534:629) = u(3)*w(62:157)
 w(630:712) = u(4)*w(75:157)
 w(713:783) = u(5)*w(87:157)
 w(784:843) = u(6)*w(98:157)
 w(844:893) = u(7)*w(108:157)
 w(894:934) = u(8)*w(117:157)
 w(935:967) = u(9)*w(125:157)
 w(968:993) = u(10)*w(132:157)
 w(994:1013) = u(11)*w(138:157)
 w(1014:1028) = u(12)*w(143:157)
 w(1029:1039) = u(13)*w(147:157)
 w(1040:1047) = u(14)*w(150:157)
 w(1048:1053) = u(15)*w(152:157)
endif
! terms of degree 4
if (4.le.mxd) then
 w(1054:1949) = u(0)*w(158:1053)
 w(1950:2704) = u(1)*w(299:1053)
 w(2705:3334) = u(2)*w(424:1053)
 w(3335:3854) = u(3)*w(534:1053)
 w(3855:4278) = u(4)*w(630:1053)
 w(4279:4619) = u(5)*w(713:1053)
 w(4620:4889) = u(6)*w(784:1053)
 w(4890:5099) = u(7)*w(844:1053)
 w(5100:5259) = u(8)*w(894:1053)
 w(5260:5378) = u(9)*w(935:1053)
 w(5379:5464) = u(10)*w(968:1053)
 w(5465:5524) = u(11)*w(994:1053)
 w(5525:5564) = u(12)*w(1014:1053)
 w(5565:5589) = u(13)*w(1029:1053)
 w(5590:5603) = u(14)*w(1040:1053)
 w(5604:5609) = u(15)*w(1048:1053)
 w(5610:5614) = u(16)*w(153:157)
 w(5615:5618) = u(17)*w(154:157)
 w(5619:5621) = u(18)*w(155:157)
 w(5622:5623) = u(19)*w(156:157)
 w(5624) = u(20)*w(157)
endif
! terms of degree 5
if (5.le.mxd) then
 w(5625:10195) = u(0)*w(1054:5624)
 w(10196:13870) = u(1)*w(1950:5624)
 w(13871:16790) = u(2)*w(2705:5624)
 w(16791:19080) = u(3)*w(3335:5624)
 w(19081:20850) = u(4)*w(3855:5624)
 w(20851:22196) = u(5)*w(4279:5624)
 w(22197:23201) = u(6)*w(4620:5624)
 w(23202:23936) = u(7)*w(4890:5624)
 w(23937:24461) = u(8)*w(5100:5624)
 w(24462:24826) = u(9)*w(5260:5624)
 w(24827:25072) = u(10)*w(5379:5624)
 w(25073:25232) = u(11)*w(5465:5624)
 w(25233:25332) = u(12)*w(5525:5624)
 w(25333:25392) = u(13)*w(5565:5624)
 w(25393:25427) = u(14)*w(5590:5624)
 w(25428:25448) = u(15)*w(5604:5624)
endif
! terms of degree 6
if (6.le.mxd) then
 w(25449:45272) = u(0)*w(5625:25448)
 w(45273:60525) = u(1)*w(10196:25448)
 w(60526:72103) = u(2)*w(13871:25448)
 w(72104:80761) = u(3)*w(16791:25448)
 w(80762:87129) = u(4)*w(19081:25448)
 w(87130:91727) = u(5)*w(20851:25448)
 w(91728:94979) = u(6)*w(22197:25448)
 w(94980:97226) = u(7)*w(23202:25448)
 w(97227:98738) = u(8)*w(23937:25448)
 w(98739:99725) = u(9)*w(24462:25448)
 w(99726:100347) = u(10)*w(24827:25448)
 w(100348:100723) = u(11)*w(25073:25448)
 w(100724:100939) = u(12)*w(25233:25448)
 w(100940:101055) = u(13)*w(25333:25448)
 w(101056:101111) = u(14)*w(25393:25448)
 w(101112:101132) = u(15)*w(25428:25448)
 w(101133:101147) = u(16)*w(5610:5624)
 w(101148:101157) = u(17)*w(5615:5624)
 w(101158:101163) = u(18)*w(5619:5624)
 w(101164:101166) = u(19)*w(5622:5624)
 w(101167) = u(20)*w(5624)
endif
! terms of degree 7
if (7.le.mxd) then
 w(101168:176886) = u(0)*w(25449:101167)
 w(176887:232781) = u(1)*w(45273:101167)
 w(232782:273423) = u(2)*w(60526:101167)
 w(273424:302487) = u(3)*w(72104:101167)
 w(302488:322893) = u(4)*w(80762:101167)
 w(322894:336931) = u(5)*w(87130:101167)
 w(336932:346371) = u(6)*w(91728:101167)
 w(346372:352559) = u(7)*w(94980:101167)
 w(352560:356500) = u(8)*w(97227:101167)
 w(356501:358929) = u(9)*w(98739:101167)
 w(358930:360371) = u(10)*w(99726:101167)
 w(360372:361191) = u(11)*w(100348:101167)
 w(361192:361635) = u(12)*w(100724:101167)
 w(361636:361863) = u(13)*w(100940:101167)
 w(361864:361975) = u(14)*w(101056:101167)
 w(361976:362031) = u(15)*w(101112:101167)
endif
! terms of degree 8
if (8.le.mxd) then
 w(362032:622895) = u(0)*w(101168:362031)
 w(622896:808040) = u(1)*w(176887:362031)
 w(808041:937290) = u(2)*w(232782:362031)
 w(937291:1025898) = u(3)*w(273424:362031)
 w(1025899:1085442) = u(4)*w(302488:362031)
 w(1085443:1124580) = u(5)*w(322894:362031)
 w(1124581:1149680) = u(6)*w(336932:362031)
 w(1149681:1165340) = u(7)*w(346372:362031)
 w(1165341:1174812) = u(8)*w(352560:362031)
 w(1174813:1180343) = u(9)*w(356501:362031)
 w(1180344:1183445) = u(10)*w(358930:362031)
 w(1183446:1185105) = u(11)*w(360372:362031)
 w(1185106:1185945) = u(12)*w(361192:362031)
 w(1185946:1186341) = u(13)*w(361636:362031)
 w(1186342:1186509) = u(14)*w(361864:362031)
 w(1186510:1186565) = u(15)*w(361976:362031)
 w(1186566:1186600) = u(16)*w(101133:101167)
 w(1186601:1186620) = u(17)*w(101148:101167)
 w(1186621:1186630) = u(18)*w(101158:101167)
 w(1186631:1186634) = u(19)*w(101164:101167)
 w(1186635) = u(20)*w(101167)
endif
! terms of degree 9
if (9.le.mxd) then
 w(1186636:2011239) = u(0)*w(362032:1186635)
 w(2011240:2574979) = u(1)*w(622896:1186635)
 w(2574980:2953574) = u(2)*w(808041:1186635)
 w(2953575:3202919) = u(3)*w(937291:1186635)
 w(3202920:3363656) = u(4)*w(1025899:1186635)
 w(3363657:3464849) = u(5)*w(1085443:1186635)
 w(3464850:3526904) = u(6)*w(1124581:1186635)
 w(3526905:3563859) = u(7)*w(1149681:1186635)
 w(3563860:3585154) = u(8)*w(1165341:1186635)
 w(3585155:3596977) = u(9)*w(1174813:1186635)
 w(3596978:3603269) = u(10)*w(1180344:1186635)
 w(3603270:3606459) = u(11)*w(1183446:1186635)
 w(3606460:3607989) = u(12)*w(1185106:1186635)
 w(3607990:3608679) = u(13)*w(1185946:1186635)
 w(3608680:3608973) = u(14)*w(1186342:1186635)
 w(3608974:3609099) = u(15)*w(1186510:1186635)
endif
END SUBROUTINE mg211111_prib
