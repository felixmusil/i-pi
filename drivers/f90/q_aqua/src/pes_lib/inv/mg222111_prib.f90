SUBROUTINE mg222111_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg222111_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg222111_prib: bad size u'
!! else if (size(w).ne.mg222111_npb(mxd)) then
!!  stop 'mg222111_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 18 18 0 0 0 0 0 0 0
! prib,  dnpb(0:*): 1 18 189 1464 9234 49932 239058 1035576 4122981 15264866
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
 w(10) = u(9)*w(0)
 w(11) = u(10)*w(0)
 w(12) = u(11)*w(0)
 w(13) = u(12)*w(0)
 w(14) = u(13)*w(0)
 w(15) = u(14)*w(0)
 w(16) = u(15)*w(0)
 w(17) = u(16)*w(0)
 w(18) = u(17)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(19:36) = u(0)*w(1:18)
 w(37:53) = u(1)*w(2:18)
 w(54:69) = u(2)*w(3:18)
 w(70:84) = u(3)*w(4:18)
 w(85:98) = u(4)*w(5:18)
 w(99:111) = u(5)*w(6:18)
 w(112:123) = u(6)*w(7:18)
 w(124:134) = u(7)*w(8:18)
 w(135:144) = u(8)*w(9:18)
 w(145:153) = u(9)*w(10:18)
 w(154:161) = u(10)*w(11:18)
 w(162:168) = u(11)*w(12:18)
 w(169:174) = u(12)*w(13:18)
 w(175:179) = u(13)*w(14:18)
 w(180:183) = u(14)*w(15:18)
 w(184:186) = u(15)*w(16:18)
 w(187:188) = u(16)*w(17:18)
 w(189) = u(17)*w(18)
 w(190) = u(18)*w(0)
 w(191) = u(19)*w(0)
 w(192) = u(20)*w(0)
 w(193) = u(21)*w(0)
 w(194) = u(22)*w(0)
 w(195) = u(23)*w(0)
 w(196) = u(24)*w(0)
 w(197) = u(25)*w(0)
 w(198) = u(26)*w(0)
 w(199) = u(27)*w(0)
 w(200) = u(28)*w(0)
 w(201) = u(29)*w(0)
 w(202) = u(30)*w(0)
 w(203) = u(31)*w(0)
 w(204) = u(32)*w(0)
 w(205) = u(33)*w(0)
 w(206) = u(34)*w(0)
 w(207) = u(35)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(208:396) = u(0)*w(19:207)
 w(397:567) = u(1)*w(37:207)
 w(568:721) = u(2)*w(54:207)
 w(722:859) = u(3)*w(70:207)
 w(860:982) = u(4)*w(85:207)
 w(983:1091) = u(5)*w(99:207)
 w(1092:1187) = u(6)*w(112:207)
 w(1188:1271) = u(7)*w(124:207)
 w(1272:1344) = u(8)*w(135:207)
 w(1345:1407) = u(9)*w(145:207)
 w(1408:1461) = u(10)*w(154:207)
 w(1462:1507) = u(11)*w(162:207)
 w(1508:1546) = u(12)*w(169:207)
 w(1547:1579) = u(13)*w(175:207)
 w(1580:1607) = u(14)*w(180:207)
 w(1608:1631) = u(15)*w(184:207)
 w(1632:1652) = u(16)*w(187:207)
 w(1653:1671) = u(17)*w(189:207)
endif
! terms of degree 4
if (4.le.mxd) then
 w(1672:3135) = u(0)*w(208:1671)
 w(3136:4410) = u(1)*w(397:1671)
 w(4411:5514) = u(2)*w(568:1671)
 w(5515:6464) = u(3)*w(722:1671)
 w(6465:7276) = u(4)*w(860:1671)
 w(7277:7965) = u(5)*w(983:1671)
 w(7966:8545) = u(6)*w(1092:1671)
 w(8546:9029) = u(7)*w(1188:1671)
 w(9030:9429) = u(8)*w(1272:1671)
 w(9430:9756) = u(9)*w(1345:1671)
 w(9757:10020) = u(10)*w(1408:1671)
 w(10021:10230) = u(11)*w(1462:1671)
 w(10231:10394) = u(12)*w(1508:1671)
 w(10395:10519) = u(13)*w(1547:1671)
 w(10520:10611) = u(14)*w(1580:1671)
 w(10612:10675) = u(15)*w(1608:1671)
 w(10676:10715) = u(16)*w(1632:1671)
 w(10716:10734) = u(17)*w(1653:1671)
 w(10735:10752) = u(18)*w(190:207)
 w(10753:10769) = u(19)*w(191:207)
 w(10770:10785) = u(20)*w(192:207)
 w(10786:10800) = u(21)*w(193:207)
 w(10801:10814) = u(22)*w(194:207)
 w(10815:10827) = u(23)*w(195:207)
 w(10828:10839) = u(24)*w(196:207)
 w(10840:10850) = u(25)*w(197:207)
 w(10851:10860) = u(26)*w(198:207)
 w(10861:10869) = u(27)*w(199:207)
 w(10870:10877) = u(28)*w(200:207)
 w(10878:10884) = u(29)*w(201:207)
 w(10885:10890) = u(30)*w(202:207)
 w(10891:10895) = u(31)*w(203:207)
 w(10896:10899) = u(32)*w(204:207)
 w(10900:10902) = u(33)*w(205:207)
 w(10903:10904) = u(34)*w(206:207)
 w(10905) = u(35)*w(207)
endif
! terms of degree 5
if (5.le.mxd) then
 w(10906:20139) = u(0)*w(1672:10905)
 w(20140:27909) = u(1)*w(3136:10905)
 w(27910:34404) = u(2)*w(4411:10905)
 w(34405:39795) = u(3)*w(5515:10905)
 w(39796:44236) = u(4)*w(6465:10905)
 w(44237:47865) = u(5)*w(7277:10905)
 w(47866:50805) = u(6)*w(7966:10905)
 w(50806:53165) = u(7)*w(8546:10905)
 w(53166:55041) = u(8)*w(9030:10905)
 w(55042:56517) = u(9)*w(9430:10905)
 w(56518:57666) = u(10)*w(9757:10905)
 w(57667:58551) = u(11)*w(10021:10905)
 w(58552:59226) = u(12)*w(10231:10905)
 w(59227:59737) = u(13)*w(10395:10905)
 w(59738:60123) = u(14)*w(10520:10905)
 w(60124:60417) = u(15)*w(10612:10905)
 w(60418:60647) = u(16)*w(10676:10905)
 w(60648:60837) = u(17)*w(10716:10905)
endif
! terms of degree 6
if (6.le.mxd) then
 w(60838:110769) = u(0)*w(10906:60837)
 w(110770:151467) = u(1)*w(20140:60837)
 w(151468:184395) = u(2)*w(27910:60837)
 w(184396:210828) = u(3)*w(34405:60837)
 w(210829:231870) = u(4)*w(39796:60837)
 w(231871:248471) = u(5)*w(44237:60837)
 w(248472:261443) = u(6)*w(47866:60837)
 w(261444:271475) = u(7)*w(50806:60837)
 w(271476:279147) = u(8)*w(53166:60837)
 w(279148:284943) = u(9)*w(55042:60837)
 w(284944:289263) = u(10)*w(56518:60837)
 w(289264:292434) = u(11)*w(57667:60837)
 w(292435:294720) = u(12)*w(58552:60837)
 w(294721:296331) = u(13)*w(59227:60837)
 w(296332:297431) = u(14)*w(59738:60837)
 w(297432:298145) = u(15)*w(60124:60837)
 w(298146:298565) = u(16)*w(60418:60837)
 w(298566:298755) = u(17)*w(60648:60837)
 w(298756:298926) = u(18)*w(10735:10905)
 w(298927:299079) = u(19)*w(10753:10905)
 w(299080:299215) = u(20)*w(10770:10905)
 w(299216:299335) = u(21)*w(10786:10905)
 w(299336:299440) = u(22)*w(10801:10905)
 w(299441:299531) = u(23)*w(10815:10905)
 w(299532:299609) = u(24)*w(10828:10905)
 w(299610:299675) = u(25)*w(10840:10905)
 w(299676:299730) = u(26)*w(10851:10905)
 w(299731:299775) = u(27)*w(10861:10905)
 w(299776:299811) = u(28)*w(10870:10905)
 w(299812:299839) = u(29)*w(10878:10905)
 w(299840:299860) = u(30)*w(10885:10905)
 w(299861:299875) = u(31)*w(10891:10905)
 w(299876:299885) = u(32)*w(10896:10905)
 w(299886:299891) = u(33)*w(10900:10905)
 w(299892:299894) = u(34)*w(10903:10905)
 w(299895) = u(35)*w(10905)
endif
! terms of degree 7
if (7.le.mxd) then
 w(299896:538953) = u(0)*w(60838:299895)
 w(538954:728079) = u(1)*w(110770:299895)
 w(728080:876507) = u(2)*w(151468:299895)
 w(876508:992007) = u(3)*w(184396:299895)
 w(992008:1081074) = u(4)*w(210829:299895)
 w(1081075:1149099) = u(5)*w(231871:299895)
 w(1149100:1200523) = u(6)*w(248472:299895)
 w(1200524:1238975) = u(7)*w(261444:299895)
 w(1238976:1267395) = u(8)*w(271476:299895)
 w(1267396:1288143) = u(9)*w(279148:299895)
 w(1288144:1303095) = u(10)*w(284944:299895)
 w(1303096:1313727) = u(11)*w(289264:299895)
 w(1313728:1321188) = u(12)*w(292435:299895)
 w(1321189:1326363) = u(13)*w(294721:299895)
 w(1326364:1329927) = u(14)*w(296332:299895)
 w(1329928:1332391) = u(15)*w(297432:299895)
 w(1332392:1334141) = u(16)*w(298146:299895)
 w(1334142:1335471) = u(17)*w(298566:299895)
endif
! terms of degree 8
if (8.le.mxd) then
 w(1335472:2371047) = u(0)*w(299896:1335471)
 w(2371048:3167565) = u(1)*w(538954:1335471)
 w(3167566:3774957) = u(2)*w(728080:1335471)
 w(3774958:4233921) = u(3)*w(876508:1335471)
 w(4233922:4577385) = u(4)*w(992008:1335471)
 w(4577386:4831782) = u(5)*w(1081075:1335471)
 w(4831783:5018154) = u(6)*w(1149100:1335471)
 w(5018155:5153102) = u(7)*w(1200524:1335471)
 w(5153103:5249598) = u(8)*w(1238976:1335471)
 w(5249599:5317674) = u(9)*w(1267396:1335471)
 w(5317675:5365002) = u(10)*w(1288144:1335471)
 w(5365003:5397378) = u(11)*w(1303096:1335471)
 w(5397379:5419122) = u(12)*w(1313728:1335471)
 w(5419123:5433405) = u(13)*w(1321189:1335471)
 w(5433406:5442513) = u(14)*w(1326364:1335471)
 w(5442514:5448057) = u(15)*w(1329928:1335471)
 w(5448058:5451137) = u(16)*w(1332392:1335471)
 w(5451138:5452467) = u(17)*w(1334142:1335471)
 w(5452468:5453607) = u(18)*w(298756:299895)
 w(5453608:5454576) = u(19)*w(298927:299895)
 w(5454577:5455392) = u(20)*w(299080:299895)
 w(5455393:5456072) = u(21)*w(299216:299895)
 w(5456073:5456632) = u(22)*w(299336:299895)
 w(5456633:5457087) = u(23)*w(299441:299895)
 w(5457088:5457451) = u(24)*w(299532:299895)
 w(5457452:5457737) = u(25)*w(299610:299895)
 w(5457738:5457957) = u(26)*w(299676:299895)
 w(5457958:5458122) = u(27)*w(299731:299895)
 w(5458123:5458242) = u(28)*w(299776:299895)
 w(5458243:5458326) = u(29)*w(299812:299895)
 w(5458327:5458382) = u(30)*w(299840:299895)
 w(5458383:5458417) = u(31)*w(299861:299895)
 w(5458418:5458437) = u(32)*w(299876:299895)
 w(5458438:5458447) = u(33)*w(299886:299895)
 w(5458448:5458451) = u(34)*w(299892:299895)
 w(5458452) = u(35)*w(299895)
endif
! terms of degree 9
if (9.le.mxd) then
 w(5458453:9581433) = u(0)*w(1335472:5458452)
 w(9581434:12668838) = u(1)*w(2371048:5458452)
 w(12668839:14959725) = u(2)*w(3167566:5458452)
 w(14959726:16643220) = u(3)*w(3774958:5458452)
 w(16643221:17867751) = u(4)*w(4233922:5458452)
 w(17867752:18748818) = u(5)*w(4577386:5458452)
 w(18748819:19375488) = u(6)*w(4831783:5458452)
 w(19375489:19815786) = u(7)*w(5018155:5458452)
 w(19815787:20121136) = u(8)*w(5153103:5458452)
 w(20121137:20329990) = u(9)*w(5249599:5458452)
 w(20329991:20470768) = u(10)*w(5317675:5458452)
 w(20470769:20564218) = u(11)*w(5365003:5458452)
 w(20564219:20625292) = u(12)*w(5397379:5458452)
 w(20625293:20664622) = u(13)*w(5419123:5458452)
 w(20664623:20689669) = u(14)*w(5433406:5458452)
 w(20689670:20705608) = u(15)*w(5442514:5458452)
 w(20705609:20716003) = u(16)*w(5448058:5458452)
 w(20716004:20723318) = u(17)*w(5451138:5458452)
endif
END SUBROUTINE mg222111_prib
