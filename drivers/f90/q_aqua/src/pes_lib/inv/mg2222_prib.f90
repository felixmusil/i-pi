SUBROUTINE mg2222_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg2222_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg2222_prib: bad size u'
!! else if (size(w).ne.mg2222_npb(mxd)) then
!!  stop 'mg2222_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 10 18 0 0 0 0 0 0 0
! prib,  dnpb(0:*): 1 10 73 400 1876 7672 28420 96496 305350 907532
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
 w(10) = u(9)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(11:20) = u(0)*w(1:10)
 w(21:29) = u(1)*w(2:10)
 w(30:37) = u(2)*w(3:10)
 w(38:44) = u(3)*w(4:10)
 w(45:50) = u(4)*w(5:10)
 w(51:55) = u(5)*w(6:10)
 w(56:59) = u(6)*w(7:10)
 w(60:62) = u(7)*w(8:10)
 w(63:64) = u(8)*w(9:10)
 w(65) = u(9)*w(10)
 w(66) = u(10)*w(0)
 w(67) = u(11)*w(0)
 w(68) = u(12)*w(0)
 w(69) = u(13)*w(0)
 w(70) = u(14)*w(0)
 w(71) = u(15)*w(0)
 w(72) = u(16)*w(0)
 w(73) = u(17)*w(0)
 w(74) = u(18)*w(0)
 w(75) = u(19)*w(0)
 w(76) = u(20)*w(0)
 w(77) = u(21)*w(0)
 w(78) = u(22)*w(0)
 w(79) = u(23)*w(0)
 w(80) = u(24)*w(0)
 w(81) = u(25)*w(0)
 w(82) = u(26)*w(0)
 w(83) = u(27)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(84:156) = u(0)*w(11:83)
 w(157:219) = u(1)*w(21:83)
 w(220:273) = u(2)*w(30:83)
 w(274:319) = u(3)*w(38:83)
 w(320:358) = u(4)*w(45:83)
 w(359:391) = u(5)*w(51:83)
 w(392:419) = u(6)*w(56:83)
 w(420:443) = u(7)*w(60:83)
 w(444:464) = u(8)*w(63:83)
 w(465:483) = u(9)*w(65:83)
endif
! terms of degree 4
if (4.le.mxd) then
 w(484:883) = u(0)*w(84:483)
 w(884:1210) = u(1)*w(157:483)
 w(1211:1474) = u(2)*w(220:483)
 w(1475:1684) = u(3)*w(274:483)
 w(1685:1848) = u(4)*w(320:483)
 w(1849:1973) = u(5)*w(359:483)
 w(1974:2065) = u(6)*w(392:483)
 w(2066:2129) = u(7)*w(420:483)
 w(2130:2169) = u(8)*w(444:483)
 w(2170:2188) = u(9)*w(465:483)
 w(2189:2206) = u(10)*w(66:83)
 w(2207:2223) = u(11)*w(67:83)
 w(2224:2239) = u(12)*w(68:83)
 w(2240:2254) = u(13)*w(69:83)
 w(2255:2268) = u(14)*w(70:83)
 w(2269:2281) = u(15)*w(71:83)
 w(2282:2293) = u(16)*w(72:83)
 w(2294:2304) = u(17)*w(73:83)
 w(2305:2314) = u(18)*w(74:83)
 w(2315:2323) = u(19)*w(75:83)
 w(2324:2331) = u(20)*w(76:83)
 w(2332:2338) = u(21)*w(77:83)
 w(2339:2344) = u(22)*w(78:83)
 w(2345:2349) = u(23)*w(79:83)
 w(2350:2353) = u(24)*w(80:83)
 w(2354:2356) = u(25)*w(81:83)
 w(2357:2358) = u(26)*w(82:83)
 w(2359) = u(27)*w(83)
endif
! terms of degree 5
if (5.le.mxd) then
 w(2360:4235) = u(0)*w(484:2359)
 w(4236:5711) = u(1)*w(884:2359)
 w(5712:6860) = u(2)*w(1211:2359)
 w(6861:7745) = u(3)*w(1475:2359)
 w(7746:8420) = u(4)*w(1685:2359)
 w(8421:8931) = u(5)*w(1849:2359)
 w(8932:9317) = u(6)*w(1974:2359)
 w(9318:9611) = u(7)*w(2066:2359)
 w(9612:9841) = u(8)*w(2130:2359)
 w(9842:10031) = u(9)*w(2170:2359)
endif
! terms of degree 6
if (6.le.mxd) then
 w(10032:17703) = u(0)*w(2360:10031)
 w(17704:23499) = u(1)*w(4236:10031)
 w(23500:27819) = u(2)*w(5712:10031)
 w(27820:30990) = u(3)*w(6861:10031)
 w(30991:33276) = u(4)*w(7746:10031)
 w(33277:34887) = u(5)*w(8421:10031)
 w(34888:35987) = u(6)*w(8932:10031)
 w(35988:36701) = u(7)*w(9318:10031)
 w(36702:37121) = u(8)*w(9612:10031)
 w(37122:37311) = u(9)*w(9842:10031)
 w(37312:37482) = u(10)*w(2189:2359)
 w(37483:37635) = u(11)*w(2207:2359)
 w(37636:37771) = u(12)*w(2224:2359)
 w(37772:37891) = u(13)*w(2240:2359)
 w(37892:37996) = u(14)*w(2255:2359)
 w(37997:38087) = u(15)*w(2269:2359)
 w(38088:38165) = u(16)*w(2282:2359)
 w(38166:38231) = u(17)*w(2294:2359)
 w(38232:38286) = u(18)*w(2305:2359)
 w(38287:38331) = u(19)*w(2315:2359)
 w(38332:38367) = u(20)*w(2324:2359)
 w(38368:38395) = u(21)*w(2332:2359)
 w(38396:38416) = u(22)*w(2339:2359)
 w(38417:38431) = u(23)*w(2345:2359)
 w(38432:38441) = u(24)*w(2350:2359)
 w(38442:38447) = u(25)*w(2354:2359)
 w(38448:38450) = u(26)*w(2357:2359)
 w(38451) = u(27)*w(2359)
endif
! terms of degree 7
if (7.le.mxd) then
 w(38452:66871) = u(0)*w(10032:38451)
 w(66872:87619) = u(1)*w(17704:38451)
 w(87620:102571) = u(2)*w(23500:38451)
 w(102572:113203) = u(3)*w(27820:38451)
 w(113204:120664) = u(4)*w(30991:38451)
 w(120665:125839) = u(5)*w(33277:38451)
 w(125840:129403) = u(6)*w(34888:38451)
 w(129404:131867) = u(7)*w(35988:38451)
 w(131868:133617) = u(8)*w(36702:38451)
 w(133618:134947) = u(9)*w(37122:38451)
endif
! terms of degree 8
if (8.le.mxd) then
 w(134948:231443) = u(0)*w(38452:134947)
 w(231444:299519) = u(1)*w(66872:134947)
 w(299520:346847) = u(2)*w(87620:134947)
 w(346848:379223) = u(3)*w(102572:134947)
 w(379224:400967) = u(4)*w(113204:134947)
 w(400968:415250) = u(5)*w(120665:134947)
 w(415251:424358) = u(6)*w(125840:134947)
 w(424359:429902) = u(7)*w(129404:134947)
 w(429903:432982) = u(8)*w(131868:134947)
 w(432983:434312) = u(9)*w(133618:134947)
 w(434313:435452) = u(10)*w(37312:38451)
 w(435453:436421) = u(11)*w(37483:38451)
 w(436422:437237) = u(12)*w(37636:38451)
 w(437238:437917) = u(13)*w(37772:38451)
 w(437918:438477) = u(14)*w(37892:38451)
 w(438478:438932) = u(15)*w(37997:38451)
 w(438933:439296) = u(16)*w(38088:38451)
 w(439297:439582) = u(17)*w(38166:38451)
 w(439583:439802) = u(18)*w(38232:38451)
 w(439803:439967) = u(19)*w(38287:38451)
 w(439968:440087) = u(20)*w(38332:38451)
 w(440088:440171) = u(21)*w(38368:38451)
 w(440172:440227) = u(22)*w(38396:38451)
 w(440228:440262) = u(23)*w(38417:38451)
 w(440263:440282) = u(24)*w(38432:38451)
 w(440283:440292) = u(25)*w(38442:38451)
 w(440293:440296) = u(26)*w(38448:38451)
 w(440297) = u(27)*w(38451)
endif
! terms of degree 9
if (9.le.mxd) then
 w(440298:745647) = u(0)*w(134948:440297)
 w(745648:954501) = u(1)*w(231444:440297)
 w(954502:1095279) = u(2)*w(299520:440297)
 w(1095280:1188729) = u(3)*w(346848:440297)
 w(1188730:1249803) = u(4)*w(379224:440297)
 w(1249804:1289133) = u(5)*w(400968:440297)
 w(1289134:1314180) = u(6)*w(415251:440297)
 w(1314181:1330119) = u(7)*w(424359:440297)
 w(1330120:1340514) = u(8)*w(429903:440297)
 w(1340515:1347829) = u(9)*w(432983:440297)
endif
END SUBROUTINE mg2222_prib
