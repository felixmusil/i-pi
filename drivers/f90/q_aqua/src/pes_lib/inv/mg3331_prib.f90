SUBROUTINE mg3331_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg3331_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg3331_prib: bad size u'
!! else if (size(w).ne.mg3331_npb(mxd)) then
!!  stop 'mg3331_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 9 15 15 3 0 3 0 0 0
! prib,  dnpb(0:*): 1 9 60 315 1428 5769 21311 73062 235266 717540
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(10:18) = u(0)*w(1:9)
 w(19:26) = u(1)*w(2:9)
 w(27:33) = u(2)*w(3:9)
 w(34:39) = u(3)*w(4:9)
 w(40:44) = u(4)*w(5:9)
 w(45:48) = u(5)*w(6:9)
 w(49:51) = u(6)*w(7:9)
 w(52:53) = u(7)*w(8:9)
 w(54) = u(8)*w(9)
 w(55) = u(9)*w(0)
 w(56) = u(10)*w(0)
 w(57) = u(11)*w(0)
 w(58) = u(12)*w(0)
 w(59) = u(13)*w(0)
 w(60) = u(14)*w(0)
 w(61) = u(15)*w(0)
 w(62) = u(16)*w(0)
 w(63) = u(17)*w(0)
 w(64) = u(18)*w(0)
 w(65) = u(19)*w(0)
 w(66) = u(20)*w(0)
 w(67) = u(21)*w(0)
 w(68) = u(22)*w(0)
 w(69) = u(23)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(70:129) = u(0)*w(10:69)
 w(130:180) = u(1)*w(19:69)
 w(181:223) = u(2)*w(27:69)
 w(224:259) = u(3)*w(34:69)
 w(260:289) = u(4)*w(40:69)
 w(290:314) = u(5)*w(45:69)
 w(315:335) = u(6)*w(49:69)
 w(336:353) = u(7)*w(52:69)
 w(354:369) = u(8)*w(54:69)
 w(370) = u(24)*w(0)
 w(371) = u(25)*w(0)
 w(372) = u(26)*w(0)
 w(373) = u(27)*w(0)
 w(374) = u(28)*w(0)
 w(375) = u(29)*w(0)
 w(376) = u(30)*w(0)
 w(377) = u(31)*w(0)
 w(378) = u(32)*w(0)
 w(379) = u(33)*w(0)
 w(380) = u(34)*w(0)
 w(381) = u(35)*w(0)
 w(382) = u(36)*w(0)
 w(383) = u(37)*w(0)
 w(384) = u(38)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(385:699) = u(0)*w(70:384)
 w(700:954) = u(1)*w(130:384)
 w(955:1158) = u(2)*w(181:384)
 w(1159:1319) = u(3)*w(224:384)
 w(1320:1444) = u(4)*w(260:384)
 w(1445:1539) = u(5)*w(290:384)
 w(1540:1609) = u(6)*w(315:384)
 w(1610:1658) = u(7)*w(336:384)
 w(1659:1689) = u(8)*w(354:384)
 w(1690:1704) = u(9)*w(55:69)
 w(1705:1718) = u(10)*w(56:69)
 w(1719:1731) = u(11)*w(57:69)
 w(1732:1743) = u(12)*w(58:69)
 w(1744:1754) = u(13)*w(59:69)
 w(1755:1764) = u(14)*w(60:69)
 w(1765:1773) = u(15)*w(61:69)
 w(1774:1781) = u(16)*w(62:69)
 w(1782:1788) = u(17)*w(63:69)
 w(1789:1794) = u(18)*w(64:69)
 w(1795:1799) = u(19)*w(65:69)
 w(1800:1803) = u(20)*w(66:69)
 w(1804:1806) = u(21)*w(67:69)
 w(1807:1808) = u(22)*w(68:69)
 w(1809) = u(23)*w(69)
 w(1810) = u(39)*w(0)
 w(1811) = u(40)*w(0)
 w(1812) = u(41)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(1813:3240) = u(0)*w(385:1812)
 w(3241:4353) = u(1)*w(700:1812)
 w(4354:5211) = u(2)*w(955:1812)
 w(5212:5865) = u(3)*w(1159:1812)
 w(5866:6358) = u(4)*w(1320:1812)
 w(6359:6726) = u(5)*w(1445:1812)
 w(6727:6999) = u(6)*w(1540:1812)
 w(7000:7202) = u(7)*w(1610:1812)
 w(7203:7356) = u(8)*w(1659:1812)
 w(7357:7371) = u(9)*w(370:384)
 w(7372:7386) = u(10)*w(370:384)
 w(7387:7401) = u(11)*w(370:384)
 w(7402:7416) = u(12)*w(370:384)
 w(7417:7431) = u(13)*w(370:384)
 w(7432:7446) = u(14)*w(370:384)
 w(7447:7461) = u(15)*w(370:384)
 w(7462:7476) = u(16)*w(370:384)
 w(7477:7491) = u(17)*w(370:384)
 w(7492:7506) = u(18)*w(370:384)
 w(7507:7521) = u(19)*w(370:384)
 w(7522:7536) = u(20)*w(370:384)
 w(7537:7551) = u(21)*w(370:384)
 w(7552:7566) = u(22)*w(370:384)
 w(7567:7581) = u(23)*w(370:384)
endif
! terms of degree 6
if (6.le.mxd) then
 w(7582:13350) = u(0)*w(1813:7581)
 w(13351:17691) = u(1)*w(3241:7581)
 w(17692:20919) = u(2)*w(4354:7581)
 w(20920:23289) = u(3)*w(5212:7581)
 w(23290:25005) = u(4)*w(5866:7581)
 w(25006:26228) = u(5)*w(6359:7581)
 w(26229:27083) = u(6)*w(6727:7581)
 w(27084:27665) = u(7)*w(7000:7581)
 w(27666:28044) = u(8)*w(7203:7581)
 w(28045:28167) = u(9)*w(1690:1812)
 w(28168:28275) = u(10)*w(1705:1812)
 w(28276:28369) = u(11)*w(1719:1812)
 w(28370:28450) = u(12)*w(1732:1812)
 w(28451:28519) = u(13)*w(1744:1812)
 w(28520:28577) = u(14)*w(1755:1812)
 w(28578:28625) = u(15)*w(1765:1812)
 w(28626:28664) = u(16)*w(1774:1812)
 w(28665:28695) = u(17)*w(1782:1812)
 w(28696:28719) = u(18)*w(1789:1812)
 w(28720:28737) = u(19)*w(1795:1812)
 w(28738:28750) = u(20)*w(1800:1812)
 w(28751:28759) = u(21)*w(1804:1812)
 w(28760:28765) = u(22)*w(1807:1812)
 w(28766:28769) = u(23)*w(1809:1812)
 w(28770:28784) = u(24)*w(370:384)
 w(28785:28798) = u(25)*w(371:384)
 w(28799:28811) = u(26)*w(372:384)
 w(28812:28823) = u(27)*w(373:384)
 w(28824:28834) = u(28)*w(374:384)
 w(28835:28844) = u(29)*w(375:384)
 w(28845:28853) = u(30)*w(376:384)
 w(28854:28861) = u(31)*w(377:384)
 w(28862:28868) = u(32)*w(378:384)
 w(28869:28874) = u(33)*w(379:384)
 w(28875:28879) = u(34)*w(380:384)
 w(28880:28883) = u(35)*w(381:384)
 w(28884:28886) = u(36)*w(382:384)
 w(28887:28888) = u(37)*w(383:384)
 w(28889) = u(38)*w(384)
 w(28890) = u(42)*w(0)
 w(28891) = u(43)*w(0)
 w(28892) = u(44)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(28893:50203) = u(0)*w(7582:28892)
 w(50204:65745) = u(1)*w(13351:28892)
 w(65746:76946) = u(2)*w(17692:28892)
 w(76947:84919) = u(3)*w(20920:28892)
 w(84920:90522) = u(4)*w(23290:28892)
 w(90523:94409) = u(5)*w(25006:28892)
 w(94410:97073) = u(6)*w(26229:28892)
 w(97074:98882) = u(7)*w(27084:28892)
 w(98883:100109) = u(8)*w(27666:28892)
 w(100110:100334) = u(9)*w(7357:7581)
 w(100335:100544) = u(10)*w(7372:7581)
 w(100545:100739) = u(11)*w(7387:7581)
 w(100740:100919) = u(12)*w(7402:7581)
 w(100920:101084) = u(13)*w(7417:7581)
 w(101085:101234) = u(14)*w(7432:7581)
 w(101235:101369) = u(15)*w(7447:7581)
 w(101370:101489) = u(16)*w(7462:7581)
 w(101490:101594) = u(17)*w(7477:7581)
 w(101595:101684) = u(18)*w(7492:7581)
 w(101685:101759) = u(19)*w(7507:7581)
 w(101760:101819) = u(20)*w(7522:7581)
 w(101820:101864) = u(21)*w(7537:7581)
 w(101865:101894) = u(22)*w(7552:7581)
 w(101895:101909) = u(23)*w(7567:7581)
 w(101910:101912) = u(24)*w(1810:1812)
 w(101913:101915) = u(25)*w(1810:1812)
 w(101916:101918) = u(26)*w(1810:1812)
 w(101919:101921) = u(27)*w(1810:1812)
 w(101922:101924) = u(28)*w(1810:1812)
 w(101925:101927) = u(29)*w(1810:1812)
 w(101928:101930) = u(30)*w(1810:1812)
 w(101931:101933) = u(31)*w(1810:1812)
 w(101934:101936) = u(32)*w(1810:1812)
 w(101937:101939) = u(33)*w(1810:1812)
 w(101940:101942) = u(34)*w(1810:1812)
 w(101943:101945) = u(35)*w(1810:1812)
 w(101946:101948) = u(36)*w(1810:1812)
 w(101949:101951) = u(37)*w(1810:1812)
 w(101952:101954) = u(38)*w(1810:1812)
endif
! terms of degree 8
if (8.le.mxd) then
 w(101955:175016) = u(0)*w(28893:101954)
 w(175017:226767) = u(1)*w(50204:101954)
 w(226768:262976) = u(2)*w(65746:101954)
 w(262977:287984) = u(3)*w(76947:101954)
 w(287985:305019) = u(4)*w(84920:101954)
 w(305020:316451) = u(5)*w(90523:101954)
 w(316452:323996) = u(6)*w(94410:101954)
 w(323997:328877) = u(7)*w(97074:101954)
 w(328878:331949) = u(8)*w(98883:101954)
 w(331950:332797) = u(9)*w(28045:28892)
 w(332798:333522) = u(10)*w(28168:28892)
 w(333523:334139) = u(11)*w(28276:28892)
 w(334140:334662) = u(12)*w(28370:28892)
 w(334663:335104) = u(13)*w(28451:28892)
 w(335105:335477) = u(14)*w(28520:28892)
 w(335478:335792) = u(15)*w(28578:28892)
 w(335793:336059) = u(16)*w(28626:28892)
 w(336060:336287) = u(17)*w(28665:28892)
 w(336288:336484) = u(18)*w(28696:28892)
 w(336485:336657) = u(19)*w(28720:28892)
 w(336658:336812) = u(20)*w(28738:28892)
 w(336813:336954) = u(21)*w(28751:28892)
 w(336955:337087) = u(22)*w(28760:28892)
 w(337088:337214) = u(23)*w(28766:28892)
 w(337215:337217) = u(39)*w(1810:1812)
 w(337218:337219) = u(40)*w(1811:1812)
 w(337220) = u(41)*w(1812)
endif
! terms of degree 9
if (9.le.mxd) then
 w(337221:572486) = u(0)*w(101955:337220)
 w(572487:734690) = u(1)*w(175017:337220)
 w(734691:845143) = u(2)*w(226768:337220)
 w(845144:919387) = u(3)*w(262977:337220)
 w(919388:968623) = u(4)*w(287985:337220)
 w(968624:1000824) = u(5)*w(305020:337220)
 w(1000825:1021593) = u(6)*w(316452:337220)
 w(1021594:1034817) = u(7)*w(323997:337220)
 w(1034818:1043160) = u(8)*w(328878:337220)
 w(1043161:1045005) = u(9)*w(100110:101954)
 w(1045006:1046625) = u(10)*w(100335:101954)
 w(1046626:1048035) = u(11)*w(100545:101954)
 w(1048036:1049250) = u(12)*w(100740:101954)
 w(1049251:1050285) = u(13)*w(100920:101954)
 w(1050286:1051155) = u(14)*w(101085:101954)
 w(1051156:1051875) = u(15)*w(101235:101954)
 w(1051876:1052460) = u(16)*w(101370:101954)
 w(1052461:1052925) = u(17)*w(101490:101954)
 w(1052926:1053285) = u(18)*w(101595:101954)
 w(1053286:1053555) = u(19)*w(101685:101954)
 w(1053556:1053750) = u(20)*w(101760:101954)
 w(1053751:1053885) = u(21)*w(101820:101954)
 w(1053886:1053975) = u(22)*w(101865:101954)
 w(1053976:1054035) = u(23)*w(101895:101954)
 w(1054036:1054158) = u(24)*w(28770:28892)
 w(1054159:1054266) = u(25)*w(28785:28892)
 w(1054267:1054360) = u(26)*w(28799:28892)
 w(1054361:1054441) = u(27)*w(28812:28892)
 w(1054442:1054510) = u(28)*w(28824:28892)
 w(1054511:1054568) = u(29)*w(28835:28892)
 w(1054569:1054616) = u(30)*w(28845:28892)
 w(1054617:1054655) = u(31)*w(28854:28892)
 w(1054656:1054686) = u(32)*w(28862:28892)
 w(1054687:1054710) = u(33)*w(28869:28892)
 w(1054711:1054728) = u(34)*w(28875:28892)
 w(1054729:1054741) = u(35)*w(28880:28892)
 w(1054742:1054750) = u(36)*w(28884:28892)
 w(1054751:1054756) = u(37)*w(28887:28892)
 w(1054757:1054760) = u(38)*w(28889:28892)
endif
END SUBROUTINE mg3331_prib
