SUBROUTINE mg5311_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg5311_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg5311_prib: bad size u'
!! else if (size(w).ne.mg5311_npb(mxd)) then
!!  stop 'mg5311_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 8 10 10 7 5 2 0 0 0
! prib,  dnpb(0:*): 1 8 46 210 832 2953 9635 29318 84175 229868
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(9:16) = u(0)*w(1:8)
 w(17:23) = u(1)*w(2:8)
 w(24:29) = u(2)*w(3:8)
 w(30:34) = u(3)*w(4:8)
 w(35:38) = u(4)*w(5:8)
 w(39:41) = u(5)*w(6:8)
 w(42:43) = u(6)*w(7:8)
 w(44) = u(7)*w(8)
 w(45) = u(8)*w(0)
 w(46) = u(9)*w(0)
 w(47) = u(10)*w(0)
 w(48) = u(11)*w(0)
 w(49) = u(12)*w(0)
 w(50) = u(13)*w(0)
 w(51) = u(14)*w(0)
 w(52) = u(15)*w(0)
 w(53) = u(16)*w(0)
 w(54) = u(17)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(55:100) = u(0)*w(9:54)
 w(101:138) = u(1)*w(17:54)
 w(139:169) = u(2)*w(24:54)
 w(170:194) = u(3)*w(30:54)
 w(195:214) = u(4)*w(35:54)
 w(215:230) = u(5)*w(39:54)
 w(231:243) = u(6)*w(42:54)
 w(244:254) = u(7)*w(44:54)
 w(255) = u(18)*w(0)
 w(256) = u(19)*w(0)
 w(257) = u(20)*w(0)
 w(258) = u(21)*w(0)
 w(259) = u(22)*w(0)
 w(260) = u(23)*w(0)
 w(261) = u(24)*w(0)
 w(262) = u(25)*w(0)
 w(263) = u(26)*w(0)
 w(264) = u(27)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(265:474) = u(0)*w(55:264)
 w(475:638) = u(1)*w(101:264)
 w(639:764) = u(2)*w(139:264)
 w(765:859) = u(3)*w(170:264)
 w(860:929) = u(4)*w(195:264)
 w(930:979) = u(5)*w(215:264)
 w(980:1013) = u(6)*w(231:264)
 w(1014:1034) = u(7)*w(244:264)
 w(1035:1044) = u(8)*w(45:54)
 w(1045:1053) = u(9)*w(46:54)
 w(1054:1061) = u(10)*w(47:54)
 w(1062:1068) = u(11)*w(48:54)
 w(1069:1074) = u(12)*w(49:54)
 w(1075:1079) = u(13)*w(50:54)
 w(1080:1083) = u(14)*w(51:54)
 w(1084:1086) = u(15)*w(52:54)
 w(1087:1088) = u(16)*w(53:54)
 w(1089) = u(17)*w(54)
 w(1090) = u(28)*w(0)
 w(1091) = u(29)*w(0)
 w(1092) = u(30)*w(0)
 w(1093) = u(31)*w(0)
 w(1094) = u(32)*w(0)
 w(1095) = u(33)*w(0)
 w(1096) = u(34)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(1097:1928) = u(0)*w(265:1096)
 w(1929:2550) = u(1)*w(475:1096)
 w(2551:3008) = u(2)*w(639:1096)
 w(3009:3340) = u(3)*w(765:1096)
 w(3341:3577) = u(4)*w(860:1096)
 w(3578:3744) = u(5)*w(930:1096)
 w(3745:3861) = u(6)*w(980:1096)
 w(3862:3944) = u(7)*w(1014:1096)
 w(3945:3954) = u(8)*w(255:264)
 w(3955:3964) = u(9)*w(255:264)
 w(3965:3974) = u(10)*w(255:264)
 w(3975:3984) = u(11)*w(255:264)
 w(3985:3994) = u(12)*w(255:264)
 w(3995:4004) = u(13)*w(255:264)
 w(4005:4014) = u(14)*w(255:264)
 w(4015:4024) = u(15)*w(255:264)
 w(4025:4034) = u(16)*w(255:264)
 w(4035:4044) = u(17)*w(255:264)
 w(4045) = u(35)*w(0)
 w(4046) = u(36)*w(0)
 w(4047) = u(37)*w(0)
 w(4048) = u(38)*w(0)
 w(4049) = u(39)*w(0)
endif
! terms of degree 6
if (6.le.mxd) then
 w(4050:7002) = u(0)*w(1097:4049)
 w(7003:9123) = u(1)*w(1929:4049)
 w(9124:10622) = u(2)*w(2551:4049)
 w(10623:11663) = u(3)*w(3009:4049)
 w(11664:12372) = u(4)*w(3341:4049)
 w(12373:12844) = u(5)*w(3578:4049)
 w(12845:13149) = u(6)*w(3745:4049)
 w(13150:13337) = u(7)*w(3862:4049)
 w(13338:13399) = u(8)*w(1035:1096)
 w(13400:13451) = u(9)*w(1045:1096)
 w(13452:13494) = u(10)*w(1054:1096)
 w(13495:13529) = u(11)*w(1062:1096)
 w(13530:13557) = u(12)*w(1069:1096)
 w(13558:13579) = u(13)*w(1075:1096)
 w(13580:13596) = u(14)*w(1080:1096)
 w(13597:13609) = u(15)*w(1084:1096)
 w(13610:13619) = u(16)*w(1087:1096)
 w(13620:13627) = u(17)*w(1089:1096)
 w(13628:13637) = u(18)*w(255:264)
 w(13638:13646) = u(19)*w(256:264)
 w(13647:13654) = u(20)*w(257:264)
 w(13655:13661) = u(21)*w(258:264)
 w(13662:13667) = u(22)*w(259:264)
 w(13668:13672) = u(23)*w(260:264)
 w(13673:13676) = u(24)*w(261:264)
 w(13677:13679) = u(25)*w(262:264)
 w(13680:13681) = u(26)*w(263:264)
 w(13682) = u(27)*w(264)
 w(13683) = u(40)*w(0)
 w(13684) = u(41)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(13685:23319) = u(0)*w(4050:13684)
 w(23320:30001) = u(1)*w(7003:13684)
 w(30002:34562) = u(2)*w(9124:13684)
 w(34563:37624) = u(3)*w(10623:13684)
 w(37625:39645) = u(4)*w(11664:13684)
 w(39646:40957) = u(5)*w(12373:13684)
 w(40958:41797) = u(6)*w(12845:13684)
 w(41798:42332) = u(7)*w(13150:13684)
 w(42333:42437) = u(8)*w(3945:4049)
 w(42438:42532) = u(9)*w(3955:4049)
 w(42533:42617) = u(10)*w(3965:4049)
 w(42618:42692) = u(11)*w(3975:4049)
 w(42693:42757) = u(12)*w(3985:4049)
 w(42758:42812) = u(13)*w(3995:4049)
 w(42813:42857) = u(14)*w(4005:4049)
 w(42858:42892) = u(15)*w(4015:4049)
 w(42893:42917) = u(16)*w(4025:4049)
 w(42918:42932) = u(17)*w(4035:4049)
 w(42933:42939) = u(18)*w(1090:1096)
 w(42940:42946) = u(19)*w(1090:1096)
 w(42947:42953) = u(20)*w(1090:1096)
 w(42954:42960) = u(21)*w(1090:1096)
 w(42961:42967) = u(22)*w(1090:1096)
 w(42968:42974) = u(23)*w(1090:1096)
 w(42975:42981) = u(24)*w(1090:1096)
 w(42982:42988) = u(25)*w(1090:1096)
 w(42989:42995) = u(26)*w(1090:1096)
 w(42996:43002) = u(27)*w(1090:1096)
endif
! terms of degree 8
if (8.le.mxd) then
 w(43003:72320) = u(0)*w(13685:43002)
 w(72321:92003) = u(1)*w(23320:43002)
 w(92004:105004) = u(2)*w(30002:43002)
 w(105005:113444) = u(3)*w(34563:43002)
 w(113445:118822) = u(4)*w(37625:43002)
 w(118823:122179) = u(5)*w(39646:43002)
 w(122180:124224) = u(6)*w(40958:43002)
 w(124225:125429) = u(7)*w(41798:43002)
 w(125430:125776) = u(8)*w(13338:13684)
 w(125777:126061) = u(9)*w(13400:13684)
 w(126062:126294) = u(10)*w(13452:13684)
 w(126295:126484) = u(11)*w(13495:13684)
 w(126485:126639) = u(12)*w(13530:13684)
 w(126640:126766) = u(13)*w(13558:13684)
 w(126767:126871) = u(14)*w(13580:13684)
 w(126872:126959) = u(15)*w(13597:13684)
 w(126960:127034) = u(16)*w(13610:13684)
 w(127035:127099) = u(17)*w(13620:13684)
 w(127100:127104) = u(18)*w(4045:4049)
 w(127105:127109) = u(19)*w(4045:4049)
 w(127110:127114) = u(20)*w(4045:4049)
 w(127115:127119) = u(21)*w(4045:4049)
 w(127120:127124) = u(22)*w(4045:4049)
 w(127125:127129) = u(23)*w(4045:4049)
 w(127130:127134) = u(24)*w(4045:4049)
 w(127135:127139) = u(25)*w(4045:4049)
 w(127140:127144) = u(26)*w(4045:4049)
 w(127145:127149) = u(27)*w(4045:4049)
 w(127150:127156) = u(28)*w(1090:1096)
 w(127157:127162) = u(29)*w(1091:1096)
 w(127163:127167) = u(30)*w(1092:1096)
 w(127168:127171) = u(31)*w(1093:1096)
 w(127172:127174) = u(32)*w(1094:1096)
 w(127175:127176) = u(33)*w(1095:1096)
 w(127177) = u(34)*w(1096)
endif
! terms of degree 9
if (9.le.mxd) then
 w(127178:211352) = u(0)*w(43003:127177)
 w(211353:266209) = u(1)*w(72321:127177)
 w(266210:301383) = u(2)*w(92004:127177)
 w(301384:323556) = u(3)*w(105005:127177)
 w(323557:337289) = u(4)*w(113445:127177)
 w(337290:345644) = u(5)*w(118823:127177)
 w(345645:350642) = u(6)*w(122180:127177)
 w(350643:353595) = u(7)*w(124225:127177)
 w(353596:354265) = u(8)*w(42333:43002)
 w(354266:354830) = u(9)*w(42438:43002)
 w(354831:355300) = u(10)*w(42533:43002)
 w(355301:355685) = u(11)*w(42618:43002)
 w(355686:355995) = u(12)*w(42693:43002)
 w(355996:356240) = u(13)*w(42758:43002)
 w(356241:356430) = u(14)*w(42813:43002)
 w(356431:356575) = u(15)*w(42858:43002)
 w(356576:356685) = u(16)*w(42893:43002)
 w(356686:356770) = u(17)*w(42918:43002)
 w(356771:356827) = u(18)*w(13628:13684)
 w(356828:356874) = u(19)*w(13638:13684)
 w(356875:356912) = u(20)*w(13647:13684)
 w(356913:356942) = u(21)*w(13655:13684)
 w(356943:356965) = u(22)*w(13662:13684)
 w(356966:356982) = u(23)*w(13668:13684)
 w(356983:356994) = u(24)*w(13673:13684)
 w(356995:357002) = u(25)*w(13677:13684)
 w(357003:357007) = u(26)*w(13680:13684)
 w(357008:357010) = u(27)*w(13682:13684)
 w(357011:357015) = u(28)*w(4045:4049)
 w(357016:357020) = u(29)*w(4045:4049)
 w(357021:357025) = u(30)*w(4045:4049)
 w(357026:357030) = u(31)*w(4045:4049)
 w(357031:357035) = u(32)*w(4045:4049)
 w(357036:357040) = u(33)*w(4045:4049)
 w(357041:357045) = u(34)*w(4045:4049)
endif
END SUBROUTINE mg5311_prib
