SUBROUTINE mg42111_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg42111_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg42111_prib: bad size u'
!! else if (size(w).ne.mg42111_npb(mxd)) then
!!  stop 'mg42111_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 12 11 6 6 0 1 0 0 0
! prib,  dnpb(0:*): 1 12 89 502 2367 9770 36357 124338 396246 1188792
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
 w(10) = u(9)*w(0)
 w(11) = u(10)*w(0)
 w(12) = u(11)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(13:24) = u(0)*w(1:12)
 w(25:35) = u(1)*w(2:12)
 w(36:45) = u(2)*w(3:12)
 w(46:54) = u(3)*w(4:12)
 w(55:62) = u(4)*w(5:12)
 w(63:69) = u(5)*w(6:12)
 w(70:75) = u(6)*w(7:12)
 w(76:80) = u(7)*w(8:12)
 w(81:84) = u(8)*w(9:12)
 w(85:87) = u(9)*w(10:12)
 w(88:89) = u(10)*w(11:12)
 w(90) = u(11)*w(12)
 w(91) = u(12)*w(0)
 w(92) = u(13)*w(0)
 w(93) = u(14)*w(0)
 w(94) = u(15)*w(0)
 w(95) = u(16)*w(0)
 w(96) = u(17)*w(0)
 w(97) = u(18)*w(0)
 w(98) = u(19)*w(0)
 w(99) = u(20)*w(0)
 w(100) = u(21)*w(0)
 w(101) = u(22)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(102:190) = u(0)*w(13:101)
 w(191:267) = u(1)*w(25:101)
 w(268:333) = u(2)*w(36:101)
 w(334:389) = u(3)*w(46:101)
 w(390:436) = u(4)*w(55:101)
 w(437:475) = u(5)*w(63:101)
 w(476:507) = u(6)*w(70:101)
 w(508:533) = u(7)*w(76:101)
 w(534:554) = u(8)*w(81:101)
 w(555:571) = u(9)*w(85:101)
 w(572:585) = u(10)*w(88:101)
 w(586:597) = u(11)*w(90:101)
 w(598) = u(23)*w(0)
 w(599) = u(24)*w(0)
 w(600) = u(25)*w(0)
 w(601) = u(26)*w(0)
 w(602) = u(27)*w(0)
 w(603) = u(28)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(604:1105) = u(0)*w(102:603)
 w(1106:1518) = u(1)*w(191:603)
 w(1519:1854) = u(2)*w(268:603)
 w(1855:2124) = u(3)*w(334:603)
 w(2125:2338) = u(4)*w(390:603)
 w(2339:2505) = u(5)*w(437:603)
 w(2506:2633) = u(6)*w(476:603)
 w(2634:2729) = u(7)*w(508:603)
 w(2730:2799) = u(8)*w(534:603)
 w(2800:2848) = u(9)*w(555:603)
 w(2849:2880) = u(10)*w(572:603)
 w(2881:2898) = u(11)*w(586:603)
 w(2899:2909) = u(12)*w(91:101)
 w(2910:2919) = u(13)*w(92:101)
 w(2920:2928) = u(14)*w(93:101)
 w(2929:2936) = u(15)*w(94:101)
 w(2937:2943) = u(16)*w(95:101)
 w(2944:2949) = u(17)*w(96:101)
 w(2950:2954) = u(18)*w(97:101)
 w(2955:2958) = u(19)*w(98:101)
 w(2959:2961) = u(20)*w(99:101)
 w(2962:2963) = u(21)*w(100:101)
 w(2964) = u(22)*w(101)
 w(2965) = u(29)*w(0)
 w(2966) = u(30)*w(0)
 w(2967) = u(31)*w(0)
 w(2968) = u(32)*w(0)
 w(2969) = u(33)*w(0)
 w(2970) = u(34)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(2971:5337) = u(0)*w(604:2970)
 w(5338:7202) = u(1)*w(1106:2970)
 w(7203:8654) = u(2)*w(1519:2970)
 w(8655:9770) = u(3)*w(1855:2970)
 w(9771:10616) = u(4)*w(2125:2970)
 w(10617:11248) = u(5)*w(2339:2970)
 w(11249:11713) = u(6)*w(2506:2970)
 w(11714:12050) = u(7)*w(2634:2970)
 w(12051:12291) = u(8)*w(2730:2970)
 w(12292:12462) = u(9)*w(2800:2970)
 w(12463:12584) = u(10)*w(2849:2970)
 w(12585:12674) = u(11)*w(2881:2970)
 w(12675:12680) = u(12)*w(598:603)
 w(12681:12686) = u(13)*w(598:603)
 w(12687:12692) = u(14)*w(598:603)
 w(12693:12698) = u(15)*w(598:603)
 w(12699:12704) = u(16)*w(598:603)
 w(12705:12710) = u(17)*w(598:603)
 w(12711:12716) = u(18)*w(598:603)
 w(12717:12722) = u(19)*w(598:603)
 w(12723:12728) = u(20)*w(598:603)
 w(12729:12734) = u(21)*w(598:603)
 w(12735:12740) = u(22)*w(598:603)
endif
! terms of degree 6
if (6.le.mxd) then
 w(12741:22510) = u(0)*w(2971:12740)
 w(22511:29913) = u(1)*w(5338:12740)
 w(29914:35451) = u(2)*w(7203:12740)
 w(35452:39537) = u(3)*w(8655:12740)
 w(39538:42507) = u(4)*w(9771:12740)
 w(42508:44631) = u(5)*w(10617:12740)
 w(44632:46123) = u(6)*w(11249:12740)
 w(46124:47150) = u(7)*w(11714:12740)
 w(47151:47840) = u(8)*w(12051:12740)
 w(47841:48289) = u(9)*w(12292:12740)
 w(48290:48567) = u(10)*w(12463:12740)
 w(48568:48723) = u(11)*w(12585:12740)
 w(48724:48795) = u(12)*w(2899:2970)
 w(48796:48856) = u(13)*w(2910:2970)
 w(48857:48907) = u(14)*w(2920:2970)
 w(48908:48949) = u(15)*w(2929:2970)
 w(48950:48983) = u(16)*w(2937:2970)
 w(48984:49010) = u(17)*w(2944:2970)
 w(49011:49031) = u(18)*w(2950:2970)
 w(49032:49047) = u(19)*w(2955:2970)
 w(49048:49059) = u(20)*w(2959:2970)
 w(49060:49068) = u(21)*w(2962:2970)
 w(49069:49075) = u(22)*w(2964:2970)
 w(49076:49081) = u(23)*w(598:603)
 w(49082:49086) = u(24)*w(599:603)
 w(49087:49090) = u(25)*w(600:603)
 w(49091:49093) = u(26)*w(601:603)
 w(49094:49095) = u(27)*w(602:603)
 w(49096) = u(28)*w(603)
 w(49097) = u(35)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(49098:85454) = u(0)*w(12741:49097)
 w(85455:112041) = u(1)*w(22511:49097)
 w(112042:131225) = u(2)*w(29914:49097)
 w(131226:144871) = u(3)*w(35452:49097)
 w(144872:154431) = u(4)*w(39538:49097)
 w(154432:161021) = u(5)*w(42508:49097)
 w(161022:165487) = u(6)*w(44632:49097)
 w(165488:168461) = u(7)*w(46124:49097)
 w(168462:170408) = u(8)*w(47151:49097)
 w(170409:171665) = u(9)*w(47841:49097)
 w(171666:172473) = u(10)*w(48290:49097)
 w(172474:173003) = u(11)*w(48568:49097)
 w(173004:173069) = u(12)*w(12675:12740)
 w(173070:173129) = u(13)*w(12681:12740)
 w(173130:173183) = u(14)*w(12687:12740)
 w(173184:173231) = u(15)*w(12693:12740)
 w(173232:173273) = u(16)*w(12699:12740)
 w(173274:173309) = u(17)*w(12705:12740)
 w(173310:173339) = u(18)*w(12711:12740)
 w(173340:173363) = u(19)*w(12717:12740)
 w(173364:173381) = u(20)*w(12723:12740)
 w(173382:173393) = u(21)*w(12729:12740)
 w(173394:173399) = u(22)*w(12735:12740)
 w(173400:173405) = u(23)*w(2965:2970)
 w(173406:173411) = u(24)*w(2965:2970)
 w(173412:173417) = u(25)*w(2965:2970)
 w(173418:173423) = u(26)*w(2965:2970)
 w(173424:173429) = u(27)*w(2965:2970)
 w(173430:173435) = u(28)*w(2965:2970)
endif
! terms of degree 8
if (8.le.mxd) then
 w(173436:297773) = u(0)*w(49098:173435)
 w(297774:385754) = u(1)*w(85455:173435)
 w(385755:447148) = u(2)*w(112042:173435)
 w(447149:489358) = u(3)*w(131226:173435)
 w(489359:517922) = u(4)*w(144872:173435)
 w(517923:536926) = u(5)*w(154432:173435)
 w(536927:549340) = u(6)*w(161022:173435)
 w(549341:557288) = u(7)*w(165488:173435)
 w(557289:562262) = u(8)*w(168462:173435)
 w(562263:565289) = u(9)*w(170409:173435)
 w(565290:567059) = u(10)*w(171666:173435)
 w(567060:568021) = u(11)*w(172474:173435)
 w(568022:568395) = u(12)*w(48724:49097)
 w(568396:568697) = u(13)*w(48796:49097)
 w(568698:568938) = u(14)*w(48857:49097)
 w(568939:569128) = u(15)*w(48908:49097)
 w(569129:569276) = u(16)*w(48950:49097)
 w(569277:569390) = u(17)*w(48984:49097)
 w(569391:569477) = u(18)*w(49011:49097)
 w(569478:569543) = u(19)*w(49032:49097)
 w(569544:569593) = u(20)*w(49048:49097)
 w(569594:569631) = u(21)*w(49060:49097)
 w(569632:569660) = u(22)*w(49069:49097)
 w(569661:569666) = u(29)*w(2965:2970)
 w(569667:569671) = u(30)*w(2966:2970)
 w(569672:569675) = u(31)*w(2967:2970)
 w(569676:569678) = u(32)*w(2968:2970)
 w(569679:569680) = u(33)*w(2969:2970)
 w(569681) = u(34)*w(2970)
endif
! terms of degree 9
if (9.le.mxd) then
 w(569682:965927) = u(0)*w(173436:569681)
 w(965928:1237835) = u(1)*w(297774:569681)
 w(1237836:1421762) = u(2)*w(385755:569681)
 w(1421763:1544295) = u(3)*w(447149:569681)
 w(1544296:1624618) = u(4)*w(489359:569681)
 w(1624619:1676377) = u(5)*w(517923:569681)
 w(1676378:1709132) = u(6)*w(536927:569681)
 w(1709133:1729473) = u(7)*w(549341:569681)
 w(1729474:1741866) = u(8)*w(557289:569681)
 w(1741867:1749285) = u(9)*w(562263:569681)
 w(1749286:1753677) = u(10)*w(565290:569681)
 w(1753678:1756299) = u(11)*w(567060:569681)
 w(1756300:1756731) = u(12)*w(173004:173435)
 w(1756732:1757097) = u(13)*w(173070:173435)
 w(1757098:1757403) = u(14)*w(173130:173435)
 w(1757404:1757655) = u(15)*w(173184:173435)
 w(1757656:1757859) = u(16)*w(173232:173435)
 w(1757860:1758021) = u(17)*w(173274:173435)
 w(1758022:1758147) = u(18)*w(173310:173435)
 w(1758148:1758243) = u(19)*w(173340:173435)
 w(1758244:1758315) = u(20)*w(173364:173435)
 w(1758316:1758369) = u(21)*w(173382:173435)
 w(1758370:1758411) = u(22)*w(173394:173435)
 w(1758412:1758433) = u(23)*w(49076:49097)
 w(1758434:1758449) = u(24)*w(49082:49097)
 w(1758450:1758460) = u(25)*w(49087:49097)
 w(1758461:1758467) = u(26)*w(49091:49097)
 w(1758468:1758471) = u(27)*w(49094:49097)
 w(1758472:1758473) = u(28)*w(49096:49097)
endif
END SUBROUTINE mg42111_prib
