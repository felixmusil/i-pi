SUBROUTINE mg22211_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg22211_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg22211_prib: bad size u'
!! else if (size(w).ne.mg22211_npb(mxd)) then
!!  stop 'mg22211_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 13 15 0 0 0 0 0 0 0
! prib,  dnpb(0:*): 1 13 106 650 3305 14573 57464 206648 687770 2141490
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
 w(10) = u(9)*w(0)
 w(11) = u(10)*w(0)
 w(12) = u(11)*w(0)
 w(13) = u(12)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(14:26) = u(0)*w(1:13)
 w(27:38) = u(1)*w(2:13)
 w(39:49) = u(2)*w(3:13)
 w(50:59) = u(3)*w(4:13)
 w(60:68) = u(4)*w(5:13)
 w(69:76) = u(5)*w(6:13)
 w(77:83) = u(6)*w(7:13)
 w(84:89) = u(7)*w(8:13)
 w(90:94) = u(8)*w(9:13)
 w(95:98) = u(9)*w(10:13)
 w(99:101) = u(10)*w(11:13)
 w(102:103) = u(11)*w(12:13)
 w(104) = u(12)*w(13)
 w(105) = u(13)*w(0)
 w(106) = u(14)*w(0)
 w(107) = u(15)*w(0)
 w(108) = u(16)*w(0)
 w(109) = u(17)*w(0)
 w(110) = u(18)*w(0)
 w(111) = u(19)*w(0)
 w(112) = u(20)*w(0)
 w(113) = u(21)*w(0)
 w(114) = u(22)*w(0)
 w(115) = u(23)*w(0)
 w(116) = u(24)*w(0)
 w(117) = u(25)*w(0)
 w(118) = u(26)*w(0)
 w(119) = u(27)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(120:225) = u(0)*w(14:119)
 w(226:318) = u(1)*w(27:119)
 w(319:399) = u(2)*w(39:119)
 w(400:469) = u(3)*w(50:119)
 w(470:529) = u(4)*w(60:119)
 w(530:580) = u(5)*w(69:119)
 w(581:623) = u(6)*w(77:119)
 w(624:659) = u(7)*w(84:119)
 w(660:689) = u(8)*w(90:119)
 w(690:714) = u(9)*w(95:119)
 w(715:735) = u(10)*w(99:119)
 w(736:753) = u(11)*w(102:119)
 w(754:769) = u(12)*w(104:119)
endif
! terms of degree 4
if (4.le.mxd) then
 w(770:1419) = u(0)*w(120:769)
 w(1420:1963) = u(1)*w(226:769)
 w(1964:2414) = u(2)*w(319:769)
 w(2415:2784) = u(3)*w(400:769)
 w(2785:3084) = u(4)*w(470:769)
 w(3085:3324) = u(5)*w(530:769)
 w(3325:3513) = u(6)*w(581:769)
 w(3514:3659) = u(7)*w(624:769)
 w(3660:3769) = u(8)*w(660:769)
 w(3770:3849) = u(9)*w(690:769)
 w(3850:3904) = u(10)*w(715:769)
 w(3905:3938) = u(11)*w(736:769)
 w(3939:3954) = u(12)*w(754:769)
 w(3955:3969) = u(13)*w(105:119)
 w(3970:3983) = u(14)*w(106:119)
 w(3984:3996) = u(15)*w(107:119)
 w(3997:4008) = u(16)*w(108:119)
 w(4009:4019) = u(17)*w(109:119)
 w(4020:4029) = u(18)*w(110:119)
 w(4030:4038) = u(19)*w(111:119)
 w(4039:4046) = u(20)*w(112:119)
 w(4047:4053) = u(21)*w(113:119)
 w(4054:4059) = u(22)*w(114:119)
 w(4060:4064) = u(23)*w(115:119)
 w(4065:4068) = u(24)*w(116:119)
 w(4069:4071) = u(25)*w(117:119)
 w(4072:4073) = u(26)*w(118:119)
 w(4074) = u(27)*w(119)
endif
! terms of degree 5
if (5.le.mxd) then
 w(4075:7379) = u(0)*w(770:4074)
 w(7380:10034) = u(1)*w(1420:4074)
 w(10035:12145) = u(2)*w(1964:4074)
 w(12146:13805) = u(3)*w(2415:4074)
 w(13806:15095) = u(4)*w(2785:4074)
 w(15096:16085) = u(5)*w(3085:4074)
 w(16086:16835) = u(6)*w(3325:4074)
 w(16836:17396) = u(7)*w(3514:4074)
 w(17397:17811) = u(8)*w(3660:4074)
 w(17812:18116) = u(9)*w(3770:4074)
 w(18117:18341) = u(10)*w(3850:4074)
 w(18342:18511) = u(11)*w(3905:4074)
 w(18512:18647) = u(12)*w(3939:4074)
endif
! terms of degree 6
if (6.le.mxd) then
 w(18648:33220) = u(0)*w(4075:18647)
 w(33221:44488) = u(1)*w(7380:18647)
 w(44489:53101) = u(2)*w(10035:18647)
 w(53102:59603) = u(3)*w(12146:18647)
 w(59604:64445) = u(4)*w(13806:18647)
 w(64446:67997) = u(5)*w(15096:18647)
 w(67998:70559) = u(6)*w(16086:18647)
 w(70560:72371) = u(7)*w(16836:18647)
 w(72372:73622) = u(8)*w(17397:18647)
 w(73623:74458) = u(9)*w(17812:18647)
 w(74459:74989) = u(10)*w(18117:18647)
 w(74990:75295) = u(11)*w(18342:18647)
 w(75296:75431) = u(12)*w(18512:18647)
 w(75432:75551) = u(13)*w(3955:4074)
 w(75552:75656) = u(14)*w(3970:4074)
 w(75657:75747) = u(15)*w(3984:4074)
 w(75748:75825) = u(16)*w(3997:4074)
 w(75826:75891) = u(17)*w(4009:4074)
 w(75892:75946) = u(18)*w(4020:4074)
 w(75947:75991) = u(19)*w(4030:4074)
 w(75992:76027) = u(20)*w(4039:4074)
 w(76028:76055) = u(21)*w(4047:4074)
 w(76056:76076) = u(22)*w(4054:4074)
 w(76077:76091) = u(23)*w(4060:4074)
 w(76092:76101) = u(24)*w(4065:4074)
 w(76102:76107) = u(25)*w(4069:4074)
 w(76108:76110) = u(26)*w(4072:4074)
 w(76111) = u(27)*w(4074)
endif
! terms of degree 7
if (7.le.mxd) then
 w(76112:133575) = u(0)*w(18648:76111)
 w(133576:176466) = u(1)*w(33221:76111)
 w(176467:208089) = u(2)*w(44489:76111)
 w(208090:231099) = u(3)*w(53102:76111)
 w(231100:247607) = u(4)*w(59604:76111)
 w(247608:259273) = u(5)*w(64446:76111)
 w(259274:267387) = u(6)*w(67998:76111)
 w(267388:272939) = u(7)*w(70560:76111)
 w(272940:276679) = u(8)*w(72372:76111)
 w(276680:279168) = u(9)*w(73623:76111)
 w(279169:280821) = u(10)*w(74459:76111)
 w(280822:281943) = u(11)*w(74990:76111)
 w(281944:282759) = u(12)*w(75296:76111)
endif
! terms of degree 8
if (8.le.mxd) then
 w(282760:489407) = u(0)*w(76112:282759)
 w(489408:638591) = u(1)*w(133576:282759)
 w(638592:744884) = u(2)*w(176467:282759)
 w(744885:819554) = u(3)*w(208090:282759)
 w(819555:871214) = u(4)*w(231100:282759)
 w(871215:906366) = u(5)*w(247608:282759)
 w(906367:929852) = u(6)*w(259274:282759)
 w(929853:945224) = u(7)*w(267388:282759)
 w(945225:955044) = u(8)*w(272940:282759)
 w(955045:961124) = u(9)*w(276680:282759)
 w(961125:964715) = u(10)*w(279169:282759)
 w(964716:966653) = u(11)*w(280822:282759)
 w(966654:967469) = u(12)*w(281944:282759)
 w(967470:968149) = u(13)*w(75432:76111)
 w(968150:968709) = u(14)*w(75552:76111)
 w(968710:969164) = u(15)*w(75657:76111)
 w(969165:969528) = u(16)*w(75748:76111)
 w(969529:969814) = u(17)*w(75826:76111)
 w(969815:970034) = u(18)*w(75892:76111)
 w(970035:970199) = u(19)*w(75947:76111)
 w(970200:970319) = u(20)*w(75992:76111)
 w(970320:970403) = u(21)*w(76028:76111)
 w(970404:970459) = u(22)*w(76056:76111)
 w(970460:970494) = u(23)*w(76077:76111)
 w(970495:970514) = u(24)*w(76092:76111)
 w(970515:970524) = u(25)*w(76102:76111)
 w(970525:970528) = u(26)*w(76108:76111)
 w(970529) = u(27)*w(76111)
endif
! terms of degree 9
if (9.le.mxd) then
 w(970530:1658299) = u(0)*w(282760:970529)
 w(1658300:2139421) = u(1)*w(489408:970529)
 w(2139422:2471359) = u(2)*w(638592:970529)
 w(2471360:2697004) = u(3)*w(744885:970529)
 w(2697005:2847979) = u(4)*w(819555:970529)
 w(2847980:2947294) = u(5)*w(871215:970529)
 w(2947295:3011457) = u(6)*w(906367:970529)
 w(3011458:3052134) = u(7)*w(929853:970529)
 w(3052135:3077439) = u(8)*w(945225:970529)
 w(3077440:3092924) = u(9)*w(955045:970529)
 w(3092925:3102329) = u(10)*w(961125:970529)
 w(3102330:3108143) = u(11)*w(964716:970529)
 w(3108144:3112019) = u(12)*w(966654:970529)
endif
END SUBROUTINE mg22211_prib
