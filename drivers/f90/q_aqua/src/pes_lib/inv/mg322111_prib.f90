SUBROUTINE mg322111_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg322111_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg322111_prib: bad size u'
!! else if (size(w).ne.mg322111_npb(mxd)) then
!!  stop 'mg322111_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 18 19 6 0 0 2 0 0 0
! prib,  dnpb(0:*): 1 18 190 1488 9532 52554 257397 1143948 4684317 17876902
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
 w(10) = u(9)*w(0)
 w(11) = u(10)*w(0)
 w(12) = u(11)*w(0)
 w(13) = u(12)*w(0)
 w(14) = u(13)*w(0)
 w(15) = u(14)*w(0)
 w(16) = u(15)*w(0)
 w(17) = u(16)*w(0)
 w(18) = u(17)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(19:36) = u(0)*w(1:18)
 w(37:53) = u(1)*w(2:18)
 w(54:69) = u(2)*w(3:18)
 w(70:84) = u(3)*w(4:18)
 w(85:98) = u(4)*w(5:18)
 w(99:111) = u(5)*w(6:18)
 w(112:123) = u(6)*w(7:18)
 w(124:134) = u(7)*w(8:18)
 w(135:144) = u(8)*w(9:18)
 w(145:153) = u(9)*w(10:18)
 w(154:161) = u(10)*w(11:18)
 w(162:168) = u(11)*w(12:18)
 w(169:174) = u(12)*w(13:18)
 w(175:179) = u(13)*w(14:18)
 w(180:183) = u(14)*w(15:18)
 w(184:186) = u(15)*w(16:18)
 w(187:188) = u(16)*w(17:18)
 w(189) = u(17)*w(18)
 w(190) = u(18)*w(0)
 w(191) = u(19)*w(0)
 w(192) = u(20)*w(0)
 w(193) = u(21)*w(0)
 w(194) = u(22)*w(0)
 w(195) = u(23)*w(0)
 w(196) = u(24)*w(0)
 w(197) = u(25)*w(0)
 w(198) = u(26)*w(0)
 w(199) = u(27)*w(0)
 w(200) = u(28)*w(0)
 w(201) = u(29)*w(0)
 w(202) = u(30)*w(0)
 w(203) = u(31)*w(0)
 w(204) = u(32)*w(0)
 w(205) = u(33)*w(0)
 w(206) = u(34)*w(0)
 w(207) = u(35)*w(0)
 w(208) = u(36)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(209:398) = u(0)*w(19:208)
 w(399:570) = u(1)*w(37:208)
 w(571:725) = u(2)*w(54:208)
 w(726:864) = u(3)*w(70:208)
 w(865:988) = u(4)*w(85:208)
 w(989:1098) = u(5)*w(99:208)
 w(1099:1195) = u(6)*w(112:208)
 w(1196:1280) = u(7)*w(124:208)
 w(1281:1354) = u(8)*w(135:208)
 w(1355:1418) = u(9)*w(145:208)
 w(1419:1473) = u(10)*w(154:208)
 w(1474:1520) = u(11)*w(162:208)
 w(1521:1560) = u(12)*w(169:208)
 w(1561:1594) = u(13)*w(175:208)
 w(1595:1623) = u(14)*w(180:208)
 w(1624:1648) = u(15)*w(184:208)
 w(1649:1670) = u(16)*w(187:208)
 w(1671:1690) = u(17)*w(189:208)
 w(1691) = u(37)*w(0)
 w(1692) = u(38)*w(0)
 w(1693) = u(39)*w(0)
 w(1694) = u(40)*w(0)
 w(1695) = u(41)*w(0)
 w(1696) = u(42)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(1697:3184) = u(0)*w(209:1696)
 w(3185:4482) = u(1)*w(399:1696)
 w(4483:5608) = u(2)*w(571:1696)
 w(5609:6579) = u(3)*w(726:1696)
 w(6580:7411) = u(4)*w(865:1696)
 w(7412:8119) = u(5)*w(989:1696)
 w(8120:8717) = u(6)*w(1099:1696)
 w(8718:9218) = u(7)*w(1196:1696)
 w(9219:9634) = u(8)*w(1281:1696)
 w(9635:9976) = u(9)*w(1355:1696)
 w(9977:10254) = u(10)*w(1419:1696)
 w(10255:10477) = u(11)*w(1474:1696)
 w(10478:10653) = u(12)*w(1521:1696)
 w(10654:10789) = u(13)*w(1561:1696)
 w(10790:10891) = u(14)*w(1595:1696)
 w(10892:10964) = u(15)*w(1624:1696)
 w(10965:11012) = u(16)*w(1649:1696)
 w(11013:11038) = u(17)*w(1671:1696)
 w(11039:11057) = u(18)*w(190:208)
 w(11058:11075) = u(19)*w(191:208)
 w(11076:11092) = u(20)*w(192:208)
 w(11093:11108) = u(21)*w(193:208)
 w(11109:11123) = u(22)*w(194:208)
 w(11124:11137) = u(23)*w(195:208)
 w(11138:11150) = u(24)*w(196:208)
 w(11151:11162) = u(25)*w(197:208)
 w(11163:11173) = u(26)*w(198:208)
 w(11174:11183) = u(27)*w(199:208)
 w(11184:11192) = u(28)*w(200:208)
 w(11193:11200) = u(29)*w(201:208)
 w(11201:11207) = u(30)*w(202:208)
 w(11208:11213) = u(31)*w(203:208)
 w(11214:11218) = u(32)*w(204:208)
 w(11219:11222) = u(33)*w(205:208)
 w(11223:11225) = u(34)*w(206:208)
 w(11226:11227) = u(35)*w(207:208)
 w(11228) = u(36)*w(208)
endif
! terms of degree 5
if (5.le.mxd) then
 w(11229:20760) = u(0)*w(1697:11228)
 w(20761:28804) = u(1)*w(3185:11228)
 w(28805:35550) = u(2)*w(4483:11228)
 w(35551:41170) = u(3)*w(5609:11228)
 w(41171:45819) = u(4)*w(6580:11228)
 w(45820:49636) = u(5)*w(7412:11228)
 w(49637:52745) = u(6)*w(8120:11228)
 w(52746:55256) = u(7)*w(8718:11228)
 w(55257:57266) = u(8)*w(9219:11228)
 w(57267:58860) = u(9)*w(9635:11228)
 w(58861:60112) = u(10)*w(9977:11228)
 w(60113:61086) = u(11)*w(10255:11228)
 w(61087:61837) = u(12)*w(10478:11228)
 w(61838:62412) = u(13)*w(10654:11228)
 w(62413:62851) = u(14)*w(10790:11228)
 w(62852:63188) = u(15)*w(10892:11228)
 w(63189:63452) = u(16)*w(10965:11228)
 w(63453:63668) = u(17)*w(11013:11228)
 w(63669:63674) = u(18)*w(1691:1696)
 w(63675:63680) = u(19)*w(1691:1696)
 w(63681:63686) = u(20)*w(1691:1696)
 w(63687:63692) = u(21)*w(1691:1696)
 w(63693:63698) = u(22)*w(1691:1696)
 w(63699:63704) = u(23)*w(1691:1696)
 w(63705:63710) = u(24)*w(1691:1696)
 w(63711:63716) = u(25)*w(1691:1696)
 w(63717:63722) = u(26)*w(1691:1696)
 w(63723:63728) = u(27)*w(1691:1696)
 w(63729:63734) = u(28)*w(1691:1696)
 w(63735:63740) = u(29)*w(1691:1696)
 w(63741:63746) = u(30)*w(1691:1696)
 w(63747:63752) = u(31)*w(1691:1696)
 w(63753:63758) = u(32)*w(1691:1696)
 w(63759:63764) = u(33)*w(1691:1696)
 w(63765:63770) = u(34)*w(1691:1696)
 w(63771:63776) = u(35)*w(1691:1696)
 w(63777:63782) = u(36)*w(1691:1696)
endif
! terms of degree 6
if (6.le.mxd) then
 w(63783:116336) = u(0)*w(11229:63782)
 w(116337:159358) = u(1)*w(20761:63782)
 w(159359:194336) = u(2)*w(28805:63782)
 w(194337:222568) = u(3)*w(35551:63782)
 w(222569:245180) = u(4)*w(41171:63782)
 w(245181:263143) = u(5)*w(45820:63782)
 w(263144:277289) = u(6)*w(49637:63782)
 w(277290:288326) = u(7)*w(52746:63782)
 w(288327:296852) = u(8)*w(55257:63782)
 w(296853:303368) = u(9)*w(57267:63782)
 w(303369:308290) = u(10)*w(58861:63782)
 w(308291:311960) = u(11)*w(60113:63782)
 w(311961:314656) = u(12)*w(61087:63782)
 w(314657:316601) = u(13)*w(61838:63782)
 w(316602:317971) = u(14)*w(62413:63782)
 w(317972:318902) = u(15)*w(62852:63782)
 w(318903:319496) = u(16)*w(63189:63782)
 w(319497:319826) = u(17)*w(63453:63782)
 w(319827:320016) = u(18)*w(11039:11228)
 w(320017:320187) = u(19)*w(11058:11228)
 w(320188:320340) = u(20)*w(11076:11228)
 w(320341:320476) = u(21)*w(11093:11228)
 w(320477:320596) = u(22)*w(11109:11228)
 w(320597:320701) = u(23)*w(11124:11228)
 w(320702:320792) = u(24)*w(11138:11228)
 w(320793:320870) = u(25)*w(11151:11228)
 w(320871:320936) = u(26)*w(11163:11228)
 w(320937:320991) = u(27)*w(11174:11228)
 w(320992:321036) = u(28)*w(11184:11228)
 w(321037:321072) = u(29)*w(11193:11228)
 w(321073:321100) = u(30)*w(11201:11228)
 w(321101:321121) = u(31)*w(11208:11228)
 w(321122:321136) = u(32)*w(11214:11228)
 w(321137:321146) = u(33)*w(11219:11228)
 w(321147:321152) = u(34)*w(11223:11228)
 w(321153:321155) = u(35)*w(11226:11228)
 w(321156) = u(36)*w(11228)
 w(321157:321162) = u(37)*w(1691:1696)
 w(321163:321167) = u(38)*w(1692:1696)
 w(321168:321171) = u(39)*w(1693:1696)
 w(321172:321174) = u(40)*w(1694:1696)
 w(321175:321176) = u(41)*w(1695:1696)
 w(321177) = u(42)*w(1696)
 w(321178) = u(43)*w(0)
 w(321179) = u(44)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(321180:578576) = u(0)*w(63783:321179)
 w(578577:783419) = u(1)*w(116337:321179)
 w(783420:945240) = u(2)*w(159359:321179)
 w(945241:1072083) = u(3)*w(194337:321179)
 w(1072084:1170694) = u(4)*w(222569:321179)
 w(1170695:1246693) = u(5)*w(245181:321179)
 w(1246694:1304729) = u(6)*w(263144:321179)
 w(1304730:1348619) = u(7)*w(277290:321179)
 w(1348620:1381472) = u(8)*w(288327:321179)
 w(1381473:1405799) = u(9)*w(296853:321179)
 w(1405800:1423610) = u(10)*w(303369:321179)
 w(1423611:1436499) = u(11)*w(308291:321179)
 w(1436500:1445718) = u(12)*w(311961:321179)
 w(1445719:1452241) = u(13)*w(314657:321179)
 w(1452242:1456819) = u(14)*w(316602:321179)
 w(1456820:1460027) = u(15)*w(317972:321179)
 w(1460028:1462304) = u(16)*w(318903:321179)
 w(1462305:1463987) = u(17)*w(319497:321179)
 w(1463988:1464101) = u(18)*w(63669:63782)
 w(1464102:1464209) = u(19)*w(63675:63782)
 w(1464210:1464311) = u(20)*w(63681:63782)
 w(1464312:1464407) = u(21)*w(63687:63782)
 w(1464408:1464497) = u(22)*w(63693:63782)
 w(1464498:1464581) = u(23)*w(63699:63782)
 w(1464582:1464659) = u(24)*w(63705:63782)
 w(1464660:1464731) = u(25)*w(63711:63782)
 w(1464732:1464797) = u(26)*w(63717:63782)
 w(1464798:1464857) = u(27)*w(63723:63782)
 w(1464858:1464911) = u(28)*w(63729:63782)
 w(1464912:1464959) = u(29)*w(63735:63782)
 w(1464960:1465001) = u(30)*w(63741:63782)
 w(1465002:1465037) = u(31)*w(63747:63782)
 w(1465038:1465067) = u(32)*w(63753:63782)
 w(1465068:1465091) = u(33)*w(63759:63782)
 w(1465092:1465109) = u(34)*w(63765:63782)
 w(1465110:1465121) = u(35)*w(63771:63782)
 w(1465122:1465127) = u(36)*w(63777:63782)
endif
! terms of degree 8
if (8.le.mxd) then
 w(1465128:2609075) = u(0)*w(321180:1465127)
 w(2609076:3495626) = u(1)*w(578577:1465127)
 w(3495627:4177334) = u(2)*w(783420:1465127)
 w(4177335:4697221) = u(3)*w(945241:1465127)
 w(4697222:5090265) = u(4)*w(1072084:1465127)
 w(5090266:5384698) = u(5)*w(1170695:1465127)
 w(5384699:5603132) = u(6)*w(1246694:1465127)
 w(5603133:5763530) = u(7)*w(1304730:1465127)
 w(5763531:5880038) = u(8)*w(1348620:1465127)
 w(5880039:5963693) = u(9)*w(1381473:1465127)
 w(5963694:6023021) = u(10)*w(1405800:1465127)
 w(6023022:6064538) = u(11)*w(1423611:1465127)
 w(6064539:6093166) = u(12)*w(1436500:1465127)
 w(6093167:6112575) = u(13)*w(1445719:1465127)
 w(6112576:6125461) = u(14)*w(1452242:1465127)
 w(6125462:6133769) = u(15)*w(1456820:1465127)
 w(6133770:6138869) = u(16)*w(1460028:1465127)
 w(6138870:6141692) = u(17)*w(1462305:1465127)
 w(6141693:6143045) = u(18)*w(319827:321179)
 w(6143046:6144208) = u(19)*w(320017:321179)
 w(6144209:6145200) = u(20)*w(320188:321179)
 w(6145201:6146039) = u(21)*w(320341:321179)
 w(6146040:6146742) = u(22)*w(320477:321179)
 w(6146743:6147325) = u(23)*w(320597:321179)
 w(6147326:6147803) = u(24)*w(320702:321179)
 w(6147804:6148190) = u(25)*w(320793:321179)
 w(6148191:6148499) = u(26)*w(320871:321179)
 w(6148500:6148742) = u(27)*w(320937:321179)
 w(6148743:6148930) = u(28)*w(320992:321179)
 w(6148931:6149073) = u(29)*w(321037:321179)
 w(6149074:6149180) = u(30)*w(321073:321179)
 w(6149181:6149259) = u(31)*w(321101:321179)
 w(6149260:6149317) = u(32)*w(321122:321179)
 w(6149318:6149360) = u(33)*w(321137:321179)
 w(6149361:6149393) = u(34)*w(321147:321179)
 w(6149394:6149420) = u(35)*w(321153:321179)
 w(6149421:6149444) = u(36)*w(321156:321179)
endif
! terms of degree 9
if (9.le.mxd) then
 w(6149445:10833761) = u(0)*w(1465128:6149444)
 w(10833762:14374130) = u(1)*w(2609076:6149444)
 w(14374131:17027948) = u(2)*w(3495627:6149444)
 w(17027949:19000058) = u(3)*w(4177335:6149444)
 w(19000059:20452281) = u(4)*w(4697222:6149444)
 w(20452282:21511460) = u(5)*w(5090266:6149444)
 w(21511461:22276206) = u(6)*w(5384699:6149444)
 w(22276207:22822518) = u(7)*w(5603133:6149444)
 w(22822519:23208432) = u(8)*w(5763531:6149444)
 w(23208433:23477838) = u(9)*w(5880039:6149444)
 w(23477839:23663589) = u(10)*w(5963694:6149444)
 w(23663590:23790012) = u(11)*w(6023022:6149444)
 w(23790013:23874918) = u(12)*w(6064539:6149444)
 w(23874919:23931196) = u(13)*w(6093167:6149444)
 w(23931197:23968065) = u(14)*w(6112576:6149444)
 w(23968066:23992048) = u(15)*w(6125462:6149444)
 w(23992049:24007723) = u(16)*w(6133770:6149444)
 w(24007724:24018298) = u(17)*w(6138870:6149444)
 w(24018299:24019438) = u(18)*w(1463988:1465127)
 w(24019439:24020464) = u(19)*w(1464102:1465127)
 w(24020465:24021382) = u(20)*w(1464210:1465127)
 w(24021383:24022198) = u(21)*w(1464312:1465127)
 w(24022199:24022918) = u(22)*w(1464408:1465127)
 w(24022919:24023548) = u(23)*w(1464498:1465127)
 w(24023549:24024094) = u(24)*w(1464582:1465127)
 w(24024095:24024562) = u(25)*w(1464660:1465127)
 w(24024563:24024958) = u(26)*w(1464732:1465127)
 w(24024959:24025288) = u(27)*w(1464798:1465127)
 w(24025289:24025558) = u(28)*w(1464858:1465127)
 w(24025559:24025774) = u(29)*w(1464912:1465127)
 w(24025775:24025942) = u(30)*w(1464960:1465127)
 w(24025943:24026068) = u(31)*w(1465002:1465127)
 w(24026069:24026158) = u(32)*w(1465038:1465127)
 w(24026159:24026218) = u(33)*w(1465068:1465127)
 w(24026219:24026254) = u(34)*w(1465092:1465127)
 w(24026255:24026272) = u(35)*w(1465110:1465127)
 w(24026273:24026278) = u(36)*w(1465122:1465127)
 w(24026279:24026301) = u(37)*w(321157:321179)
 w(24026302:24026318) = u(38)*w(321163:321179)
 w(24026319:24026330) = u(39)*w(321168:321179)
 w(24026331:24026338) = u(40)*w(321172:321179)
 w(24026339:24026343) = u(41)*w(321175:321179)
 w(24026344:24026346) = u(42)*w(321177:321179)
endif
END SUBROUTINE mg322111_prib
