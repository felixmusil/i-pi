SUBROUTINE mg321111_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg321111_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg321111_prib: bad size u'
!! else if (size(w).ne.mg321111_npb(mxd)) then
!!  stop 'mg321111_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 17 12 6 0 0 1 0 0 0
! prib,  dnpb(0:*): 1 17 165 1179 6861 34293 152111 612043 2269242 7844176
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
 w(10) = u(9)*w(0)
 w(11) = u(10)*w(0)
 w(12) = u(11)*w(0)
 w(13) = u(12)*w(0)
 w(14) = u(13)*w(0)
 w(15) = u(14)*w(0)
 w(16) = u(15)*w(0)
 w(17) = u(16)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(18:34) = u(0)*w(1:17)
 w(35:50) = u(1)*w(2:17)
 w(51:65) = u(2)*w(3:17)
 w(66:79) = u(3)*w(4:17)
 w(80:92) = u(4)*w(5:17)
 w(93:104) = u(5)*w(6:17)
 w(105:115) = u(6)*w(7:17)
 w(116:125) = u(7)*w(8:17)
 w(126:134) = u(8)*w(9:17)
 w(135:142) = u(9)*w(10:17)
 w(143:149) = u(10)*w(11:17)
 w(150:155) = u(11)*w(12:17)
 w(156:160) = u(12)*w(13:17)
 w(161:164) = u(13)*w(14:17)
 w(165:167) = u(14)*w(15:17)
 w(168:169) = u(15)*w(16:17)
 w(170) = u(16)*w(17)
 w(171) = u(17)*w(0)
 w(172) = u(18)*w(0)
 w(173) = u(19)*w(0)
 w(174) = u(20)*w(0)
 w(175) = u(21)*w(0)
 w(176) = u(22)*w(0)
 w(177) = u(23)*w(0)
 w(178) = u(24)*w(0)
 w(179) = u(25)*w(0)
 w(180) = u(26)*w(0)
 w(181) = u(27)*w(0)
 w(182) = u(28)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(183:347) = u(0)*w(18:182)
 w(348:495) = u(1)*w(35:182)
 w(496:627) = u(2)*w(51:182)
 w(628:744) = u(3)*w(66:182)
 w(745:847) = u(4)*w(80:182)
 w(848:937) = u(5)*w(93:182)
 w(938:1015) = u(6)*w(105:182)
 w(1016:1082) = u(7)*w(116:182)
 w(1083:1139) = u(8)*w(126:182)
 w(1140:1187) = u(9)*w(135:182)
 w(1188:1227) = u(10)*w(143:182)
 w(1228:1260) = u(11)*w(150:182)
 w(1261:1287) = u(12)*w(156:182)
 w(1288:1309) = u(13)*w(161:182)
 w(1310:1327) = u(14)*w(165:182)
 w(1328:1342) = u(15)*w(168:182)
 w(1343:1355) = u(16)*w(170:182)
 w(1356) = u(29)*w(0)
 w(1357) = u(30)*w(0)
 w(1358) = u(31)*w(0)
 w(1359) = u(32)*w(0)
 w(1360) = u(33)*w(0)
 w(1361) = u(34)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(1362:2540) = u(0)*w(183:1361)
 w(2541:3554) = u(1)*w(348:1361)
 w(3555:4420) = u(2)*w(496:1361)
 w(4421:5154) = u(3)*w(628:1361)
 w(5155:5771) = u(4)*w(745:1361)
 w(5772:6285) = u(5)*w(848:1361)
 w(6286:6709) = u(6)*w(938:1361)
 w(6710:7055) = u(7)*w(1016:1361)
 w(7056:7334) = u(8)*w(1083:1361)
 w(7335:7556) = u(9)*w(1140:1361)
 w(7557:7730) = u(10)*w(1188:1361)
 w(7731:7864) = u(11)*w(1228:1361)
 w(7865:7965) = u(12)*w(1261:1361)
 w(7966:8039) = u(13)*w(1288:1361)
 w(8040:8091) = u(14)*w(1310:1361)
 w(8092:8125) = u(15)*w(1328:1361)
 w(8126:8144) = u(16)*w(1343:1361)
 w(8145:8156) = u(17)*w(171:182)
 w(8157:8167) = u(18)*w(172:182)
 w(8168:8177) = u(19)*w(173:182)
 w(8178:8186) = u(20)*w(174:182)
 w(8187:8194) = u(21)*w(175:182)
 w(8195:8201) = u(22)*w(176:182)
 w(8202:8207) = u(23)*w(177:182)
 w(8208:8212) = u(24)*w(178:182)
 w(8213:8216) = u(25)*w(179:182)
 w(8217:8219) = u(26)*w(180:182)
 w(8220:8221) = u(27)*w(181:182)
 w(8222) = u(28)*w(182)
endif
! terms of degree 5
if (5.le.mxd) then
 w(8223:15083) = u(0)*w(1362:8222)
 w(15084:20765) = u(1)*w(2541:8222)
 w(20766:25433) = u(2)*w(3555:8222)
 w(25434:29235) = u(3)*w(4421:8222)
 w(29236:32303) = u(4)*w(5155:8222)
 w(32304:34754) = u(5)*w(5772:8222)
 w(34755:36691) = u(6)*w(6286:8222)
 w(36692:38204) = u(7)*w(6710:8222)
 w(38205:39371) = u(8)*w(7056:8222)
 w(39372:40259) = u(9)*w(7335:8222)
 w(40260:40925) = u(10)*w(7557:8222)
 w(40926:41417) = u(11)*w(7731:8222)
 w(41418:41775) = u(12)*w(7865:8222)
 w(41776:42032) = u(13)*w(7966:8222)
 w(42033:42215) = u(14)*w(8040:8222)
 w(42216:42346) = u(15)*w(8092:8222)
 w(42347:42443) = u(16)*w(8126:8222)
 w(42444:42449) = u(17)*w(1356:1361)
 w(42450:42455) = u(18)*w(1356:1361)
 w(42456:42461) = u(19)*w(1356:1361)
 w(42462:42467) = u(20)*w(1356:1361)
 w(42468:42473) = u(21)*w(1356:1361)
 w(42474:42479) = u(22)*w(1356:1361)
 w(42480:42485) = u(23)*w(1356:1361)
 w(42486:42491) = u(24)*w(1356:1361)
 w(42492:42497) = u(25)*w(1356:1361)
 w(42498:42503) = u(26)*w(1356:1361)
 w(42504:42509) = u(27)*w(1356:1361)
 w(42510:42515) = u(28)*w(1356:1361)
endif
! terms of degree 6
if (6.le.mxd) then
 w(42516:76808) = u(0)*w(8223:42515)
 w(76809:104240) = u(1)*w(15084:42515)
 w(104241:125990) = u(2)*w(20766:42515)
 w(125991:143072) = u(3)*w(25434:42515)
 w(143073:156352) = u(4)*w(29236:42515)
 w(156353:166564) = u(5)*w(32304:42515)
 w(166565:174325) = u(6)*w(34755:42515)
 w(174326:180149) = u(7)*w(36692:42515)
 w(180150:184460) = u(8)*w(38205:42515)
 w(184461:187604) = u(9)*w(39372:42515)
 w(187605:189860) = u(10)*w(40260:42515)
 w(189861:191450) = u(11)*w(40926:42515)
 w(191451:192548) = u(12)*w(41418:42515)
 w(192549:193288) = u(13)*w(41776:42515)
 w(193289:193771) = u(14)*w(42033:42515)
 w(193772:194071) = u(15)*w(42216:42515)
 w(194072:194240) = u(16)*w(42347:42515)
 w(194241:194318) = u(17)*w(8145:8222)
 w(194319:194384) = u(18)*w(8157:8222)
 w(194385:194439) = u(19)*w(8168:8222)
 w(194440:194484) = u(20)*w(8178:8222)
 w(194485:194520) = u(21)*w(8187:8222)
 w(194521:194548) = u(22)*w(8195:8222)
 w(194549:194569) = u(23)*w(8202:8222)
 w(194570:194584) = u(24)*w(8208:8222)
 w(194585:194594) = u(25)*w(8213:8222)
 w(194595:194600) = u(26)*w(8217:8222)
 w(194601:194603) = u(27)*w(8220:8222)
 w(194604) = u(28)*w(8222)
 w(194605:194610) = u(29)*w(1356:1361)
 w(194611:194615) = u(30)*w(1357:1361)
 w(194616:194619) = u(31)*w(1358:1361)
 w(194620:194622) = u(32)*w(1359:1361)
 w(194623:194624) = u(33)*w(1360:1361)
 w(194625) = u(34)*w(1361)
 w(194626) = u(35)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(194627:346737) = u(0)*w(42516:194626)
 w(346738:464555) = u(1)*w(76809:194626)
 w(464556:554941) = u(2)*w(104241:194626)
 w(554942:623577) = u(3)*w(125991:194626)
 w(623578:675131) = u(4)*w(143073:194626)
 w(675132:713405) = u(5)*w(156353:194626)
 w(713406:741467) = u(6)*w(166565:194626)
 w(741468:761768) = u(7)*w(174326:194626)
 w(761769:776245) = u(8)*w(180150:194626)
 w(776246:786411) = u(9)*w(184461:194626)
 w(786412:793433) = u(10)*w(187605:194626)
 w(793434:798199) = u(11)*w(189861:194626)
 w(798200:801375) = u(12)*w(191451:194626)
 w(801376:803453) = u(13)*w(192549:194626)
 w(803454:804791) = u(14)*w(193289:194626)
 w(804792:805646) = u(15)*w(193772:194626)
 w(805647:806201) = u(16)*w(194072:194626)
 w(806202:806273) = u(17)*w(42444:42515)
 w(806274:806339) = u(18)*w(42450:42515)
 w(806340:806399) = u(19)*w(42456:42515)
 w(806400:806453) = u(20)*w(42462:42515)
 w(806454:806501) = u(21)*w(42468:42515)
 w(806502:806543) = u(22)*w(42474:42515)
 w(806544:806579) = u(23)*w(42480:42515)
 w(806580:806609) = u(24)*w(42486:42515)
 w(806610:806633) = u(25)*w(42492:42515)
 w(806634:806651) = u(26)*w(42498:42515)
 w(806652:806663) = u(27)*w(42504:42515)
 w(806664:806669) = u(28)*w(42510:42515)
endif
! terms of degree 8
if (8.le.mxd) then
 w(806670:1418712) = u(0)*w(194627:806669)
 w(1418713:1878644) = u(1)*w(346738:806669)
 w(1878645:2220758) = u(2)*w(464556:806669)
 w(2220759:2472486) = u(3)*w(554942:806669)
 w(2472487:2655578) = u(4)*w(623578:806669)
 w(2655579:2787116) = u(5)*w(675132:806669)
 w(2787117:2880380) = u(6)*w(713406:806669)
 w(2880381:2945582) = u(7)*w(741468:806669)
 w(2945583:2990483) = u(8)*w(761769:806669)
 w(2990484:3020907) = u(9)*w(776246:806669)
 w(3020908:3041165) = u(10)*w(786412:806669)
 w(3041166:3054401) = u(11)*w(793434:806669)
 w(3054402:3062871) = u(12)*w(798200:806669)
 w(3062872:3068165) = u(13)*w(801376:806669)
 w(3068166:3071381) = u(14)*w(803454:806669)
 w(3071382:3073259) = u(15)*w(804792:806669)
 w(3073260:3074282) = u(16)*w(805647:806669)
 w(3074283:3074668) = u(17)*w(194241:194626)
 w(3074669:3074976) = u(18)*w(194319:194626)
 w(3074977:3075218) = u(19)*w(194385:194626)
 w(3075219:3075405) = u(20)*w(194440:194626)
 w(3075406:3075547) = u(21)*w(194485:194626)
 w(3075548:3075653) = u(22)*w(194521:194626)
 w(3075654:3075731) = u(23)*w(194549:194626)
 w(3075732:3075788) = u(24)*w(194570:194626)
 w(3075789:3075830) = u(25)*w(194585:194626)
 w(3075831:3075862) = u(26)*w(194595:194626)
 w(3075863:3075888) = u(27)*w(194601:194626)
 w(3075889:3075911) = u(28)*w(194604:194626)
endif
! terms of degree 9
if (9.le.mxd) then
 w(3075912:5345153) = u(0)*w(806670:3075911)
 w(5345154:7002352) = u(1)*w(1418713:3075911)
 w(7002353:8199619) = u(2)*w(1878645:3075911)
 w(8199620:9054772) = u(3)*w(2220759:3075911)
 w(9054773:9658197) = u(4)*w(2472487:3075911)
 w(9658198:10078530) = u(5)*w(2655579:3075911)
 w(10078531:10367325) = u(6)*w(2787117:3075911)
 w(10367326:10562856) = u(7)*w(2880381:3075911)
 w(10562857:10693185) = u(8)*w(2945583:3075911)
 w(10693186:10778613) = u(9)*w(2990484:3075911)
 w(10778614:10833617) = u(10)*w(3020908:3075911)
 w(10833618:10868363) = u(11)*w(3041166:3075911)
 w(10868364:10889873) = u(12)*w(3054402:3075911)
 w(10889874:10902913) = u(13)*w(3062872:3075911)
 w(10902914:10910659) = u(14)*w(3068166:3075911)
 w(10910660:10915189) = u(15)*w(3071382:3075911)
 w(10915190:10917841) = u(16)*w(3073260:3075911)
 w(10917842:10918309) = u(17)*w(806202:806669)
 w(10918310:10918705) = u(18)*w(806274:806669)
 w(10918706:10919035) = u(19)*w(806340:806669)
 w(10919036:10919305) = u(20)*w(806400:806669)
 w(10919306:10919521) = u(21)*w(806454:806669)
 w(10919522:10919689) = u(22)*w(806502:806669)
 w(10919690:10919815) = u(23)*w(806544:806669)
 w(10919816:10919905) = u(24)*w(806580:806669)
 w(10919906:10919965) = u(25)*w(806610:806669)
 w(10919966:10920001) = u(26)*w(806634:806669)
 w(10920002:10920019) = u(27)*w(806652:806669)
 w(10920020:10920025) = u(28)*w(806664:806669)
 w(10920026:10920047) = u(29)*w(194605:194626)
 w(10920048:10920063) = u(30)*w(194611:194626)
 w(10920064:10920074) = u(31)*w(194616:194626)
 w(10920075:10920081) = u(32)*w(194620:194626)
 w(10920082:10920085) = u(33)*w(194623:194626)
 w(10920086:10920087) = u(34)*w(194625:194626)
endif
END SUBROUTINE mg321111_prib
