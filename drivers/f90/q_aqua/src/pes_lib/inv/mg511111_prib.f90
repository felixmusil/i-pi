SUBROUTINE mg511111_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg511111_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg511111_prib: bad size u'
!! else if (size(w).ne.mg511111_npb(mxd)) then
!!  stop 'mg511111_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 16 7 7 7 7 1 0 0 0
! prib,  dnpb(0:*): 1 16 143 935 4975 22784 92926 345266 1187468 3825275
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
 w(10) = u(9)*w(0)
 w(11) = u(10)*w(0)
 w(12) = u(11)*w(0)
 w(13) = u(12)*w(0)
 w(14) = u(13)*w(0)
 w(15) = u(14)*w(0)
 w(16) = u(15)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(17:32) = u(0)*w(1:16)
 w(33:47) = u(1)*w(2:16)
 w(48:61) = u(2)*w(3:16)
 w(62:74) = u(3)*w(4:16)
 w(75:86) = u(4)*w(5:16)
 w(87:97) = u(5)*w(6:16)
 w(98:107) = u(6)*w(7:16)
 w(108:116) = u(7)*w(8:16)
 w(117:124) = u(8)*w(9:16)
 w(125:131) = u(9)*w(10:16)
 w(132:137) = u(10)*w(11:16)
 w(138:142) = u(11)*w(12:16)
 w(143:146) = u(12)*w(13:16)
 w(147:149) = u(13)*w(14:16)
 w(150:151) = u(14)*w(15:16)
 w(152) = u(15)*w(16)
 w(153) = u(16)*w(0)
 w(154) = u(17)*w(0)
 w(155) = u(18)*w(0)
 w(156) = u(19)*w(0)
 w(157) = u(20)*w(0)
 w(158) = u(21)*w(0)
 w(159) = u(22)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(160:302) = u(0)*w(17:159)
 w(303:429) = u(1)*w(33:159)
 w(430:541) = u(2)*w(48:159)
 w(542:639) = u(3)*w(62:159)
 w(640:724) = u(4)*w(75:159)
 w(725:797) = u(5)*w(87:159)
 w(798:859) = u(6)*w(98:159)
 w(860:911) = u(7)*w(108:159)
 w(912:954) = u(8)*w(117:159)
 w(955:989) = u(9)*w(125:159)
 w(990:1017) = u(10)*w(132:159)
 w(1018:1039) = u(11)*w(138:159)
 w(1040:1056) = u(12)*w(143:159)
 w(1057:1069) = u(13)*w(147:159)
 w(1070:1079) = u(14)*w(150:159)
 w(1080:1087) = u(15)*w(152:159)
 w(1088) = u(23)*w(0)
 w(1089) = u(24)*w(0)
 w(1090) = u(25)*w(0)
 w(1091) = u(26)*w(0)
 w(1092) = u(27)*w(0)
 w(1093) = u(28)*w(0)
 w(1094) = u(29)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(1095:2029) = u(0)*w(160:1094)
 w(2030:2821) = u(1)*w(303:1094)
 w(2822:3486) = u(2)*w(430:1094)
 w(3487:4039) = u(3)*w(542:1094)
 w(4040:4494) = u(4)*w(640:1094)
 w(4495:4864) = u(5)*w(725:1094)
 w(4865:5161) = u(6)*w(798:1094)
 w(5162:5396) = u(7)*w(860:1094)
 w(5397:5579) = u(8)*w(912:1094)
 w(5580:5719) = u(9)*w(955:1094)
 w(5720:5824) = u(10)*w(990:1094)
 w(5825:5901) = u(11)*w(1018:1094)
 w(5902:5956) = u(12)*w(1040:1094)
 w(5957:5994) = u(13)*w(1057:1094)
 w(5995:6019) = u(14)*w(1070:1094)
 w(6020:6034) = u(15)*w(1080:1094)
 w(6035:6041) = u(16)*w(153:159)
 w(6042:6047) = u(17)*w(154:159)
 w(6048:6052) = u(18)*w(155:159)
 w(6053:6056) = u(19)*w(156:159)
 w(6057:6059) = u(20)*w(157:159)
 w(6060:6061) = u(21)*w(158:159)
 w(6062) = u(22)*w(159)
 w(6063) = u(30)*w(0)
 w(6064) = u(31)*w(0)
 w(6065) = u(32)*w(0)
 w(6066) = u(33)*w(0)
 w(6067) = u(34)*w(0)
 w(6068) = u(35)*w(0)
 w(6069) = u(36)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(6070:11044) = u(0)*w(1095:6069)
 w(11045:15084) = u(1)*w(2030:6069)
 w(15085:18332) = u(2)*w(2822:6069)
 w(18333:20915) = u(3)*w(3487:6069)
 w(20916:22945) = u(4)*w(4040:6069)
 w(22946:24520) = u(5)*w(4495:6069)
 w(24521:25725) = u(6)*w(4865:6069)
 w(25726:26633) = u(7)*w(5162:6069)
 w(26634:27306) = u(8)*w(5397:6069)
 w(27307:27796) = u(9)*w(5580:6069)
 w(27797:28146) = u(10)*w(5720:6069)
 w(28147:28391) = u(11)*w(5825:6069)
 w(28392:28559) = u(12)*w(5902:6069)
 w(28560:28672) = u(13)*w(5957:6069)
 w(28673:28747) = u(14)*w(5995:6069)
 w(28748:28797) = u(15)*w(6020:6069)
 w(28798:28804) = u(16)*w(1088:1094)
 w(28805:28811) = u(17)*w(1088:1094)
 w(28812:28818) = u(18)*w(1088:1094)
 w(28819:28825) = u(19)*w(1088:1094)
 w(28826:28832) = u(20)*w(1088:1094)
 w(28833:28839) = u(21)*w(1088:1094)
 w(28840:28846) = u(22)*w(1088:1094)
 w(28847) = u(37)*w(0)
 w(28848) = u(38)*w(0)
 w(28849) = u(39)*w(0)
 w(28850) = u(40)*w(0)
 w(28851) = u(41)*w(0)
 w(28852) = u(42)*w(0)
 w(28853) = u(43)*w(0)
endif
! terms of degree 6
if (6.le.mxd) then
 w(28854:51637) = u(0)*w(6070:28853)
 w(51638:69446) = u(1)*w(11045:28853)
 w(69447:83215) = u(2)*w(15085:28853)
 w(83216:93736) = u(3)*w(18333:28853)
 w(93737:101674) = u(4)*w(20916:28853)
 w(101675:107582) = u(5)*w(22946:28853)
 w(107583:111915) = u(6)*w(24521:28853)
 w(111916:115043) = u(7)*w(25726:28853)
 w(115044:117263) = u(8)*w(26634:28853)
 w(117264:118810) = u(9)*w(27307:28853)
 w(118811:119867) = u(10)*w(27797:28853)
 w(119868:120574) = u(11)*w(28147:28853)
 w(120575:121036) = u(12)*w(28392:28853)
 w(121037:121330) = u(13)*w(28560:28853)
 w(121331:121511) = u(14)*w(28673:28853)
 w(121512:121617) = u(15)*w(28748:28853)
 w(121618:121652) = u(16)*w(6035:6069)
 w(121653:121680) = u(17)*w(6042:6069)
 w(121681:121702) = u(18)*w(6048:6069)
 w(121703:121719) = u(19)*w(6053:6069)
 w(121720:121732) = u(20)*w(6057:6069)
 w(121733:121742) = u(21)*w(6060:6069)
 w(121743:121750) = u(22)*w(6062:6069)
 w(121751:121757) = u(23)*w(1088:1094)
 w(121758:121763) = u(24)*w(1089:1094)
 w(121764:121768) = u(25)*w(1090:1094)
 w(121769:121772) = u(26)*w(1091:1094)
 w(121773:121775) = u(27)*w(1092:1094)
 w(121776:121777) = u(28)*w(1093:1094)
 w(121778) = u(29)*w(1094)
 w(121779) = u(44)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(121780:214705) = u(0)*w(28854:121779)
 w(214706:284847) = u(1)*w(51638:121779)
 w(284848:337180) = u(2)*w(69447:121779)
 w(337181:375744) = u(3)*w(83216:121779)
 w(375745:403787) = u(4)*w(93737:121779)
 w(403788:423892) = u(5)*w(101675:121779)
 w(423893:438089) = u(6)*w(107583:121779)
 w(438090:447953) = u(7)*w(111916:121779)
 w(447954:454689) = u(8)*w(115044:121779)
 w(454690:459205) = u(9)*w(117264:121779)
 w(459206:462174) = u(10)*w(118811:121779)
 w(462175:464086) = u(11)*w(119868:121779)
 w(464087:465291) = u(12)*w(120575:121779)
 w(465292:466034) = u(13)*w(121037:121779)
 w(466035:466483) = u(14)*w(121331:121779)
 w(466484:466751) = u(15)*w(121512:121779)
 w(466752:466807) = u(16)*w(28798:28853)
 w(466808:466856) = u(17)*w(28805:28853)
 w(466857:466898) = u(18)*w(28812:28853)
 w(466899:466933) = u(19)*w(28819:28853)
 w(466934:466961) = u(20)*w(28826:28853)
 w(466962:466982) = u(21)*w(28833:28853)
 w(466983:466996) = u(22)*w(28840:28853)
 w(466997:467003) = u(23)*w(6063:6069)
 w(467004:467010) = u(24)*w(6063:6069)
 w(467011:467017) = u(25)*w(6063:6069)
 w(467018:467024) = u(26)*w(6063:6069)
 w(467025:467031) = u(27)*w(6063:6069)
 w(467032:467038) = u(28)*w(6063:6069)
 w(467039:467045) = u(29)*w(6063:6069)
endif
! terms of degree 8
if (8.le.mxd) then
 w(467046:812311) = u(0)*w(121780:467045)
 w(812312:1064651) = u(1)*w(214706:467045)
 w(1064652:1246849) = u(2)*w(284848:467045)
 w(1246850:1376714) = u(3)*w(337181:467045)
 w(1376715:1468015) = u(4)*w(375745:467045)
 w(1468016:1531273) = u(5)*w(403788:467045)
 w(1531274:1574426) = u(6)*w(423893:467045)
 w(1574427:1603382) = u(7)*w(438090:467045)
 w(1603383:1622474) = u(8)*w(447954:467045)
 w(1622475:1634830) = u(9)*w(454690:467045)
 w(1634831:1642670) = u(10)*w(459206:467045)
 w(1642671:1647541) = u(11)*w(462175:467045)
 w(1647542:1650500) = u(12)*w(464087:467045)
 w(1650501:1652254) = u(13)*w(465292:467045)
 w(1652255:1653265) = u(14)*w(466035:467045)
 w(1653266:1653827) = u(15)*w(466484:467045)
 w(1653828:1653989) = u(16)*w(121618:121779)
 w(1653990:1654116) = u(17)*w(121653:121779)
 w(1654117:1654215) = u(18)*w(121681:121779)
 w(1654216:1654292) = u(19)*w(121703:121779)
 w(1654293:1654352) = u(20)*w(121720:121779)
 w(1654353:1654399) = u(21)*w(121733:121779)
 w(1654400:1654436) = u(22)*w(121743:121779)
 w(1654437:1654443) = u(23)*w(28847:28853)
 w(1654444:1654450) = u(24)*w(28847:28853)
 w(1654451:1654457) = u(25)*w(28847:28853)
 w(1654458:1654464) = u(26)*w(28847:28853)
 w(1654465:1654471) = u(27)*w(28847:28853)
 w(1654472:1654478) = u(28)*w(28847:28853)
 w(1654479:1654485) = u(29)*w(28847:28853)
 w(1654486:1654492) = u(30)*w(6063:6069)
 w(1654493:1654498) = u(31)*w(6064:6069)
 w(1654499:1654503) = u(32)*w(6065:6069)
 w(1654504:1654507) = u(33)*w(6066:6069)
 w(1654508:1654510) = u(34)*w(6067:6069)
 w(1654511:1654512) = u(35)*w(6068:6069)
 w(1654513) = u(36)*w(6069)
endif
! terms of degree 9
if (9.le.mxd) then
 w(1654514:2841981) = u(0)*w(467046:1654513)
 w(2841982:3684183) = u(1)*w(812312:1654513)
 w(3684184:4274045) = u(2)*w(1064652:1654513)
 w(4274046:4681709) = u(3)*w(1246850:1654513)
 w(4681710:4959508) = u(4)*w(1376715:1654513)
 w(4959509:5146006) = u(5)*w(1468016:1654513)
 w(5146007:5269246) = u(6)*w(1531274:1654513)
 w(5269247:5349333) = u(7)*w(1574427:1654513)
 w(5349334:5400464) = u(8)*w(1603383:1654513)
 w(5400465:5432503) = u(9)*w(1622475:1654513)
 w(5432504:5452186) = u(10)*w(1634831:1654513)
 w(5452187:5464029) = u(11)*w(1642671:1654513)
 w(5464030:5471001) = u(12)*w(1647542:1654513)
 w(5471002:5475014) = u(13)*w(1650501:1654513)
 w(5475015:5477273) = u(14)*w(1652255:1654513)
 w(5477274:5478521) = u(15)*w(1653266:1654513)
 w(5478522:5478815) = u(16)*w(466752:467045)
 w(5478816:5479053) = u(17)*w(466808:467045)
 w(5479054:5479242) = u(18)*w(466857:467045)
 w(5479243:5479389) = u(19)*w(466899:467045)
 w(5479390:5479501) = u(20)*w(466934:467045)
 w(5479502:5479585) = u(21)*w(466962:467045)
 w(5479586:5479648) = u(22)*w(466983:467045)
 w(5479649:5479677) = u(23)*w(121751:121779)
 w(5479678:5479699) = u(24)*w(121758:121779)
 w(5479700:5479715) = u(25)*w(121764:121779)
 w(5479716:5479726) = u(26)*w(121769:121779)
 w(5479727:5479733) = u(27)*w(121773:121779)
 w(5479734:5479737) = u(28)*w(121776:121779)
 w(5479738:5479739) = u(29)*w(121778:121779)
 w(5479740:5479746) = u(30)*w(28847:28853)
 w(5479747:5479753) = u(31)*w(28847:28853)
 w(5479754:5479760) = u(32)*w(28847:28853)
 w(5479761:5479767) = u(33)*w(28847:28853)
 w(5479768:5479774) = u(34)*w(28847:28853)
 w(5479775:5479781) = u(35)*w(28847:28853)
 w(5479782:5479788) = u(36)*w(28847:28853)
endif
END SUBROUTINE mg511111_prib
