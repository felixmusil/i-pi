SUBROUTINE mg111111_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg111111_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg111111_prib: bad size u'
!! else if (size(w).ne.mg111111_npb(mxd)) then
!!  stop 'mg111111_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 15 0 0 0 0 0 0 0 0
! prib,  dnpb(0:*): 1 15 120 680 3060 11628 38760 116280 319770 817190
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
 w(10) = u(9)*w(0)
 w(11) = u(10)*w(0)
 w(12) = u(11)*w(0)
 w(13) = u(12)*w(0)
 w(14) = u(13)*w(0)
 w(15) = u(14)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(16:30) = u(0)*w(1:15)
 w(31:44) = u(1)*w(2:15)
 w(45:57) = u(2)*w(3:15)
 w(58:69) = u(3)*w(4:15)
 w(70:80) = u(4)*w(5:15)
 w(81:90) = u(5)*w(6:15)
 w(91:99) = u(6)*w(7:15)
 w(100:107) = u(7)*w(8:15)
 w(108:114) = u(8)*w(9:15)
 w(115:120) = u(9)*w(10:15)
 w(121:125) = u(10)*w(11:15)
 w(126:129) = u(11)*w(12:15)
 w(130:132) = u(12)*w(13:15)
 w(133:134) = u(13)*w(14:15)
 w(135) = u(14)*w(15)
endif
! terms of degree 3
if (3.le.mxd) then
 w(136:255) = u(0)*w(16:135)
 w(256:360) = u(1)*w(31:135)
 w(361:451) = u(2)*w(45:135)
 w(452:529) = u(3)*w(58:135)
 w(530:595) = u(4)*w(70:135)
 w(596:650) = u(5)*w(81:135)
 w(651:695) = u(6)*w(91:135)
 w(696:731) = u(7)*w(100:135)
 w(732:759) = u(8)*w(108:135)
 w(760:780) = u(9)*w(115:135)
 w(781:795) = u(10)*w(121:135)
 w(796:805) = u(11)*w(126:135)
 w(806:811) = u(12)*w(130:135)
 w(812:814) = u(13)*w(133:135)
 w(815) = u(14)*w(135)
endif
! terms of degree 4
if (4.le.mxd) then
 w(816:1495) = u(0)*w(136:815)
 w(1496:2055) = u(1)*w(256:815)
 w(2056:2510) = u(2)*w(361:815)
 w(2511:2874) = u(3)*w(452:815)
 w(2875:3160) = u(4)*w(530:815)
 w(3161:3380) = u(5)*w(596:815)
 w(3381:3545) = u(6)*w(651:815)
 w(3546:3665) = u(7)*w(696:815)
 w(3666:3749) = u(8)*w(732:815)
 w(3750:3805) = u(9)*w(760:815)
 w(3806:3840) = u(10)*w(781:815)
 w(3841:3860) = u(11)*w(796:815)
 w(3861:3870) = u(12)*w(806:815)
 w(3871:3874) = u(13)*w(812:815)
 w(3875) = u(14)*w(815)
endif
! terms of degree 5
if (5.le.mxd) then
 w(3876:6935) = u(0)*w(816:3875)
 w(6936:9315) = u(1)*w(1496:3875)
 w(9316:11135) = u(2)*w(2056:3875)
 w(11136:12500) = u(3)*w(2511:3875)
 w(12501:13501) = u(4)*w(2875:3875)
 w(13502:14216) = u(5)*w(3161:3875)
 w(14217:14711) = u(6)*w(3381:3875)
 w(14712:15041) = u(7)*w(3546:3875)
 w(15042:15251) = u(8)*w(3666:3875)
 w(15252:15377) = u(9)*w(3750:3875)
 w(15378:15447) = u(10)*w(3806:3875)
 w(15448:15482) = u(11)*w(3841:3875)
 w(15483:15497) = u(12)*w(3861:3875)
 w(15498:15502) = u(13)*w(3871:3875)
 w(15503) = u(14)*w(3875)
endif
! terms of degree 6
if (6.le.mxd) then
 w(15504:27131) = u(0)*w(3876:15503)
 w(27132:35699) = u(1)*w(6936:15503)
 w(35700:41887) = u(2)*w(9316:15503)
 w(41888:46255) = u(3)*w(11136:15503)
 w(46256:49258) = u(4)*w(12501:15503)
 w(49259:51260) = u(5)*w(13502:15503)
 w(51261:52547) = u(6)*w(14217:15503)
 w(52548:53339) = u(7)*w(14712:15503)
 w(53340:53801) = u(8)*w(15042:15503)
 w(53802:54053) = u(9)*w(15252:15503)
 w(54054:54179) = u(10)*w(15378:15503)
 w(54180:54235) = u(11)*w(15448:15503)
 w(54236:54256) = u(12)*w(15483:15503)
 w(54257:54262) = u(13)*w(15498:15503)
 w(54263) = u(14)*w(15503)
endif
! terms of degree 7
if (7.le.mxd) then
 w(54264:93023) = u(0)*w(15504:54263)
 w(93024:120155) = u(1)*w(27132:54263)
 w(120156:138719) = u(2)*w(35700:54263)
 w(138720:151095) = u(3)*w(41888:54263)
 w(151096:159103) = u(4)*w(46256:54263)
 w(159104:164108) = u(5)*w(49259:54263)
 w(164109:167111) = u(6)*w(51261:54263)
 w(167112:168827) = u(7)*w(52548:54263)
 w(168828:169751) = u(8)*w(53340:54263)
 w(169752:170213) = u(9)*w(53802:54263)
 w(170214:170423) = u(10)*w(54054:54263)
 w(170424:170507) = u(11)*w(54180:54263)
 w(170508:170535) = u(12)*w(54236:54263)
 w(170536:170542) = u(13)*w(54257:54263)
 w(170543) = u(14)*w(54263)
endif
! terms of degree 8
if (8.le.mxd) then
 w(170544:286823) = u(0)*w(54264:170543)
 w(286824:364343) = u(1)*w(93024:170543)
 w(364344:414731) = u(2)*w(120156:170543)
 w(414732:446555) = u(3)*w(138720:170543)
 w(446556:466003) = u(4)*w(151096:170543)
 w(466004:477443) = u(5)*w(159104:170543)
 w(477444:483878) = u(6)*w(164109:170543)
 w(483879:487310) = u(7)*w(167112:170543)
 w(487311:489026) = u(8)*w(168828:170543)
 w(489027:489818) = u(9)*w(169752:170543)
 w(489819:490148) = u(10)*w(170214:170543)
 w(490149:490268) = u(11)*w(170424:170543)
 w(490269:490304) = u(12)*w(170508:170543)
 w(490305:490312) = u(13)*w(170536:170543)
 w(490313) = u(14)*w(170543)
endif
! terms of degree 9
if (9.le.mxd) then
 w(490314:810083) = u(0)*w(170544:490313)
 w(810084:1013573) = u(1)*w(286824:490313)
 w(1013574:1139543) = u(2)*w(364344:490313)
 w(1139544:1215125) = u(3)*w(414732:490313)
 w(1215126:1258883) = u(4)*w(446556:490313)
 w(1258884:1283193) = u(5)*w(466004:490313)
 w(1283194:1296063) = u(6)*w(477444:490313)
 w(1296064:1302498) = u(7)*w(483879:490313)
 w(1302499:1305501) = u(8)*w(487311:490313)
 w(1305502:1306788) = u(9)*w(489027:490313)
 w(1306789:1307283) = u(10)*w(489819:490313)
 w(1307284:1307448) = u(11)*w(490149:490313)
 w(1307449:1307493) = u(12)*w(490269:490313)
 w(1307494:1307502) = u(13)*w(490305:490313)
 w(1307503) = u(14)*w(490313)
endif
END SUBROUTINE mg111111_prib
