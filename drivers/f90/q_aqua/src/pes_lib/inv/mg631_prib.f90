SUBROUTINE mg631_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg631_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg631_prib: bad size u'
!! else if (size(w).ne.mg631_npb(mxd)) then
!!  stop 'mg631_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 5 8 10 8 6 5 0 0 0
! prib,  dnpb(0:*): 1 5 23 85 284 862 2454 6576 16819 41223
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(6:10) = u(0)*w(1:5)
 w(11:14) = u(1)*w(2:5)
 w(15:17) = u(2)*w(3:5)
 w(18:19) = u(3)*w(4:5)
 w(20) = u(4)*w(5)
 w(21) = u(5)*w(0)
 w(22) = u(6)*w(0)
 w(23) = u(7)*w(0)
 w(24) = u(8)*w(0)
 w(25) = u(9)*w(0)
 w(26) = u(10)*w(0)
 w(27) = u(11)*w(0)
 w(28) = u(12)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(29:51) = u(0)*w(6:28)
 w(52:69) = u(1)*w(11:28)
 w(70:83) = u(2)*w(15:28)
 w(84:94) = u(3)*w(18:28)
 w(95:103) = u(4)*w(20:28)
 w(104) = u(13)*w(0)
 w(105) = u(14)*w(0)
 w(106) = u(15)*w(0)
 w(107) = u(16)*w(0)
 w(108) = u(17)*w(0)
 w(109) = u(18)*w(0)
 w(110) = u(19)*w(0)
 w(111) = u(20)*w(0)
 w(112) = u(21)*w(0)
 w(113) = u(22)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(114:198) = u(0)*w(29:113)
 w(199:260) = u(1)*w(52:113)
 w(261:304) = u(2)*w(70:113)
 w(305:334) = u(3)*w(84:113)
 w(335:353) = u(4)*w(95:113)
 w(354:361) = u(5)*w(21:28)
 w(362:368) = u(6)*w(22:28)
 w(369:374) = u(7)*w(23:28)
 w(375:379) = u(8)*w(24:28)
 w(380:383) = u(9)*w(25:28)
 w(384:386) = u(10)*w(26:28)
 w(387:388) = u(11)*w(27:28)
 w(389) = u(12)*w(28)
 w(390) = u(23)*w(0)
 w(391) = u(24)*w(0)
 w(392) = u(25)*w(0)
 w(393) = u(26)*w(0)
 w(394) = u(27)*w(0)
 w(395) = u(28)*w(0)
 w(396) = u(29)*w(0)
 w(397) = u(30)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(398:681) = u(0)*w(114:397)
 w(682:880) = u(1)*w(199:397)
 w(881:1017) = u(2)*w(261:397)
 w(1018:1110) = u(3)*w(305:397)
 w(1111:1173) = u(4)*w(335:397)
 w(1174:1183) = u(5)*w(104:113)
 w(1184:1193) = u(6)*w(104:113)
 w(1194:1203) = u(7)*w(104:113)
 w(1204:1213) = u(8)*w(104:113)
 w(1214:1223) = u(9)*w(104:113)
 w(1224:1233) = u(10)*w(104:113)
 w(1234:1243) = u(11)*w(104:113)
 w(1244:1253) = u(12)*w(104:113)
 w(1254) = u(31)*w(0)
 w(1255) = u(32)*w(0)
 w(1256) = u(33)*w(0)
 w(1257) = u(34)*w(0)
 w(1258) = u(35)*w(0)
 w(1259) = u(36)*w(0)
endif
! terms of degree 6
if (6.le.mxd) then
 w(1260:2121) = u(0)*w(398:1259)
 w(2122:2699) = u(1)*w(682:1259)
 w(2700:3078) = u(2)*w(881:1259)
 w(3079:3320) = u(3)*w(1018:1259)
 w(3321:3469) = u(4)*w(1111:1259)
 w(3470:3513) = u(5)*w(354:397)
 w(3514:3549) = u(6)*w(362:397)
 w(3550:3578) = u(7)*w(369:397)
 w(3579:3601) = u(8)*w(375:397)
 w(3602:3619) = u(9)*w(380:397)
 w(3620:3633) = u(10)*w(384:397)
 w(3634:3644) = u(11)*w(387:397)
 w(3645:3653) = u(12)*w(389:397)
 w(3654:3663) = u(13)*w(104:113)
 w(3664:3672) = u(14)*w(105:113)
 w(3673:3680) = u(15)*w(106:113)
 w(3681:3687) = u(16)*w(107:113)
 w(3688:3693) = u(17)*w(108:113)
 w(3694:3698) = u(18)*w(109:113)
 w(3699:3702) = u(19)*w(110:113)
 w(3703:3705) = u(20)*w(111:113)
 w(3706:3707) = u(21)*w(112:113)
 w(3708) = u(22)*w(113)
 w(3709) = u(37)*w(0)
 w(3710) = u(38)*w(0)
 w(3711) = u(39)*w(0)
 w(3712) = u(40)*w(0)
 w(3713) = u(41)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(3714:6167) = u(0)*w(1260:3713)
 w(6168:7759) = u(1)*w(2122:3713)
 w(7760:8773) = u(2)*w(2700:3713)
 w(8774:9408) = u(3)*w(3079:3713)
 w(9409:9801) = u(4)*w(3321:3713)
 w(9802:9887) = u(5)*w(1174:1259)
 w(9888:9963) = u(6)*w(1184:1259)
 w(9964:10029) = u(7)*w(1194:1259)
 w(10030:10085) = u(8)*w(1204:1259)
 w(10086:10131) = u(9)*w(1214:1259)
 w(10132:10167) = u(10)*w(1224:1259)
 w(10168:10193) = u(11)*w(1234:1259)
 w(10194:10209) = u(12)*w(1244:1259)
 w(10210:10217) = u(13)*w(390:397)
 w(10218:10225) = u(14)*w(390:397)
 w(10226:10233) = u(15)*w(390:397)
 w(10234:10241) = u(16)*w(390:397)
 w(10242:10249) = u(17)*w(390:397)
 w(10250:10257) = u(18)*w(390:397)
 w(10258:10265) = u(19)*w(390:397)
 w(10266:10273) = u(20)*w(390:397)
 w(10274:10281) = u(21)*w(390:397)
 w(10282:10289) = u(22)*w(390:397)
endif
! terms of degree 8
if (8.le.mxd) then
 w(10290:16865) = u(0)*w(3714:10289)
 w(16866:20987) = u(1)*w(6168:10289)
 w(20988:23517) = u(2)*w(7760:10289)
 w(23518:25033) = u(3)*w(8774:10289)
 w(25034:25914) = u(4)*w(9409:10289)
 w(25915:26158) = u(5)*w(3470:3713)
 w(26159:26358) = u(6)*w(3514:3713)
 w(26359:26522) = u(7)*w(3550:3713)
 w(26523:26657) = u(8)*w(3579:3713)
 w(26658:26769) = u(9)*w(3602:3713)
 w(26770:26863) = u(10)*w(3620:3713)
 w(26864:26943) = u(11)*w(3634:3713)
 w(26944:27012) = u(12)*w(3645:3713)
 w(27013:27018) = u(13)*w(1254:1259)
 w(27019:27024) = u(14)*w(1254:1259)
 w(27025:27030) = u(15)*w(1254:1259)
 w(27031:27036) = u(16)*w(1254:1259)
 w(27037:27042) = u(17)*w(1254:1259)
 w(27043:27048) = u(18)*w(1254:1259)
 w(27049:27054) = u(19)*w(1254:1259)
 w(27055:27060) = u(20)*w(1254:1259)
 w(27061:27066) = u(21)*w(1254:1259)
 w(27067:27072) = u(22)*w(1254:1259)
 w(27073:27080) = u(23)*w(390:397)
 w(27081:27087) = u(24)*w(391:397)
 w(27088:27093) = u(25)*w(392:397)
 w(27094:27098) = u(26)*w(393:397)
 w(27099:27102) = u(27)*w(394:397)
 w(27103:27105) = u(28)*w(395:397)
 w(27106:27107) = u(29)*w(396:397)
 w(27108) = u(30)*w(397)
endif
! terms of degree 9
if (9.le.mxd) then
 w(27109:43927) = u(0)*w(10290:27108)
 w(43928:54170) = u(1)*w(16866:27108)
 w(54171:60291) = u(2)*w(20988:27108)
 w(60292:63882) = u(3)*w(23518:27108)
 w(63883:65957) = u(4)*w(25034:27108)
 w(65958:66445) = u(5)*w(9802:10289)
 w(66446:66847) = u(6)*w(9888:10289)
 w(66848:67173) = u(7)*w(9964:10289)
 w(67174:67433) = u(8)*w(10030:10289)
 w(67434:67637) = u(9)*w(10086:10289)
 w(67638:67795) = u(10)*w(10132:10289)
 w(67796:67917) = u(11)*w(10168:10289)
 w(67918:68013) = u(12)*w(10194:10289)
 w(68014:68073) = u(13)*w(3654:3713)
 w(68074:68123) = u(14)*w(3664:3713)
 w(68124:68164) = u(15)*w(3673:3713)
 w(68165:68197) = u(16)*w(3681:3713)
 w(68198:68223) = u(17)*w(3688:3713)
 w(68224:68243) = u(18)*w(3694:3713)
 w(68244:68258) = u(19)*w(3699:3713)
 w(68259:68269) = u(20)*w(3703:3713)
 w(68270:68277) = u(21)*w(3706:3713)
 w(68278:68283) = u(22)*w(3708:3713)
 w(68284:68289) = u(23)*w(1254:1259)
 w(68290:68295) = u(24)*w(1254:1259)
 w(68296:68301) = u(25)*w(1254:1259)
 w(68302:68307) = u(26)*w(1254:1259)
 w(68308:68313) = u(27)*w(1254:1259)
 w(68314:68319) = u(28)*w(1254:1259)
 w(68320:68325) = u(29)*w(1254:1259)
 w(68326:68331) = u(30)*w(1254:1259)
endif
END SUBROUTINE mg631_prib
