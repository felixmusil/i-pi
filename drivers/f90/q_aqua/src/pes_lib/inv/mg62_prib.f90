SUBROUTINE mg62_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg62_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg62_prib: bad size u'
!! else if (size(w).ne.mg62_npb(mxd)) then
!!  stop 'mg62_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 3 5 6 5 4 4 0 0 0
! prib,  dnpb(0:*): 1 3 11 31 83 201 470 1030 2190 4470
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(4:6) = u(0)*w(1:3)
 w(7:8) = u(1)*w(2:3)
 w(9) = u(2)*w(3)
 w(10) = u(3)*w(0)
 w(11) = u(4)*w(0)
 w(12) = u(5)*w(0)
 w(13) = u(6)*w(0)
 w(14) = u(7)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(15:25) = u(0)*w(4:14)
 w(26:33) = u(1)*w(7:14)
 w(34:39) = u(2)*w(9:14)
 w(40) = u(8)*w(0)
 w(41) = u(9)*w(0)
 w(42) = u(10)*w(0)
 w(43) = u(11)*w(0)
 w(44) = u(12)*w(0)
 w(45) = u(13)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(46:76) = u(0)*w(15:45)
 w(77:96) = u(1)*w(26:45)
 w(97:108) = u(2)*w(34:45)
 w(109:113) = u(3)*w(10:14)
 w(114:117) = u(4)*w(11:14)
 w(118:120) = u(5)*w(12:14)
 w(121:122) = u(6)*w(13:14)
 w(123) = u(7)*w(14)
 w(124) = u(14)*w(0)
 w(125) = u(15)*w(0)
 w(126) = u(16)*w(0)
 w(127) = u(17)*w(0)
 w(128) = u(18)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(129:211) = u(0)*w(46:128)
 w(212:263) = u(1)*w(77:128)
 w(264:295) = u(2)*w(97:128)
 w(296:301) = u(3)*w(40:45)
 w(302:307) = u(4)*w(40:45)
 w(308:313) = u(5)*w(40:45)
 w(314:319) = u(6)*w(40:45)
 w(320:325) = u(7)*w(40:45)
 w(326) = u(19)*w(0)
 w(327) = u(20)*w(0)
 w(328) = u(21)*w(0)
 w(329) = u(22)*w(0)
endif
! terms of degree 6
if (6.le.mxd) then
 w(330:530) = u(0)*w(129:329)
 w(531:648) = u(1)*w(212:329)
 w(649:714) = u(2)*w(264:329)
 w(715:734) = u(3)*w(109:128)
 w(735:749) = u(4)*w(114:128)
 w(750:760) = u(5)*w(118:128)
 w(761:768) = u(6)*w(121:128)
 w(769:774) = u(7)*w(123:128)
 w(775:780) = u(8)*w(40:45)
 w(781:785) = u(9)*w(41:45)
 w(786:789) = u(10)*w(42:45)
 w(790:792) = u(11)*w(43:45)
 w(793:794) = u(12)*w(44:45)
 w(795) = u(13)*w(45)
 w(796) = u(23)*w(0)
 w(797) = u(24)*w(0)
 w(798) = u(25)*w(0)
 w(799) = u(26)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(800:1269) = u(0)*w(330:799)
 w(1270:1538) = u(1)*w(531:799)
 w(1539:1689) = u(2)*w(649:799)
 w(1690:1723) = u(3)*w(296:329)
 w(1724:1751) = u(4)*w(302:329)
 w(1752:1773) = u(5)*w(308:329)
 w(1774:1789) = u(6)*w(314:329)
 w(1790:1799) = u(7)*w(320:329)
 w(1800:1804) = u(8)*w(124:128)
 w(1805:1809) = u(9)*w(124:128)
 w(1810:1814) = u(10)*w(124:128)
 w(1815:1819) = u(11)*w(124:128)
 w(1820:1824) = u(12)*w(124:128)
 w(1825:1829) = u(13)*w(124:128)
endif
! terms of degree 8
if (8.le.mxd) then
 w(1830:2859) = u(0)*w(800:1829)
 w(2860:3419) = u(1)*w(1270:1829)
 w(3420:3710) = u(2)*w(1539:1829)
 w(3711:3795) = u(3)*w(715:799)
 w(3796:3860) = u(4)*w(735:799)
 w(3861:3910) = u(5)*w(750:799)
 w(3911:3949) = u(6)*w(761:799)
 w(3950:3980) = u(7)*w(769:799)
 w(3981:3984) = u(8)*w(326:329)
 w(3985:3988) = u(9)*w(326:329)
 w(3989:3992) = u(10)*w(326:329)
 w(3993:3996) = u(11)*w(326:329)
 w(3997:4000) = u(12)*w(326:329)
 w(4001:4004) = u(13)*w(326:329)
 w(4005:4009) = u(14)*w(124:128)
 w(4010:4013) = u(15)*w(125:128)
 w(4014:4016) = u(16)*w(126:128)
 w(4017:4018) = u(17)*w(127:128)
 w(4019) = u(18)*w(128)
endif
! terms of degree 9
if (9.le.mxd) then
 w(4020:6209) = u(0)*w(1830:4019)
 w(6210:7369) = u(1)*w(2860:4019)
 w(7370:7969) = u(2)*w(3420:4019)
 w(7970:8109) = u(3)*w(1690:1829)
 w(8110:8215) = u(4)*w(1724:1829)
 w(8216:8293) = u(5)*w(1752:1829)
 w(8294:8349) = u(6)*w(1774:1829)
 w(8350:8389) = u(7)*w(1790:1829)
 w(8390:8414) = u(8)*w(775:799)
 w(8415:8433) = u(9)*w(781:799)
 w(8434:8447) = u(10)*w(786:799)
 w(8448:8457) = u(11)*w(790:799)
 w(8458:8464) = u(12)*w(793:799)
 w(8465:8469) = u(13)*w(795:799)
 w(8470:8473) = u(14)*w(326:329)
 w(8474:8477) = u(15)*w(326:329)
 w(8478:8481) = u(16)*w(326:329)
 w(8482:8485) = u(17)*w(326:329)
 w(8486:8489) = u(18)*w(326:329)
endif
END SUBROUTINE mg62_prib
