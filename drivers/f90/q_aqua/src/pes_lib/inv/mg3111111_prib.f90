SUBROUTINE mg3111111_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg3111111_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg3111111_prib: bad size u'
!! else if (size(w).ne.mg3111111_npb(mxd)) then
!!  stop 'mg3111111_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 22 7 7 0 0 0 0 0 0
! prib,  dnpb(0:*): 1 22 260 2185 14603 82384 407002 1804779 7311105 27415070
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
 w(10) = u(9)*w(0)
 w(11) = u(10)*w(0)
 w(12) = u(11)*w(0)
 w(13) = u(12)*w(0)
 w(14) = u(13)*w(0)
 w(15) = u(14)*w(0)
 w(16) = u(15)*w(0)
 w(17) = u(16)*w(0)
 w(18) = u(17)*w(0)
 w(19) = u(18)*w(0)
 w(20) = u(19)*w(0)
 w(21) = u(20)*w(0)
 w(22) = u(21)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(23:44) = u(0)*w(1:22)
 w(45:65) = u(1)*w(2:22)
 w(66:85) = u(2)*w(3:22)
 w(86:104) = u(3)*w(4:22)
 w(105:122) = u(4)*w(5:22)
 w(123:139) = u(5)*w(6:22)
 w(140:155) = u(6)*w(7:22)
 w(156:170) = u(7)*w(8:22)
 w(171:184) = u(8)*w(9:22)
 w(185:197) = u(9)*w(10:22)
 w(198:209) = u(10)*w(11:22)
 w(210:220) = u(11)*w(12:22)
 w(221:230) = u(12)*w(13:22)
 w(231:239) = u(13)*w(14:22)
 w(240:247) = u(14)*w(15:22)
 w(248:254) = u(15)*w(16:22)
 w(255:260) = u(16)*w(17:22)
 w(261:265) = u(17)*w(18:22)
 w(266:269) = u(18)*w(19:22)
 w(270:272) = u(19)*w(20:22)
 w(273:274) = u(20)*w(21:22)
 w(275) = u(21)*w(22)
 w(276) = u(22)*w(0)
 w(277) = u(23)*w(0)
 w(278) = u(24)*w(0)
 w(279) = u(25)*w(0)
 w(280) = u(26)*w(0)
 w(281) = u(27)*w(0)
 w(282) = u(28)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(283:542) = u(0)*w(23:282)
 w(543:780) = u(1)*w(45:282)
 w(781:997) = u(2)*w(66:282)
 w(998:1194) = u(3)*w(86:282)
 w(1195:1372) = u(4)*w(105:282)
 w(1373:1532) = u(5)*w(123:282)
 w(1533:1675) = u(6)*w(140:282)
 w(1676:1802) = u(7)*w(156:282)
 w(1803:1914) = u(8)*w(171:282)
 w(1915:2012) = u(9)*w(185:282)
 w(2013:2097) = u(10)*w(198:282)
 w(2098:2170) = u(11)*w(210:282)
 w(2171:2232) = u(12)*w(221:282)
 w(2233:2284) = u(13)*w(231:282)
 w(2285:2327) = u(14)*w(240:282)
 w(2328:2362) = u(15)*w(248:282)
 w(2363:2390) = u(16)*w(255:282)
 w(2391:2412) = u(17)*w(261:282)
 w(2413:2429) = u(18)*w(266:282)
 w(2430:2442) = u(19)*w(270:282)
 w(2443:2452) = u(20)*w(273:282)
 w(2453:2460) = u(21)*w(275:282)
 w(2461) = u(29)*w(0)
 w(2462) = u(30)*w(0)
 w(2463) = u(31)*w(0)
 w(2464) = u(32)*w(0)
 w(2465) = u(33)*w(0)
 w(2466) = u(34)*w(0)
 w(2467) = u(35)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(2468:4652) = u(0)*w(283:2467)
 w(4653:6577) = u(1)*w(543:2467)
 w(6578:8264) = u(2)*w(781:2467)
 w(8265:9734) = u(3)*w(998:2467)
 w(9735:11007) = u(4)*w(1195:2467)
 w(11008:12102) = u(5)*w(1373:2467)
 w(12103:13037) = u(6)*w(1533:2467)
 w(13038:13829) = u(7)*w(1676:2467)
 w(13830:14494) = u(8)*w(1803:2467)
 w(14495:15047) = u(9)*w(1915:2467)
 w(15048:15502) = u(10)*w(2013:2467)
 w(15503:15872) = u(11)*w(2098:2467)
 w(15873:16169) = u(12)*w(2171:2467)
 w(16170:16404) = u(13)*w(2233:2467)
 w(16405:16587) = u(14)*w(2285:2467)
 w(16588:16727) = u(15)*w(2328:2467)
 w(16728:16832) = u(16)*w(2363:2467)
 w(16833:16909) = u(17)*w(2391:2467)
 w(16910:16964) = u(18)*w(2413:2467)
 w(16965:17002) = u(19)*w(2430:2467)
 w(17003:17027) = u(20)*w(2443:2467)
 w(17028:17042) = u(21)*w(2453:2467)
 w(17043:17049) = u(22)*w(276:282)
 w(17050:17055) = u(23)*w(277:282)
 w(17056:17060) = u(24)*w(278:282)
 w(17061:17064) = u(25)*w(279:282)
 w(17065:17067) = u(26)*w(280:282)
 w(17068:17069) = u(27)*w(281:282)
 w(17070) = u(28)*w(282)
endif
! terms of degree 5
if (5.le.mxd) then
 w(17071:31673) = u(0)*w(2468:17070)
 w(31674:44091) = u(1)*w(4653:17070)
 w(44092:54584) = u(2)*w(6578:17070)
 w(54585:63390) = u(3)*w(8265:17070)
 w(63391:70726) = u(4)*w(9735:17070)
 w(70727:76789) = u(5)*w(11008:17070)
 w(76790:81757) = u(6)*w(12103:17070)
 w(81758:85790) = u(7)*w(13038:17070)
 w(85791:89031) = u(8)*w(13830:17070)
 w(89032:91607) = u(9)*w(14495:17070)
 w(91608:93630) = u(10)*w(15048:17070)
 w(93631:95198) = u(11)*w(15503:17070)
 w(95199:96396) = u(12)*w(15873:17070)
 w(96397:97297) = u(13)*w(16170:17070)
 w(97298:97963) = u(14)*w(16405:17070)
 w(97964:98446) = u(15)*w(16588:17070)
 w(98447:98789) = u(16)*w(16728:17070)
 w(98790:99027) = u(17)*w(16833:17070)
 w(99028:99188) = u(18)*w(16910:17070)
 w(99189:99294) = u(19)*w(16965:17070)
 w(99295:99362) = u(20)*w(17003:17070)
 w(99363:99405) = u(21)*w(17028:17070)
 w(99406:99412) = u(22)*w(2461:2467)
 w(99413:99419) = u(23)*w(2461:2467)
 w(99420:99426) = u(24)*w(2461:2467)
 w(99427:99433) = u(25)*w(2461:2467)
 w(99434:99440) = u(26)*w(2461:2467)
 w(99441:99447) = u(27)*w(2461:2467)
 w(99448:99454) = u(28)*w(2461:2467)
endif
! terms of degree 6
if (6.le.mxd) then
 w(99455:181838) = u(0)*w(17071:99454)
 w(181839:249619) = u(1)*w(31674:99454)
 w(249620:304982) = u(2)*w(44092:99454)
 w(304983:349852) = u(3)*w(54585:99454)
 w(349853:385916) = u(4)*w(63391:99454)
 w(385917:414644) = u(5)*w(70727:99454)
 w(414645:437309) = u(6)*w(76790:99454)
 w(437310:455006) = u(7)*w(81758:99454)
 w(455007:468670) = u(8)*w(85791:99454)
 w(468671:479093) = u(9)*w(89032:99454)
 w(479094:486940) = u(10)*w(91608:99454)
 w(486941:492764) = u(11)*w(93631:99454)
 w(492765:497020) = u(12)*w(95199:99454)
 w(497021:500078) = u(13)*w(96397:99454)
 w(500079:502235) = u(14)*w(97298:99454)
 w(502236:503726) = u(15)*w(97964:99454)
 w(503727:504734) = u(16)*w(98447:99454)
 w(504735:505399) = u(17)*w(98790:99454)
 w(505400:505826) = u(18)*w(99028:99454)
 w(505827:506092) = u(19)*w(99189:99454)
 w(506093:506252) = u(20)*w(99295:99454)
 w(506253:506344) = u(21)*w(99363:99454)
 w(506345:506372) = u(22)*w(17043:17070)
 w(506373:506393) = u(23)*w(17050:17070)
 w(506394:506408) = u(24)*w(17056:17070)
 w(506409:506418) = u(25)*w(17061:17070)
 w(506419:506424) = u(26)*w(17065:17070)
 w(506425:506427) = u(27)*w(17068:17070)
 w(506428) = u(28)*w(17070)
 w(506429:506435) = u(29)*w(2461:2467)
 w(506436:506441) = u(30)*w(2462:2467)
 w(506442:506446) = u(31)*w(2463:2467)
 w(506447:506450) = u(32)*w(2464:2467)
 w(506451:506453) = u(33)*w(2465:2467)
 w(506454:506455) = u(34)*w(2466:2467)
 w(506456) = u(35)*w(2467)
endif
! terms of degree 7
if (7.le.mxd) then
 w(506457:913458) = u(0)*w(99455:506456)
 w(913459:1238076) = u(1)*w(181839:506456)
 w(1238077:1494913) = u(2)*w(249620:506456)
 w(1494914:1696387) = u(3)*w(304983:506456)
 w(1696388:1852991) = u(4)*w(349853:506456)
 w(1852992:1973531) = u(5)*w(385917:506456)
 w(1973532:2065343) = u(6)*w(414645:506456)
 w(2065344:2134490) = u(7)*w(437310:506456)
 w(2134491:2185940) = u(8)*w(455007:506456)
 w(2185941:2223726) = u(9)*w(468671:506456)
 w(2223727:2251089) = u(10)*w(479094:506456)
 w(2251090:2270605) = u(11)*w(486941:506456)
 w(2270606:2284297) = u(12)*w(492765:506456)
 w(2284298:2293733) = u(13)*w(497021:506456)
 w(2293734:2300111) = u(14)*w(500079:506456)
 w(2300112:2304332) = u(15)*w(502236:506456)
 w(2304333:2307062) = u(16)*w(503727:506456)
 w(2307063:2308784) = u(17)*w(504735:506456)
 w(2308785:2309841) = u(18)*w(505400:506456)
 w(2309842:2310471) = u(19)*w(505827:506456)
 w(2310472:2310835) = u(20)*w(506093:506456)
 w(2310836:2311039) = u(21)*w(506253:506456)
 w(2311040:2311088) = u(22)*w(99406:99454)
 w(2311089:2311130) = u(23)*w(99413:99454)
 w(2311131:2311165) = u(24)*w(99420:99454)
 w(2311166:2311193) = u(25)*w(99427:99454)
 w(2311194:2311214) = u(26)*w(99434:99454)
 w(2311215:2311228) = u(27)*w(99441:99454)
 w(2311229:2311235) = u(28)*w(99448:99454)
endif
! terms of degree 8
if (8.le.mxd) then
 w(2311236:4116014) = u(0)*w(506457:2311235)
 w(4116015:5513791) = u(1)*w(913459:2311235)
 w(5513792:6586950) = u(2)*w(1238077:2311235)
 w(6586951:7403272) = u(3)*w(1494914:2311235)
 w(7403273:8018120) = u(4)*w(1696388:2311235)
 w(8018121:8476364) = u(5)*w(1852992:2311235)
 w(8476365:8814068) = u(6)*w(1973532:2311235)
 w(8814069:9059960) = u(7)*w(2065344:2311235)
 w(9059961:9236705) = u(8)*w(2134491:2311235)
 w(9236706:9362000) = u(9)*w(2185941:2311235)
 w(9362001:9449509) = u(10)*w(2223727:2311235)
 w(9449510:9509655) = u(11)*w(2251090:2311235)
 w(9509656:9550285) = u(12)*w(2270606:2311235)
 w(9550286:9577223) = u(13)*w(2284298:2311235)
 w(9577224:9594725) = u(14)*w(2293734:2311235)
 w(9594726:9605849) = u(15)*w(2300112:2311235)
 w(9605850:9612752) = u(16)*w(2304333:2311235)
 w(9612753:9616925) = u(17)*w(2307063:2311235)
 w(9616926:9619376) = u(18)*w(2308785:2311235)
 w(9619377:9620770) = u(19)*w(2309842:2311235)
 w(9620771:9621534) = u(20)*w(2310472:2311235)
 w(9621535:9621934) = u(21)*w(2310836:2311235)
 w(9621935:9622046) = u(22)*w(506345:506456)
 w(9622047:9622130) = u(23)*w(506373:506456)
 w(9622131:9622193) = u(24)*w(506394:506456)
 w(9622194:9622241) = u(25)*w(506409:506456)
 w(9622242:9622279) = u(26)*w(506419:506456)
 w(9622280:9622311) = u(27)*w(506425:506456)
 w(9622312:9622340) = u(28)*w(506428:506456)
endif
! terms of degree 9
if (9.le.mxd) then
 w(9622341:16933445) = u(0)*w(2311236:9622340)
 w(16933446:22439771) = u(1)*w(4116015:9622340)
 w(22439772:26548320) = u(2)*w(5513792:9622340)
 w(26548321:29583710) = u(3)*w(6586951:9622340)
 w(29583711:31802778) = u(4)*w(7403273:9622340)
 w(31802779:33406998) = u(5)*w(8018121:9622340)
 w(33406999:34552974) = u(6)*w(8476365:9622340)
 w(34552975:35361246) = u(7)*w(8814069:9622340)
 w(35361247:35923626) = u(8)*w(9059961:9622340)
 w(35923627:36309261) = u(9)*w(9236706:9622340)
 w(36309262:36569601) = u(10)*w(9362001:9622340)
 w(36569602:36742432) = u(11)*w(9449510:9622340)
 w(36742433:36855117) = u(12)*w(9509656:9622340)
 w(36855118:36927172) = u(13)*w(9550286:9622340)
 w(36927173:36972289) = u(14)*w(9577224:9622340)
 w(36972290:36999904) = u(15)*w(9594726:9622340)
 w(36999905:37016395) = u(16)*w(9605850:9622340)
 w(37016396:37025983) = u(17)*w(9612753:9622340)
 w(37025984:37031398) = u(18)*w(9616926:9622340)
 w(37031399:37034362) = u(19)*w(9619377:9622340)
 w(37034363:37035932) = u(20)*w(9620771:9622340)
 w(37035933:37036738) = u(21)*w(9621535:9622340)
 w(37036739:37036934) = u(22)*w(2311040:2311235)
 w(37036935:37037081) = u(23)*w(2311089:2311235)
 w(37037082:37037186) = u(24)*w(2311131:2311235)
 w(37037187:37037256) = u(25)*w(2311166:2311235)
 w(37037257:37037298) = u(26)*w(2311194:2311235)
 w(37037299:37037319) = u(27)*w(2311215:2311235)
 w(37037320:37037326) = u(28)*w(2311229:2311235)
 w(37037327:37037354) = u(29)*w(506429:506456)
 w(37037355:37037375) = u(30)*w(506436:506456)
 w(37037376:37037390) = u(31)*w(506442:506456)
 w(37037391:37037400) = u(32)*w(506447:506456)
 w(37037401:37037406) = u(33)*w(506451:506456)
 w(37037407:37037409) = u(34)*w(506454:506456)
 w(37037410) = u(35)*w(506456)
endif
END SUBROUTINE mg3111111_prib
