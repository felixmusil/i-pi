SUBROUTINE mg21111_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg21111_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg21111_prib: bad size u'
!! else if (size(w).ne.mg21111_npb(mxd)) then
!!  stop 'mg21111_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 11 4 0 0 0 0 0 0 0
! prib,  dnpb(0:*): 1 11 70 330 1275 4257 12692 34540 87155 206305
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
 w(10) = u(9)*w(0)
 w(11) = u(10)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(12:22) = u(0)*w(1:11)
 w(23:32) = u(1)*w(2:11)
 w(33:41) = u(2)*w(3:11)
 w(42:49) = u(3)*w(4:11)
 w(50:56) = u(4)*w(5:11)
 w(57:62) = u(5)*w(6:11)
 w(63:67) = u(6)*w(7:11)
 w(68:71) = u(7)*w(8:11)
 w(72:74) = u(8)*w(9:11)
 w(75:76) = u(9)*w(10:11)
 w(77) = u(10)*w(11)
 w(78) = u(11)*w(0)
 w(79) = u(12)*w(0)
 w(80) = u(13)*w(0)
 w(81) = u(14)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(82:151) = u(0)*w(12:81)
 w(152:210) = u(1)*w(23:81)
 w(211:259) = u(2)*w(33:81)
 w(260:299) = u(3)*w(42:81)
 w(300:331) = u(4)*w(50:81)
 w(332:356) = u(5)*w(57:81)
 w(357:375) = u(6)*w(63:81)
 w(376:389) = u(7)*w(68:81)
 w(390:399) = u(8)*w(72:81)
 w(400:406) = u(9)*w(75:81)
 w(407:411) = u(10)*w(77:81)
endif
! terms of degree 4
if (4.le.mxd) then
 w(412:741) = u(0)*w(82:411)
 w(742:1001) = u(1)*w(152:411)
 w(1002:1202) = u(2)*w(211:411)
 w(1203:1354) = u(3)*w(260:411)
 w(1355:1466) = u(4)*w(300:411)
 w(1467:1546) = u(5)*w(332:411)
 w(1547:1601) = u(6)*w(357:411)
 w(1602:1637) = u(7)*w(376:411)
 w(1638:1659) = u(8)*w(390:411)
 w(1660:1671) = u(9)*w(400:411)
 w(1672:1676) = u(10)*w(407:411)
 w(1677:1680) = u(11)*w(78:81)
 w(1681:1683) = u(12)*w(79:81)
 w(1684:1685) = u(13)*w(80:81)
 w(1686) = u(14)*w(81)
endif
! terms of degree 5
if (5.le.mxd) then
 w(1687:2961) = u(0)*w(412:1686)
 w(2962:3906) = u(1)*w(742:1686)
 w(3907:4591) = u(2)*w(1002:1686)
 w(4592:5075) = u(3)*w(1203:1686)
 w(5076:5407) = u(4)*w(1355:1686)
 w(5408:5627) = u(5)*w(1467:1686)
 w(5628:5767) = u(6)*w(1547:1686)
 w(5768:5852) = u(7)*w(1602:1686)
 w(5853:5901) = u(8)*w(1638:1686)
 w(5902:5928) = u(9)*w(1660:1686)
 w(5929:5943) = u(10)*w(1672:1686)
endif
! terms of degree 6
if (6.le.mxd) then
 w(5944:10200) = u(0)*w(1687:5943)
 w(10201:13182) = u(1)*w(2962:5943)
 w(13183:15219) = u(2)*w(3907:5943)
 w(15220:16571) = u(3)*w(4592:5943)
 w(16572:17439) = u(4)*w(5076:5943)
 w(17440:17975) = u(5)*w(5408:5943)
 w(17976:18291) = u(6)*w(5628:5943)
 w(18292:18467) = u(7)*w(5768:5943)
 w(18468:18558) = u(8)*w(5853:5943)
 w(18559:18600) = u(9)*w(5902:5943)
 w(18601:18615) = u(10)*w(5929:5943)
 w(18616:18625) = u(11)*w(1677:1686)
 w(18626:18631) = u(12)*w(1681:1686)
 w(18632:18634) = u(13)*w(1684:1686)
 w(18635) = u(14)*w(1686)
endif
! terms of degree 7
if (7.le.mxd) then
 w(18636:31327) = u(0)*w(5944:18635)
 w(31328:39762) = u(1)*w(10201:18635)
 w(39763:45215) = u(2)*w(13183:18635)
 w(45216:48631) = u(3)*w(15220:18635)
 w(48632:50695) = u(4)*w(16572:18635)
 w(50696:51891) = u(5)*w(17440:18635)
 w(51892:52551) = u(6)*w(17976:18635)
 w(52552:52895) = u(7)*w(18292:18635)
 w(52896:53063) = u(8)*w(18468:18635)
 w(53064:53140) = u(9)*w(18559:18635)
 w(53141:53175) = u(10)*w(18601:18635)
endif
! terms of degree 8
if (8.le.mxd) then
 w(53176:87715) = u(0)*w(18636:53175)
 w(87716:109563) = u(1)*w(31328:53175)
 w(109564:122976) = u(2)*w(39763:53175)
 w(122977:130936) = u(3)*w(45216:53175)
 w(130937:135480) = u(4)*w(48632:53175)
 w(135481:137960) = u(5)*w(50696:53175)
 w(137961:139244) = u(6)*w(51892:53175)
 w(139245:139868) = u(7)*w(52552:53175)
 w(139869:140148) = u(8)*w(52896:53175)
 w(140149:140260) = u(9)*w(53064:53175)
 w(140261:140295) = u(10)*w(53141:53175)
 w(140296:140315) = u(11)*w(18616:18635)
 w(140316:140325) = u(12)*w(18626:18635)
 w(140326:140329) = u(13)*w(18632:18635)
 w(140330) = u(14)*w(18635)
endif
! terms of degree 9
if (9.le.mxd) then
 w(140331:227485) = u(0)*w(53176:140330)
 w(227486:280100) = u(1)*w(87716:140330)
 w(280101:310867) = u(2)*w(109564:140330)
 w(310868:328221) = u(3)*w(122977:140330)
 w(328222:337615) = u(4)*w(130937:140330)
 w(337616:342465) = u(5)*w(135481:140330)
 w(342466:344835) = u(6)*w(137961:140330)
 w(344836:345921) = u(7)*w(139245:140330)
 w(345922:346383) = u(8)*w(139869:140330)
 w(346384:346565) = u(9)*w(140149:140330)
 w(346566:346635) = u(10)*w(140261:140330)
endif
END SUBROUTINE mg21111_prib
