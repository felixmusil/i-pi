SUBROUTINE mg541_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg541_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg541_prib: bad size u'
!! else if (size(w).ne.mg541_npb(mxd)) then
!!  stop 'mg541_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 5 9 11 10 4 2 0 0 0
! prib,  dnpb(0:*): 1 5 24 91 315 984 2888 7960 20932 52668
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(6:10) = u(0)*w(1:5)
 w(11:14) = u(1)*w(2:5)
 w(15:17) = u(2)*w(3:5)
 w(18:19) = u(3)*w(4:5)
 w(20) = u(4)*w(5)
 w(21) = u(5)*w(0)
 w(22) = u(6)*w(0)
 w(23) = u(7)*w(0)
 w(24) = u(8)*w(0)
 w(25) = u(9)*w(0)
 w(26) = u(10)*w(0)
 w(27) = u(11)*w(0)
 w(28) = u(12)*w(0)
 w(29) = u(13)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(30:53) = u(0)*w(6:29)
 w(54:72) = u(1)*w(11:29)
 w(73:87) = u(2)*w(15:29)
 w(88:99) = u(3)*w(18:29)
 w(100:109) = u(4)*w(20:29)
 w(110) = u(14)*w(0)
 w(111) = u(15)*w(0)
 w(112) = u(16)*w(0)
 w(113) = u(17)*w(0)
 w(114) = u(18)*w(0)
 w(115) = u(19)*w(0)
 w(116) = u(20)*w(0)
 w(117) = u(21)*w(0)
 w(118) = u(22)*w(0)
 w(119) = u(23)*w(0)
 w(120) = u(24)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(121:211) = u(0)*w(30:120)
 w(212:278) = u(1)*w(54:120)
 w(279:326) = u(2)*w(73:120)
 w(327:359) = u(3)*w(88:120)
 w(360:380) = u(4)*w(100:120)
 w(381:389) = u(5)*w(21:29)
 w(390:397) = u(6)*w(22:29)
 w(398:404) = u(7)*w(23:29)
 w(405:410) = u(8)*w(24:29)
 w(411:415) = u(9)*w(25:29)
 w(416:419) = u(10)*w(26:29)
 w(420:422) = u(11)*w(27:29)
 w(423:424) = u(12)*w(28:29)
 w(425) = u(13)*w(29)
 w(426) = u(25)*w(0)
 w(427) = u(26)*w(0)
 w(428) = u(27)*w(0)
 w(429) = u(28)*w(0)
 w(430) = u(29)*w(0)
 w(431) = u(30)*w(0)
 w(432) = u(31)*w(0)
 w(433) = u(32)*w(0)
 w(434) = u(33)*w(0)
 w(435) = u(34)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(436:750) = u(0)*w(121:435)
 w(751:974) = u(1)*w(212:435)
 w(975:1131) = u(2)*w(279:435)
 w(1132:1240) = u(3)*w(327:435)
 w(1241:1316) = u(4)*w(360:435)
 w(1317:1327) = u(5)*w(110:120)
 w(1328:1338) = u(6)*w(110:120)
 w(1339:1349) = u(7)*w(110:120)
 w(1350:1360) = u(8)*w(110:120)
 w(1361:1371) = u(9)*w(110:120)
 w(1372:1382) = u(10)*w(110:120)
 w(1383:1393) = u(11)*w(110:120)
 w(1394:1404) = u(12)*w(110:120)
 w(1405:1415) = u(13)*w(110:120)
 w(1416) = u(35)*w(0)
 w(1417) = u(36)*w(0)
 w(1418) = u(37)*w(0)
 w(1419) = u(38)*w(0)
endif
! terms of degree 6
if (6.le.mxd) then
 w(1420:2403) = u(0)*w(436:1419)
 w(2404:3072) = u(1)*w(751:1419)
 w(3073:3517) = u(2)*w(975:1419)
 w(3518:3805) = u(3)*w(1132:1419)
 w(3806:3984) = u(4)*w(1241:1419)
 w(3985:4039) = u(5)*w(381:435)
 w(4040:4085) = u(6)*w(390:435)
 w(4086:4123) = u(7)*w(398:435)
 w(4124:4154) = u(8)*w(405:435)
 w(4155:4179) = u(9)*w(411:435)
 w(4180:4199) = u(10)*w(416:435)
 w(4200:4215) = u(11)*w(420:435)
 w(4216:4228) = u(12)*w(423:435)
 w(4229:4239) = u(13)*w(425:435)
 w(4240:4250) = u(14)*w(110:120)
 w(4251:4260) = u(15)*w(111:120)
 w(4261:4269) = u(16)*w(112:120)
 w(4270:4277) = u(17)*w(113:120)
 w(4278:4284) = u(18)*w(114:120)
 w(4285:4290) = u(19)*w(115:120)
 w(4291:4295) = u(20)*w(116:120)
 w(4296:4299) = u(21)*w(117:120)
 w(4300:4302) = u(22)*w(118:120)
 w(4303:4304) = u(23)*w(119:120)
 w(4305) = u(24)*w(120)
 w(4306) = u(39)*w(0)
 w(4307) = u(40)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(4308:7195) = u(0)*w(1420:4307)
 w(7196:9099) = u(1)*w(2404:4307)
 w(9100:10334) = u(2)*w(3073:4307)
 w(10335:11124) = u(3)*w(3518:4307)
 w(11125:11626) = u(4)*w(3806:4307)
 w(11627:11729) = u(5)*w(1317:1419)
 w(11730:11821) = u(6)*w(1328:1419)
 w(11822:11902) = u(7)*w(1339:1419)
 w(11903:11972) = u(8)*w(1350:1419)
 w(11973:12031) = u(9)*w(1361:1419)
 w(12032:12079) = u(10)*w(1372:1419)
 w(12080:12116) = u(11)*w(1383:1419)
 w(12117:12142) = u(12)*w(1394:1419)
 w(12143:12157) = u(13)*w(1405:1419)
 w(12158:12167) = u(14)*w(426:435)
 w(12168:12177) = u(15)*w(426:435)
 w(12178:12187) = u(16)*w(426:435)
 w(12188:12197) = u(17)*w(426:435)
 w(12198:12207) = u(18)*w(426:435)
 w(12208:12217) = u(19)*w(426:435)
 w(12218:12227) = u(20)*w(426:435)
 w(12228:12237) = u(21)*w(426:435)
 w(12238:12247) = u(22)*w(426:435)
 w(12248:12257) = u(23)*w(426:435)
 w(12258:12267) = u(24)*w(426:435)
endif
! terms of degree 8
if (8.le.mxd) then
 w(12268:20227) = u(0)*w(4308:12267)
 w(20228:25299) = u(1)*w(7196:12267)
 w(25300:28467) = u(2)*w(9100:12267)
 w(28468:30400) = u(3)*w(10335:12267)
 w(30401:31543) = u(4)*w(11125:12267)
 w(31544:31866) = u(5)*w(3985:4307)
 w(31867:32134) = u(6)*w(4040:4307)
 w(32135:32356) = u(7)*w(4086:4307)
 w(32357:32540) = u(8)*w(4124:4307)
 w(32541:32693) = u(9)*w(4155:4307)
 w(32694:32821) = u(10)*w(4180:4307)
 w(32822:32929) = u(11)*w(4200:4307)
 w(32930:33021) = u(12)*w(4216:4307)
 w(33022:33100) = u(13)*w(4229:4307)
 w(33101:33104) = u(14)*w(1416:1419)
 w(33105:33108) = u(15)*w(1416:1419)
 w(33109:33112) = u(16)*w(1416:1419)
 w(33113:33116) = u(17)*w(1416:1419)
 w(33117:33120) = u(18)*w(1416:1419)
 w(33121:33124) = u(19)*w(1416:1419)
 w(33125:33128) = u(20)*w(1416:1419)
 w(33129:33132) = u(21)*w(1416:1419)
 w(33133:33136) = u(22)*w(1416:1419)
 w(33137:33140) = u(23)*w(1416:1419)
 w(33141:33144) = u(24)*w(1416:1419)
 w(33145:33154) = u(25)*w(426:435)
 w(33155:33163) = u(26)*w(427:435)
 w(33164:33171) = u(27)*w(428:435)
 w(33172:33178) = u(28)*w(429:435)
 w(33179:33184) = u(29)*w(430:435)
 w(33185:33189) = u(30)*w(431:435)
 w(33190:33193) = u(31)*w(432:435)
 w(33194:33196) = u(32)*w(433:435)
 w(33197:33198) = u(33)*w(434:435)
 w(33199) = u(34)*w(435)
endif
! terms of degree 9
if (9.le.mxd) then
 w(33200:54131) = u(0)*w(12268:33199)
 w(54132:67103) = u(1)*w(20228:33199)
 w(67104:75003) = u(2)*w(25300:33199)
 w(75004:79735) = u(3)*w(28468:33199)
 w(79736:82534) = u(4)*w(30401:33199)
 w(82535:83175) = u(5)*w(11627:12267)
 w(83176:83713) = u(6)*w(11730:12267)
 w(83714:84159) = u(7)*w(11822:12267)
 w(84160:84524) = u(8)*w(11903:12267)
 w(84525:84819) = u(9)*w(11973:12267)
 w(84820:85055) = u(10)*w(12032:12267)
 w(85056:85243) = u(11)*w(12080:12267)
 w(85244:85394) = u(12)*w(12117:12267)
 w(85395:85519) = u(13)*w(12143:12267)
 w(85520:85587) = u(14)*w(4240:4307)
 w(85588:85644) = u(15)*w(4251:4307)
 w(85645:85691) = u(16)*w(4261:4307)
 w(85692:85729) = u(17)*w(4270:4307)
 w(85730:85759) = u(18)*w(4278:4307)
 w(85760:85782) = u(19)*w(4285:4307)
 w(85783:85799) = u(20)*w(4291:4307)
 w(85800:85811) = u(21)*w(4296:4307)
 w(85812:85819) = u(22)*w(4300:4307)
 w(85820:85824) = u(23)*w(4303:4307)
 w(85825:85827) = u(24)*w(4305:4307)
 w(85828:85831) = u(25)*w(1416:1419)
 w(85832:85835) = u(26)*w(1416:1419)
 w(85836:85839) = u(27)*w(1416:1419)
 w(85840:85843) = u(28)*w(1416:1419)
 w(85844:85847) = u(29)*w(1416:1419)
 w(85848:85851) = u(30)*w(1416:1419)
 w(85852:85855) = u(31)*w(1416:1419)
 w(85856:85859) = u(32)*w(1416:1419)
 w(85860:85863) = u(33)*w(1416:1419)
 w(85864:85867) = u(34)*w(1416:1419)
endif
END SUBROUTINE mg541_prib
