SUBROUTINE mg331111_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg331111_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg331111_prib: bad size u'
!! else if (size(w).ne.mg331111_npb(mxd)) then
!!  stop 'mg331111_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 17 13 13 1 0 1 0 0 0
! prib,  dnpb(0:*): 1 17 166 1203 7147 36668 167704 698400 2688598 9675914
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
 w(10) = u(9)*w(0)
 w(11) = u(10)*w(0)
 w(12) = u(11)*w(0)
 w(13) = u(12)*w(0)
 w(14) = u(13)*w(0)
 w(15) = u(14)*w(0)
 w(16) = u(15)*w(0)
 w(17) = u(16)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(18:34) = u(0)*w(1:17)
 w(35:50) = u(1)*w(2:17)
 w(51:65) = u(2)*w(3:17)
 w(66:79) = u(3)*w(4:17)
 w(80:92) = u(4)*w(5:17)
 w(93:104) = u(5)*w(6:17)
 w(105:115) = u(6)*w(7:17)
 w(116:125) = u(7)*w(8:17)
 w(126:134) = u(8)*w(9:17)
 w(135:142) = u(9)*w(10:17)
 w(143:149) = u(10)*w(11:17)
 w(150:155) = u(11)*w(12:17)
 w(156:160) = u(12)*w(13:17)
 w(161:164) = u(13)*w(14:17)
 w(165:167) = u(14)*w(15:17)
 w(168:169) = u(15)*w(16:17)
 w(170) = u(16)*w(17)
 w(171) = u(17)*w(0)
 w(172) = u(18)*w(0)
 w(173) = u(19)*w(0)
 w(174) = u(20)*w(0)
 w(175) = u(21)*w(0)
 w(176) = u(22)*w(0)
 w(177) = u(23)*w(0)
 w(178) = u(24)*w(0)
 w(179) = u(25)*w(0)
 w(180) = u(26)*w(0)
 w(181) = u(27)*w(0)
 w(182) = u(28)*w(0)
 w(183) = u(29)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(184:349) = u(0)*w(18:183)
 w(350:498) = u(1)*w(35:183)
 w(499:631) = u(2)*w(51:183)
 w(632:749) = u(3)*w(66:183)
 w(750:853) = u(4)*w(80:183)
 w(854:944) = u(5)*w(93:183)
 w(945:1023) = u(6)*w(105:183)
 w(1024:1091) = u(7)*w(116:183)
 w(1092:1149) = u(8)*w(126:183)
 w(1150:1198) = u(9)*w(135:183)
 w(1199:1239) = u(10)*w(143:183)
 w(1240:1273) = u(11)*w(150:183)
 w(1274:1301) = u(12)*w(156:183)
 w(1302:1324) = u(13)*w(161:183)
 w(1325:1343) = u(14)*w(165:183)
 w(1344:1359) = u(15)*w(168:183)
 w(1360:1373) = u(16)*w(170:183)
 w(1374) = u(30)*w(0)
 w(1375) = u(31)*w(0)
 w(1376) = u(32)*w(0)
 w(1377) = u(33)*w(0)
 w(1378) = u(34)*w(0)
 w(1379) = u(35)*w(0)
 w(1380) = u(36)*w(0)
 w(1381) = u(37)*w(0)
 w(1382) = u(38)*w(0)
 w(1383) = u(39)*w(0)
 w(1384) = u(40)*w(0)
 w(1385) = u(41)*w(0)
 w(1386) = u(42)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(1387:2589) = u(0)*w(184:1386)
 w(2590:3626) = u(1)*w(350:1386)
 w(3627:4514) = u(2)*w(499:1386)
 w(4515:5269) = u(3)*w(632:1386)
 w(5270:5906) = u(4)*w(750:1386)
 w(5907:6439) = u(5)*w(854:1386)
 w(6440:6881) = u(6)*w(945:1386)
 w(6882:7244) = u(7)*w(1024:1386)
 w(7245:7539) = u(8)*w(1092:1386)
 w(7540:7776) = u(9)*w(1150:1386)
 w(7777:7964) = u(10)*w(1199:1386)
 w(7965:8111) = u(11)*w(1240:1386)
 w(8112:8224) = u(12)*w(1274:1386)
 w(8225:8309) = u(13)*w(1302:1386)
 w(8310:8371) = u(14)*w(1325:1386)
 w(8372:8414) = u(15)*w(1344:1386)
 w(8415:8441) = u(16)*w(1360:1386)
 w(8442:8454) = u(17)*w(171:183)
 w(8455:8466) = u(18)*w(172:183)
 w(8467:8477) = u(19)*w(173:183)
 w(8478:8487) = u(20)*w(174:183)
 w(8488:8496) = u(21)*w(175:183)
 w(8497:8504) = u(22)*w(176:183)
 w(8505:8511) = u(23)*w(177:183)
 w(8512:8517) = u(24)*w(178:183)
 w(8518:8522) = u(25)*w(179:183)
 w(8523:8526) = u(26)*w(180:183)
 w(8527:8529) = u(27)*w(181:183)
 w(8530:8531) = u(28)*w(182:183)
 w(8532) = u(29)*w(183)
 w(8533) = u(43)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(8534:15680) = u(0)*w(1387:8533)
 w(15681:21624) = u(1)*w(2590:8533)
 w(21625:26531) = u(2)*w(3627:8533)
 w(26532:30550) = u(3)*w(4515:8533)
 w(30551:33814) = u(4)*w(5270:8533)
 w(33815:36441) = u(5)*w(5907:8533)
 w(36442:38535) = u(6)*w(6440:8533)
 w(38536:40187) = u(7)*w(6882:8533)
 w(40188:41476) = u(8)*w(7245:8533)
 w(41477:42470) = u(9)*w(7540:8533)
 w(42471:43227) = u(10)*w(7777:8533)
 w(43228:43796) = u(11)*w(7965:8533)
 w(43797:44218) = u(12)*w(8112:8533)
 w(44219:44527) = u(13)*w(8225:8533)
 w(44528:44751) = u(14)*w(8310:8533)
 w(44752:44913) = u(15)*w(8372:8533)
 w(44914:45032) = u(16)*w(8415:8533)
 w(45033:45045) = u(17)*w(1374:1386)
 w(45046:45058) = u(18)*w(1374:1386)
 w(45059:45071) = u(19)*w(1374:1386)
 w(45072:45084) = u(20)*w(1374:1386)
 w(45085:45097) = u(21)*w(1374:1386)
 w(45098:45110) = u(22)*w(1374:1386)
 w(45111:45123) = u(23)*w(1374:1386)
 w(45124:45136) = u(24)*w(1374:1386)
 w(45137:45149) = u(25)*w(1374:1386)
 w(45150:45162) = u(26)*w(1374:1386)
 w(45163:45175) = u(27)*w(1374:1386)
 w(45176:45188) = u(28)*w(1374:1386)
 w(45189:45201) = u(29)*w(1374:1386)
endif
! terms of degree 6
if (6.le.mxd) then
 w(45202:81869) = u(0)*w(8534:45201)
 w(81870:111390) = u(1)*w(15681:45201)
 w(111391:134967) = u(2)*w(21625:45201)
 w(134968:153637) = u(3)*w(26532:45201)
 w(153638:168288) = u(4)*w(30551:45201)
 w(168289:179675) = u(5)*w(33815:45201)
 w(179676:188435) = u(6)*w(36442:45201)
 w(188436:195101) = u(7)*w(38536:45201)
 w(195102:200115) = u(8)*w(40188:45201)
 w(200116:203840) = u(9)*w(41477:45201)
 w(203841:206571) = u(10)*w(42471:45201)
 w(206572:208545) = u(11)*w(43228:45201)
 w(208546:209950) = u(12)*w(43797:45201)
 w(209951:210933) = u(13)*w(44219:45201)
 w(210934:211607) = u(14)*w(44528:45201)
 w(211608:212057) = u(15)*w(44752:45201)
 w(212058:212345) = u(16)*w(44914:45201)
 w(212346:212437) = u(17)*w(8442:8533)
 w(212438:212516) = u(18)*w(8455:8533)
 w(212517:212583) = u(19)*w(8467:8533)
 w(212584:212639) = u(20)*w(8478:8533)
 w(212640:212685) = u(21)*w(8488:8533)
 w(212686:212722) = u(22)*w(8497:8533)
 w(212723:212751) = u(23)*w(8505:8533)
 w(212752:212773) = u(24)*w(8512:8533)
 w(212774:212789) = u(25)*w(8518:8533)
 w(212790:212800) = u(26)*w(8523:8533)
 w(212801:212807) = u(27)*w(8527:8533)
 w(212808:212811) = u(28)*w(8530:8533)
 w(212812:212813) = u(29)*w(8532:8533)
 w(212814:212826) = u(30)*w(1374:1386)
 w(212827:212838) = u(31)*w(1375:1386)
 w(212839:212849) = u(32)*w(1376:1386)
 w(212850:212859) = u(33)*w(1377:1386)
 w(212860:212868) = u(34)*w(1378:1386)
 w(212869:212876) = u(35)*w(1379:1386)
 w(212877:212883) = u(36)*w(1380:1386)
 w(212884:212889) = u(37)*w(1381:1386)
 w(212890:212894) = u(38)*w(1382:1386)
 w(212895:212898) = u(39)*w(1383:1386)
 w(212899:212901) = u(40)*w(1384:1386)
 w(212902:212903) = u(41)*w(1385:1386)
 w(212904) = u(42)*w(1386)
 w(212905) = u(44)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(212906:380609) = u(0)*w(45202:212905)
 w(380610:511645) = u(1)*w(81870:212905)
 w(511646:613160) = u(2)*w(111391:212905)
 w(613161:691098) = u(3)*w(134968:212905)
 w(691099:750366) = u(4)*w(153638:212905)
 w(750367:794983) = u(5)*w(168289:212905)
 w(794984:828213) = u(6)*w(179676:212905)
 w(828214:852683) = u(7)*w(188436:212905)
 w(852684:870487) = u(8)*w(195102:212905)
 w(870488:883277) = u(9)*w(200116:212905)
 w(883278:892342) = u(10)*w(203841:212905)
 w(892343:898676) = u(11)*w(206572:212905)
 w(898677:903036) = u(12)*w(208546:212905)
 w(903037:905991) = u(13)*w(209951:212905)
 w(905992:907963) = u(14)*w(210934:212905)
 w(907964:909261) = u(15)*w(211608:212905)
 w(909262:910109) = u(16)*w(212058:212905)
 w(910110:910278) = u(17)*w(45033:45201)
 w(910279:910434) = u(18)*w(45046:45201)
 w(910435:910577) = u(19)*w(45059:45201)
 w(910578:910707) = u(20)*w(45072:45201)
 w(910708:910824) = u(21)*w(45085:45201)
 w(910825:910928) = u(22)*w(45098:45201)
 w(910929:911019) = u(23)*w(45111:45201)
 w(911020:911097) = u(24)*w(45124:45201)
 w(911098:911162) = u(25)*w(45137:45201)
 w(911163:911214) = u(26)*w(45150:45201)
 w(911215:911253) = u(27)*w(45163:45201)
 w(911254:911279) = u(28)*w(45176:45201)
 w(911280:911292) = u(29)*w(45189:45201)
 w(911293) = u(30)*w(8533)
 w(911294) = u(31)*w(8533)
 w(911295) = u(32)*w(8533)
 w(911296) = u(33)*w(8533)
 w(911297) = u(34)*w(8533)
 w(911298) = u(35)*w(8533)
 w(911299) = u(36)*w(8533)
 w(911300) = u(37)*w(8533)
 w(911301) = u(38)*w(8533)
 w(911302) = u(39)*w(8533)
 w(911303) = u(40)*w(8533)
 w(911304) = u(41)*w(8533)
 w(911305) = u(42)*w(8533)
endif
! terms of degree 8
if (8.le.mxd) then
 w(911306:1609705) = u(0)*w(212906:911305)
 w(1609706:2140401) = u(1)*w(380610:911305)
 w(2140402:2540061) = u(2)*w(511646:911305)
 w(2540062:2838206) = u(3)*w(613161:911305)
 w(2838207:3058413) = u(4)*w(691099:911305)
 w(3058414:3219352) = u(5)*w(750367:911305)
 w(3219353:3335674) = u(6)*w(794984:911305)
 w(3335675:3418766) = u(7)*w(828214:911305)
 w(3418767:3477388) = u(8)*w(852684:911305)
 w(3477389:3518206) = u(9)*w(870488:911305)
 w(3518207:3546234) = u(10)*w(883278:911305)
 w(3546235:3565197) = u(11)*w(892343:911305)
 w(3565198:3577826) = u(12)*w(898677:911305)
 w(3577827:3586095) = u(13)*w(903037:911305)
 w(3586096:3591409) = u(14)*w(905992:911305)
 w(3591410:3594751) = u(15)*w(907964:911305)
 w(3594752:3596795) = u(16)*w(909262:911305)
 w(3596796:3597355) = u(17)*w(212346:212905)
 w(3597356:3597823) = u(18)*w(212438:212905)
 w(3597824:3598212) = u(19)*w(212517:212905)
 w(3598213:3598534) = u(20)*w(212584:212905)
 w(3598535:3598800) = u(21)*w(212640:212905)
 w(3598801:3599020) = u(22)*w(212686:212905)
 w(3599021:3599203) = u(23)*w(212723:212905)
 w(3599204:3599357) = u(24)*w(212752:212905)
 w(3599358:3599489) = u(25)*w(212774:212905)
 w(3599490:3599605) = u(26)*w(212790:212905)
 w(3599606:3599710) = u(27)*w(212801:212905)
 w(3599711:3599808) = u(28)*w(212808:212905)
 w(3599809:3599902) = u(29)*w(212812:212905)
 w(3599903) = u(43)*w(8533)
endif
! terms of degree 9
if (9.le.mxd) then
 w(3599904:6288501) = u(0)*w(911306:3599903)
 w(6288502:8278699) = u(1)*w(1609706:3599903)
 w(8278700:9738201) = u(2)*w(2140402:3599903)
 w(9738202:10798043) = u(3)*w(2540062:3599903)
 w(10798044:11559740) = u(4)*w(2838207:3599903)
 w(11559741:12101230) = u(5)*w(3058414:3599903)
 w(12101231:12481781) = u(6)*w(3219353:3599903)
 w(12481782:12746010) = u(7)*w(3335675:3599903)
 w(12746011:12927147) = u(8)*w(3418767:3599903)
 w(12927148:13049662) = u(9)*w(3477389:3599903)
 w(13049663:13131359) = u(10)*w(3518207:3599903)
 w(13131360:13185028) = u(11)*w(3546235:3599903)
 w(13185029:13219734) = u(12)*w(3565198:3599903)
 w(13219735:13241811) = u(13)*w(3577827:3599903)
 w(13241812:13255619) = u(14)*w(3586096:3599903)
 w(13255620:13264113) = u(15)*w(3591410:3599903)
 w(13264114:13269265) = u(16)*w(3594752:3599903)
 w(13269266:13270461) = u(17)*w(910110:911305)
 w(13270462:13271488) = u(18)*w(910279:911305)
 w(13271489:13272359) = u(19)*w(910435:911305)
 w(13272360:13273087) = u(20)*w(910578:911305)
 w(13273088:13273685) = u(21)*w(910708:911305)
 w(13273686:13274166) = u(22)*w(910825:911305)
 w(13274167:13274543) = u(23)*w(910929:911305)
 w(13274544:13274829) = u(24)*w(911020:911305)
 w(13274830:13275037) = u(25)*w(911098:911305)
 w(13275038:13275180) = u(26)*w(911163:911305)
 w(13275181:13275271) = u(27)*w(911215:911305)
 w(13275272:13275323) = u(28)*w(911254:911305)
 w(13275324:13275349) = u(29)*w(911280:911305)
 w(13275350:13275441) = u(30)*w(212814:212905)
 w(13275442:13275520) = u(31)*w(212827:212905)
 w(13275521:13275587) = u(32)*w(212839:212905)
 w(13275588:13275643) = u(33)*w(212850:212905)
 w(13275644:13275689) = u(34)*w(212860:212905)
 w(13275690:13275726) = u(35)*w(212869:212905)
 w(13275727:13275755) = u(36)*w(212877:212905)
 w(13275756:13275777) = u(37)*w(212884:212905)
 w(13275778:13275793) = u(38)*w(212890:212905)
 w(13275794:13275804) = u(39)*w(212895:212905)
 w(13275805:13275811) = u(40)*w(212899:212905)
 w(13275812:13275815) = u(41)*w(212902:212905)
 w(13275816:13275817) = u(42)*w(212904:212905)
endif
END SUBROUTINE mg331111_prib
