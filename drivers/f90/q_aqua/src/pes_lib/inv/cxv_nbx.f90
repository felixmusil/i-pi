PURE FUNCTION cxv_nbx (nkj, dg) RESULT (nb)
integer, intent (in) :: nkj(0:), dg
integer :: nb
!-----------------------------------------------------------------------
! Note: All error conditions are indicated by returning nb = -huge(0)
integer :: id
if (dg.lt.0) then
 nb = 0
 return
endif
select case (mgx_id(nkj))
case (0)
 nb = 0
case (1)
 nb = 1 !! must look into this
case (mg2_id)
 nb = mgv2_nb(dg)
case (mg11_id)
 nb = mgv11_nb(dg)
case (mg3_id)
 nb = mgv3_nb(dg)
case (mg21_id)
 nb = mgv21_nb(dg)
case (mg111_id)
 nb = mgv111_nb(dg)
case (mg4_id)
 nb = mgv4_nb(dg)
case (mg31_id)
 nb = mgv31_nb(dg)
case (mg22_id)
 nb = mgv22_nb(dg)
case (mg211_id)
 nb = mgv211_nb(dg)
case (mg1111_id)
 nb = mgv1111_nb(dg)
case (mg5_id)
 nb = mgv5_nb(dg)
case (mg41_id)
 nb = mgv41_nb(dg)
case (mg32_id)
 nb = mgv32_nb(dg)
case (mg311_id)
 nb = mgv311_nb(dg)
case (mg221_id)
 nb = mgv221_nb(dg)
case (mg2111_id)
 nb = mgv2111_nb(dg)
case (mg11111_id)
 nb = mgv11111_nb(dg)
case (mg6_id)
 nb = mgv6_nb(dg)
case (mg51_id)
 nb = mgv51_nb(dg)
case (mg42_id)
 nb = mgv42_nb(dg)
case (mg33_id)
 nb = mgv33_nb(dg)
case (mg411_id)
 nb = mgv411_nb(dg)
case (mg321_id)
 nb = mgv321_nb(dg)
case (mg222_id)
 nb = mgv222_nb(dg)
case (mg3111_id)
 nb = mgv3111_nb(dg)
case (mg2211_id)
 nb = mgv2211_nb(dg)
case (mg21111_id)
 nb = mgv21111_nb(dg)
case (mg111111_id)
 nb = mgv111111_nb(dg)
case (mg7_id)
 nb = mgv7_nb(dg)
case (mg61_id)
 nb = mgv61_nb(dg)
case (mg52_id)
 nb = mgv52_nb(dg)
case (mg43_id)
 nb = mgv43_nb(dg)
case (mg511_id)
 nb = mgv511_nb(dg)
case (mg421_id)
 nb = mgv421_nb(dg)
case (mg331_id)
 nb = mgv331_nb(dg)
case (mg322_id)
 nb = mgv322_nb(dg)
case (mg4111_id)
 nb = mgv4111_nb(dg)
case (mg3211_id)
 nb = mgv3211_nb(dg)
case (mg2221_id)
 nb = mgv2221_nb(dg)
case (mg31111_id)
 nb = mgv31111_nb(dg)
case (mg22111_id)
 nb = mgv22111_nb(dg)
case (mg211111_id)
 nb = mgv211111_nb(dg)
case (mg1111111_id)
 nb = mgv1111111_nb(dg)
!! case (mg8_id)
!!  nb = mgv8_nb(dg)
case (mg71_id)
 nb = mgv71_nb(dg)
case (mg62_id)
 nb = mgv62_nb(dg)
case (mg53_id)
 nb = mgv53_nb(dg)
case (mg44_id)
 nb = mgv44_nb(dg)
case (mg611_id)
 nb = mgv611_nb(dg)
case (mg521_id)
 nb = mgv521_nb(dg)
case (mg431_id)
 nb = mgv431_nb(dg)
case (mg422_id)
 nb = mgv422_nb(dg)
case (mg332_id)
 nb = mgv332_nb(dg)
case (mg5111_id)
 nb = mgv5111_nb(dg)
case (mg4211_id)
 nb = mgv4211_nb(dg)
case (mg3311_id)
 nb = mgv3311_nb(dg)
case (mg3221_id)
 nb = mgv3221_nb(dg)
case (mg2222_id)
 nb = mgv2222_nb(dg)
case (mg41111_id)
 nb = mgv41111_nb(dg)
case (mg32111_id)
 nb = mgv32111_nb(dg)
case (mg22211_id)
 nb = mgv22211_nb(dg)
case (mg311111_id)
 nb = mgv311111_nb(dg)
case (mg221111_id)
 nb = mgv221111_nb(dg)
case (mg2111111_id)
 nb = mgv2111111_nb(dg)
case (mg11111111_id)
 nb = mgv11111111_nb(dg)
!! case (mg9_id)
!!  nb = mgv9_nb(dg)
!! case (mg81_id)
!!  nb = mgv81_nb(dg)
case (mg72_id)
 nb = mgv72_nb(dg)
case (mg63_id)
 nb = mgv63_nb(dg)
case (mg54_id)
 nb = mgv54_nb(dg)
case (mg711_id)
 nb = mgv711_nb(dg)
case (mg621_id)
 nb = mgv621_nb(dg)
case (mg531_id)
 nb = mgv531_nb(dg)
case (mg441_id)
 nb = mgv441_nb(dg)
case (mg522_id)
 nb = mgv522_nb(dg)
case (mg432_id)
 nb = mgv432_nb(dg)
case (mg333_id)
 nb = mgv333_nb(dg)
case (mg6111_id)
 nb = mgv6111_nb(dg)
case (mg5211_id)
 nb = mgv5211_nb(dg)
case (mg4311_id)
 nb = mgv4311_nb(dg)
case (mg4221_id)
 nb = mgv4221_nb(dg)
case (mg3321_id)
 nb = mgv3321_nb(dg)
case (mg3222_id)
 nb = mgv3222_nb(dg)
case (mg51111_id)
 nb = mgv51111_nb(dg)
case (mg42111_id)
 nb = mgv42111_nb(dg)
case (mg33111_id)
 nb = mgv33111_nb(dg)
case (mg32211_id)
 nb = mgv32211_nb(dg)
case (mg22221_id)
 nb = mgv22221_nb(dg)
case (mg411111_id)
 nb = mgv411111_nb(dg)
case (mg321111_id)
 nb = mgv321111_nb(dg)
case (mg222111_id)
 nb = mgv222111_nb(dg)
case (mg3111111_id)
 nb = mgv3111111_nb(dg)
case (mg2211111_id)
 nb = mgv2211111_nb(dg)
case (mg21111111_id)
 nb = mgv21111111_nb(dg)
case (mg111111111_id)
 nb = mgv111111111_nb(dg)
case (mg73_id)
 nb = mgv73_nb(dg)
case (mg721_id)
 nb = mgv721_nb(dg)
case (mg631_id)
 nb = mgv631_nb(dg)
case (mg541_id)
 nb = mgv541_nb(dg)
case (mg622_id)
 nb = mgv622_nb(dg)
case (mg532_id)
 nb = mgv532_nb(dg)
case (mg442_id)
 nb = mgv442_nb(dg)
case (mg433_id)
 nb = mgv433_nb(dg)
case (mg7111_id)
 nb = mgv7111_nb(dg)
case (mg6211_id)
 nb = mgv6211_nb(dg)
case (mg5311_id)
 nb = mgv5311_nb(dg)
case (mg4411_id)
 nb = mgv4411_nb(dg)
case (mg5221_id)
 nb = mgv5221_nb(dg)
case (mg4321_id)
 nb = mgv4321_nb(dg)
case (mg3331_id)
 nb = mgv3331_nb(dg)
case (mg4222_id)
 nb = mgv4222_nb(dg)
case (mg3322_id)
 nb = mgv3322_nb(dg)
case (mg61111_id)
 nb = mgv61111_nb(dg)
case (mg52111_id)
 nb = mgv52111_nb(dg)
case (mg43111_id)
 nb = mgv43111_nb(dg)
case (mg42211_id)
 nb = mgv42211_nb(dg)
case (mg33211_id)
 nb = mgv33211_nb(dg)
case (mg32221_id)
 nb = mgv32221_nb(dg)
case (mg22222_id)
 nb = mgv22222_nb(dg)
case (mg511111_id)
 nb = mgv511111_nb(dg)
case (mg421111_id)
 nb = mgv421111_nb(dg)
case (mg331111_id)
 nb = mgv331111_nb(dg)
case (mg322111_id)
 nb = mgv322111_nb(dg)
case (mg222211_id)
 nb = mgv222211_nb(dg)
case (mg4111111_id)
 nb = mgv4111111_nb(dg)
case (mg3211111_id)
 nb = mgv3211111_nb(dg)
case (mg2221111_id)
 nb = mgv2221111_nb(dg)
case (mg31111111_id)
 nb = mgv31111111_nb(dg)
case (mg22111111_id)
 nb = mgv22111111_nb(dg)
case (mg211111111_id)
 nb = mgv211111111_nb(dg)
case (mg1111111111_id)
 nb = mgv1111111111_nb(dg)
case default
 nb = -huge(0)
end select
return
END FUNCTION cxv_nbx
