SUBROUTINE mg3311_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg3311_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg3311_prib: bad size u'
!! else if (size(w).ne.mg3311_npb(mxd)) then
!!  stop 'mg3311_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 8 9 9 1 0 1 0 0 0
! prib,  dnpb(0:*): 1 8 45 201 772 2645 8290 24140 66094 171618
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(9:16) = u(0)*w(1:8)
 w(17:23) = u(1)*w(2:8)
 w(24:29) = u(2)*w(3:8)
 w(30:34) = u(3)*w(4:8)
 w(35:38) = u(4)*w(5:8)
 w(39:41) = u(5)*w(6:8)
 w(42:43) = u(6)*w(7:8)
 w(44) = u(7)*w(8)
 w(45) = u(8)*w(0)
 w(46) = u(9)*w(0)
 w(47) = u(10)*w(0)
 w(48) = u(11)*w(0)
 w(49) = u(12)*w(0)
 w(50) = u(13)*w(0)
 w(51) = u(14)*w(0)
 w(52) = u(15)*w(0)
 w(53) = u(16)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(54:98) = u(0)*w(9:53)
 w(99:135) = u(1)*w(17:53)
 w(136:165) = u(2)*w(24:53)
 w(166:189) = u(3)*w(30:53)
 w(190:208) = u(4)*w(35:53)
 w(209:223) = u(5)*w(39:53)
 w(224:235) = u(6)*w(42:53)
 w(236:245) = u(7)*w(44:53)
 w(246) = u(17)*w(0)
 w(247) = u(18)*w(0)
 w(248) = u(19)*w(0)
 w(249) = u(20)*w(0)
 w(250) = u(21)*w(0)
 w(251) = u(22)*w(0)
 w(252) = u(23)*w(0)
 w(253) = u(24)*w(0)
 w(254) = u(25)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(255:455) = u(0)*w(54:254)
 w(456:611) = u(1)*w(99:254)
 w(612:730) = u(2)*w(136:254)
 w(731:819) = u(3)*w(166:254)
 w(820:884) = u(4)*w(190:254)
 w(885:930) = u(5)*w(209:254)
 w(931:961) = u(6)*w(224:254)
 w(962:980) = u(7)*w(236:254)
 w(981:989) = u(8)*w(45:53)
 w(990:997) = u(9)*w(46:53)
 w(998:1004) = u(10)*w(47:53)
 w(1005:1010) = u(11)*w(48:53)
 w(1011:1015) = u(12)*w(49:53)
 w(1016:1019) = u(13)*w(50:53)
 w(1020:1022) = u(14)*w(51:53)
 w(1023:1024) = u(15)*w(52:53)
 w(1025) = u(16)*w(53)
 w(1026) = u(26)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(1027:1798) = u(0)*w(255:1026)
 w(1799:2369) = u(1)*w(456:1026)
 w(2370:2784) = u(2)*w(612:1026)
 w(2785:3080) = u(3)*w(731:1026)
 w(3081:3287) = u(4)*w(820:1026)
 w(3288:3429) = u(5)*w(885:1026)
 w(3430:3525) = u(6)*w(931:1026)
 w(3526:3590) = u(7)*w(962:1026)
 w(3591:3599) = u(8)*w(246:254)
 w(3600:3608) = u(9)*w(246:254)
 w(3609:3617) = u(10)*w(246:254)
 w(3618:3626) = u(11)*w(246:254)
 w(3627:3635) = u(12)*w(246:254)
 w(3636:3644) = u(13)*w(246:254)
 w(3645:3653) = u(14)*w(246:254)
 w(3654:3662) = u(15)*w(246:254)
 w(3663:3671) = u(16)*w(246:254)
endif
! terms of degree 6
if (6.le.mxd) then
 w(3672:6316) = u(0)*w(1027:3671)
 w(6317:8189) = u(1)*w(1799:3671)
 w(8190:9491) = u(2)*w(2370:3671)
 w(9492:10378) = u(3)*w(2785:3671)
 w(10379:10969) = u(4)*w(3081:3671)
 w(10970:11353) = u(5)*w(3288:3671)
 w(11354:11595) = u(6)*w(3430:3671)
 w(11596:11741) = u(7)*w(3526:3671)
 w(11742:11787) = u(8)*w(981:1026)
 w(11788:11824) = u(9)*w(990:1026)
 w(11825:11853) = u(10)*w(998:1026)
 w(11854:11875) = u(11)*w(1005:1026)
 w(11876:11891) = u(12)*w(1011:1026)
 w(11892:11902) = u(13)*w(1016:1026)
 w(11903:11909) = u(14)*w(1020:1026)
 w(11910:11913) = u(15)*w(1023:1026)
 w(11914:11915) = u(16)*w(1025:1026)
 w(11916:11924) = u(17)*w(246:254)
 w(11925:11932) = u(18)*w(247:254)
 w(11933:11939) = u(19)*w(248:254)
 w(11940:11945) = u(20)*w(249:254)
 w(11946:11950) = u(21)*w(250:254)
 w(11951:11954) = u(22)*w(251:254)
 w(11955:11957) = u(23)*w(252:254)
 w(11958:11959) = u(24)*w(253:254)
 w(11960) = u(25)*w(254)
 w(11961) = u(27)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(11962:20251) = u(0)*w(3672:11961)
 w(20252:25896) = u(1)*w(6317:11961)
 w(25897:29668) = u(2)*w(8190:11961)
 w(29669:32138) = u(3)*w(9492:11961)
 w(32139:33721) = u(4)*w(10379:11961)
 w(33722:34713) = u(5)*w(10970:11961)
 w(34714:35321) = u(6)*w(11354:11961)
 w(35322:35687) = u(7)*w(11596:11961)
 w(35688:35768) = u(8)*w(3591:3671)
 w(35769:35840) = u(9)*w(3600:3671)
 w(35841:35903) = u(10)*w(3609:3671)
 w(35904:35957) = u(11)*w(3618:3671)
 w(35958:36002) = u(12)*w(3627:3671)
 w(36003:36038) = u(13)*w(3636:3671)
 w(36039:36065) = u(14)*w(3645:3671)
 w(36066:36083) = u(15)*w(3654:3671)
 w(36084:36092) = u(16)*w(3663:3671)
 w(36093) = u(17)*w(1026)
 w(36094) = u(18)*w(1026)
 w(36095) = u(19)*w(1026)
 w(36096) = u(20)*w(1026)
 w(36097) = u(21)*w(1026)
 w(36098) = u(22)*w(1026)
 w(36099) = u(23)*w(1026)
 w(36100) = u(24)*w(1026)
 w(36101) = u(25)*w(1026)
endif
! terms of degree 8
if (8.le.mxd) then
 w(36102:60241) = u(0)*w(11962:36101)
 w(60242:76091) = u(1)*w(20252:36101)
 w(76092:86296) = u(2)*w(25897:36101)
 w(86297:92729) = u(3)*w(29669:36101)
 w(92730:96692) = u(4)*w(32139:36101)
 w(96693:99072) = u(5)*w(33722:36101)
 w(99073:100460) = u(6)*w(34714:36101)
 w(100461:101240) = u(7)*w(35322:36101)
 w(101241:101460) = u(8)*w(11742:11961)
 w(101461:101634) = u(9)*w(11788:11961)
 w(101635:101771) = u(10)*w(11825:11961)
 w(101772:101879) = u(11)*w(11854:11961)
 w(101880:101965) = u(12)*w(11876:11961)
 w(101966:102035) = u(13)*w(11892:11961)
 w(102036:102094) = u(14)*w(11903:11961)
 w(102095:102146) = u(15)*w(11910:11961)
 w(102147:102194) = u(16)*w(11914:11961)
 w(102195) = u(26)*w(1026)
endif
! terms of degree 9
if (9.le.mxd) then
 w(102196:168289) = u(0)*w(36102:102195)
 w(168290:210243) = u(1)*w(60242:102195)
 w(210244:236347) = u(2)*w(76092:102195)
 w(236348:252246) = u(3)*w(86297:102195)
 w(252247:261712) = u(4)*w(92730:102195)
 w(261713:267215) = u(5)*w(96693:102195)
 w(267216:270338) = u(6)*w(99073:102195)
 w(270339:272073) = u(7)*w(100461:102195)
 w(272074:272487) = u(8)*w(35688:36101)
 w(272488:272820) = u(9)*w(35769:36101)
 w(272821:273081) = u(10)*w(35841:36101)
 w(273082:273279) = u(11)*w(35904:36101)
 w(273280:273423) = u(12)*w(35958:36101)
 w(273424:273522) = u(13)*w(36003:36101)
 w(273523:273585) = u(14)*w(36039:36101)
 w(273586:273621) = u(15)*w(36066:36101)
 w(273622:273639) = u(16)*w(36084:36101)
 w(273640:273685) = u(17)*w(11916:11961)
 w(273686:273722) = u(18)*w(11925:11961)
 w(273723:273751) = u(19)*w(11933:11961)
 w(273752:273773) = u(20)*w(11940:11961)
 w(273774:273789) = u(21)*w(11946:11961)
 w(273790:273800) = u(22)*w(11951:11961)
 w(273801:273807) = u(23)*w(11955:11961)
 w(273808:273811) = u(24)*w(11958:11961)
 w(273812:273813) = u(25)*w(11960:11961)
endif
END SUBROUTINE mg3311_prib
