SUBROUTINE mg71_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg71_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg71_prib: bad size u'
!! else if (size(w).ne.mg71_npb(mxd)) then
!!  stop 'mg71_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 2 3 6 4 4 3 4 0 0
! prib,  dnpb(0:*): 1 2 6 16 36 78 166 330 639 1206
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(3:4) = u(0)*w(1:2)
 w(5) = u(1)*w(2)
 w(6) = u(2)*w(0)
 w(7) = u(3)*w(0)
 w(8) = u(4)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(9:14) = u(0)*w(3:8)
 w(15:18) = u(1)*w(5:8)
 w(19) = u(5)*w(0)
 w(20) = u(6)*w(0)
 w(21) = u(7)*w(0)
 w(22) = u(8)*w(0)
 w(23) = u(9)*w(0)
 w(24) = u(10)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(25:40) = u(0)*w(9:24)
 w(41:50) = u(1)*w(15:24)
 w(51:53) = u(2)*w(6:8)
 w(54:55) = u(3)*w(7:8)
 w(56) = u(4)*w(8)
 w(57) = u(11)*w(0)
 w(58) = u(12)*w(0)
 w(59) = u(13)*w(0)
 w(60) = u(14)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(61:96) = u(0)*w(25:60)
 w(97:116) = u(1)*w(41:60)
 w(117:122) = u(2)*w(19:24)
 w(123:128) = u(3)*w(19:24)
 w(129:134) = u(4)*w(19:24)
 w(135) = u(15)*w(0)
 w(136) = u(16)*w(0)
 w(137) = u(17)*w(0)
 w(138) = u(18)*w(0)
endif
! terms of degree 6
if (6.le.mxd) then
 w(139:216) = u(0)*w(61:138)
 w(217:258) = u(1)*w(97:138)
 w(259:268) = u(2)*w(51:60)
 w(269:275) = u(3)*w(54:60)
 w(276:280) = u(4)*w(56:60)
 w(281:286) = u(5)*w(19:24)
 w(287:291) = u(6)*w(20:24)
 w(292:295) = u(7)*w(21:24)
 w(296:298) = u(8)*w(22:24)
 w(299:300) = u(9)*w(23:24)
 w(301) = u(10)*w(24)
 w(302) = u(19)*w(0)
 w(303) = u(20)*w(0)
 w(304) = u(21)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(305:470) = u(0)*w(139:304)
 w(471:558) = u(1)*w(217:304)
 w(559:580) = u(2)*w(117:138)
 w(581:596) = u(3)*w(123:138)
 w(597:606) = u(4)*w(129:138)
 w(607:610) = u(5)*w(57:60)
 w(611:614) = u(6)*w(57:60)
 w(615:618) = u(7)*w(57:60)
 w(619:622) = u(8)*w(57:60)
 w(623:626) = u(9)*w(57:60)
 w(627:630) = u(10)*w(57:60)
 w(631) = u(22)*w(0)
 w(632) = u(23)*w(0)
 w(633) = u(24)*w(0)
 w(634) = u(25)*w(0)
endif
! terms of degree 8
if (8.le.mxd) then
 w(635:964) = u(0)*w(305:634)
 w(965:1128) = u(1)*w(471:634)
 w(1129:1174) = u(2)*w(259:304)
 w(1175:1210) = u(3)*w(269:304)
 w(1211:1239) = u(4)*w(276:304)
 w(1240:1243) = u(5)*w(135:138)
 w(1244:1247) = u(6)*w(135:138)
 w(1248:1251) = u(7)*w(135:138)
 w(1252:1255) = u(8)*w(135:138)
 w(1256:1259) = u(9)*w(135:138)
 w(1260:1263) = u(10)*w(135:138)
 w(1264:1267) = u(11)*w(57:60)
 w(1268:1270) = u(12)*w(58:60)
 w(1271:1272) = u(13)*w(59:60)
 w(1273) = u(14)*w(60)
endif
! terms of degree 9
if (9.le.mxd) then
 w(1274:1912) = u(0)*w(635:1273)
 w(1913:2221) = u(1)*w(965:1273)
 w(2222:2297) = u(2)*w(559:634)
 w(2298:2351) = u(3)*w(581:634)
 w(2352:2389) = u(4)*w(597:634)
 w(2390:2413) = u(5)*w(281:304)
 w(2414:2431) = u(6)*w(287:304)
 w(2432:2444) = u(7)*w(292:304)
 w(2445:2453) = u(8)*w(296:304)
 w(2454:2459) = u(9)*w(299:304)
 w(2460:2463) = u(10)*w(301:304)
 w(2464:2467) = u(11)*w(135:138)
 w(2468:2471) = u(12)*w(135:138)
 w(2472:2475) = u(13)*w(135:138)
 w(2476:2479) = u(14)*w(135:138)
endif
END SUBROUTINE mg71_prib
