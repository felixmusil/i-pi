SUBROUTINE mg3322_prib (mxd, u, w)
integer, intent (in) :: mxd
real (kind=wp), intent (in) :: u(0:)
real (kind=wp), intent (out) :: w(0:mg3322_npb(mxd)-1)
!-----------------------------------------------------------------------
if (size(u).ne.nr) then
 stop 'mg3322_prib: bad size u'
!! else if (size(w).ne.mg3322_npb(mxd)) then
!!  stop 'mg3322_prib: bad size w'
endif
! The following code was obtained using these parameters
! prims, dnpr(0:*): 0 10 20 9 1 0 5 0 0 0
! prib,  dnpb(0:*): 1 10 75 429 2116 9187 36300 132234 450499 1447142
! constant term
w(0) = 1
! terms of degree 1
if (1.le.mxd) then
 w(1) = u(0)*w(0)
 w(2) = u(1)*w(0)
 w(3) = u(2)*w(0)
 w(4) = u(3)*w(0)
 w(5) = u(4)*w(0)
 w(6) = u(5)*w(0)
 w(7) = u(6)*w(0)
 w(8) = u(7)*w(0)
 w(9) = u(8)*w(0)
 w(10) = u(9)*w(0)
endif
! terms of degree 2
if (2.le.mxd) then
 w(11:20) = u(0)*w(1:10)
 w(21:29) = u(1)*w(2:10)
 w(30:37) = u(2)*w(3:10)
 w(38:44) = u(3)*w(4:10)
 w(45:50) = u(4)*w(5:10)
 w(51:55) = u(5)*w(6:10)
 w(56:59) = u(6)*w(7:10)
 w(60:62) = u(7)*w(8:10)
 w(63:64) = u(8)*w(9:10)
 w(65) = u(9)*w(10)
 w(66) = u(10)*w(0)
 w(67) = u(11)*w(0)
 w(68) = u(12)*w(0)
 w(69) = u(13)*w(0)
 w(70) = u(14)*w(0)
 w(71) = u(15)*w(0)
 w(72) = u(16)*w(0)
 w(73) = u(17)*w(0)
 w(74) = u(18)*w(0)
 w(75) = u(19)*w(0)
 w(76) = u(20)*w(0)
 w(77) = u(21)*w(0)
 w(78) = u(22)*w(0)
 w(79) = u(23)*w(0)
 w(80) = u(24)*w(0)
 w(81) = u(25)*w(0)
 w(82) = u(26)*w(0)
 w(83) = u(27)*w(0)
 w(84) = u(28)*w(0)
 w(85) = u(29)*w(0)
endif
! terms of degree 3
if (3.le.mxd) then
 w(86:160) = u(0)*w(11:85)
 w(161:225) = u(1)*w(21:85)
 w(226:281) = u(2)*w(30:85)
 w(282:329) = u(3)*w(38:85)
 w(330:370) = u(4)*w(45:85)
 w(371:405) = u(5)*w(51:85)
 w(406:435) = u(6)*w(56:85)
 w(436:461) = u(7)*w(60:85)
 w(462:484) = u(8)*w(63:85)
 w(485:505) = u(9)*w(65:85)
 w(506) = u(30)*w(0)
 w(507) = u(31)*w(0)
 w(508) = u(32)*w(0)
 w(509) = u(33)*w(0)
 w(510) = u(34)*w(0)
 w(511) = u(35)*w(0)
 w(512) = u(36)*w(0)
 w(513) = u(37)*w(0)
 w(514) = u(38)*w(0)
endif
! terms of degree 4
if (4.le.mxd) then
 w(515:943) = u(0)*w(86:514)
 w(944:1297) = u(1)*w(161:514)
 w(1298:1586) = u(2)*w(226:514)
 w(1587:1819) = u(3)*w(282:514)
 w(1820:2004) = u(4)*w(330:514)
 w(2005:2148) = u(5)*w(371:514)
 w(2149:2257) = u(6)*w(406:514)
 w(2258:2336) = u(7)*w(436:514)
 w(2337:2389) = u(8)*w(462:514)
 w(2390:2419) = u(9)*w(485:514)
 w(2420:2439) = u(10)*w(66:85)
 w(2440:2458) = u(11)*w(67:85)
 w(2459:2476) = u(12)*w(68:85)
 w(2477:2493) = u(13)*w(69:85)
 w(2494:2509) = u(14)*w(70:85)
 w(2510:2524) = u(15)*w(71:85)
 w(2525:2538) = u(16)*w(72:85)
 w(2539:2551) = u(17)*w(73:85)
 w(2552:2563) = u(18)*w(74:85)
 w(2564:2574) = u(19)*w(75:85)
 w(2575:2584) = u(20)*w(76:85)
 w(2585:2593) = u(21)*w(77:85)
 w(2594:2601) = u(22)*w(78:85)
 w(2602:2608) = u(23)*w(79:85)
 w(2609:2614) = u(24)*w(80:85)
 w(2615:2619) = u(25)*w(81:85)
 w(2620:2623) = u(26)*w(82:85)
 w(2624:2626) = u(27)*w(83:85)
 w(2627:2628) = u(28)*w(84:85)
 w(2629) = u(29)*w(85)
 w(2630) = u(39)*w(0)
endif
! terms of degree 5
if (5.le.mxd) then
 w(2631:4746) = u(0)*w(515:2630)
 w(4747:6433) = u(1)*w(944:2630)
 w(6434:7766) = u(2)*w(1298:2630)
 w(7767:8810) = u(3)*w(1587:2630)
 w(8811:9621) = u(4)*w(1820:2630)
 w(9622:10247) = u(5)*w(2005:2630)
 w(10248:10729) = u(6)*w(2149:2630)
 w(10730:11102) = u(7)*w(2258:2630)
 w(11103:11396) = u(8)*w(2337:2630)
 w(11397:11637) = u(9)*w(2390:2630)
 w(11638:11646) = u(10)*w(506:514)
 w(11647:11655) = u(11)*w(506:514)
 w(11656:11664) = u(12)*w(506:514)
 w(11665:11673) = u(13)*w(506:514)
 w(11674:11682) = u(14)*w(506:514)
 w(11683:11691) = u(15)*w(506:514)
 w(11692:11700) = u(16)*w(506:514)
 w(11701:11709) = u(17)*w(506:514)
 w(11710:11718) = u(18)*w(506:514)
 w(11719:11727) = u(19)*w(506:514)
 w(11728:11736) = u(20)*w(506:514)
 w(11737:11745) = u(21)*w(506:514)
 w(11746:11754) = u(22)*w(506:514)
 w(11755:11763) = u(23)*w(506:514)
 w(11764:11772) = u(24)*w(506:514)
 w(11773:11781) = u(25)*w(506:514)
 w(11782:11790) = u(26)*w(506:514)
 w(11791:11799) = u(27)*w(506:514)
 w(11800:11808) = u(28)*w(506:514)
 w(11809:11817) = u(29)*w(506:514)
endif
! terms of degree 6
if (6.le.mxd) then
 w(11818:21004) = u(0)*w(2631:11817)
 w(21005:28075) = u(1)*w(4747:11817)
 w(28076:33459) = u(2)*w(6434:11817)
 w(33460:37510) = u(3)*w(7767:11817)
 w(37511:40517) = u(4)*w(8811:11817)
 w(40518:42713) = u(5)*w(9622:11817)
 w(42714:44283) = u(6)*w(10248:11817)
 w(44284:45371) = u(7)*w(10730:11817)
 w(45372:46086) = u(8)*w(11103:11817)
 w(46087:46507) = u(9)*w(11397:11817)
 w(46508:46718) = u(10)*w(2420:2630)
 w(46719:46909) = u(11)*w(2440:2630)
 w(46910:47081) = u(12)*w(2459:2630)
 w(47082:47235) = u(13)*w(2477:2630)
 w(47236:47372) = u(14)*w(2494:2630)
 w(47373:47493) = u(15)*w(2510:2630)
 w(47494:47599) = u(16)*w(2525:2630)
 w(47600:47691) = u(17)*w(2539:2630)
 w(47692:47770) = u(18)*w(2552:2630)
 w(47771:47837) = u(19)*w(2564:2630)
 w(47838:47893) = u(20)*w(2575:2630)
 w(47894:47939) = u(21)*w(2585:2630)
 w(47940:47976) = u(22)*w(2594:2630)
 w(47977:48005) = u(23)*w(2602:2630)
 w(48006:48027) = u(24)*w(2609:2630)
 w(48028:48043) = u(25)*w(2615:2630)
 w(48044:48054) = u(26)*w(2620:2630)
 w(48055:48061) = u(27)*w(2624:2630)
 w(48062:48065) = u(28)*w(2627:2630)
 w(48066:48067) = u(29)*w(2629:2630)
 w(48068:48076) = u(30)*w(506:514)
 w(48077:48084) = u(31)*w(507:514)
 w(48085:48091) = u(32)*w(508:514)
 w(48092:48097) = u(33)*w(509:514)
 w(48098:48102) = u(34)*w(510:514)
 w(48103:48106) = u(35)*w(511:514)
 w(48107:48109) = u(36)*w(512:514)
 w(48110:48111) = u(37)*w(513:514)
 w(48112) = u(38)*w(514)
 w(48113) = u(40)*w(0)
 w(48114) = u(41)*w(0)
 w(48115) = u(42)*w(0)
 w(48116) = u(43)*w(0)
 w(48117) = u(44)*w(0)
endif
! terms of degree 7
if (7.le.mxd) then
 w(48118:84417) = u(0)*w(11818:48117)
 w(84418:111530) = u(1)*w(21005:48117)
 w(111531:131572) = u(2)*w(28076:48117)
 w(131573:146230) = u(3)*w(33460:48117)
 w(146231:156837) = u(4)*w(37511:48117)
 w(156838:164437) = u(5)*w(40518:48117)
 w(164438:169841) = u(6)*w(42714:48117)
 w(169842:173675) = u(7)*w(44284:48117)
 w(173676:176421) = u(8)*w(45372:48117)
 w(176422:178452) = u(9)*w(46087:48117)
 w(178453:178632) = u(10)*w(11638:11817)
 w(178633:178803) = u(11)*w(11647:11817)
 w(178804:178965) = u(12)*w(11656:11817)
 w(178966:179118) = u(13)*w(11665:11817)
 w(179119:179262) = u(14)*w(11674:11817)
 w(179263:179397) = u(15)*w(11683:11817)
 w(179398:179523) = u(16)*w(11692:11817)
 w(179524:179640) = u(17)*w(11701:11817)
 w(179641:179748) = u(18)*w(11710:11817)
 w(179749:179847) = u(19)*w(11719:11817)
 w(179848:179937) = u(20)*w(11728:11817)
 w(179938:180018) = u(21)*w(11737:11817)
 w(180019:180090) = u(22)*w(11746:11817)
 w(180091:180153) = u(23)*w(11755:11817)
 w(180154:180207) = u(24)*w(11764:11817)
 w(180208:180252) = u(25)*w(11773:11817)
 w(180253:180288) = u(26)*w(11782:11817)
 w(180289:180315) = u(27)*w(11791:11817)
 w(180316:180333) = u(28)*w(11800:11817)
 w(180334:180342) = u(29)*w(11809:11817)
 w(180343) = u(30)*w(2630)
 w(180344) = u(31)*w(2630)
 w(180345) = u(32)*w(2630)
 w(180346) = u(33)*w(2630)
 w(180347) = u(34)*w(2630)
 w(180348) = u(35)*w(2630)
 w(180349) = u(36)*w(2630)
 w(180350) = u(37)*w(2630)
 w(180351) = u(38)*w(2630)
endif
! terms of degree 8
if (8.le.mxd) then
 w(180352:312585) = u(0)*w(48118:180351)
 w(312586:408519) = u(1)*w(84418:180351)
 w(408520:477340) = u(2)*w(111531:180351)
 w(477341:526119) = u(3)*w(131573:180351)
 w(526120:560240) = u(4)*w(146231:180351)
 w(560241:583754) = u(5)*w(156838:180351)
 w(583755:599668) = u(6)*w(164438:180351)
 w(599669:610178) = u(7)*w(169842:180351)
 w(610179:616854) = u(8)*w(173676:180351)
 w(616855:620784) = u(9)*w(176422:180351)
 w(620785:622394) = u(10)*w(46508:48117)
 w(622395:623793) = u(11)*w(46719:48117)
 w(623794:625001) = u(12)*w(46910:48117)
 w(625002:626037) = u(13)*w(47082:48117)
 w(626038:626919) = u(14)*w(47236:48117)
 w(626920:627664) = u(15)*w(47373:48117)
 w(627665:628288) = u(16)*w(47494:48117)
 w(628289:628806) = u(17)*w(47600:48117)
 w(628807:629232) = u(18)*w(47692:48117)
 w(629233:629579) = u(19)*w(47771:48117)
 w(629580:629859) = u(20)*w(47838:48117)
 w(629860:630083) = u(21)*w(47894:48117)
 w(630084:630261) = u(22)*w(47940:48117)
 w(630262:630402) = u(23)*w(47977:48117)
 w(630403:630514) = u(24)*w(48006:48117)
 w(630515:630604) = u(25)*w(48028:48117)
 w(630605:630678) = u(26)*w(48044:48117)
 w(630679:630741) = u(27)*w(48055:48117)
 w(630742:630797) = u(28)*w(48062:48117)
 w(630798:630849) = u(29)*w(48066:48117)
 w(630850) = u(39)*w(2630)
endif
! terms of degree 9
if (9.le.mxd) then
 w(630851:1081349) = u(0)*w(180352:630850)
 w(1081350:1399614) = u(1)*w(312586:630850)
 w(1399615:1621945) = u(2)*w(408520:630850)
 w(1621946:1775455) = u(3)*w(477341:630850)
 w(1775456:1880186) = u(4)*w(526120:630850)
 w(1880187:1950796) = u(5)*w(560241:630850)
 w(1950797:1997892) = u(6)*w(583755:630850)
 w(1997893:2029074) = u(7)*w(599669:630850)
 w(2029075:2049746) = u(8)*w(610179:630850)
 w(2049747:2063742) = u(9)*w(616855:630850)
 w(2063743:2065641) = u(10)*w(178453:180351)
 w(2065642:2067360) = u(11)*w(178633:180351)
 w(2067361:2068908) = u(12)*w(178804:180351)
 w(2068909:2070294) = u(13)*w(178966:180351)
 w(2070295:2071527) = u(14)*w(179119:180351)
 w(2071528:2072616) = u(15)*w(179263:180351)
 w(2072617:2073570) = u(16)*w(179398:180351)
 w(2073571:2074398) = u(17)*w(179524:180351)
 w(2074399:2075109) = u(18)*w(179641:180351)
 w(2075110:2075712) = u(19)*w(179749:180351)
 w(2075713:2076216) = u(20)*w(179848:180351)
 w(2076217:2076630) = u(21)*w(179938:180351)
 w(2076631:2076963) = u(22)*w(180019:180351)
 w(2076964:2077224) = u(23)*w(180091:180351)
 w(2077225:2077422) = u(24)*w(180154:180351)
 w(2077423:2077566) = u(25)*w(180208:180351)
 w(2077567:2077665) = u(26)*w(180253:180351)
 w(2077666:2077728) = u(27)*w(180289:180351)
 w(2077729:2077764) = u(28)*w(180316:180351)
 w(2077765:2077782) = u(29)*w(180334:180351)
 w(2077783:2077832) = u(30)*w(48068:48117)
 w(2077833:2077873) = u(31)*w(48077:48117)
 w(2077874:2077906) = u(32)*w(48085:48117)
 w(2077907:2077932) = u(33)*w(48092:48117)
 w(2077933:2077952) = u(34)*w(48098:48117)
 w(2077953:2077967) = u(35)*w(48103:48117)
 w(2077968:2077978) = u(36)*w(48107:48117)
 w(2077979:2077986) = u(37)*w(48110:48117)
 w(2077987:2077992) = u(38)*w(48112:48117)
endif
END SUBROUTINE mg3322_prib
